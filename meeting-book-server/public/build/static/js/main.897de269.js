/*! For license information please see main.897de269.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:o,_owner:a.current}}t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function w(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=w.prototype=new y;b.constructor=w,g(b,v.prototype),b.isPureReactComponent=!0;var C=Array.isArray,S=Object.prototype.hasOwnProperty,E={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,r){var i,o={},s=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)S.call(t,i)&&!T.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:n,type:e,key:s,ref:a,props:o,_owner:E.current}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function R(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===o?"."+k(l,0):o,C(s)?(i="",null!=e&&(i=e.replace(A,"$&/")+"/"),R(s,t,i,"",function(e){return e})):null!=s&&(I(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(A,"$&/")+"/")+e)),t.push(s)),1;if(l=0,o=""===o?".":o+":",C(e))for(var c=0;c<e.length;c++){var u=o+k(a=e[c],c);l+=R(a,t,i,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=R(a=a.value,t,i,u=o+k(a,c++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function D(e,t,n){if(null==e)return e;var r=[],i=0;return R(e,r,"","",function(e){return t.call(n,e,i++)}),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var x={current:null},O={transition:null},N={ReactCurrentDispatcher:x,ReactCurrentBatchConfig:O,ReactCurrentOwner:E};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:D,forEach:function(e,t,n){D(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return D(e,function(){t++}),t},toArray:function(e){return D(e,function(e){return e})||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=w,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),o=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=E.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!T.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:o,ref:s,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return x.current.useCallback(e,t)},t.useContext=function(e){return x.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return x.current.useDeferredValue(e)},t.useEffect=function(e,t){return x.current.useEffect(e,t)},t.useId=function(){return x.current.useId()},t.useImperativeHandle=function(e,t,n){return x.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return x.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return x.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return x.current.useMemo(e,t)},t.useReducer=function(e,t,n){return x.current.useReducer(e,t,n)},t.useRef=function(e){return x.current.useRef(e)},t.useState=function(e){return x.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return x.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return x.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function C(e){if(m=!1,b(e),!g)if(null!==r(c))g=!0,O(S);else{var t=r(u);null!==t&&N(C,t.startTime-e)}}function S(e,n){g=!1,m&&(m=!1,y(I),I=-1),p=!0;var o=f;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!R());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var a=s(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?h.callback=a:h===r(c)&&i(c),b(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&N(C,d.startTime-n),l=!1}return l}finally{h=null,f=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,T=!1,_=null,I=-1,A=5,k=-1;function R(){return!(t.unstable_now()-k<A)}function D(){if(null!==_){var e=t.unstable_now();k=e;var n=!0;try{n=_(!0,e)}finally{n?E():(T=!1,_=null)}}else T=!1}if("function"===typeof w)E=function(){w(D)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,x=P.port2;P.port1.onmessage=D,E=function(){x.postMessage(null)}}else E=function(){v(D,0)};function O(e){_=e,T||(T=!0,E())}function N(e,n){I=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,O(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(m?(y(I),I=-1):m=!0,N(C,o-s))):(e.sortIndex=a,n(c,e),g||p||(g=!0,O(S))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),o=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=new Set,h={};function f(e,t){p(e,t),p(e+"Capture",t)}function p(e,t){for(h[e]=t,e=0;e<t.length;e++)c.add(t[e])}var m=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),w=Object.prototype.hasOwnProperty,b=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,C={},S={};function T(e,t,n,r,i,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var I={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){I[e]=new T(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];I[t]=new T(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){I[e]=new T(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){I[e]=new T(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){I[e]=new T(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){I[e]=new T(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){I[e]=new T(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){I[e]=new T(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){I[e]=new T(e,5,!1,e.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function k(e){return e[1].toUpperCase()}function R(e,t,n,r){var i=I.hasOwnProperty(t)?I[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!w.call(S,e)||!w.call(C,e)&&(b.test(e)?S[e]=!0:(C[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(A,k);I[t]=new T(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(A,k);I[t]=new T(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(A,k);I[t]=new T(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){I[e]=new T(e,1,!1,e.toLowerCase(),null,!1,!1)}),I.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){I[e]=new T(e,1,!1,e.toLowerCase(),null,!0,!0)});var D=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P=Symbol.for("react.element"),x=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),U=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),j=Symbol.for("react.suspense_list"),B=Symbol.for("react.memo"),z=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var q=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var V=Symbol.iterator;function W(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=V&&e[V]||e["@@iterator"])?e:null}var $,G=Object.assign;function K(e){if(void 0===$)try{throw Error()}catch(g){var t=g.stack.trim().match(/\n( *(at )?)/);$=t&&t[1]||""}return"\n"+$+e}var Q=!1;function Y(e,t){if(!e||Q)return"";Q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(i){var r=i}Reflect.construct(e,[],t)}else{try{t.call()}catch(i){r=i}e.call(t.prototype)}else{try{throw Error()}catch(i){r=i}e()}}catch(i){if(i&&r&&"string"===typeof i.stack){for(var o=i.stack.split("\n"),s=r.stack.split("\n"),a=o.length-1,l=s.length-1;1<=a&&0<=l&&o[a]!==s[l];)l--;for(;1<=a&&0<=l;a--,l--)if(o[a]!==s[l]){if(1!==a||1!==l)do{if(a--,0>--l||o[a]!==s[l]){var c="\n"+o[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=a&&0<=l);break}}}finally{Q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?K(e):""}function J(e){switch(e.tag){case 5:return K(e.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return e=Y(e.type,!1);case 11:return e=Y(e.type.render,!1);case 1:return e=Y(e.type,!0);default:return""}}function X(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case O:return"Fragment";case x:return"Portal";case M:return"Profiler";case N:return"StrictMode";case H:return"Suspense";case j:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case U:return(e.displayName||"Context")+".Consumer";case L:return(e._context.displayName||"Context")+".Provider";case F:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case B:return null!==(t=e.displayName||null)?t:X(e.type)||"Memo";case z:t=e._payload,e=e._init;try{return X(e(t))}catch(g){}}return null}function Z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(t);case 8:return t===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function ee(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function te(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ne(e){e._valueTracker||(e._valueTracker=function(e){var t=te(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function re(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=te(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ie(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(E){return e.body}}function oe(e,t){var n=t.checked;return G({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function se(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=ee(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function ae(e,t){null!=(t=t.checked)&&R(e,"checked",t,!1)}function le(e,t){ae(e,t);var n=ee(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ue(e,t.type,n):t.hasOwnProperty("defaultValue")&&ue(e,t.type,ee(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ce(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ue(e,t,n){"number"===t&&ie(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var de=Array.isArray;function he(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ee(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function fe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return G({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function pe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(de(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:ee(n)}}function ge(e,t){var n=ee(t.value),r=ee(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function me(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ve(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ye(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ve(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var we,be=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n)})}:e}(function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((we=we||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=we.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ce(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Se={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ee=["Webkit","ms","Moz","O"];function Te(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||Se.hasOwnProperty(e)&&Se[e]?(""+t).trim():t+"px"}function _e(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=Te(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(Se).forEach(function(e){Ee.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Se[t]=Se[e]})});var Ie=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ae(e,t){if(t){if(Ie[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Re=null;function De(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Pe=null,xe=null,Oe=null;function Ne(e){if(e=ki(e)){if("function"!==typeof Pe)throw Error(s(280));var t=e.stateNode;t&&(t=Di(t),Pe(e.stateNode,e.type,t))}}function Me(e){xe?Oe?Oe.push(e):Oe=[e]:xe=e}function Le(){if(xe){var e=xe,t=Oe;if(Oe=xe=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function Ue(e,t){return e(t)}function Fe(){}var He=!1;function je(e,t,n){if(He)return e(t,n);He=!0;try{return Ue(e,t,n)}finally{He=!1,(null!==xe||null!==Oe)&&(Fe(),Le())}}function Be(e,t){var n=e.stateNode;if(null===n)return null;var r=Di(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var ze=!1;if(m)try{var qe={};Object.defineProperty(qe,"passive",{get:function(){ze=!0}}),window.addEventListener("test",qe,qe),window.removeEventListener("test",qe,qe)}catch(v){ze=!1}function Ve(e,t,n,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(_){this.onError(_)}}var We=!1,$e=null,Ge=!1,Ke=null,Qe={onError:function(e){We=!0,$e=e}};function Ye(e,t,n,r,i,o,s,a,l){We=!1,$e=null,Ve.apply(Qe,arguments)}function Je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Xe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ze(e){if(Je(e)!==e)throw Error(s(188))}function et(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Je(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Ze(i),e;if(o===r)return Ze(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?tt(e):null}function tt(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=tt(e);if(null!==t)return t;e=e.sibling}return null}var nt=o.unstable_scheduleCallback,rt=o.unstable_cancelCallback,it=o.unstable_shouldYield,ot=o.unstable_requestPaint,st=o.unstable_now,at=o.unstable_getCurrentPriorityLevel,lt=o.unstable_ImmediatePriority,ct=o.unstable_UserBlockingPriority,ut=o.unstable_NormalPriority,dt=o.unstable_LowPriority,ht=o.unstable_IdlePriority,ft=null,pt=null;var gt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(mt(e)/vt|0)|0},mt=Math.log,vt=Math.LN2;var yt=64,wt=4194304;function bt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ct(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~i;0!==a?r=bt(a):0!==(o&=s)&&(r=bt(o))}else 0!==(s=n&~i)?r=bt(s):0!==o&&(r=bt(o));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-gt(t)),r|=e[n],t&=~i;return r}function St(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Et(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Tt(){var e=yt;return 0===(4194240&(yt<<=1))&&(yt=64),e}function _t(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function It(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-gt(t)]=n}function At(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-gt(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var kt=0;function Rt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Dt,Pt,xt,Ot,Nt,Mt=!1,Lt=[],Ut=null,Ft=null,Ht=null,jt=new Map,Bt=new Map,zt=[],qt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vt(e,t){switch(e){case"focusin":case"focusout":Ut=null;break;case"dragenter":case"dragleave":Ft=null;break;case"mouseover":case"mouseout":Ht=null;break;case"pointerover":case"pointerout":jt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bt.delete(t.pointerId)}}function Wt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=ki(t))&&Pt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function $t(e){var t=Ai(e.target);if(null!==t){var n=Je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Xe(n)))return e.blockedOn=t,void Nt(e.priority,function(){xt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Gt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=on(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ki(n))&&Pt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Re=r,n.target.dispatchEvent(r),Re=null,t.shift()}return!0}function Kt(e,t,n){Gt(e)&&n.delete(t)}function Qt(){Mt=!1,null!==Ut&&Gt(Ut)&&(Ut=null),null!==Ft&&Gt(Ft)&&(Ft=null),null!==Ht&&Gt(Ht)&&(Ht=null),jt.forEach(Kt),Bt.forEach(Kt)}function Yt(e,t){e.blockedOn===t&&(e.blockedOn=null,Mt||(Mt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Qt)))}function Jt(e){function t(t){return Yt(t,e)}if(0<Lt.length){Yt(Lt[0],e);for(var n=1;n<Lt.length;n++){var r=Lt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ut&&Yt(Ut,e),null!==Ft&&Yt(Ft,e),null!==Ht&&Yt(Ht,e),jt.forEach(t),Bt.forEach(t),n=0;n<zt.length;n++)(r=zt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<zt.length&&null===(n=zt[0]).blockedOn;)$t(n),null===n.blockedOn&&zt.shift()}var Xt=D.ReactCurrentBatchConfig,Zt=!0;function en(e,t,n,r){var i=kt,o=Xt.transition;Xt.transition=null;try{kt=1,nn(e,t,n,r)}finally{kt=i,Xt.transition=o}}function tn(e,t,n,r){var i=kt,o=Xt.transition;Xt.transition=null;try{kt=4,nn(e,t,n,r)}finally{kt=i,Xt.transition=o}}function nn(e,t,n,r){if(Zt){var i=on(e,t,n,r);if(null===i)Zr(e,t,r,rn,n),Vt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ut=Wt(Ut,e,t,n,r,i),!0;case"dragenter":return Ft=Wt(Ft,e,t,n,r,i),!0;case"mouseover":return Ht=Wt(Ht,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return jt.set(o,Wt(jt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Bt.set(o,Wt(Bt.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Vt(e,r),4&t&&-1<qt.indexOf(e)){for(;null!==i;){var o=ki(i);if(null!==o&&Dt(o),null===(o=on(e,t,n,r))&&Zr(e,t,r,rn,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Zr(e,t,r,null,n)}}var rn=null;function on(e,t,n,r){if(rn=null,null!==(e=Ai(e=De(r))))if(null===(t=Je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Xe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return rn=e,null}function sn(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(at()){case lt:return 1;case ct:return 4;case ut:case dt:return 16;case ht:return 536870912;default:return 16}default:return 16}}var an=null,ln=null,cn=null;function un(){if(cn)return cn;var e,t,n=ln,r=n.length,i="value"in an?an.value:an.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return cn=i.slice(e,1<t?1-t:void 0)}function dn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function hn(){return!0}function fn(){return!1}function pn(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?hn:fn,this.isPropagationStopped=fn,this}return G(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=hn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=hn)},persist:function(){},isPersistent:hn}),t}var gn,mn,vn,yn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wn=pn(yn),bn=G({},yn,{view:0,detail:0}),Cn=pn(bn),Sn=G({},bn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==vn&&(vn&&"mousemove"===e.type?(gn=e.screenX-vn.screenX,mn=e.screenY-vn.screenY):mn=gn=0,vn=e),gn)},movementY:function(e){return"movementY"in e?e.movementY:mn}}),En=pn(Sn),Tn=pn(G({},Sn,{dataTransfer:0})),_n=pn(G({},bn,{relatedTarget:0})),In=pn(G({},yn,{animationName:0,elapsedTime:0,pseudoElement:0})),An=G({},yn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=pn(An),Rn=pn(G({},yn,{data:0})),Dn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function On(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function Nn(){return On}var Mn=G({},bn,{key:function(e){if(e.key){var t=Dn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=dn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Pn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nn,charCode:function(e){return"keypress"===e.type?dn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?dn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ln=pn(Mn),Un=pn(G({},Sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Fn=pn(G({},bn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nn})),Hn=pn(G({},yn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=G({},Sn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Bn=pn(jn),zn=[9,13,27,32],qn=m&&"CompositionEvent"in window,Vn=null;m&&"documentMode"in document&&(Vn=document.documentMode);var Wn=m&&"TextEvent"in window&&!Vn,$n=m&&(!qn||Vn&&8<Vn&&11>=Vn),Gn=String.fromCharCode(32),Kn=!1;function Qn(e,t){switch(e){case"keyup":return-1!==zn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Jn=!1;var Xn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Xn[e.type]:"textarea"===t}function er(e,t,n,r){Me(r),0<(t=ti(t,"onChange")).length&&(n=new wn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var tr=null,nr=null;function rr(e){Gr(e,0)}function ir(e){if(re(Ri(e)))return e}function or(e,t){if("change"===e)return t}var sr=!1;if(m){var ar;if(m){var lr="oninput"in document;if(!lr){var cr=document.createElement("div");cr.setAttribute("oninput","return;"),lr="function"===typeof cr.oninput}ar=lr}else ar=!1;sr=ar&&(!document.documentMode||9<document.documentMode)}function ur(){tr&&(tr.detachEvent("onpropertychange",dr),nr=tr=null)}function dr(e){if("value"===e.propertyName&&ir(nr)){var t=[];er(t,nr,e,De(e)),je(rr,t)}}function hr(e,t,n){"focusin"===e?(ur(),nr=n,(tr=t).attachEvent("onpropertychange",dr)):"focusout"===e&&ur()}function fr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return ir(nr)}function pr(e,t){if("click"===e)return ir(t)}function gr(e,t){if("input"===e||"change"===e)return ir(t)}var mr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function vr(e,t){if(mr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!w.call(t,i)||!mr(e[i],t[i]))return!1}return!0}function yr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wr(e,t){var n,r=yr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=yr(r)}}function br(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?br(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Cr(){for(var e=window,t=ie();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ie((e=t.contentWindow).document)}return t}function Sr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function Er(e){var t=Cr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&br(n.ownerDocument.documentElement,n)){if(null!==r&&Sr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=wr(n,o);var s=wr(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Tr=m&&"documentMode"in document&&11>=document.documentMode,_r=null,Ir=null,Ar=null,kr=!1;function Rr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;kr||null==_r||_r!==ie(r)||("selectionStart"in(r=_r)&&Sr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},Ar&&vr(Ar,r)||(Ar=r,0<(r=ti(Ir,"onSelect")).length&&(t=new wn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=_r)))}function Dr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Pr={animationend:Dr("Animation","AnimationEnd"),animationiteration:Dr("Animation","AnimationIteration"),animationstart:Dr("Animation","AnimationStart"),transitionend:Dr("Transition","TransitionEnd")},xr={},Or={};function Nr(e){if(xr[e])return xr[e];if(!Pr[e])return e;var t,n=Pr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Or)return xr[e]=n[t];return e}m&&(Or=document.createElement("div").style,"AnimationEvent"in window||(delete Pr.animationend.animation,delete Pr.animationiteration.animation,delete Pr.animationstart.animation),"TransitionEvent"in window||delete Pr.transitionend.transition);var Mr=Nr("animationend"),Lr=Nr("animationiteration"),Ur=Nr("animationstart"),Fr=Nr("transitionend"),Hr=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(e,t){Hr.set(e,t),f(t,[e])}for(var zr=0;zr<jr.length;zr++){var qr=jr[zr];Br(qr.toLowerCase(),"on"+(qr[0].toUpperCase()+qr.slice(1)))}Br(Mr,"onAnimationEnd"),Br(Lr,"onAnimationIteration"),Br(Ur,"onAnimationStart"),Br("dblclick","onDoubleClick"),Br("focusin","onFocus"),Br("focusout","onBlur"),Br(Fr,"onTransitionEnd"),p("onMouseEnter",["mouseout","mouseover"]),p("onMouseLeave",["mouseout","mouseover"]),p("onPointerEnter",["pointerout","pointerover"]),p("onPointerLeave",["pointerout","pointerover"]),f("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),f("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),f("onBeforeInput",["compositionend","keypress","textInput","paste"]),f("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),f("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vr));function $r(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,c){if(Ye.apply(this,arguments),We){if(!We)throw Error(s(198));var u=$e;We=!1,$e=null,Ge||(Ge=!0,Ke=u)}}(r,t,void 0,e),e.currentTarget=null}function Gr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;$r(i,a,c),o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;$r(i,a,c),o=l}}}if(Ge)throw e=Ke,Ge=!1,Ke=null,e}function Kr(e,t){var n=t[Ti];void 0===n&&(n=t[Ti]=new Set);var r=e+"__bubble";n.has(r)||(Xr(t,e,2,!1),n.add(r))}function Qr(e,t,n){var r=0;t&&(r|=4),Xr(n,e,r,t)}var Yr="_reactListening"+Math.random().toString(36).slice(2);function Jr(e){if(!e[Yr]){e[Yr]=!0,c.forEach(function(t){"selectionchange"!==t&&(Wr.has(t)||Qr(t,!1,e),Qr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Yr]||(t[Yr]=!0,Qr("selectionchange",!1,t))}}function Xr(e,t,n,r){switch(sn(t)){case 1:var i=en;break;case 4:i=tn;break;default:i=nn}n=i.bind(null,t,n,e),i=void 0,!ze||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Zr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==a;){if(null===(s=Ai(a)))return;if(5===(l=s.tag)||6===l){r=o=s;continue e}a=a.parentNode}}r=r.return}je(function(){var r=o,i=De(n),s=[];e:{var a=Hr.get(e);if(void 0!==a){var l=wn,c=e;switch(e){case"keypress":if(0===dn(n))break e;case"keydown":case"keyup":l=Ln;break;case"focusin":c="focus",l=_n;break;case"focusout":c="blur",l=_n;break;case"beforeblur":case"afterblur":l=_n;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=En;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=Tn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Fn;break;case Mr:case Lr:case Ur:l=In;break;case Fr:l=Hn;break;case"scroll":l=Cn;break;case"wheel":l=Bn;break;case"copy":case"cut":case"paste":l=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Un}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==h&&(null!=(g=Be(p,h))&&u.push(ei(p,g,f)))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Re||!(c=n.relatedTarget||n.fromElement)||!Ai(c)&&!c[Ei])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?Ai(c):null)&&(c!==(d=Je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=En,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Un,g="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:Ri(l),f=null==c?a:Ri(c),(a=new u(g,p+"leave",l,n,i)).target=d,a.relatedTarget=f,g=null,Ai(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,g=u),d=g,l&&c)e:{for(h=c,p=0,f=u=l;f;f=ni(f))p++;for(f=0,g=h;g;g=ni(g))f++;for(;0<p-f;)u=ni(u),p--;for(;0<f-p;)h=ni(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=ni(u),h=ni(h)}u=null}else u=null;null!==l&&ri(s,a,l,u,!1),null!==c&&null!==d&&ri(s,d,c,u,!0)}if("select"===(l=(a=r?Ri(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=or;else if(Zn(a))if(sr)m=gr;else{m=fr;var v=hr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=pr);switch(m&&(m=m(e,r))?er(s,m,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ue(a,"number",a.value)),v=r?Ri(r):window,e){case"focusin":(Zn(v)||"true"===v.contentEditable)&&(_r=v,Ir=r,Ar=null);break;case"focusout":Ar=Ir=_r=null;break;case"mousedown":kr=!0;break;case"contextmenu":case"mouseup":case"dragend":kr=!1,Rr(s,n,i);break;case"selectionchange":if(Tr)break;case"keydown":case"keyup":Rr(s,n,i)}var y;if(qn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Jn?Qn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&($n&&"ko"!==n.locale&&(Jn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Jn&&(y=un()):(ln="value"in(an=i)?an.value:an.textContent,Jn=!0)),0<(v=ti(r,w)).length&&(w=new Rn(w,e,null,n,i),s.push({event:w,listeners:v}),y?w.data=y:null!==(y=Yn(n))&&(w.data=y))),(y=Wn?function(e,t){switch(e){case"compositionend":return Yn(t);case"keypress":return 32!==t.which?null:(Kn=!0,Gn);case"textInput":return(e=t.data)===Gn&&Kn?null:e;default:return null}}(e,n):function(e,t){if(Jn)return"compositionend"===e||!qn&&Qn(e,t)?(e=un(),cn=ln=an=null,Jn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return $n&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=ti(r,"onBeforeInput")).length&&(i=new Rn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=y))}Gr(s,t)})}function ei(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ti(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Be(e,n))&&r.unshift(ei(e,o,i)),null!=(o=Be(e,t))&&r.push(ei(e,o,i))),e=e.return}return r}function ni(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function ri(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Be(n,o))&&s.unshift(ei(n,l,a)):i||null!=(l=Be(n,o))&&s.push(ei(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var ii=/\r\n?/g,oi=/\u0000|\uFFFD/g;function si(e){return("string"===typeof e?e:""+e).replace(ii,"\n").replace(oi,"")}function ai(e,t,n){if(t=si(t),si(e)!==t&&n)throw Error(s(425))}function li(){}var ci=null,ui=null;function di(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var hi="function"===typeof setTimeout?setTimeout:void 0,fi="function"===typeof clearTimeout?clearTimeout:void 0,pi="function"===typeof Promise?Promise:void 0,gi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof pi?function(e){return pi.resolve(null).then(e).catch(mi)}:hi;function mi(e){setTimeout(function(){throw e})}function vi(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Jt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Jt(t)}function yi(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function wi(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var bi=Math.random().toString(36).slice(2),Ci="__reactFiber$"+bi,Si="__reactProps$"+bi,Ei="__reactContainer$"+bi,Ti="__reactEvents$"+bi,_i="__reactListeners$"+bi,Ii="__reactHandles$"+bi;function Ai(e){var t=e[Ci];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ei]||n[Ci]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=wi(e);null!==e;){if(n=e[Ci])return n;e=wi(e)}return t}n=(e=n).parentNode}return null}function ki(e){return!(e=e[Ci]||e[Ei])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ri(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Di(e){return e[Si]||null}var Pi=[],xi=-1;function Oi(e){return{current:e}}function Ni(e){0>xi||(e.current=Pi[xi],Pi[xi]=null,xi--)}function Mi(e,t){xi++,Pi[xi]=e.current,e.current=t}var Li={},Ui=Oi(Li),Fi=Oi(!1),Hi=Li;function ji(e,t){var n=e.type.contextTypes;if(!n)return Li;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Bi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function zi(){Ni(Fi),Ni(Ui)}function qi(e,t,n){if(Ui.current!==Li)throw Error(s(168));Mi(Ui,t),Mi(Fi,n)}function Vi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,Z(e)||"Unknown",i));return G({},n,r)}function Wi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Li,Hi=Ui.current,Mi(Ui,e),Mi(Fi,Fi.current),!0}function $i(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Vi(e,t,Hi),r.__reactInternalMemoizedMergedChildContext=e,Ni(Fi),Ni(Ui),Mi(Ui,e)):Ni(Fi),Mi(Fi,n)}var Gi=null,Ki=!1,Qi=!1;function Yi(e){null===Gi?Gi=[e]:Gi.push(e)}function Ji(){if(!Qi&&null!==Gi){Qi=!0;var e=0,t=kt;try{var n=Gi;for(kt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Gi=null,Ki=!1}catch(d){throw null!==Gi&&(Gi=Gi.slice(e+1)),nt(lt,Ji),d}finally{kt=t,Qi=!1}}return null}var Xi=[],Zi=0,eo=null,to=0,no=[],ro=0,io=null,oo=1,so="";function ao(e,t){Xi[Zi++]=to,Xi[Zi++]=eo,eo=e,to=t}function lo(e,t,n){no[ro++]=oo,no[ro++]=so,no[ro++]=io,io=e;var r=oo;e=so;var i=32-gt(r)-1;r&=~(1<<i),n+=1;var o=32-gt(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,oo=1<<32-gt(t)+i|n<<i|r,so=o+e}else oo=1<<o|n<<i|r,so=e}function co(e){null!==e.return&&(ao(e,1),lo(e,1,0))}function uo(e){for(;e===eo;)eo=Xi[--Zi],Xi[Zi]=null,to=Xi[--Zi],Xi[Zi]=null;for(;e===io;)io=no[--ro],no[ro]=null,so=no[--ro],no[ro]=null,oo=no[--ro],no[ro]=null}var ho=null,fo=null,po=!1,go=null;function mo(e,t){var n=jc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function vo(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ho=e,fo=yi(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ho=e,fo=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==io?{id:oo,overflow:so}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=jc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ho=e,fo=null,!0);default:return!1}}function yo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function wo(e){if(po){var t=fo;if(t){var n=t;if(!vo(e,t)){if(yo(e))throw Error(s(418));t=yi(n.nextSibling);var r=ho;t&&vo(e,t)?mo(r,n):(e.flags=-4097&e.flags|2,po=!1,ho=e)}}else{if(yo(e))throw Error(s(418));e.flags=-4097&e.flags|2,po=!1,ho=e}}}function bo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ho=e}function Co(e){if(e!==ho)return!1;if(!po)return bo(e),po=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!di(e.type,e.memoizedProps)),t&&(t=fo)){if(yo(e))throw So(),Error(s(418));for(;t;)mo(e,t),t=yi(t.nextSibling)}if(bo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){fo=yi(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}fo=null}}else fo=ho?yi(e.stateNode.nextSibling):null;return!0}function So(){for(var e=fo;e;)e=yi(e.nextSibling)}function Eo(){fo=ho=null,po=!1}function To(e){null===go?go=[e]:go.push(e)}var _o=D.ReactCurrentBatchConfig;function Io(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Ao(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ko(e){return(0,e._init)(e._payload)}function Ro(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=zc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=$c(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===O?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===z&&ko(o)===t.type)?((r=i(t,n.props)).ref=Io(e,t,n),r.return=e,r):((r=qc(n.type,n.key,n.props,null,e.mode,r)).ref=Io(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Gc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Vc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=$c(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case P:return(n=qc(t.type,t.key,t.props,null,e.mode,n)).ref=Io(e,null,t),n.return=e,n;case x:return(t=Gc(t,e.mode,n)).return=e,t;case z:return h(e,(0,t._init)(t._payload),n)}if(de(t)||W(t))return(t=Vc(t,e.mode,n,null)).return=e,t;Ao(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case P:return n.key===i?c(e,t,n,r):null;case x:return n.key===i?u(e,t,n,r):null;case z:return f(e,t,(i=n._init)(n._payload),r)}if(de(n)||W(n))return null!==i?null:d(e,t,n,r,null);Ao(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case P:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case x:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case z:return p(e,t,n,(0,r._init)(r._payload),i)}if(de(r)||W(r))return d(t,e=e.get(n)||null,r,i,null);Ao(t,r)}return null}function g(i,s,a,l){for(var c=null,u=null,d=s,g=s=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=f(i,d,a[g],l);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(i,d),s=o(v,s,g),null===u?c=v:u.sibling=v,u=v,d=m}if(g===a.length)return n(i,d),po&&ao(i,g),c;if(null===d){for(;g<a.length;g++)null!==(d=h(i,a[g],l))&&(s=o(d,s,g),null===u?c=d:u.sibling=d,u=d);return po&&ao(i,g),c}for(d=r(i,d);g<a.length;g++)null!==(m=p(d,i,g,a[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),s=o(m,s,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(i,e)}),po&&ao(i,g),c}function m(i,a,l,c){var u=W(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,g=a,m=a=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var w=f(i,g,y.value,c);if(null===w){null===g&&(g=v);break}e&&g&&null===w.alternate&&t(i,g),a=o(w,a,m),null===d?u=w:d.sibling=w,d=w,g=v}if(y.done)return n(i,g),po&&ao(i,m),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=h(i,y.value,c))&&(a=o(y,a,m),null===d?u=y:d.sibling=y,d=y);return po&&ao(i,m),u}for(g=r(i,g);!y.done;m++,y=l.next())null!==(y=p(g,i,m,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=o(y,a,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach(function(e){return t(i,e)}),po&&ao(i,m),u}return function e(r,o,s,l){if("object"===typeof s&&null!==s&&s.type===O&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case P:e:{for(var c=s.key,u=o;null!==u;){if(u.key===c){if((c=s.type)===O){if(7===u.tag){n(r,u.sibling),(o=i(u,s.props.children)).return=r,r=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===z&&ko(c)===u.type){n(r,u.sibling),(o=i(u,s.props)).ref=Io(r,u,s),o.return=r,r=o;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===O?((o=Vc(s.props.children,r.mode,l,s.key)).return=r,r=o):((l=qc(s.type,s.key,s.props,null,r.mode,l)).ref=Io(r,o,s),l.return=r,r=l)}return a(r);case x:e:{for(u=s.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(r,o.sibling),(o=i(o,s.children||[])).return=r,r=o;break e}n(r,o);break}t(r,o),o=o.sibling}(o=Gc(s,r.mode,l)).return=r,r=o}return a(r);case z:return e(r,o,(u=s._init)(s._payload),l)}if(de(s))return g(r,o,s,l);if(W(s))return m(r,o,s,l);Ao(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==o&&6===o.tag?(n(r,o.sibling),(o=i(o,s)).return=r,r=o):(n(r,o),(o=$c(s,r.mode,l)).return=r,r=o),a(r)):n(r,o)}}var Do=Ro(!0),Po=Ro(!1),xo=Oi(null),Oo=null,No=null,Mo=null;function Lo(){Mo=No=Oo=null}function Uo(e){var t=xo.current;Ni(xo),e._currentValue=t}function Fo(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ho(e,t){Oo=e,Mo=No=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ka=!0),e.firstContext=null)}function jo(e){var t=e._currentValue;if(Mo!==e)if(e={context:e,memoizedValue:t,next:null},null===No){if(null===Oo)throw Error(s(308));No=e,Oo.dependencies={lanes:0,firstContext:e}}else No=No.next=e;return t}var Bo=null;function zo(e){null===Bo?Bo=[e]:Bo.push(e)}function qo(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,zo(t)):(n.next=i.next,i.next=n),t.interleaved=n,Vo(e,r)}function Vo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Wo=!1;function $o(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Go(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ko(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Ul)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Vo(e,n)}return null===(i=r.interleaved)?(t.next=t,zo(r)):(t.next=i.next,i.next=t),r.interleaved=t,Vo(e,n)}function Yo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,At(e,n)}}function Jo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Xo(e,t,n,r){var i=e.updateQueue;Wo=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(s=0,u=c=l=null,a=o;;){var h=a.lane,f=a.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(h=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(f,d,h):p)||void 0===h)break e;d=G({},d,h);break e;case 2:Wo=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,s|=h;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(h=a).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Wl|=s,e.lanes=s,e.memoizedState=d}}function Zo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var es={},ts=Oi(es),ns=Oi(es),rs=Oi(es);function is(e){if(e===es)throw Error(s(174));return e}function os(e,t){switch(Mi(rs,t),Mi(ns,e),Mi(ts,es),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ye(null,"");break;default:t=ye(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ni(ts),Mi(ts,t)}function ss(){Ni(ts),Ni(ns),Ni(rs)}function as(e){is(rs.current);var t=is(ts.current),n=ye(t,e.type);t!==n&&(Mi(ns,e),Mi(ts,n))}function ls(e){ns.current===e&&(Ni(ts),Ni(ns))}var cs=Oi(0);function us(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ds=[];function hs(){for(var e=0;e<ds.length;e++)ds[e]._workInProgressVersionPrimary=null;ds.length=0}var fs=D.ReactCurrentDispatcher,ps=D.ReactCurrentBatchConfig,gs=0,ms=null,vs=null,ys=null,ws=!1,bs=!1,Cs=0,Ss=0;function Es(){throw Error(s(321))}function Ts(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!mr(e[n],t[n]))return!1;return!0}function _s(e,t,n,r,i,o){if(gs=o,ms=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fs.current=null===e||null===e.memoizedState?la:ca,e=n(r,i),bs){o=0;do{if(bs=!1,Cs=0,25<=o)throw Error(s(301));o+=1,ys=vs=null,t.updateQueue=null,fs.current=ua,e=n(r,i)}while(bs)}if(fs.current=aa,t=null!==vs&&null!==vs.next,gs=0,ys=vs=ms=null,ws=!1,t)throw Error(s(300));return e}function Is(){var e=0!==Cs;return Cs=0,e}function As(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ys?ms.memoizedState=ys=e:ys=ys.next=e,ys}function ks(){if(null===vs){var e=ms.alternate;e=null!==e?e.memoizedState:null}else e=vs.next;var t=null===ys?ms.memoizedState:ys.next;if(null!==t)ys=t,vs=e;else{if(null===e)throw Error(s(310));e={memoizedState:(vs=e).memoizedState,baseState:vs.baseState,baseQueue:vs.baseQueue,queue:vs.queue,next:null},null===ys?ms.memoizedState=ys=e:ys=ys.next=e}return ys}function Rs(e,t){return"function"===typeof t?t(e):t}function Ds(e){var t=ks(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=vs,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var d=u.lane;if((gs&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=r):c=c.next=h,ms.lanes|=d,Wl|=d}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,mr(r,t.memoizedState)||(ka=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,ms.lanes|=o,Wl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ps(e){var t=ks(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);mr(o,t.memoizedState)||(ka=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function xs(){}function Os(e,t){var n=ms,r=ks(),i=t(),o=!mr(r.memoizedState,i);if(o&&(r.memoizedState=i,ka=!0),r=r.queue,Ws(Ls.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==ys&&1&ys.memoizedState.tag){if(n.flags|=2048,js(9,Ms.bind(null,n,r,i,t),void 0,null),null===Fl)throw Error(s(349));0!==(30&gs)||Ns(n,t,i)}return i}function Ns(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ms(e,t,n,r){t.value=n,t.getSnapshot=r,Us(t)&&Fs(e)}function Ls(e,t,n){return n(function(){Us(t)&&Fs(e)})}function Us(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!mr(e,n)}catch(r){return!0}}function Fs(e){var t=Vo(e,1);null!==t&&dc(t,e,1,-1)}function Hs(e){var t=As();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rs,lastRenderedState:e},t.queue=e,e=e.dispatch=ra.bind(null,ms,e),[t.memoizedState,e]}function js(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ms.updateQueue)?(t={lastEffect:null,stores:null},ms.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Bs(){return ks().memoizedState}function zs(e,t,n,r){var i=As();ms.flags|=e,i.memoizedState=js(1|t,n,void 0,void 0===r?null:r)}function qs(e,t,n,r){var i=ks();r=void 0===r?null:r;var o=void 0;if(null!==vs){var s=vs.memoizedState;if(o=s.destroy,null!==r&&Ts(r,s.deps))return void(i.memoizedState=js(t,n,o,r))}ms.flags|=e,i.memoizedState=js(1|t,n,o,r)}function Vs(e,t){return zs(8390656,8,e,t)}function Ws(e,t){return qs(2048,8,e,t)}function $s(e,t){return qs(4,2,e,t)}function Gs(e,t){return qs(4,4,e,t)}function Ks(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Qs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,qs(4,4,Ks.bind(null,t,e),n)}function Ys(){}function Js(e,t){var n=ks();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ts(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xs(e,t){var n=ks();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ts(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Zs(e,t,n){return 0===(21&gs)?(e.baseState&&(e.baseState=!1,ka=!0),e.memoizedState=n):(mr(n,t)||(n=Tt(),ms.lanes|=n,Wl|=n,e.baseState=!0),t)}function ea(e,t){var n=kt;kt=0!==n&&4>n?n:4,e(!0);var r=ps.transition;ps.transition={};try{e(!1),t()}finally{kt=n,ps.transition=r}}function ta(){return ks().memoizedState}function na(e,t,n){var r=uc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ia(e))oa(t,n);else if(null!==(n=qo(e,t,n,r))){dc(n,e,r,cc()),sa(n,t,r)}}function ra(e,t,n){var r=uc(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ia(e))oa(t,o);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,l=s(a,n);if(o.hasEagerState=!0,o.eagerState=l,mr(l,a)){var c=t.interleaved;return null===c?(o.next=o,zo(t)):(o.next=c.next,c.next=o),void(t.interleaved=o)}}catch(i){}null!==(n=qo(e,t,o,r))&&(dc(n,e,r,o=cc()),sa(n,t,r))}}function ia(e){var t=e.alternate;return e===ms||null!==t&&t===ms}function oa(e,t){bs=ws=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,At(e,n)}}var aa={readContext:jo,useCallback:Es,useContext:Es,useEffect:Es,useImperativeHandle:Es,useInsertionEffect:Es,useLayoutEffect:Es,useMemo:Es,useReducer:Es,useRef:Es,useState:Es,useDebugValue:Es,useDeferredValue:Es,useTransition:Es,useMutableSource:Es,useSyncExternalStore:Es,useId:Es,unstable_isNewReconciler:!1},la={readContext:jo,useCallback:function(e,t){return As().memoizedState=[e,void 0===t?null:t],e},useContext:jo,useEffect:Vs,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zs(4194308,4,Ks.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zs(4194308,4,e,t)},useInsertionEffect:function(e,t){return zs(4,2,e,t)},useMemo:function(e,t){var n=As();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=As();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=na.bind(null,ms,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},As().memoizedState=e},useState:Hs,useDebugValue:Ys,useDeferredValue:function(e){return As().memoizedState=e},useTransition:function(){var e=Hs(!1),t=e[0];return e=ea.bind(null,e[1]),As().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ms,i=As();if(po){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Fl)throw Error(s(349));0!==(30&gs)||Ns(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Vs(Ls.bind(null,r,o,e),[e]),r.flags|=2048,js(9,Ms.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=As(),t=Fl.identifierPrefix;if(po){var n=so;t=":"+t+"R"+(n=(oo&~(1<<32-gt(oo)-1)).toString(32)+n),0<(n=Cs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Ss++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ca={readContext:jo,useCallback:Js,useContext:jo,useEffect:Ws,useImperativeHandle:Qs,useInsertionEffect:$s,useLayoutEffect:Gs,useMemo:Xs,useReducer:Ds,useRef:Bs,useState:function(){return Ds(Rs)},useDebugValue:Ys,useDeferredValue:function(e){return Zs(ks(),vs.memoizedState,e)},useTransition:function(){return[Ds(Rs)[0],ks().memoizedState]},useMutableSource:xs,useSyncExternalStore:Os,useId:ta,unstable_isNewReconciler:!1},ua={readContext:jo,useCallback:Js,useContext:jo,useEffect:Ws,useImperativeHandle:Qs,useInsertionEffect:$s,useLayoutEffect:Gs,useMemo:Xs,useReducer:Ps,useRef:Bs,useState:function(){return Ps(Rs)},useDebugValue:Ys,useDeferredValue:function(e){var t=ks();return null===vs?t.memoizedState=e:Zs(t,vs.memoizedState,e)},useTransition:function(){return[Ps(Rs)[0],ks().memoizedState]},useMutableSource:xs,useSyncExternalStore:Os,useId:ta,unstable_isNewReconciler:!1};function da(e,t){if(e&&e.defaultProps){for(var n in t=G({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ha(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:G({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fa={isMounted:function(e){return!!(e=e._reactInternals)&&Je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=cc(),i=uc(e),o=Ko(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Qo(e,o,i))&&(dc(t,e,i,r),Yo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=cc(),i=uc(e),o=Ko(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=Qo(e,o,i))&&(dc(t,e,i,r),Yo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cc(),r=uc(e),i=Ko(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Qo(e,i,r))&&(dc(t,e,r,n),Yo(t,e,r))}};function pa(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!vr(n,r)||!vr(i,o))}function ga(e,t,n){var r=!1,i=Li,o=t.contextType;return"object"===typeof o&&null!==o?o=jo(o):(i=Bi(t)?Hi:Ui.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?ji(e,i):Li),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=fa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ma(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fa.enqueueReplaceState(t,t.state,null)}function va(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},$o(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=jo(o):(o=Bi(t)?Hi:Ui.current,i.context=ji(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(ha(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&fa.enqueueReplaceState(i,i.state,null),Xo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ya(e,t){try{var n="",r=t;do{n+=J(r),r=r.return}while(r);var i=n}catch(u){i="\nError generating stack: "+u.message+"\n"+u.stack}return{value:e,source:t,stack:i,digest:null}}function wa(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ba(e,t){try{console.error(t.value)}catch(g){setTimeout(function(){throw g})}}var Ca="function"===typeof WeakMap?WeakMap:Map;function Sa(e,t,n){(n=Ko(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Zl||(Zl=!0,ec=r),ba(0,t)},n}function Ea(e,t,n){(n=Ko(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ba(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){ba(0,t),"function"!==typeof r&&(null===tc?tc=new Set([this]):tc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Ta(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Ca;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Nc.bind(null,e,t,n),t.then(e,e))}function _a(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Ia(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ko(-1,1)).tag=2,Qo(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var Aa=D.ReactCurrentOwner,ka=!1;function Ra(e,t,n,r){t.child=null===e?Po(t,null,n,r):Do(t,e.child,n,r)}function Da(e,t,n,r,i){n=n.render;var o=t.ref;return Ho(t,i),r=_s(e,t,n,r,o,i),n=Is(),null===e||ka?(po&&n&&co(t),t.flags|=1,Ra(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Za(e,t,i))}function Pa(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||Bc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=qc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,xa(e,t,o,r,i))}if(o=e.child,0===(e.lanes&i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:vr)(s,r)&&e.ref===t.ref)return Za(e,t,i)}return t.flags|=1,(e=zc(o,r)).ref=t.ref,e.return=t,t.child=e}function xa(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if(vr(o,r)&&e.ref===t.ref){if(ka=!1,t.pendingProps=r=o,0===(e.lanes&i))return t.lanes=e.lanes,Za(e,t,i);0!==(131072&e.flags)&&(ka=!0)}}return Ma(e,t,n,r,i)}function Oa(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mi(zl,Bl),Bl|=n;else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mi(zl,Bl),Bl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==o?o.baseLanes:n,Mi(zl,Bl),Bl|=r}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Mi(zl,Bl),Bl|=r;return Ra(e,t,i,n),t.child}function Na(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ma(e,t,n,r,i){var o=Bi(n)?Hi:Ui.current;return o=ji(t,o),Ho(t,i),n=_s(e,t,n,r,o,i),r=Is(),null===e||ka?(po&&r&&co(t),t.flags|=1,Ra(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Za(e,t,i))}function La(e,t,n,r,i){if(Bi(n)){var o=!0;Wi(t)}else o=!1;if(Ho(t,i),null===t.stateNode)Xa(e,t),ga(t,n,r),va(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=jo(c):c=ji(t,c=Bi(n)?Hi:Ui.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==r||l!==c)&&ma(t,s,r,c),Wo=!1;var h=t.memoizedState;s.state=h,Xo(t,r,s,i),l=t.memoizedState,a!==r||h!==l||Fi.current||Wo?("function"===typeof u&&(ha(t,n,u,r),l=t.memoizedState),(a=Wo||pa(t,n,a,r,h,l,c))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Go(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:da(t.type,a),s.props=c,d=t.pendingProps,h=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=jo(l):l=ji(t,l=Bi(n)?Hi:Ui.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==d||h!==l)&&ma(t,s,r,l),Wo=!1,h=t.memoizedState,s.state=h,Xo(t,r,s,i);var p=t.memoizedState;a!==d||h!==p||Fi.current||Wo?("function"===typeof f&&(ha(t,n,f,r),p=t.memoizedState),(c=Wo||pa(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ua(e,t,n,r,o,i)}function Ua(e,t,n,r,i,o){Na(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&$i(t,n,!1),Za(e,t,o);r=t.stateNode,Aa.current=t;var a=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Do(t,e.child,null,o),t.child=Do(t,null,a,o)):Ra(e,t,a,o),t.memoizedState=r.state,i&&$i(t,n,!0),t.child}function Fa(e){var t=e.stateNode;t.pendingContext?qi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&qi(0,t.context,!1),os(e,t.containerInfo)}function Ha(e,t,n,r,i){return Eo(),To(i),t.flags|=256,Ra(e,t,n,r),t.child}var ja,Ba,za,qa,Va={dehydrated:null,treeContext:null,retryLane:0};function Wa(e){return{baseLanes:e,cachePool:null,transitions:null}}function $a(e,t,n){var r,i=t.pendingProps,o=cs.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Mi(cs,1&o),null===e)return wo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Wc(l,i,0,null),e=Vc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Wa(n),t.memoizedState=Va,e):Ga(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ka(e,t,a,r=wa(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Wc({mode:"visible",children:r.children},i,0,null),(o=Vc(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Do(t,e.child,null,a),t.child.memoizedState=Wa(a),t.memoizedState=Va,o);if(0===(1&t.mode))return Ka(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Ka(e,t,a,r=wa(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),ka||l){if(null!==(r=Fl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Vo(e,i),dc(r,e,i,-1))}return Tc(),Ka(e,t,a,r=wa(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Lc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,fo=yi(i.nextSibling),ho=t,po=!0,go=null,null!==e&&(no[ro++]=oo,no[ro++]=so,no[ro++]=io,oo=e.id,so=e.overflow,io=t),t=Ga(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=zc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=zc(r,a):(a=Vc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Wa(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Va,i}return e=(a=e.child).sibling,i=zc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ga(e,t){return(t=Wc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ka(e,t,n,r){return null!==r&&To(r),Do(t,e.child,null,n),(e=Ga(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Qa(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Fo(e.return,t,n)}function Ya(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ja(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Ra(e,t,r.children,n),0!==(2&(r=cs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Qa(e,n,t);else if(19===e.tag)Qa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Mi(cs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===us(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ya(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===us(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ya(t,!0,n,null,o);break;case"together":Ya(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xa(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Za(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Wl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=zc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function el(e,t){if(!po)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function tl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function nl(e,t,n){var r=t.pendingProps;switch(uo(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tl(t),null;case 1:case 17:return Bi(t.type)&&zi(),tl(t),null;case 3:return r=t.stateNode,ss(),Ni(Fi),Ni(Ui),hs(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Co(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==go&&(gc(go),go=null))),Ba(e,t),tl(t),null;case 5:ls(t);var i=is(rs.current);if(n=t.type,null!==e&&null!=t.stateNode)za(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return tl(t),null}if(e=is(ts.current),Co(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Ci]=t,r[Si]=o,e=0!==(1&t.mode),n){case"dialog":Kr("cancel",r),Kr("close",r);break;case"iframe":case"object":case"embed":Kr("load",r);break;case"video":case"audio":for(i=0;i<Vr.length;i++)Kr(Vr[i],r);break;case"source":Kr("error",r);break;case"img":case"image":case"link":Kr("error",r),Kr("load",r);break;case"details":Kr("toggle",r);break;case"input":se(r,o),Kr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Kr("invalid",r);break;case"textarea":pe(r,o),Kr("invalid",r)}for(var a in Ae(n,o),i=null,o)if(o.hasOwnProperty(a)){var l=o[a];"children"===a?"string"===typeof l?r.textContent!==l&&(!0!==o.suppressHydrationWarning&&ai(r.textContent,l,e),i=["children",l]):"number"===typeof l&&r.textContent!==""+l&&(!0!==o.suppressHydrationWarning&&ai(r.textContent,l,e),i=["children",""+l]):h.hasOwnProperty(a)&&null!=l&&"onScroll"===a&&Kr("scroll",r)}switch(n){case"input":ne(r),ce(r,o,!0);break;case"textarea":ne(r),me(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=li)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{a=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ve(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),"select"===n&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[Ci]=t,e[Si]=r,ja(e,t,!1,!1),t.stateNode=e;e:{switch(a=ke(n,r),n){case"dialog":Kr("cancel",e),Kr("close",e),i=r;break;case"iframe":case"object":case"embed":Kr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Vr.length;i++)Kr(Vr[i],e);i=r;break;case"source":Kr("error",e),i=r;break;case"img":case"image":case"link":Kr("error",e),Kr("load",e),i=r;break;case"details":Kr("toggle",e),i=r;break;case"input":se(e,r),i=oe(e,r),Kr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=G({},r,{value:void 0}),Kr("invalid",e);break;case"textarea":pe(e,r),i=fe(e,r),Kr("invalid",e)}for(o in Ae(n,i),l=i)if(l.hasOwnProperty(o)){var c=l[o];"style"===o?_e(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&be(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&Ce(e,c):"number"===typeof c&&Ce(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(h.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Kr("scroll",e):null!=c&&R(e,o,c,a))}switch(n){case"input":ne(e),ce(e,r,!1);break;case"textarea":ne(e),me(e);break;case"option":null!=r.value&&e.setAttribute("value",""+ee(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?he(e,!!r.multiple,o,!1):null!=r.defaultValue&&he(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=li)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return tl(t),null;case 6:if(e&&null!=t.stateNode)qa(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=is(rs.current),is(ts.current),Co(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ci]=t,(o=r.nodeValue!==n)&&null!==(e=ho))switch(e.tag){case 3:ai(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&ai(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Ci]=t,t.stateNode=r}return tl(t),null;case 13:if(Ni(cs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(po&&null!==fo&&0!==(1&t.mode)&&0===(128&t.flags))So(),Eo(),t.flags|=98560,o=!1;else if(o=Co(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[Ci]=t}else Eo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;tl(t),o=!1}else null!==go&&(gc(go),go=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&cs.current)?0===ql&&(ql=3):Tc())),null!==t.updateQueue&&(t.flags|=4),tl(t),null);case 4:return ss(),Ba(e,t),null===e&&Jr(t.stateNode.containerInfo),tl(t),null;case 10:return Uo(t.type._context),tl(t),null;case 19:if(Ni(cs),null===(o=t.memoizedState))return tl(t),null;if(r=0!==(128&t.flags),null===(a=o.rendering))if(r)el(o,!1);else{if(0!==ql||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(a=us(e))){for(t.flags|=128,el(o,!1),null!==(r=a.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(a=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Mi(cs,1&cs.current|2),t.child}e=e.sibling}null!==o.tail&&st()>Jl&&(t.flags|=128,r=!0,el(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=us(a))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),el(o,!0),null===o.tail&&"hidden"===o.tailMode&&!a.alternate&&!po)return tl(t),null}else 2*st()-o.renderingStartTime>Jl&&1073741824!==n&&(t.flags|=128,r=!0,el(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(null!==(n=o.last)?n.sibling=a:t.child=a,o.last=a)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=st(),t.sibling=null,n=cs.current,Mi(cs,r?1&n|2:1&n),t):(tl(t),null);case 22:case 23:return bc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Bl)&&(tl(t),6&t.subtreeFlags&&(t.flags|=8192)):tl(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function rl(e,t){switch(uo(t),t.tag){case 1:return Bi(t.type)&&zi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ss(),Ni(Fi),Ni(Ui),hs(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ls(t),null;case 13:if(Ni(cs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));Eo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ni(cs),null;case 4:return ss(),null;case 10:return Uo(t.type._context),null;case 22:case 23:return bc(),null;default:return null}}ja=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ba=function(){},za=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,is(ts.current);var o,s=null;switch(n){case"input":i=oe(e,i),r=oe(e,r),s=[];break;case"select":i=G({},i,{value:void 0}),r=G({},r,{value:void 0}),s=[];break;case"textarea":i=fe(e,i),r=fe(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=li)}for(c in Ae(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(h.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(null!=l||null!=a))if("style"===c)if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(s=s||[]).push(c,l)):"children"===c?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(h.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&Kr("scroll",e),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(t.updateQueue=c)&&(t.flags|=4)}},qa=function(e,t,n,r){n!==r&&(t.flags|=4)};var il=!1,ol=!1,sl="function"===typeof WeakSet?WeakSet:Set,al=null;function ll(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Oc(e,t,r)}else n.current=null}function cl(e,t,n){try{n()}catch(r){Oc(e,t,r)}}var ul=!1;function dl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&cl(t,n,o)}i=i.next}while(i!==r)}}function hl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function fl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function pl(e){var t=e.alternate;null!==t&&(e.alternate=null,pl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[Ci],delete t[Si],delete t[Ti],delete t[_i],delete t[Ii])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function gl(e){return 5===e.tag||3===e.tag||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||gl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=li));else if(4!==r&&null!==(e=e.child))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(yl(e,t,n),e=e.sibling;null!==e;)yl(e,t,n),e=e.sibling}var wl=null,bl=!1;function Cl(e,t,n){for(n=n.child;null!==n;)Sl(e,t,n),n=n.sibling}function Sl(e,t,n){if(pt&&"function"===typeof pt.onCommitFiberUnmount)try{pt.onCommitFiberUnmount(ft,n)}catch(y){}switch(n.tag){case 5:ol||ll(n,t);case 6:var r=wl,i=bl;wl=null,Cl(e,t,n),bl=i,null!==(wl=r)&&(bl?(e=wl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):wl.removeChild(n.stateNode));break;case 18:null!==wl&&(bl?(e=wl,n=n.stateNode,8===e.nodeType?vi(e.parentNode,n):1===e.nodeType&&vi(e,n),Jt(e)):vi(wl,n.stateNode));break;case 4:r=wl,i=bl,wl=n.stateNode.containerInfo,bl=!0,Cl(e,t,n),wl=r,bl=i;break;case 0:case 11:case 14:case 15:if(!ol&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,void 0!==s&&(0!==(2&o)||0!==(4&o))&&cl(n,t,s),i=i.next}while(i!==r)}Cl(e,t,n);break;case 1:if(!ol&&(ll(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(y){Oc(n,t,y)}Cl(e,t,n);break;case 21:Cl(e,t,n);break;case 22:1&n.mode?(ol=(r=ol)||null!==n.memoizedState,Cl(e,t,n),ol=r):Cl(e,t,n);break;default:Cl(e,t,n)}}function El(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new sl),t.forEach(function(t){var r=Uc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function Tl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var a=e,l=t,c=l;e:for(;null!==c;){switch(c.tag){case 5:wl=c.stateNode,bl=!1;break e;case 3:case 4:wl=c.stateNode.containerInfo,bl=!0;break e}c=c.return}if(null===wl)throw Error(s(160));Sl(a,l,o),wl=null,bl=!1;var u=o.alternate;null!==u&&(u.return=null),o.return=null}catch(i){Oc(o,t,i)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)_l(t,e),t=t.sibling}function _l(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Tl(t,e),Il(e),4&r){try{dl(3,e,e.return),hl(3,e)}catch(a){Oc(e,e.return,a)}try{dl(5,e,e.return)}catch(a){Oc(e,e.return,a)}}break;case 1:Tl(t,e),Il(e),512&r&&null!==n&&ll(n,n.return);break;case 5:if(Tl(t,e),Il(e),512&r&&null!==n&&ll(n,n.return),32&e.flags){var i=e.stateNode;try{Ce(i,"")}catch(a){Oc(e,e.return,a)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,l=null!==n?n.memoizedProps:o,c=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===c&&"radio"===o.type&&null!=o.name&&ae(i,o),ke(c,l);var d=ke(c,o);for(l=0;l<u.length;l+=2){var h=u[l],f=u[l+1];"style"===h?_e(i,f):"dangerouslySetInnerHTML"===h?be(i,f):"children"===h?Ce(i,f):R(i,h,f,d)}switch(c){case"input":le(i,o);break;case"textarea":ge(i,o);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var g=o.value;null!=g?he(i,!!o.multiple,g,!1):p!==!!o.multiple&&(null!=o.defaultValue?he(i,!!o.multiple,o.defaultValue,!0):he(i,!!o.multiple,o.multiple?[]:"",!1))}i[Si]=o}catch(a){Oc(e,e.return,a)}}break;case 6:if(Tl(t,e),Il(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(a){Oc(e,e.return,a)}}break;case 3:if(Tl(t,e),Il(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Jt(t.containerInfo)}catch(a){Oc(e,e.return,a)}break;case 4:default:Tl(t,e),Il(e);break;case 13:Tl(t,e),Il(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Yl=st())),4&r&&El(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(ol=(d=ol)||h,Tl(t,e),ol=d):Tl(t,e),Il(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!h&&0!==(1&e.mode))for(al=e,h=e.child;null!==h;){for(f=al=h;null!==al;){switch(g=(p=al).child,p.tag){case 0:case 11:case 14:case 15:dl(4,p,p.return);break;case 1:ll(p,p.return);var m=p.stateNode;if("function"===typeof m.componentWillUnmount){r=p,n=p.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(a){Oc(r,n,a)}}break;case 5:ll(p,p.return);break;case 22:if(null!==p.memoizedState){Dl(f);continue}}null!==g?(g.return=p,al=g):Dl(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{i=f.stateNode,d?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=f.stateNode,l=void 0!==(u=f.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,c.style.display=Te("display",l))}catch(a){Oc(e,e.return,a)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(a){Oc(e,e.return,a)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Tl(t,e),Il(e),4&r&&El(e);case 21:}}function Il(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(gl(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(Ce(i,""),r.flags&=-33),yl(e,ml(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;vl(e,ml(e),o);break;default:throw Error(s(161))}}catch(a){Oc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Al(e,t,n){al=e,kl(e,t,n)}function kl(e,t,n){for(var r=0!==(1&e.mode);null!==al;){var i=al,o=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||il;if(!s){var a=i.alternate,l=null!==a&&null!==a.memoizedState||ol;a=il;var c=ol;if(il=s,(ol=l)&&!c)for(al=i;null!==al;)l=(s=al).child,22===s.tag&&null!==s.memoizedState?Pl(i):null!==l?(l.return=s,al=l):Pl(i);for(;null!==o;)al=o,kl(o,t,n),o=o.sibling;al=i,il=a,ol=c}Rl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,al=o):Rl(e)}}function Rl(e){for(;null!==al;){var t=al;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:ol||hl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!ol)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:da(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Zo(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Zo(t,a,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var h=d.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&Jt(f)}}}break;default:throw Error(s(163))}ol||512&t.flags&&fl(t)}catch(l){Oc(t,t.return,l)}}if(t===e){al=null;break}if(null!==(n=t.sibling)){n.return=t.return,al=n;break}al=t.return}}function Dl(e){for(;null!==al;){var t=al;if(t===e){al=null;break}var n=t.sibling;if(null!==n){n.return=t.return,al=n;break}al=t.return}}function Pl(e){for(;null!==al;){var t=al;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{hl(4,t)}catch(l){Oc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Oc(t,i,l)}}var o=t.return;try{fl(t)}catch(l){Oc(t,o,l)}break;case 5:var s=t.return;try{fl(t)}catch(l){Oc(t,s,l)}}}catch(l){Oc(t,t.return,l)}if(t===e){al=null;break}var a=t.sibling;if(null!==a){a.return=t.return,al=a;break}al=t.return}}var xl,Ol=Math.ceil,Nl=D.ReactCurrentDispatcher,Ml=D.ReactCurrentOwner,Ll=D.ReactCurrentBatchConfig,Ul=0,Fl=null,Hl=null,jl=0,Bl=0,zl=Oi(0),ql=0,Vl=null,Wl=0,$l=0,Gl=0,Kl=null,Ql=null,Yl=0,Jl=1/0,Xl=null,Zl=!1,ec=null,tc=null,nc=!1,rc=null,ic=0,oc=0,sc=null,ac=-1,lc=0;function cc(){return 0!==(6&Ul)?st():-1!==ac?ac:ac=st()}function uc(e){return 0===(1&e.mode)?1:0!==(2&Ul)&&0!==jl?jl&-jl:null!==_o.transition?(0===lc&&(lc=Tt()),lc):0!==(e=kt)?e:e=void 0===(e=window.event)?16:sn(e.type)}function dc(e,t,n,r){if(50<oc)throw oc=0,sc=null,Error(s(185));It(e,n,r),0!==(2&Ul)&&e===Fl||(e===Fl&&(0===(2&Ul)&&($l|=n),4===ql&&mc(e,jl)),hc(e,r),1===n&&0===Ul&&0===(1&t.mode)&&(Jl=st()+500,Ki&&Ji()))}function hc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-gt(o),a=1<<s,l=i[s];-1===l?0!==(a&n)&&0===(a&r)||(i[s]=St(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var r=Ct(e,e===Fl?jl:0);if(0===r)null!==n&&rt(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&rt(n),1===t)0===e.tag?function(e){Ki=!0,Yi(e)}(vc.bind(null,e)):Yi(vc.bind(null,e)),gi(function(){0===(6&Ul)&&Ji()}),n=null;else{switch(Rt(r)){case 1:n=lt;break;case 4:n=ct;break;case 16:default:n=ut;break;case 536870912:n=ht}n=Fc(n,fc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function fc(e,t){if(ac=-1,lc=0,0!==(6&Ul))throw Error(s(327));var n=e.callbackNode;if(Pc()&&e.callbackNode!==n)return null;var r=Ct(e,e===Fl?jl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=_c(e,r);else{t=r;var i=Ul;Ul|=2;var o=Ec();for(Fl===e&&jl===t||(Xl=null,Jl=st()+500,Cc(e,t));;)try{Ac();break}catch(y){Sc(e,y)}Lo(),Nl.current=o,Ul=i,null!==Hl?t=0:(Fl=null,jl=0,t=ql)}if(0!==t){if(2===t&&(0!==(i=Et(e))&&(r=i,t=pc(e,i))),1===t)throw n=Vl,Cc(e,0),mc(e,r),hc(e,st()),n;if(6===t)mc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!mr(o(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=_c(e,r))&&(0!==(o=Et(e))&&(r=o,t=pc(e,o))),1===t))throw n=Vl,Cc(e,0),mc(e,r),hc(e,st()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Dc(e,Ql,Xl);break;case 3:if(mc(e,r),(130023424&r)===r&&10<(t=Yl+500-st())){if(0!==Ct(e,0))break;if(((i=e.suspendedLanes)&r)!==r){cc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=hi(Dc.bind(null,e,Ql,Xl),t);break}Dc(e,Ql,Xl);break;case 4:if(mc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-gt(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=st()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ol(r/1960))-r)){e.timeoutHandle=hi(Dc.bind(null,e,Ql,Xl),r);break}Dc(e,Ql,Xl);break;default:throw Error(s(329))}}}return hc(e,st()),e.callbackNode===n?fc.bind(null,e):null}function pc(e,t){var n=Kl;return e.current.memoizedState.isDehydrated&&(Cc(e,t).flags|=256),2!==(e=_c(e,t))&&(t=Ql,Ql=n,null!==t&&gc(t)),e}function gc(e){null===Ql?Ql=e:Ql.push.apply(Ql,e)}function mc(e,t){for(t&=~Gl,t&=~$l,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-gt(t),r=1<<n;e[n]=-1,t&=~r}}function vc(e){if(0!==(6&Ul))throw Error(s(327));Pc();var t=Ct(e,0);if(0===(1&t))return hc(e,st()),null;var n=_c(e,t);if(0!==e.tag&&2===n){var r=Et(e);0!==r&&(t=r,n=pc(e,r))}if(1===n)throw n=Vl,Cc(e,0),mc(e,t),hc(e,st()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Dc(e,Ql,Xl),hc(e,st()),null}function yc(e,t){var n=Ul;Ul|=1;try{return e(t)}finally{0===(Ul=n)&&(Jl=st()+500,Ki&&Ji())}}function wc(e){null!==rc&&0===rc.tag&&0===(6&Ul)&&Pc();var t=Ul;Ul|=1;var n=Ll.transition,r=kt;try{if(Ll.transition=null,kt=1,e)return e()}finally{kt=r,Ll.transition=n,0===(6&(Ul=t))&&Ji()}}function bc(){Bl=zl.current,Ni(zl)}function Cc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,fi(n)),null!==Hl)for(n=Hl.return;null!==n;){var r=n;switch(uo(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&zi();break;case 3:ss(),Ni(Fi),Ni(Ui),hs();break;case 5:ls(r);break;case 4:ss();break;case 13:case 19:Ni(cs);break;case 10:Uo(r.type._context);break;case 22:case 23:bc()}n=n.return}if(Fl=e,Hl=e=zc(e.current,null),jl=Bl=t,ql=0,Vl=null,Gl=$l=Wl=0,Ql=Kl=null,null!==Bo){for(t=0;t<Bo.length;t++)if(null!==(r=(n=Bo[t]).interleaved)){n.interleaved=null;var i=r.next,o=n.pending;if(null!==o){var s=o.next;o.next=i,r.next=s}n.pending=r}Bo=null}return e}function Sc(e,t){for(;;){var n=Hl;try{if(Lo(),fs.current=aa,ws){for(var r=ms.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ws=!1}if(gs=0,ys=vs=ms=null,bs=!1,Cs=0,Ml.current=null,null===n||null===n.return){ql=1,Vl=t,Hl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=jl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=_a(a);if(null!==p){p.flags&=-257,Ia(p,a,l,0,t),1&p.mode&&Ta(o,u,t),c=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){Ta(o,u,t),Tc();break e}c=Error(s(426))}else if(po&&1&l.mode){var v=_a(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),Ia(v,a,l,0,t),To(ya(c,l));break e}}o=c=ya(c,l),4!==ql&&(ql=2),null===Kl?Kl=[o]:Kl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Jo(o,Sa(0,c,t));break e;case 1:l=c;var y=o.type,w=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===tc||!tc.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t,Jo(o,Ea(o,l,t));break e}}o=o.return}while(null!==o)}Rc(n)}catch(b){t=b,Hl===n&&null!==n&&(Hl=n=n.return);continue}break}}function Ec(){var e=Nl.current;return Nl.current=aa,null===e?aa:e}function Tc(){0!==ql&&3!==ql&&2!==ql||(ql=4),null===Fl||0===(268435455&Wl)&&0===(268435455&$l)||mc(Fl,jl)}function _c(e,t){var n=Ul;Ul|=2;var r=Ec();for(Fl===e&&jl===t||(Xl=null,Cc(e,t));;)try{Ic();break}catch(d){Sc(e,d)}if(Lo(),Ul=n,Nl.current=r,null!==Hl)throw Error(s(261));return Fl=null,jl=0,ql}function Ic(){for(;null!==Hl;)kc(Hl)}function Ac(){for(;null!==Hl&&!it();)kc(Hl)}function kc(e){var t=xl(e.alternate,e,Bl);e.memoizedProps=e.pendingProps,null===t?Rc(e):Hl=t,Ml.current=null}function Rc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=nl(n,t,Bl)))return void(Hl=n)}else{if(null!==(n=rl(n,t)))return n.flags&=32767,void(Hl=n);if(null===e)return ql=6,void(Hl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Hl=t);Hl=t=e}while(null!==t);0===ql&&(ql=5)}function Dc(e,t,n){var r=kt,i=Ll.transition;try{Ll.transition=null,kt=1,function(e,t,n,r){do{Pc()}while(null!==rc);if(0!==(6&Ul))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-gt(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}(e,o),e===Fl&&(Hl=Fl=null,jl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||nc||(nc=!0,Fc(ut,function(){return Pc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Ll.transition,Ll.transition=null;var a=kt;kt=1;var l=Ul;Ul|=4,Ml.current=null,function(e,t){if(ci=Zt,Sr(e=Cr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(C){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==o||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++d===r&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ui={focusedElem:e,selectionRange:n},Zt=!1,al=t;null!==al;)if(e=(t=al).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,al=e;else for(;null!==al;){t=al;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:da(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(C){Oc(t,t.return,C)}if(null!==(e=t.sibling)){e.return=t.return,al=e;break}al=t.return}g=ul,ul=!1}(e,n),_l(n,e),Er(ui),Zt=!!ci,ui=ci=null,e.current=n,Al(n,e,i),ot(),Ul=l,kt=a,Ll.transition=o}else e.current=n;if(nc&&(nc=!1,rc=e,ic=i),o=e.pendingLanes,0===o&&(tc=null),function(e){if(pt&&"function"===typeof pt.onCommitFiberRoot)try{pt.onCommitFiberRoot(ft,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),hc(e,st()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Zl)throw Zl=!1,e=ec,ec=null,e;0!==(1&ic)&&0!==e.tag&&Pc(),o=e.pendingLanes,0!==(1&o)?e===sc?oc++:(oc=0,sc=e):oc=0,Ji()}(e,t,n,r)}finally{Ll.transition=i,kt=r}return null}function Pc(){if(null!==rc){var e=Rt(ic),t=Ll.transition,n=kt;try{if(Ll.transition=null,kt=16>e?16:e,null===rc)var r=!1;else{if(e=rc,rc=null,ic=0,0!==(6&Ul))throw Error(s(331));var i=Ul;for(Ul|=4,al=e.current;null!==al;){var o=al,a=o.child;if(0!==(16&al.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(al=u;null!==al;){var d=al;switch(d.tag){case 0:case 11:case 15:dl(8,d,o)}var h=d.child;if(null!==h)h.return=d,al=h;else for(;null!==al;){var f=(d=al).sibling,p=d.return;if(pl(d),d===u){al=null;break}if(null!==f){f.return=p,al=f;break}al=p}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}al=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,al=a;else e:for(;null!==al;){if(0!==(2048&(o=al).flags))switch(o.tag){case 0:case 11:case 15:dl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,al=y;break e}al=o.return}}var w=e.current;for(al=w;null!==al;){var b=(a=al).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,al=b;else e:for(a=w;null!==al;){if(0!==(2048&(l=al).flags))try{switch(l.tag){case 0:case 11:case 15:hl(9,l)}}catch(S){Oc(l,l.return,S)}if(l===a){al=null;break e}var C=l.sibling;if(null!==C){C.return=l.return,al=C;break e}al=l.return}}if(Ul=i,Ji(),pt&&"function"===typeof pt.onPostCommitFiberRoot)try{pt.onPostCommitFiberRoot(ft,e)}catch(S){}r=!0}return r}finally{kt=n,Ll.transition=t}}return!1}function xc(e,t,n){e=Qo(e,t=Sa(0,t=ya(n,t),1),1),t=cc(),null!==e&&(It(e,1,t),hc(e,t))}function Oc(e,t,n){if(3===e.tag)xc(e,e,n);else for(;null!==t;){if(3===t.tag){xc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===tc||!tc.has(r))){t=Qo(t,e=Ea(t,e=ya(n,e),1),1),e=cc(),null!==t&&(It(t,1,e),hc(t,e));break}}t=t.return}}function Nc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=cc(),e.pingedLanes|=e.suspendedLanes&n,Fl===e&&(jl&n)===n&&(4===ql||3===ql&&(130023424&jl)===jl&&500>st()-Yl?Cc(e,0):Gl|=n),hc(e,t)}function Mc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=wt,0===(130023424&(wt<<=1))&&(wt=4194304)));var n=cc();null!==(e=Vo(e,t))&&(It(e,t,n),hc(e,n))}function Lc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Mc(e,n)}function Uc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Mc(e,n)}function Fc(e,t){return nt(e,t)}function Hc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jc(e,t,n,r){return new Hc(e,t,n,r)}function Bc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zc(e,t){var n=e.alternate;return null===n?((n=jc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function qc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Bc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case O:return Vc(n.children,i,o,t);case N:a=8,i|=8;break;case M:return(e=jc(12,n,t,2|i)).elementType=M,e.lanes=o,e;case H:return(e=jc(13,n,t,i)).elementType=H,e.lanes=o,e;case j:return(e=jc(19,n,t,i)).elementType=j,e.lanes=o,e;case q:return Wc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case L:a=10;break e;case U:a=9;break e;case F:a=11;break e;case B:a=14;break e;case z:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=jc(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Vc(e,t,n,r){return(e=jc(7,e,r,t)).lanes=n,e}function Wc(e,t,n,r){return(e=jc(22,e,r,t)).elementType=q,e.lanes=n,e.stateNode={isHidden:!1},e}function $c(e,t,n){return(e=jc(6,e,null,t)).lanes=n,e}function Gc(e,t,n){return(t=jc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Kc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_t(0),this.expirationTimes=_t(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_t(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qc(e,t,n,r,i,o,s,a,l){return e=new Kc(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=jc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$o(o),e}function Yc(e){if(!e)return Li;e:{if(Je(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Bi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Bi(n))return Vi(e,n,t)}return t}function Jc(e,t,n,r,i,o,s,a,l){return(e=Qc(n,r,!0,e,0,o,0,a,l)).context=Yc(null),n=e.current,(o=Ko(r=cc(),i=uc(n))).callback=void 0!==t&&null!==t?t:null,Qo(n,o,i),e.current.lanes=i,It(e,i,r),hc(e,r),e}function Xc(e,t,n,r){var i=t.current,o=cc(),s=uc(i);return n=Yc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ko(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Qo(i,t,s))&&(dc(e,i,s,o),Yo(e,i,s)),s}function Zc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function eu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function tu(e,t){eu(e,t),(e=e.alternate)&&eu(e,t)}xl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Fi.current)ka=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ka=!1,function(e,t,n){switch(t.tag){case 3:Fa(t),Eo();break;case 5:as(t);break;case 1:Bi(t.type)&&Wi(t);break;case 4:os(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Mi(xo,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Mi(cs,1&cs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?$a(e,t,n):(Mi(cs,1&cs.current),null!==(e=Za(e,t,n))?e.sibling:null);Mi(cs,1&cs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ja(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Mi(cs,cs.current),r)break;return null;case 22:case 23:return t.lanes=0,Oa(e,t,n)}return Za(e,t,n)}(e,t,n);ka=0!==(131072&e.flags)}else ka=!1,po&&0!==(1048576&t.flags)&&lo(t,to,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Xa(e,t),e=t.pendingProps;var i=ji(t,Ui.current);Ho(t,n),i=_s(null,t,r,e,i,n);var o=Is();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Bi(r)?(o=!0,Wi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,$o(t),i.updater=fa,t.stateNode=i,i._reactInternals=t,va(t,r,e,n),t=Ua(null,t,r,!0,o,n)):(t.tag=0,po&&o&&co(t),Ra(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Xa(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Bc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===F)return 11;if(e===B)return 14}return 2}(r),e=da(r,e),i){case 0:t=Ma(null,t,r,e,n);break e;case 1:t=La(null,t,r,e,n);break e;case 11:t=Da(null,t,r,e,n);break e;case 14:t=Pa(null,t,r,da(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ma(e,t,r,i=t.elementType===r?i:da(r,i),n);case 1:return r=t.type,i=t.pendingProps,La(e,t,r,i=t.elementType===r?i:da(r,i),n);case 3:e:{if(Fa(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Go(e,t),Xo(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ha(e,t,r,n,i=ya(Error(s(423)),t));break e}if(r!==i){t=Ha(e,t,r,n,i=ya(Error(s(424)),t));break e}for(fo=yi(t.stateNode.containerInfo.firstChild),ho=t,po=!0,go=null,n=Po(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Eo(),r===i){t=Za(e,t,n);break e}Ra(e,t,r,n)}t=t.child}return t;case 5:return as(t),null===e&&wo(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,di(r,i)?a=null:null!==o&&di(r,o)&&(t.flags|=32),Na(e,t),Ra(e,t,a,n),t.child;case 6:return null===e&&wo(t),null;case 13:return $a(e,t,n);case 4:return os(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Do(t,null,r,n):Ra(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Da(e,t,r,i=t.elementType===r?i:da(r,i),n);case 7:return Ra(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ra(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Mi(xo,r._currentValue),r._currentValue=a,null!==o)if(mr(o.value,a)){if(o.children===i.children&&!Fi.current){t=Za(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Ko(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Fo(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Fo(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}Ra(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ho(t,n),r=r(i=jo(i)),t.flags|=1,Ra(e,t,r,n),t.child;case 14:return i=da(r=t.type,t.pendingProps),Pa(e,t,r,i=da(r.type,i),n);case 15:return xa(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:da(r,i),Xa(e,t),t.tag=1,Bi(r)?(e=!0,Wi(t)):e=!1,Ho(t,n),ga(t,r,i),va(t,r,i,n),Ua(null,t,r,!0,e,n);case 19:return Ja(e,t,n);case 22:return Oa(e,t,n)}throw Error(s(156,t.tag))};var nu="function"===typeof reportError?reportError:function(e){console.error(e)};function ru(e){this._internalRoot=e}function iu(e){this._internalRoot=e}function ou(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function su(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function au(){}function lu(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if("function"===typeof i){var a=i;i=function(){var e=Zc(s);a.call(e)}}Xc(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"===typeof r){var o=r;r=function(){var e=Zc(s);o.call(e)}}var s=Jc(t,r,e,0,null,!1,0,"",au);return e._reactRootContainer=s,e[Ei]=s.current,Jr(8===e.nodeType?e.parentNode:e),wc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Zc(l);a.call(e)}}var l=Qc(e,0,!1,null,0,!1,0,"",au);return e._reactRootContainer=l,e[Ei]=l.current,Jr(8===e.nodeType?e.parentNode:e),wc(function(){Xc(t,l,n,r)}),l}(n,t,e,i,r);return Zc(s)}iu.prototype.render=ru.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Xc(e,t,null,null)},iu.prototype.unmount=ru.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;wc(function(){Xc(null,e,null,null)}),t[Ei]=null}},iu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ot();e={blockedOn:null,target:e,priority:t};for(var n=0;n<zt.length&&0!==t&&t<zt[n].priority;n++);zt.splice(n,0,e),0===n&&$t(e)}},Dt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=bt(t.pendingLanes);0!==n&&(At(t,1|n),hc(t,st()),0===(6&Ul)&&(Jl=st()+500,Ji()))}break;case 13:wc(function(){var t=Vo(e,1);if(null!==t){var n=cc();dc(t,e,1,n)}}),tu(e,1)}},Pt=function(e){if(13===e.tag){var t=Vo(e,134217728);if(null!==t)dc(t,e,134217728,cc());tu(e,134217728)}},xt=function(e){if(13===e.tag){var t=uc(e),n=Vo(e,t);if(null!==n)dc(n,e,t,cc());tu(e,t)}},Ot=function(){return kt},Nt=function(e,t){var n=kt;try{return kt=e,t()}finally{kt=n}},Pe=function(e,t,n){switch(t){case"input":if(le(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Di(r);if(!i)throw Error(s(90));re(r),le(r,i)}}}break;case"textarea":ge(e,n);break;case"select":null!=(t=n.value)&&he(e,!!n.multiple,t,!1)}},Ue=yc,Fe=wc;var cu={usingClientEntryPoint:!1,Events:[ki,Ri,Di,Me,Le,yc]},uu={findFiberByHostInstance:Ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},du={bundleType:uu.bundleType,version:uu.version,rendererPackageName:uu.rendererPackageName,rendererConfig:uu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=et(e))?null:e.stateNode},findFiberByHostInstance:uu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hu.isDisabled&&hu.supportsFiber)try{ft=hu.inject(du),pt=hu}catch(v){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ou(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!ou(e))throw Error(s(299));var n=!1,r="",i=nu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Qc(e,1,!1,null,0,n,0,r,i),e[Ei]=t.current,Jr(8===e.nodeType?e.parentNode:e),new ru(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=et(t))?null:e.stateNode},t.flushSync=function(e){return wc(e)},t.hydrate=function(e,t,n){if(!su(t))throw Error(s(200));return lu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!ou(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=nu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Jc(t,null,e,1,null!=n?n:null,i,0,o,a),e[Ei]=t.current,Jr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new iu(t)},t.render=function(e,t,n){if(!su(t))throw Error(s(200));return lu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!su(e))throw Error(s(40));return!!e._reactRootContainer&&(wc(function(){lu(null,null,e,!1,function(){e._reactRootContainer=null,e[Ei]=null})}),!0)},t.unstable_batchedUpdates=yc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!su(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return lu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(d){if("object"===typeof window)return window}}();var r,i,o,s,a,l,c,u,d,h=n(43),f=n(391),p=n(950),g={},m=[],v=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function y(e,t){for(var n in t)e[n]=t[n];return e}function w(e){var t=e.parentNode;t&&t.removeChild(e)}function b(e,t,n){var i,o,s,a={};for(s in t)"key"==s?i=t[s]:"ref"==s?o=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?r.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return C(e,a,i,o,null)}function C(e,t,n,r,s){var a={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==s?++o:s};return null==s&&null!=i.vnode&&i.vnode(a),a}function S(e){return e.children}function E(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||v.test(t)?n:n+"px"}function T(e,t,n,r,i){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||E(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||E(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r||e.addEventListener(t,o?I:_,o):e.removeEventListener(t,o?I:_,o);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&-1==t.indexOf("-")?e.removeAttribute(t):e.setAttribute(t,n))}}function _(e){a=!0;try{return this.l[e.type+!1](i.event?i.event(e):e)}finally{a=!1}}function I(e){a=!0;try{return this.l[e.type+!0](i.event?i.event(e):e)}finally{a=!1}}function A(e,t){this.props=e,this.context=t}function k(e,t){if(null==t)return e.__?k(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?k(e):null}function R(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return R(e)}}function D(e){a?setTimeout(e):u(e)}function P(e){(!e.__d&&(e.__d=!0)&&l.push(e)&&!x.__r++||c!==i.debounceRendering)&&((c=i.debounceRendering)||D)(x)}function x(){var e,t,n,r,i,o,s,a;for(l.sort(function(e,t){return e.__v.__b-t.__v.__b});e=l.shift();)e.__d&&(t=l.length,r=void 0,i=void 0,s=(o=(n=e).__v).__e,(a=n.__P)&&(r=[],(i=y({},o)).__v=o.__v+1,F(a,o,i,n.__n,void 0!==a.ownerSVGElement,null!=o.__h?[s]:null,r,null==s?k(o):s,o.__h),H(r,o),o.__e!=s&&R(o)),l.length>t&&l.sort(function(e,t){return e.__v.__b-t.__v.__b}));x.__r=0}function O(e,t,n,r,i,o,s,a,l,c){var u,d,h,f,p,v,y,w=r&&r.__k||m,b=w.length;for(n.__k=[],u=0;u<t.length;u++)if(null!=(f=n.__k[u]=null==(f=t[u])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?C(null,f,null,null,f):Array.isArray(f)?C(S,{children:f},null,null,null):f.__b>0?C(f.type,f.props,f.key,f.ref?f.ref:null,f.__v):f)){if(f.__=n,f.__b=n.__b+1,null===(h=w[u])||h&&f.key==h.key&&f.type===h.type)w[u]=void 0;else for(d=0;d<b;d++){if((h=w[d])&&f.key==h.key&&f.type===h.type){w[d]=void 0;break}h=null}F(e,f,h=h||g,i,o,s,a,l,c),p=f.__e,(d=f.ref)&&h.ref!=d&&(y||(y=[]),h.ref&&y.push(h.ref,null,f),y.push(d,f.__c||p,f)),null!=p?(null==v&&(v=p),"function"==typeof f.type&&f.__k===h.__k?f.__d=l=N(f,l,e):l=L(e,f,h,w,p,l),"function"==typeof n.type&&(n.__d=l)):l&&h.__e==l&&l.parentNode!=e&&(l=k(h))}for(n.__e=v,u=b;u--;)null!=w[u]&&("function"==typeof n.type&&null!=w[u].__e&&w[u].__e==n.__d&&(n.__d=U(r).nextSibling),z(w[u],w[u]));if(y)for(u=0;u<y.length;u++)B(y[u],y[++u],y[++u])}function N(e,t,n){for(var r,i=e.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=e,t="function"==typeof r.type?N(r,t,n):L(n,r,r,i,r.__e,t));return t}function M(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some(function(e){M(e,t)}):t.push(e)),t}function L(e,t,n,r,i,o){var s,a,l;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||i!=o||null==i.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(i),s=null;else{for(a=o,l=0;(a=a.nextSibling)&&l<r.length;l+=1)if(a==i)break e;e.insertBefore(i,o),s=o}return void 0!==s?s:i.nextSibling}function U(e){var t,n,r;if(null==e.type||"string"==typeof e.type)return e.__e;if(e.__k)for(t=e.__k.length-1;t>=0;t--)if((n=e.__k[t])&&(r=U(n)))return r;return null}function F(e,t,n,r,o,s,a,l,c){var u,d,h,f,p,g,m,v,w,b,C,E,T,_,I,k=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(c=n.__h,l=t.__e=n.__e,t.__h=null,s=[l]),(u=i.__b)&&u(t);try{e:if("function"==typeof k){if(v=t.props,w=(u=k.contextType)&&r[u.__c],b=u?w?w.props.value:u.__:r,n.__c?m=(d=t.__c=n.__c).__=d.__E:("prototype"in k&&k.prototype.render?t.__c=d=new k(v,b):(t.__c=d=new A(v,b),d.constructor=k,d.render=q),w&&w.sub(d),d.props=v,d.state||(d.state={}),d.context=b,d.__n=r,h=d.__d=!0,d.__h=[],d._sb=[]),null==d.__s&&(d.__s=d.state),null!=k.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=y({},d.__s)),y(d.__s,k.getDerivedStateFromProps(v,d.__s))),f=d.props,p=d.state,d.__v=t,h)null==k.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==k.getDerivedStateFromProps&&v!==f&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(v,b),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(v,d.__s,b)||t.__v===n.__v){for(t.__v!==n.__v&&(d.props=v,d.state=d.__s,d.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach(function(e){e&&(e.__=t)}),C=0;C<d._sb.length;C++)d.__h.push(d._sb[C]);d._sb=[],d.__h.length&&a.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(v,d.__s,b),null!=d.componentDidUpdate&&d.__h.push(function(){d.componentDidUpdate(f,p,g)})}if(d.context=b,d.props=v,d.__P=e,E=i.__r,T=0,"prototype"in k&&k.prototype.render){for(d.state=d.__s,d.__d=!1,E&&E(t),u=d.render(d.props,d.state,d.context),_=0;_<d._sb.length;_++)d.__h.push(d._sb[_]);d._sb=[]}else do{d.__d=!1,E&&E(t),u=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++T<25);d.state=d.__s,null!=d.getChildContext&&(r=y(y({},r),d.getChildContext())),h||null==d.getSnapshotBeforeUpdate||(g=d.getSnapshotBeforeUpdate(f,p)),I=null!=u&&u.type===S&&null==u.key?u.props.children:u,O(e,Array.isArray(I)?I:[I],t,n,r,o,s,a,l,c),d.base=t.__e,t.__h=null,d.__h.length&&a.push(d),m&&(d.__E=d.__=null),d.__e=!1}else null==s&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=j(n.__e,t,n,r,o,s,a,c);(u=i.diffed)&&u(t)}catch(e){t.__v=null,(c||null!=s)&&(t.__e=l,t.__h=!!c,s[s.indexOf(l)]=null),i.__e(e,t,n)}}function H(e,t){i.__c&&i.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){i.__e(e,t.__v)}})}function j(e,t,n,i,o,s,a,l){var c,u,d,h=n.props,f=t.props,p=t.type,m=0;if("svg"===p&&(o=!0),null!=s)for(;m<s.length;m++)if((c=s[m])&&"setAttribute"in c==!!p&&(p?c.localName===p:3===c.nodeType)){e=c,s[m]=null;break}if(null==e){if(null===p)return document.createTextNode(f);e=o?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,f.is&&f),s=null,l=!1}if(null===p)h===f||l&&e.data===f||(e.data=f);else{if(s=s&&r.call(e.childNodes),u=(h=n.props||g).dangerouslySetInnerHTML,d=f.dangerouslySetInnerHTML,!l){if(null!=s)for(h={},m=0;m<e.attributes.length;m++)h[e.attributes[m].name]=e.attributes[m].value;(d||u)&&(d&&(u&&d.__html==u.__html||d.__html===e.innerHTML)||(e.innerHTML=d&&d.__html||""))}if(function(e,t,n,r,i){var o;for(o in n)"children"===o||"key"===o||o in t||T(e,o,null,n[o],r);for(o in t)i&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||T(e,o,t[o],n[o],r)}(e,f,h,o,l),d)t.__k=[];else if(m=t.props.children,O(e,Array.isArray(m)?m:[m],t,n,i,o&&"foreignObject"!==p,s,a,s?s[0]:n.__k&&k(n,0),l),null!=s)for(m=s.length;m--;)null!=s[m]&&w(s[m]);l||("value"in f&&void 0!==(m=f.value)&&(m!==e.value||"progress"===p&&!m||"option"===p&&m!==h.value)&&T(e,"value",m,h.value,!1),"checked"in f&&void 0!==(m=f.checked)&&m!==e.checked&&T(e,"checked",m,h.checked,!1))}return e}function B(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){i.__e(e,n)}}function z(e,t,n){var r,o;if(i.unmount&&i.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||B(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){i.__e(e,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&z(r[o],t,n||"function"!=typeof e.type);n||null==e.__e||w(e.__e),e.__=e.__e=e.__d=void 0}function q(e,t,n){return this.constructor(e,n)}function V(e,t,n){var o,s,a;i.__&&i.__(e,t),s=(o="function"==typeof n)?null:n&&n.__k||t.__k,a=[],F(t,e=(!o&&n||t).__k=b(S,null,[e]),s||g,g,void 0!==t.ownerSVGElement,!o&&n?[n]:s?null:t.firstChild?r.call(t.childNodes):null,a,!o&&n?n:s?s.__e:t.firstChild,o),H(a,e)}function W(e,t){var n={__c:t="__cC"+d++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(function(e){e.__e=!0,P(e)})},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}r=m.slice,i={__e:function(e,t,n,r){for(var i,o,s;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(e)),s=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),s=i.__d),s)return i.__E=i}catch(t){e=t}throw e}},o=0,s=function(e){return null!=e&&void 0===e.constructor},a=!1,A.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=y({},this.state),"function"==typeof e&&(e=e(y({},n),this.props)),e&&y(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),P(this))},A.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),P(this))},A.prototype.render=S,l=[],u="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,x.__r=0,d=0;var $,G,K,Q=[],Y=[],J=i.__b,X=i.__r,Z=i.diffed,ee=i.__c,te=i.unmount;function ne(){for(var e;e=Q.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(oe),e.__H.__h.forEach(se),e.__H.__h=[]}catch(l){e.__H.__h=[],i.__e(l,e.__v)}}i.__b=function(e){$=null,J&&J(e)},i.__r=function(e){X&&X(e);var t=($=e.__c).__H;t&&(G===$?(t.__h=[],$.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.__V=Y,e.__N=e.i=void 0})):(t.__h.forEach(oe),t.__h.forEach(se),t.__h=[])),G=$},i.diffed=function(e){Z&&Z(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==Q.push(t)&&K===i.requestAnimationFrame||((K=i.requestAnimationFrame)||ie)(ne)),t.__H.__.forEach(function(e){e.i&&(e.__H=e.i),e.__V!==Y&&(e.__=e.__V),e.i=void 0,e.__V=Y})),G=$=null},i.__c=function(e,t){t.some(function(e){try{e.__h.forEach(oe),e.__h=e.__h.filter(function(e){return!e.__||se(e)})}catch(o){t.some(function(e){e.__h&&(e.__h=[])}),t=[],i.__e(o,e.__v)}}),ee&&ee(e,t)},i.unmount=function(e){te&&te(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{oe(e)}catch(e){t=e}}),n.__H=void 0,t&&i.__e(t,n.__v))};var re="function"==typeof requestAnimationFrame;function ie(e){var t,n=function(){clearTimeout(r),re&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);re&&(t=requestAnimationFrame(n))}function oe(e){var t=$,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),$=t}function se(e){var t=$;e.__c=e.__(),$=t}function ae(e,t){for(var n in t)e[n]=t[n];return e}function le(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function ce(e){this.props=e}(ce.prototype=new A).isPureReactComponent=!0,ce.prototype.shouldComponentUpdate=function(e,t){return le(this.props,e)||le(this.state,t)};var ue=i.__b;i.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),ue&&ue(e)};"undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref");var de=i.__e;i.__e=function(e,t,n,r){if(e.then)for(var i,o=t;o=o.__;)if((i=o.__c)&&i.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),i.__c(e,t);de(e,t,n,r)};var he=i.unmount;function fe(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(e){"function"==typeof e.__c&&e.__c()}),e.__c.__H=null),null!=(e=ae({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map(function(e){return fe(e,t,n)})),e}function pe(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(e){return pe(e,t,n)}),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function ge(){this.__u=0,this.t=null,this.__b=null}function me(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function ve(){this.u=null,this.o=null}i.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),he&&he(e)},(ge.prototype=new A).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var i=me(r.__v),o=!1,s=function(){o||(o=!0,n.__R=null,i?i(a):a())};n.__R=s;var a=function(){if(! --r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=pe(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},l=!0===t.__h;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(s,s)},ge.prototype.componentWillUnmount=function(){this.t=[]},ge.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=fe(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__a&&b(S,null,e.fallback);return i&&(i.__h=null),[b(S,null,t.__a?null:e.children),i]};var ye=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function we(e){return this.getChildContext=function(){return e.context},e.children}function be(e){var t=this,n=e.i;t.componentWillUnmount=function(){V(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,n){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),V(b(we,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function Ce(e,t){var n=b(be,{__v:e,i:t});return n.containerInfo=t,n}(ve.prototype=new A).__a=function(e){var t=this,n=me(t.__v),r=t.o.get(e);return r[0]++,function(i){var o=function(){t.props.revealOrder?(r.push(i),ye(t,e,r)):i()};n?n(o):o()}},ve.prototype.render=function(e){this.u=null,this.o=new Map;var t=M(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},ve.prototype.componentDidUpdate=ve.prototype.componentDidMount=function(){var e=this;this.o.forEach(function(t,n){ye(e,n,t)})};var Se="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Ee=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Te="undefined"!=typeof document,_e=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};A.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(A.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var Ie=i.event;function Ae(){}function ke(){return this.cancelBubble}function Re(){return this.defaultPrevented}i.event=function(e){return Ie&&(e=Ie(e)),e.persist=Ae,e.isPropagationStopped=ke,e.isDefaultPrevented=Re,e.nativeEvent=e};var De={configurable:!0,get:function(){return this.class}},Pe=i.vnode;i.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var i=-1===t.indexOf("-");for(var o in r={},n){var s=n[o];Te&&"children"===o&&"noscript"===t||"value"===o&&"defaultValue"in n&&null==s||("defaultValue"===o&&"value"in n&&null==n.value?o="value":"download"===o&&!0===s?s="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+t)&&!_e(n.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():i&&Ee.test(o)?o=o.replace(/[A-Z0-9]/g,"-$&").toLowerCase():null===s&&(s=void 0),/^oninput$/i.test(o)&&(o=o.toLowerCase(),r[o]&&(o="oninputCapture")),r[o]=s)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=M(n.children).forEach(function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)})),"select"==t&&null!=r.defaultValue&&(r.value=M(n.children).forEach(function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value})),e.props=r,n.class!=n.className&&(De.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",De))}e.$$typeof=Se,Pe&&Pe(e)};var xe=i.__r;i.__r=function(e){xe&&xe(e),e.__c};const Oe=[],Ne=new Map;function Me(e){Oe.push(e),Ne.forEach(t=>{Ue(t,e)})}function Le(e){let t=Ne.get(e);if(!t||!t.isConnected){if(t=e.querySelector("style[data-fullcalendar]"),!t){t=document.createElement("style"),t.setAttribute("data-fullcalendar","");const n=function(){void 0===Fe&&(Fe=function(){const e=document.querySelector('meta[name="csp-nonce"]');if(e&&e.hasAttribute("content"))return e.getAttribute("content");const t=document.querySelector("script[nonce]");if(t)return t.nonce||"";return""}());return Fe}();n&&(t.nonce=n);const r=e===document?document.head:e,i=e===document?r.querySelector("script,link[rel=stylesheet],link[as=style],style"):r.firstChild;r.insertBefore(t,i)}Ne.set(e,t),function(e){for(const t of Oe)Ue(e,t)}(t)}}function Ue(e,t){const{sheet:n}=e,r=n.cssRules.length;t.split("}").forEach((e,t)=>{(e=e.trim())&&n.insertRule(e+"}",r+t)})}let Fe;"undefined"!==typeof document&&Le(document);Me(':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}');class He{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),null==e?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{pauseDepths:t}=this;t[e]=(t[e]||0)+1,this.clearTimeout()}resume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,{pauseDepths:n}=this;if(e in n){if(t)delete n[e];else{n[e]-=1,n[e]<=0&&delete n[e]}this.tryDrain()}}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}}function je(e){e.parentNode&&e.parentNode.removeChild(e)}function Be(e,t){if(e.closest)return e.closest(t);if(!document.documentElement.contains(e))return null;do{if(ze(e,t))return e;e=e.parentElement||e.parentNode}while(null!==e&&1===e.nodeType);return null}function ze(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector).call(e,t)}const qe=/(top|left|right|bottom|width|height)$/i;function Ve(e,t){for(let n in t)We(e,n,t[n])}function We(e,t,n){null==n?e.style[t]="":"number"===typeof n&&qe.test(t)?e.style[t]=`${n}px`:e.style[t]=n}function $e(e){var t,n;return null!==(n=null===(t=e.composedPath)||void 0===t?void 0:t.call(e)[0])&&void 0!==n?n:e.target}let Ge=0;function Ke(){return Ge+=1,"fc-dom-"+Ge}function Qe(e){e.preventDefault()}function Ye(e,t,n,r){let i=function(e,t){return n=>{let r=Be(n.target,e);r&&t.call(r,n,r)}}(n,r);return e.addEventListener(t,i),()=>{e.removeEventListener(t,i)}}const Je=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function Xe(e){return Object.assign({onClick:e},Ze(e))}function Ze(e){return{tabIndex:0,onKeyDown(t){"Enter"!==t.key&&" "!==t.key||(e(t),t.preventDefault())}}}let et=0;function tt(){return et+=1,String(et)}function nt(){document.body.classList.add("fc-not-allowed")}function rt(){document.body.classList.remove("fc-not-allowed")}function it(e){let t,n,r=[],i=[];for("string"===typeof e?i=e.split(/\s*,\s*/):"function"===typeof e?i=[e]:Array.isArray(e)&&(i=e),t=0;t<i.length;t+=1)n=i[t],"string"===typeof n?r.push("-"===n.charAt(0)?{field:n.substring(1),order:-1}:{field:n,order:1}):"function"===typeof n&&r.push({func:n});return r}function ot(e,t,n){let r,i;for(r=0;r<n.length;r+=1)if(i=st(e,t,n[r]),i)return i;return 0}function st(e,t,n){return n.func?n.func(e,t):at(e[n.field],t[n.field])*(n.order||1)}function at(e,t){return e||t?null==t?-1:null==e?1:"string"===typeof e||"string"===typeof t?String(e).localeCompare(String(t)):e-t:0}function lt(e,t){let n=String(e);return"000".substr(0,t-n.length)+n}function ct(e,t,n){return"function"===typeof e?e(...t):"string"===typeof e?t.reduce((e,t,n)=>e.replace("$"+n,t||""),e):n}function ut(e,t){return e-t}function dt(e){return e%1===0}function ht(e){let t=e.querySelector(".fc-scrollgrid-shrink-frame"),n=e.querySelector(".fc-scrollgrid-shrink-cushion");if(!t)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!n)throw new Error("needs fc-scrollgrid-shrink-cushion className");return e.getBoundingClientRect().width-t.getBoundingClientRect().width+n.getBoundingClientRect().width}const ft=["years","months","days","milliseconds"],pt=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function gt(e,t){return"string"===typeof e?function(e){let t=pt.exec(e);if(t){let e=t[1]?-1:1;return{years:0,months:0,days:e*(t[2]?parseInt(t[2],10):0),milliseconds:e*(60*(t[3]?parseInt(t[3],10):0)*60*1e3+60*(t[4]?parseInt(t[4],10):0)*1e3+1e3*(t[5]?parseInt(t[5],10):0)+(t[6]?parseInt(t[6],10):0))}}return null}(e):"object"===typeof e&&e?mt(e):"number"===typeof e?mt({[t||"milliseconds"]:e}):null}function mt(e){let t={years:e.years||e.year||0,months:e.months||e.month||0,days:e.days||e.day||0,milliseconds:60*(e.hours||e.hour||0)*60*1e3+60*(e.minutes||e.minute||0)*1e3+1e3*(e.seconds||e.second||0)+(e.milliseconds||e.millisecond||e.ms||0)},n=e.weeks||e.week;return n&&(t.days+=7*n,t.specifiedWeeks=!0),t}function vt(e,t){return{years:e.years+t.years,months:e.months+t.months,days:e.days+t.days,milliseconds:e.milliseconds+t.milliseconds}}function yt(e){return wt(e)/864e5}function wt(e){return 31536e6*e.years+2592e6*e.months+864e5*e.days+e.milliseconds}function bt(e,t){let n=null;for(let r=0;r<ft.length;r+=1){let i=ft[r];if(t[i]){let r=e[i]/t[i];if(!dt(r)||null!==n&&n!==r)return null;n=r}else if(e[i])return null}return n}function Ct(e){let t=e.milliseconds;if(t){if(t%1e3!==0)return{unit:"millisecond",value:t};if(t%6e4!==0)return{unit:"second",value:t/1e3};if(t%36e5!==0)return{unit:"minute",value:t/6e4};if(t)return{unit:"hour",value:t/36e5}}return e.days?e.specifiedWeeks&&e.days%7===0?{unit:"week",value:e.days/7}:{unit:"day",value:e.days}:e.months?{unit:"month",value:e.months}:e.years?{unit:"year",value:e.years}:{unit:"millisecond",value:0}}function St(e,t,n){if(e===t)return!0;let r,i=e.length;if(i!==t.length)return!1;for(r=0;r<i;r+=1)if(!(n?n(e[r],t[r]):e[r]===t[r]))return!1;return!0}const Et=["sun","mon","tue","wed","thu","fri","sat"];function Tt(e,t){let n=Ot(e);return n[2]+=t,Nt(n)}function _t(e,t){let n=Ot(e);return n[6]+=t,Nt(n)}function It(e,t){return(t.valueOf()-e.valueOf())/864e5}function At(e,t){return Lt(e)===Lt(t)?Math.round(It(e,t)):null}function kt(e){return Nt([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()])}function Rt(e,t,n,r){let i=Nt([t,0,1+Dt(t,n,r)]),o=kt(e),s=Math.round(It(i,o));return Math.floor(s/7)+1}function Dt(e,t,n){let r=7+t-n;return-((7+Nt([e,0,r]).getUTCDay()-t)%7)+r-1}function Pt(e){return[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]}function xt(e){return new Date(e[0],e[1]||0,null==e[2]?1:e[2],e[3]||0,e[4]||0,e[5]||0)}function Ot(e){return[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()]}function Nt(e){return 1===e.length&&(e=e.concat([0])),new Date(Date.UTC(...e))}function Mt(e){return!isNaN(e.valueOf())}function Lt(e){return 1e3*e.getUTCHours()*60*60+1e3*e.getUTCMinutes()*60+1e3*e.getUTCSeconds()+e.getUTCMilliseconds()}function Ut(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.toISOString();return r=r.replace(".000",""),n&&(r=r.replace("T00:00:00Z","")),r.length>10&&(null==t?r=r.replace("Z",""):0!==t&&(r=r.replace("Z",jt(t,!0)))),r}function Ft(e){return e.toISOString().replace(/T.*$/,"")}function Ht(e){return lt(e.getUTCHours(),2)+":"+lt(e.getUTCMinutes(),2)+":"+lt(e.getUTCSeconds(),2)}function jt(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e<0?"-":"+",r=Math.abs(e),i=Math.floor(r/60),o=Math.round(r%60);return t?`${n+lt(i,2)}:${lt(o,2)}`:`GMT${n}${i}${o?`:${lt(o,2)}`:""}`}function Bt(e,t,n){let r,i;return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];if(r){if(!St(r,s)){n&&n(i);let r=e.apply(this,s);t&&t(r,i)||(i=r)}}else i=e.apply(this,s);return r=s,i}}function zt(e,t,n){let r,i;return o=>{if(r){if(!Cn(r,o)){n&&n(i);let r=e.call(this,o);t&&t(r,i)||(i=r)}}else i=e.call(this,o);return r=o,i}}const qt={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},Vt={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},Wt=/\s*([ap])\.?m\.?/i,$t=/,/g,Gt=/\s+/g,Kt=/\u200e/g,Qt=/UTC|GMT/;class Yt{constructor(e){let t={},n={},r=9;for(let i in e)if(i in qt){n[i]=e[i];qt[i]<9&&(r=Math.min(qt[i],r))}else t[i]=e[i],i in Vt&&(r=Math.min(Vt[i],r));this.standardDateProps=t,this.extendedSettings=n,this.smallestUnitNum=r,this.buildFormattingFunc=Bt(Jt)}format(e,t){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,t)(e)}formatRange(e,t,n,r){let{standardDateProps:i,extendedSettings:o}=this,s=function(e,t,n){if(n.getMarkerYear(e)!==n.getMarkerYear(t))return 5;if(n.getMarkerMonth(e)!==n.getMarkerMonth(t))return 4;if(n.getMarkerDay(e)!==n.getMarkerDay(t))return 2;if(Lt(e)!==Lt(t))return 1;return 0}(e.marker,t.marker,n.calendarSystem);if(!s)return this.format(e,n);let a=s;!(a>1)||"numeric"!==i.year&&"2-digit"!==i.year||"numeric"!==i.month&&"2-digit"!==i.month||"numeric"!==i.day&&"2-digit"!==i.day||(a=1);let l=this.format(e,n),c=this.format(t,n);if(l===c)return l;let u=Jt(function(e,t){let n={};for(let r in e)(!(r in Vt)||Vt[r]<=t)&&(n[r]=e[r]);return n}(i,a),o,n),d=u(e),h=u(t),f=function(e,t,n,r){let i=0;for(;i<e.length;){let o=e.indexOf(t,i);if(-1===o)break;let s=e.substr(0,o);i=o+t.length;let a=e.substr(i),l=0;for(;l<n.length;){let e=n.indexOf(r,l);if(-1===e)break;let t=n.substr(0,e);l=e+r.length;let i=n.substr(l);if(s===t&&a===i)return{before:s,after:a}}}return null}(l,d,c,h),p=o.separator||r||n.defaultSeparator||"";return f?f.before+d+p+h+f.after:l+p+c}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}}function Jt(e,t,n){let r=Object.keys(e).length;return 1===r&&"short"===e.timeZoneName?e=>jt(e.timeZoneOffset):0===r&&t.week?e=>function(e,t,n,r,i){let o=[];"long"===i?o.push(n):"short"!==i&&"narrow"!==i||o.push(t);"long"!==i&&"short"!==i||o.push(" ");o.push(r.simpleNumberFormat.format(e)),"rtl"===r.options.direction&&o.reverse();return o.join("")}(n.computeWeekNumber(e.marker),n.weekText,n.weekTextLong,n.locale,t.week):function(e,t,n){e=Object.assign({},e),t=Object.assign({},t),function(e,t){e.timeZoneName&&(e.hour||(e.hour="2-digit"),e.minute||(e.minute="2-digit"));"long"===e.timeZoneName&&(e.timeZoneName="short");t.omitZeroMinute&&(e.second||e.millisecond)&&delete t.omitZeroMinute}(e,t),e.timeZone="UTC";let r,i=new Intl.DateTimeFormat(n.locale.codes,e);if(t.omitZeroMinute){let t=Object.assign({},e);delete t.minute,r=new Intl.DateTimeFormat(n.locale.codes,t)}return o=>{let s,{marker:a}=o;return s=r&&!a.getUTCMinutes()?r:i,function(e,t,n,r,i){e=e.replace(Kt,""),"short"===n.timeZoneName&&(e=function(e,t){let n=!1;e=e.replace(Qt,()=>(n=!0,t)),n||(e+=` ${t}`);return e}(e,"UTC"===i.timeZone||null==t.timeZoneOffset?"UTC":jt(t.timeZoneOffset)));r.omitCommas&&(e=e.replace($t,"").trim());r.omitZeroMinute&&(e=e.replace(":00",""));!1===r.meridiem?e=e.replace(Wt,"").trim():"narrow"===r.meridiem?e=e.replace(Wt,(e,t)=>t.toLocaleLowerCase()):"short"===r.meridiem?e=e.replace(Wt,(e,t)=>`${t.toLocaleLowerCase()}m`):"lowercase"===r.meridiem&&(e=e.replace(Wt,e=>e.toLocaleLowerCase()));return e=e.replace(Gt," "),e=e.trim(),e}(s.format(a),o,e,t,n)}}(e,t,n)}function Xt(e,t){let n=t.markerToArray(e.marker);return{marker:e.marker,timeZoneOffset:e.timeZoneOffset,array:n,year:n[0],month:n[1],day:n[2],hour:n[3],minute:n[4],second:n[5],millisecond:n[6]}}function Zt(e,t,n,r){let i=Xt(e,n.calendarSystem);return{date:i,start:i,end:t?Xt(t,n.calendarSystem):null,timeZone:n.timeZone,localeCodes:n.locale.codes,defaultSeparator:r||n.defaultSeparator}}class en{constructor(e){this.cmdStr=e}format(e,t,n){return t.cmdFormatter(this.cmdStr,Zt(e,null,t,n))}formatRange(e,t,n,r){return n.cmdFormatter(this.cmdStr,Zt(e,t,n,r))}}class tn{constructor(e){this.func=e}format(e,t,n){return this.func(Zt(e,null,t,n))}formatRange(e,t,n,r){return this.func(Zt(e,t,n,r))}}function nn(e){return"object"===typeof e&&e?new Yt(e):"string"===typeof e?new en(e):"function"===typeof e?new tn(e):null}const rn={navLinkDayClick:pn,navLinkWeekClick:pn,duration:gt,bootstrapFontAwesome:pn,buttonIcons:pn,customButtons:pn,defaultAllDayEventDuration:gt,defaultTimedEventDuration:gt,nextDayThreshold:gt,scrollTime:gt,scrollTimeReset:Boolean,slotMinTime:gt,slotMaxTime:gt,dayPopoverFormat:nn,slotDuration:gt,snapDuration:gt,headerToolbar:pn,footerToolbar:pn,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:nn,dayHeaderClassNames:pn,dayHeaderContent:pn,dayHeaderDidMount:pn,dayHeaderWillUnmount:pn,dayCellClassNames:pn,dayCellContent:pn,dayCellDidMount:pn,dayCellWillUnmount:pn,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:pn,weekNumbers:Boolean,weekNumberClassNames:pn,weekNumberContent:pn,weekNumberDidMount:pn,weekNumberWillUnmount:pn,editable:Boolean,viewClassNames:pn,viewDidMount:pn,viewWillUnmount:pn,nowIndicator:Boolean,nowIndicatorClassNames:pn,nowIndicatorContent:pn,nowIndicatorDidMount:pn,nowIndicatorWillUnmount:pn,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:pn,locale:pn,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:pn,eventOrder:it,eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:pn,contentHeight:pn,direction:String,weekNumberFormat:nn,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:pn,initialDate:pn,now:pn,eventDataTransform:pn,stickyHeaderDates:pn,stickyFooterScrollbar:pn,viewHeight:pn,defaultAllDay:Boolean,eventSourceFailure:pn,eventSourceSuccess:pn,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:pn,eventConstraint:pn,eventAllow:pn,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:pn,eventContent:pn,eventDidMount:pn,eventWillUnmount:pn,selectConstraint:pn,selectOverlap:pn,selectAllow:pn,droppable:Boolean,unselectCancel:String,slotLabelFormat:pn,slotLaneClassNames:pn,slotLaneContent:pn,slotLaneDidMount:pn,slotLaneWillUnmount:pn,slotLabelClassNames:pn,slotLabelContent:pn,slotLabelDidMount:pn,slotLabelWillUnmount:pn,dayMaxEvents:pn,dayMaxEventRows:pn,dayMinWidth:Number,slotLabelInterval:gt,allDayText:String,allDayClassNames:pn,allDayContent:pn,allDayDidMount:pn,allDayWillUnmount:pn,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:nn,rerenderDelay:Number,moreLinkText:pn,moreLinkHint:pn,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:pn,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:gt,hiddenDays:pn,fixedWeekCount:Boolean,validRange:pn,visibleRange:pn,titleFormat:pn,eventInteractive:Boolean,noEventsText:String,viewHint:pn,navLinkHint:pn,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:pn,moreLinkClassNames:pn,moreLinkContent:pn,moreLinkDidMount:pn,moreLinkWillUnmount:pn,monthStartFormat:nn,handleCustomRendering:pn,customRenderingMetaMap:pn,customRenderingReplaces:Boolean},on={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:" \u2013 ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"}},sn={datesSet:pn,eventsSet:pn,eventAdd:pn,eventChange:pn,eventRemove:pn,windowResize:pn,eventClick:pn,eventMouseEnter:pn,eventMouseLeave:pn,select:pn,unselect:pn,loading:pn,_unmount:pn,_beforeprint:pn,_afterprint:pn,_noEventDrop:pn,_noEventResize:pn,_resize:pn,_scrollRequest:pn},an={buttonText:pn,buttonHints:pn,views:pn,plugins:pn,initialEvents:pn,events:pn,eventSources:pn},ln={headerToolbar:cn,footerToolbar:cn,buttonText:cn,buttonHints:cn,buttonIcons:cn,dateIncrement:cn,plugins:un,events:un,eventSources:un,resources:un};function cn(e,t){return"object"===typeof e&&"object"===typeof t&&e&&t?Cn(e,t):e===t}function un(e,t){return Array.isArray(e)&&Array.isArray(t)?St(e,t):e===t}const dn={type:String,component:pn,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:pn,usesMinMaxTime:Boolean,classNames:pn,content:pn,didMount:pn,willUnmount:pn};function hn(e){return mn(e,ln)}function fn(e,t){let n={},r={};for(let i in t)i in e&&(n[i]=t[i](e[i]));for(let i in e)i in t||(r[i]=e[i]);return{refined:n,extra:r}}function pn(e){return e}const{hasOwnProperty:gn}=Object.prototype;function mn(e,t){let n={};if(t)for(let r in t)if(t[r]===cn){let t=[];for(let i=e.length-1;i>=0;i-=1){let o=e[i][r];if("object"===typeof o&&o)t.unshift(o);else if(void 0!==o){n[r]=o;break}}t.length&&(n[r]=mn(t))}for(let r=e.length-1;r>=0;r-=1){let t=e[r];for(let e in t)e in n||(n[e]=t[e])}return n}function vn(e,t){let n={};for(let r in e)t(e[r],r)&&(n[r]=e[r]);return n}function yn(e,t){let n={};for(let r in e)n[r]=t(e[r],r);return n}function wn(e){let t={};for(let n of e)t[n]=!0;return t}function bn(e){let t=[];for(let n in e)t.push(e[n]);return t}function Cn(e,t){if(e===t)return!0;for(let n in e)if(gn.call(e,n)&&!(n in t))return!1;for(let n in t)if(gn.call(t,n)&&e[n]!==t[n])return!1;return!0}const Sn=/^on[A-Z]/;function En(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;for(let r in t)if(!(r in e)||!Tn(e[r],t[r],n[r]))return!1;for(let r in e)if(!(r in t))return!1;return!0}function Tn(e,t,n){return e===t||!0===n||!!n&&n(e,t)}let _n={};!function(e,t){_n[e]=t}("gregory",class{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return Nt(e)}markerToArray(e){return Ot(e)}});const In=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;class An{constructor(e){let t=this.timeZone=e.timeZone,n="local"!==t&&"UTC"!==t;e.namedTimeZoneImpl&&n&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(t)),this.canComputeOffset=Boolean(!n||this.namedTimeZoneImpl),this.calendarSystem=function(e){return new _n[e]}(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,"ISO"===e.weekNumberCalculation&&(this.weekDow=1,this.weekDoy=4),"number"===typeof e.firstDay&&(this.weekDow=e.firstDay),"function"===typeof e.weekNumberCalculation&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=null!=e.weekText?e.weekText:e.locale.options.weekText,this.weekTextLong=(null!=e.weekTextLong?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let t=this.createMarkerMeta(e);return null===t?null:t.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker((new Date).valueOf()):Nt(Pt(new Date))}createMarkerMeta(e){if("string"===typeof e)return this.parse(e);let t=null;return"number"===typeof e?t=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(t=this.timestampToMarker(e))):Array.isArray(e)&&(t=Nt(e)),null!==t&&Mt(t)?{marker:t,isTimeUnspecified:!1,forcedTzo:null}:null}parse(e){let t=function(e){let t=In.exec(e);if(t){let e=new Date(Date.UTC(Number(t[1]),t[3]?Number(t[3])-1:0,Number(t[5]||1),Number(t[7]||0),Number(t[8]||0),Number(t[10]||0),t[12]?1e3*Number(`0.${t[12]}`):0));if(Mt(e)){let n=null;return t[13]&&(n=("-"===t[15]?-1:1)*(60*Number(t[16]||0)+Number(t[18]||0))),{marker:e,isTimeUnspecified:!t[6],timeZoneOffset:n}}}return null}(e);if(null===t)return null;let{marker:n}=t,r=null;return null!==t.timeZoneOffset&&(this.canComputeOffset?n=this.timestampToMarker(n.valueOf()-60*t.timeZoneOffset*1e3):r=t.timeZoneOffset),{marker:n,isTimeUnspecified:t.isTimeUnspecified,forcedTzo:r}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]+=t.years,n[1]+=t.months,n[2]+=t.days,n[6]+=t.milliseconds,this.calendarSystem.arrayToMarker(n)}subtract(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]-=t.years,n[1]-=t.months,n[2]-=t.days,n[6]-=t.milliseconds,this.calendarSystem.arrayToMarker(n)}addYears(e,t){let n=this.calendarSystem.markerToArray(e);return n[0]+=t,this.calendarSystem.arrayToMarker(n)}addMonths(e,t){let n=this.calendarSystem.markerToArray(e);return n[1]+=t,this.calendarSystem.arrayToMarker(n)}diffWholeYears(e,t){let{calendarSystem:n}=this;return Lt(e)===Lt(t)&&n.getMarkerDay(e)===n.getMarkerDay(t)&&n.getMarkerMonth(e)===n.getMarkerMonth(t)?n.getMarkerYear(t)-n.getMarkerYear(e):null}diffWholeMonths(e,t){let{calendarSystem:n}=this;return Lt(e)===Lt(t)&&n.getMarkerDay(e)===n.getMarkerDay(t)?n.getMarkerMonth(t)-n.getMarkerMonth(e)+12*(n.getMarkerYear(t)-n.getMarkerYear(e)):null}greatestWholeUnit(e,t){let n=this.diffWholeYears(e,t);return null!==n?{unit:"year",value:n}:(n=this.diffWholeMonths(e,t),null!==n?{unit:"month",value:n}:(n=function(e,t){let n=At(e,t);return null!==n&&n%7===0?n/7:null}(e,t),null!==n?{unit:"week",value:n}:(n=At(e,t),null!==n?{unit:"day",value:n}:(n=function(e,t){return(t.valueOf()-e.valueOf())/36e5}(e,t),dt(n)?{unit:"hour",value:n}:(n=function(e,t){return(t.valueOf()-e.valueOf())/6e4}(e,t),dt(n)?{unit:"minute",value:n}:(n=function(e,t){return(t.valueOf()-e.valueOf())/1e3}(e,t),dt(n)?{unit:"second",value:n}:{unit:"millisecond",value:t.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,t,n){let r;return n.years&&(r=this.diffWholeYears(e,t),null!==r)?r/(yt(n)/365):n.months&&(r=this.diffWholeMonths(e,t),null!==r)?r/function(e){return yt(e)/30}(n):n.days&&(r=At(e,t),null!==r)?r/yt(n):(t.valueOf()-e.valueOf())/wt(n)}startOf(e,t){return"year"===t?this.startOfYear(e):"month"===t?this.startOfMonth(e):"week"===t?this.startOfWeek(e):"day"===t?kt(e):"hour"===t?function(e){return Nt([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours()])}(e):"minute"===t?function(e){return Nt([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes()])}(e):"second"===t?function(e){return Nt([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()])}(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):function(e,t,n){let r=e.getUTCFullYear(),i=Rt(e,r,t,n);if(i<1)return Rt(e,r-1,t,n);let o=Rt(e,r+1,t,n);return o>=1?Math.min(i,o):i}(e,this.weekDow,this.weekDoy)}format(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.format({marker:e,timeZoneOffset:null!=n.forcedTzo?n.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r.isEndExclusive&&(t=_t(t,-1)),n.formatRange({marker:e,timeZoneOffset:null!=r.forcedStartTzo?r.forcedStartTzo:this.offsetForMarker(e)},{marker:t,timeZoneOffset:null!=r.forcedEndTzo?r.forcedEndTzo:this.offsetForMarker(t)},this,r.defaultSeparator)}formatIso(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null;return t.omitTimeZoneOffset||(n=null!=t.forcedTzo?t.forcedTzo:this.offsetForMarker(e)),Ut(e,n,t.omitTime)}timestampToMarker(e){return"local"===this.timeZone?Nt(Pt(new Date(e))):"UTC"!==this.timeZone&&this.namedTimeZoneImpl?Nt(this.namedTimeZoneImpl.timestampToArray(e)):new Date(e)}offsetForMarker(e){return"local"===this.timeZone?-xt(Ot(e)).getTimezoneOffset():"UTC"===this.timeZone?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(Ot(e)):null}toDate(e,t){return"local"===this.timeZone?xt(Ot(e)):"UTC"===this.timeZone?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-1e3*this.namedTimeZoneImpl.offsetForArray(Ot(e))*60):new Date(e.valueOf()-(t||0))}}class kn{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let t,n;if("object"===typeof e&&e){for(n in t=Object.assign({},this.iconClasses),e)t[n]=this.applyIconOverridePrefix(e[n]);this.iconClasses=t}else!1===e&&(this.iconClasses={})}applyIconOverridePrefix(e){let t=this.iconOverridePrefix;return t&&0!==e.indexOf(t)&&(e=t+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,t){let n;return n=t&&this.rtlIconClasses&&this.rtlIconClasses[e]||this.iconClasses[e],n?`${this.baseIconClass} ${n}`:""}getCustomButtonIconClass(e){let t;return this.iconOverrideCustomButtonOption&&(t=e[this.iconOverrideCustomButtonOption],t)?`${this.baseIconClass} ${this.applyIconOverridePrefix(t)}`:""}}function Rn(e){e();let t=i.debounceRendering,n=[];for(i.debounceRendering=function(e){n.push(e)},V(b(Dn,{}),document.createElement("div"));n.length;)n.shift()();i.debounceRendering=t}kn.prototype.classes={},kn.prototype.iconClasses={},kn.prototype.baseIconClass="",kn.prototype.iconOverridePrefix="";class Dn extends A{render(){return b("div",{})}componentDidMount(){this.setState({})}}function Pn(e){let t=W(e),n=t.Provider;return t.Provider=function(){let e=!this.getChildContext,t=n.apply(this,arguments);if(e){let e=[];this.shouldComponentUpdate=t=>{this.props.value!==t.value&&e.forEach(e=>{e.context=t.value,e.forceUpdate()})},this.sub=t=>{e.push(t);let n=t.componentWillUnmount;t.componentWillUnmount=()=>{e.splice(e.indexOf(t),1),n&&n.call(t)}}}return t},t}class xn{constructor(e,t,n,r){this.execFunc=e,this.emitter=t,this.scrollTime=n,this.scrollTimeReset=r,this.handleScrollRequest=e=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},e),this.drain()},t.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}}const On=Pn({});function Nn(e,t,n,r,i,o,s,a,l,c,u,d,h,f){return{dateEnv:i,nowManager:o,options:n,pluginHooks:a,emitter:u,dispatch:l,getCurrentData:c,calendarApi:d,viewSpec:e,viewApi:t,dateProfileGenerator:r,theme:s,isRtl:"rtl"===n.direction,addResizeHandler(e){u.on("_resize",e)},removeResizeHandler(e){u.off("_resize",e)},createScrollResponder:e=>new xn(e,u,gt(n.scrollTime),n.scrollTimeReset),registerInteractiveComponent:h,unregisterInteractiveComponent:f}}class Mn extends A{shouldComponentUpdate(e,t){return!En(this.props,e,this.propEquality)||!En(this.state,t,this.stateEquality)}safeSetState(e){En(this.state,Object.assign(Object.assign({},this.state),e),this.stateEquality)||this.setState(e)}}Mn.addPropsEquality=function(e){let t=Object.create(this.prototype.propEquality);Object.assign(t,e),this.prototype.propEquality=t},Mn.addStateEquality=function(e){let t=Object.create(this.prototype.stateEquality);Object.assign(t,e),this.prototype.stateEquality=t},Mn.contextType=On,Mn.prototype.propEquality={},Mn.prototype.stateEquality={};class Ln extends Mn{}function Un(e,t){"function"===typeof e?e(t):e&&(e.current=t)}Ln.contextType=On;class Fn extends Ln{constructor(){super(...arguments),this.id=tt(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{const{options:t}=this.context,{generatorName:n}=this.props;t.customRenderingReplaces&&Hn(n,t)||this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&Un(this.props.elRef,e)}}render(){const{props:e,context:t}=this,{options:n}=t,{customGenerator:r,defaultGenerator:i,renderProps:o}=e,a=jn(e,[],this.handleEl);let l,c,u=!1,d=[];if(null!=r){const e="function"===typeof r?r(o,b):r;if(!0===e)u=!0;else{const t=e&&"object"===typeof e;t&&"html"in e?a.dangerouslySetInnerHTML={__html:e.html}:t&&"domNodes"in e?d=Array.prototype.slice.call(e.domNodes):(t?s(e):"function"!==typeof e)?l=e:c=e}}else u=!Hn(e.generatorName,n);return u&&i&&(l=i(o)),this.queuedDomNodes=d,this.currentGeneratorMeta=c,b(e.elTag,a,l)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var t;const{props:n,context:r}=this,{handleCustomRendering:i,customRenderingMetaMap:o}=r.options;if(i){const r=null!==(t=this.currentGeneratorMeta)&&void 0!==t?t:null===o||void 0===o?void 0:o[n.generatorName];r&&i(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:r},n),{elClasses:(n.elClasses||[]).filter(Bn)}))}}applyQueueudDomNodes(){const{queuedDomNodes:e,currentDomNodes:t}=this,n=this.base;if(!St(e,t)){t.forEach(je);for(let t of e)n.appendChild(t);this.currentDomNodes=e}}}function Hn(e,t){var n;return Boolean(t.handleCustomRendering&&e&&(null===(n=t.customRenderingMetaMap)||void 0===n?void 0:n[e]))}function jn(e,t,n){const r=Object.assign(Object.assign({},e.elAttrs),{ref:n});return(e.elClasses||t)&&(r.className=(e.elClasses||[]).concat(t||[]).concat(r.className||[]).filter(Boolean).join(" ")),e.elStyle&&(r.style=e.elStyle),r}function Bn(e){return Boolean(e)}Fn.addPropsEquality({elClasses:St,elStyle:Cn,elAttrs:function(e,t){const n=function(e,t){let n=[];for(let r in e)gn.call(e,r)&&(r in t||n.push(r));for(let r in t)gn.call(t,r)&&e[r]!==t[r]&&n.push(r);return n}(e,t);for(let r of n)if(!Sn.test(r))return!1;return!0},renderProps:Cn});const zn=Pn(0);class qn extends A{constructor(){super(...arguments),this.InnerContent=Vn.bind(void 0,this),this.handleEl=e=>{this.el=e,this.props.elRef&&(Un(this.props.elRef,e),e&&this.didMountMisfire&&this.componentDidMount())}}render(){const{props:e}=this,t=function(e,t){const n="function"===typeof e?e(t):e||[];return"string"===typeof n?[n]:n}(e.classNameGenerator,e.renderProps);if(e.children){const n=jn(e,t,this.handleEl),r=e.children(this.InnerContent,e.renderProps,n);return e.elTag?b(e.elTag,n,r):r}return b(Fn,Object.assign(Object.assign({},e),{elRef:this.handleEl,elTag:e.elTag||"div",elClasses:(e.elClasses||[]).concat(t),renderId:this.context}))}componentDidMount(){var e,t;this.el?null===(t=(e=this.props).didMount)||void 0===t||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var e,t;null===(t=(e=this.props).willUnmount)||void 0===t||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}}function Vn(e,t){const n=e.props;return b(Fn,Object.assign({renderProps:n.renderProps,generatorName:n.generatorName,customGenerator:n.customGenerator,defaultGenerator:n.defaultGenerator,renderId:e.context},t))}qn.contextType=zn;class Wn extends Ln{render(){let{props:e,context:t}=this,{options:n}=t,r={view:t.viewApi};return b(qn,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:[...$n(e.viewSpec),...e.elClasses||[]],elStyle:e.elStyle,renderProps:r,classNameGenerator:n.viewClassNames,generatorName:void 0,didMount:n.viewDidMount,willUnmount:n.viewWillUnmount},()=>e.children)}}function $n(e){return[`fc-${e.type}-view`,"fc-view"]}function Gn(e,t){let n,r,i=[],{start:o}=t;for(e.sort(Kn),n=0;n<e.length;n+=1)r=e[n],r.start>o&&i.push({start:o,end:r.start}),r.end>o&&(o=r.end);return o<t.end&&i.push({start:o,end:t.end}),i}function Kn(e,t){return e.start.valueOf()-t.start.valueOf()}function Qn(e,t){let{start:n,end:r}=e,i=null;return null!==t.start&&(n=null===n?t.start:new Date(Math.max(n.valueOf(),t.start.valueOf()))),null!=t.end&&(r=null===r?t.end:new Date(Math.min(r.valueOf(),t.end.valueOf()))),(null===n||null===r||n<r)&&(i={start:n,end:r}),i}function Yn(e,t){return(null===e.start?null:e.start.valueOf())===(null===t.start?null:t.start.valueOf())&&(null===e.end?null:e.end.valueOf())===(null===t.end?null:t.end.valueOf())}function Jn(e,t){return(null===e.end||null===t.start||e.end>t.start)&&(null===e.start||null===t.end||e.start<t.end)}function Xn(e,t){return(null===e.start||null!==t.start&&t.start>=e.start)&&(null===e.end||null!==t.end&&t.end<=e.end)}function Zn(e,t){return(null===e.start||t>=e.start)&&(null===e.end||t<e.end)}function er(e){let t=Math.floor(It(e.start,e.end))||1,n=kt(e.start);return{start:n,end:Tt(n,t)}}function tr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gt(0),n=null,r=null;if(e.end){r=kt(e.end);let n=e.end.valueOf()-r.valueOf();n&&n>=wt(t)&&(r=Tt(r,1))}return e.start&&(n=kt(e.start),r&&r<=n&&(r=Tt(n,1))),{start:n,end:r}}function nr(e,t,n,r){return"year"===r?gt(n.diffWholeYears(e,t),"year"):"month"===r?gt(n.diffWholeMonths(e,t),"month"):function(e,t){let n=kt(e),r=kt(t);return{years:0,months:0,days:Math.round(It(n,r)),milliseconds:t.valueOf()-r.valueOf()-(e.valueOf()-n.valueOf())}}(e,t)}class rr{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,t,n){let{dateEnv:r}=this.props,i=r.subtract(r.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(i,-1,n)}buildNext(e,t,n){let{dateEnv:r}=this.props,i=r.add(r.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(i,1,n)}build(e,t){let n,r,i,o,s,a,l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],{props:c}=this;var u,d;return n=this.buildValidRange(),n=this.trimHiddenDays(n),l&&(u=e,e=null!=(d=n).start&&u<d.start?d.start:null!=d.end&&u>=d.end?new Date(d.end.valueOf()-1):u),r=this.buildCurrentRangeInfo(e,t),i=/^(year|month|week|day)$/.test(r.unit),o=this.buildRenderRange(this.trimHiddenDays(r.range),r.unit,i),o=this.trimHiddenDays(o),s=o,c.showNonCurrentDates||(s=Qn(s,r.range)),s=this.adjustActiveRange(s),s=Qn(s,n),a=Jn(r.range,n),Zn(o,e)||(e=o.start),{currentDate:e,validRange:n,currentRange:r.range,currentRangeUnit:r.unit,isRangeAllDay:i,activeRange:s,renderRange:o,slotMinTime:c.slotMinTime,slotMaxTime:c.slotMaxTime,isValid:a,dateIncrement:this.buildDateIncrement(r.duration)}}buildValidRange(){let e=this.props.validRangeInput,t="function"===typeof e?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(t)||{start:null,end:null}}buildCurrentRangeInfo(e,t){let n,{props:r}=this,i=null,o=null,s=null;return r.duration?(i=r.duration,o=r.durationUnit,s=this.buildRangeFromDuration(e,t,i,o)):(n=this.props.dayCount)?(o="day",s=this.buildRangeFromDayCount(e,t,n)):(s=this.buildCustomVisibleRange(e))?o=r.dateEnv.greatestWholeUnit(s.start,s.end).unit:(i=this.getFallbackDuration(),o=Ct(i).unit,s=this.buildRangeFromDuration(e,t,i,o)),{duration:i,unit:o,range:s}}getFallbackDuration(){return gt({day:1})}adjustActiveRange(e){let{dateEnv:t,usesMinMaxTime:n,slotMinTime:r,slotMaxTime:i}=this.props,{start:o,end:s}=e;return n&&(yt(r)<0&&(o=kt(o),o=t.add(o,r)),yt(i)>1&&(s=kt(s),s=Tt(s,-1),s=t.add(s,i))),{start:o,end:s}}buildRangeFromDuration(e,t,n,r){let i,o,s,{dateEnv:a,dateAlignment:l}=this.props;if(!l){let{dateIncrement:e}=this.props;l=e&&wt(e)<wt(n)?Ct(e).unit:r}function c(){i=a.startOf(e,l),o=a.add(i,n),s={start:i,end:o}}return yt(n)<=1&&this.isHiddenDay(i)&&(i=this.skipHiddenDays(i,t),i=kt(i)),c(),this.trimHiddenDays(s)||(e=this.skipHiddenDays(e,t),c()),s}buildRangeFromDayCount(e,t,n){let r,{dateEnv:i,dateAlignment:o}=this.props,s=0,a=e;o&&(a=i.startOf(a,o)),a=kt(a),a=this.skipHiddenDays(a,t),r=a;do{r=Tt(r,1),this.isHiddenDay(r)||(s+=1)}while(s<n);return{start:a,end:r}}buildCustomVisibleRange(e){let{props:t}=this,n=t.visibleRangeInput,r="function"===typeof n?n.call(t.calendarApi,t.dateEnv.toDate(e)):n,i=this.refineRange(r);return!i||null!=i.start&&null!=i.end?i:null}buildRenderRange(e,t,n){return e}buildDateIncrement(e){let t,{dateIncrement:n}=this.props;return n||((t=this.props.dateAlignment)?gt(1,t):e||gt({days:1}))}refineRange(e){if(e){let t=function(e,t){let n=null,r=null;return e.start&&(n=t.createMarker(e.start)),e.end&&(r=t.createMarker(e.end)),n||r?n&&r&&r<n?null:{start:n,end:r}:null}(e,this.props.dateEnv);return t&&(t=tr(t)),t}return null}initHiddenDays(){let e,t=this.props.hiddenDays||[],n=[],r=0;for(!1===this.props.weekends&&t.push(0,6),e=0;e<7;e+=1)(n[e]=-1!==t.indexOf(e))||(r+=1);if(!r)throw new Error("invalid hiddenDays");this.isHiddenDayHash=n}trimHiddenDays(e){let{start:t,end:n}=e;return t&&(t=this.skipHiddenDays(t)),n&&(n=this.skipHiddenDays(n,-1,!0)),null==t||null==n||t<n?{start:t,end:n}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(;this.isHiddenDayHash[(e.getUTCDay()+(n?t:0)+7)%7];)e=Tt(e,t);return e}}function ir(e,t,n,r){return{instanceId:tt(),defId:e,range:t,forcedStartTzo:null==n?null:n,forcedEndTzo:null==r?null:r}}function or(e,t,n){let{dateEnv:r,pluginHooks:i,options:o}=n,{defs:s,instances:a}=e;a=vn(a,e=>!s[e.defId].recurringDef);for(let l in s){let e=s[l];if(e.recurringDef){let{duration:n}=e.recurringDef;n||(n=e.allDay?o.defaultAllDayEventDuration:o.defaultTimedEventDuration);let s=sr(e,n,t,r,i.recurringTypes);for(let e of s){let t=ir(l,{start:e,end:r.add(e,n)});a[t.instanceId]=t}}}return{defs:s,instances:a}}function sr(e,t,n,r,i){let o=i[e.recurringDef.typeId].expand(e.recurringDef.typeData,{start:r.subtract(n.start,t),end:n.end},r);return e.allDay&&(o=o.map(kt)),o}const ar={id:String,groupId:String,title:String,url:String,interactive:Boolean},lr={start:pn,end:pn,date:pn,allDay:Boolean},cr=Object.assign(Object.assign(Object.assign({},ar),lr),{extendedProps:pn});function ur(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:hr(n),o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,{refined:a,extra:l}=dr(e,n,i),c=function(e,t){let n=null;e&&(n=e.defaultAllDay);null==n&&(n=t.options.defaultAllDay);return n}(t,n),u=function(e,t,n,r){for(let i=0;i<r.length;i+=1){let o=r[i].parse(e,n);if(o){let{allDay:n}=e;return null==n&&(n=t,null==n&&(n=o.allDayGuess,null==n&&(n=!1))),{allDay:n,duration:o.duration,typeData:o.typeData,typeId:i}}}return null}(a,c,n.dateEnv,n.pluginHooks.recurringTypes);if(u){let e=fr(a,l,t?t.sourceId:"",u.allDay,Boolean(u.duration),n,o);return e.recurringDef={typeId:u.typeId,typeData:u.typeData,duration:u.duration},{def:e,instance:null}}let d=function(e,t,n,r){let i,o,{allDay:s}=e,a=null,l=!1,c=null,u=null!=e.start?e.start:e.date;if(i=n.dateEnv.createMarkerMeta(u),i)a=i.marker;else if(!r)return null;null!=e.end&&(o=n.dateEnv.createMarkerMeta(e.end));null==s&&(s=null!=t?t:(!i||i.isTimeUnspecified)&&(!o||o.isTimeUnspecified));s&&a&&(a=kt(a));o&&(c=o.marker,s&&(c=kt(c)),a&&c<=a&&(c=null));c?l=!0:r||(l=n.options.forceEventDuration||!1,c=n.dateEnv.add(a,s?n.options.defaultAllDayEventDuration:n.options.defaultTimedEventDuration));return{allDay:s,hasEnd:l,range:{start:a,end:c},forcedStartTzo:i?i.forcedTzo:null,forcedEndTzo:o?o.forcedTzo:null}}(a,c,n,r);if(d){let e=fr(a,l,t?t.sourceId:"",d.allDay,d.hasEnd,n,o),r=ir(e.defId,d.range,d.forcedStartTzo,d.forcedEndTzo);return s&&e.publicId&&s[e.publicId]&&(r.instanceId=s[e.publicId]),{def:e,instance:r}}return null}function dr(e,t){return fn(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:hr(t))}function hr(e){return Object.assign(Object.assign(Object.assign({},Cr),cr),e.pluginHooks.eventRefiners)}function fr(e,t,n,r,i,o,s){let a={title:e.title||"",groupId:e.groupId||"",publicId:e.id||"",url:e.url||"",recurringDef:null,defId:(s&&e.id?s[e.id]:"")||tt(),sourceId:n,allDay:r,hasEnd:i,interactive:e.interactive,ui:Er(e,o),extendedProps:Object.assign(Object.assign({},e.extendedProps||{}),t)};for(let l of o.pluginHooks.eventDefMemberAdders)Object.assign(a,l(e));return Object.freeze(a.ui.classNames),Object.freeze(a.extendedProps),a}function pr(e,t,n,r,i,o){let s={defs:{},instances:{}},a=hr(n);for(let l of e){let e=ur(l,t,n,r,a,i,o);e&&gr(e,s)}return s}function gr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{defs:{},instances:{}};return t.defs[e.def.defId]=e.def,e.instance&&(t.instances[e.instance.instanceId]=e.instance),t}function mr(e,t){let n=e.instances[t];if(n){let t=e.defs[n.defId],r=wr(e,e=>{return n=t,r=e,Boolean(n.groupId&&n.groupId===r.groupId);var n,r});return r.defs[t.defId]=t,r.instances[n.instanceId]=n,r}return{defs:{},instances:{}}}function vr(){return{defs:{},instances:{}}}function yr(e,t){return{defs:Object.assign(Object.assign({},e.defs),t.defs),instances:Object.assign(Object.assign({},e.instances),t.instances)}}function wr(e,t){let n=vn(e.defs,t),r=vn(e.instances,e=>n[e.defId]);return{defs:n,instances:r}}function br(e){return Array.isArray(e)?e:"string"===typeof e?e.split(/\s+/):[]}const Cr={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:pn,overlap:pn,allow:pn,className:br,classNames:br,color:String,backgroundColor:String,borderColor:String,textColor:String},Sr={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function Er(e,t){let n=function(e,t){return Array.isArray(e)?pr(e,null,t,!0):"object"===typeof e&&e?pr([e],null,t,!0):null!=e?String(e):null}(e.constraint,t);return{display:e.display||null,startEditable:null!=e.startEditable?e.startEditable:e.editable,durationEditable:null!=e.durationEditable?e.durationEditable:e.editable,constraints:null!=n?[n]:[],overlap:null!=e.overlap?e.overlap:null,allows:null!=e.allow?[e.allow]:[],backgroundColor:e.backgroundColor||e.color||"",borderColor:e.borderColor||e.color||"",textColor:e.textColor||"",classNames:(e.className||[]).concat(e.classNames||[])}}function Tr(e){return e.reduce(_r,Sr)}function _r(e,t){return{display:null!=t.display?t.display:e.display,startEditable:null!=t.startEditable?t.startEditable:e.startEditable,durationEditable:null!=t.durationEditable?t.durationEditable:e.durationEditable,constraints:e.constraints.concat(t.constraints),overlap:"boolean"===typeof t.overlap?t.overlap:e.overlap,allows:e.allows.concat(t.allows),backgroundColor:t.backgroundColor||e.backgroundColor,borderColor:t.borderColor||e.borderColor,textColor:t.textColor||e.textColor,classNames:e.classNames.concat(t.classNames)}}const Ir={id:String,defaultAllDay:Boolean,url:String,format:String,events:pn,eventDataTransform:pn,success:pn,failure:pn};function Ar(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kr(t);if("string"===typeof e?n={url:e}:"function"===typeof e||Array.isArray(e)?n={events:e}:"object"===typeof e&&e&&(n=e),n){let{refined:i,extra:o}=fn(n,r),s=function(e,t){let n=t.pluginHooks.eventSourceDefs;for(let r=n.length-1;r>=0;r-=1){let t=n[r].parseMeta(e);if(t)return{sourceDefId:r,meta:t}}return null}(i,t);if(s)return{_raw:e,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:i.defaultAllDay,eventDataTransform:i.eventDataTransform,success:i.success,failure:i.failure,publicId:i.id||"",sourceId:tt(),sourceDefId:s.sourceDefId,meta:s.meta,ui:Er(i,t),extendedProps:o}}return null}function kr(e){return Object.assign(Object.assign(Object.assign({},Cr),Ir),e.pluginHooks.eventSourceRefiners)}function Rr(e,t,n,r,i){switch(t.type){case"RECEIVE_EVENTS":return function(e,t,n,r,i,o){if(t&&n===t.latestFetchId){let n=pr(Dr(i,t,o),t,o);return r&&(n=or(n,r,o)),yr(Or(e,t.sourceId),n)}return e}(e,n[t.sourceId],t.fetchId,t.fetchRange,t.rawEvents,i);case"RESET_RAW_EVENTS":return function(e,t,n,r,i){const{defIdMap:o,instanceIdMap:s}=function(e){const{defs:t,instances:n}=e,r={},i={};for(let o in t){const e=t[o],{publicId:n}=e;n&&(r[n]=o)}for(let o in n){const e=t[n[o].defId],{publicId:r}=e;r&&(i[r]=o)}return{defIdMap:r,instanceIdMap:i}}(e);let a=pr(Dr(n,t,i),t,i,!1,o,s);return or(a,r,i)}(e,n[t.sourceId],t.rawEvents,r.activeRange,i);case"ADD_EVENTS":return function(e,t,n,r){n&&(t=or(t,n,r));return yr(e,t)}(e,t.eventStore,r?r.activeRange:null,i);case"RESET_EVENTS":return t.eventStore;case"MERGE_EVENTS":return yr(e,t.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return r?or(e,r.activeRange,i):e;case"REMOVE_EVENTS":return function(e,t){let{defs:n,instances:r}=e,i={},o={};for(let s in n)t.defs[s]||(i[s]=n[s]);for(let s in r)!t.instances[s]&&i[r[s].defId]&&(o[s]=r[s]);return{defs:i,instances:o}}(e,t.eventStore);case"REMOVE_EVENT_SOURCE":return Or(e,t.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return wr(e,e=>!e.sourceId);case"REMOVE_ALL_EVENTS":return{defs:{},instances:{}};default:return e}}function Dr(e,t,n){let r=n.options.eventDataTransform,i=t?t.eventDataTransform:null;return i&&(e=Pr(e,i)),r&&(e=Pr(e,r)),e}function Pr(e,t){let n;if(t){n=[];for(let r of e){let e=t(r);e?n.push(e):null==e&&n.push(r)}}else n=e;return n}function xr(e,t,n){let{defs:r}=e,i=yn(e.instances,e=>r[e.defId].allDay?e:Object.assign(Object.assign({},e),{range:{start:n.createMarker(t.toDate(e.range.start,e.forcedStartTzo)),end:n.createMarker(t.toDate(e.range.end,e.forcedEndTzo))},forcedStartTzo:n.canComputeOffset?null:e.forcedStartTzo,forcedEndTzo:n.canComputeOffset?null:e.forcedEndTzo}));return{defs:r,instances:i}}function Or(e,t){return wr(e,e=>e.sourceId!==t)}class Nr{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,t){!function(e,t,n){(e[t]||(e[t]=[])).push(n)}(this.handlers,e,t)}off(e,t){!function(e,t,n){n?e[t]&&(e[t]=e[t].filter(e=>e!==n)):delete e[t]}(this.handlers,e,t)}trigger(e){let t=this.handlers[e]||[],n=this.options&&this.options[e],r=[].concat(n||[],t);for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];for(let a of r)a.apply(this.thisContext,o)}hasHandlers(e){return Boolean(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}}const Mr={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function Lr(e,t){return pr(function(e){let t;t=!0===e?[{}]:Array.isArray(e)?e.filter(e=>e.daysOfWeek):"object"===typeof e&&e?[e]:[];return t=t.map(e=>Object.assign(Object.assign({},Mr),e)),t}(e),null,t)}function Ur(e,t,n){n.emitter.trigger("select",Object.assign(Object.assign({},Fr(e,n)),{jsEvent:t?t.origEvent:null,view:n.viewApi||n.calendarApi.view}))}function Fr(e,t){let n={};for(let o of t.pluginHooks.dateSpanTransforms)Object.assign(n,o(e,t));var r,i;return Object.assign(n,(r=e,i=t.dateEnv,Object.assign(Object.assign({},di(r.range,i,r.allDay)),{allDay:r.allDay}))),n}function Hr(e,t,n){let{dateEnv:r,options:i}=n,o=t;return e?(o=kt(o),o=r.add(o,i.defaultAllDayEventDuration)):o=r.add(o,i.defaultTimedEventDuration),o}function jr(e,t,n,r){let i=Yr(e.defs,t),o={defs:{},instances:{}};for(let s in e.defs){let t=e.defs[s];o.defs[s]=Br(t,i[s],n,r)}for(let s in e.instances){let t=e.instances[s],a=o.defs[t.defId];o.instances[s]=zr(t,a,i[t.defId],n,r)}return o}function Br(e,t,n,r){let i=n.standardProps||{};null==i.hasEnd&&t.durationEditable&&(n.startDelta||n.endDelta)&&(i.hasEnd=!0);let o=Object.assign(Object.assign(Object.assign({},e),i),{ui:Object.assign(Object.assign({},e.ui),i.ui)});n.extendedProps&&(o.extendedProps=Object.assign(Object.assign({},o.extendedProps),n.extendedProps));for(let s of r.pluginHooks.eventDefMutationAppliers)s(o,n,r);return!o.hasEnd&&r.options.forceEventDuration&&(o.hasEnd=!0),o}function zr(e,t,n,r,i){let{dateEnv:o}=i,s=r.standardProps&&!0===r.standardProps.allDay,a=r.standardProps&&!1===r.standardProps.hasEnd,l=Object.assign({},e);return s&&(l.range=er(l.range)),r.datesDelta&&n.startEditable&&(l.range={start:o.add(l.range.start,r.datesDelta),end:o.add(l.range.end,r.datesDelta)}),r.startDelta&&n.durationEditable&&(l.range={start:o.add(l.range.start,r.startDelta),end:l.range.end}),r.endDelta&&n.durationEditable&&(l.range={start:l.range.start,end:o.add(l.range.end,r.endDelta)}),a&&(l.range={start:l.range.start,end:Hr(t.allDay,l.range.start,i)}),t.allDay&&(l.range={start:kt(l.range.start),end:kt(l.range.end)}),l.range.end<l.range.start&&(l.range.end=Hr(t.allDay,l.range.start,i)),l}class qr{constructor(e,t){this.context=e,this.internalEventSource=t}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}}class Vr{constructor(e,t,n){this._context=e,this._def=t,this._instance=n||null}setProp(e,t){if(e in lr)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if("id"===e)t=ar[e](t),this.mutate({standardProps:{publicId:t}});else if(e in ar)t=ar[e](t),this.mutate({standardProps:{[e]:t}});else if(e in Cr){let n=Cr[e](t);n="color"===e?{backgroundColor:t,borderColor:t}:"editable"===e?{startEditable:t,durationEditable:t}:{[e]:t},this.mutate({standardProps:{ui:n}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,t){this.mutate({extendedProps:{[e]:t}})}setStart(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{dateEnv:n}=this._context,r=n.createMarker(e);if(r&&this._instance){let e=nr(this._instance.range.start,r,n,t.granularity);t.maintainDuration?this.mutate({datesDelta:e}):this.mutate({startDelta:e})}}setEnd(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{dateEnv:r}=this._context;if((null==e||(t=r.createMarker(e),t))&&this._instance)if(t){let e=nr(this._instance.range.end,t,r,n.granularity);this.mutate({endDelta:e})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,t){let n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{dateEnv:i}=this._context,o={allDay:r.allDay},s=i.createMarker(e);var a,l;if(s&&((null==t||(n=i.createMarker(t),n))&&this._instance)){let e=this._instance.range;!0===r.allDay&&(e=er(e));let t=nr(e.start,s,i,r.granularity);if(n){let s=nr(e.end,n,i,r.granularity);l=s,(a=t).years===l.years&&a.months===l.months&&a.days===l.days&&a.milliseconds===l.milliseconds?this.mutate({datesDelta:t,standardProps:o}):this.mutate({startDelta:t,endDelta:s,standardProps:o})}else o.hasEnd=!1,this.mutate({datesDelta:t,standardProps:o})}}moveStart(e){let t=gt(e);t&&this.mutate({startDelta:t})}moveEnd(e){let t=gt(e);t&&this.mutate({endDelta:t})}moveDates(e){let t=gt(e);t&&this.mutate({datesDelta:t})}setAllDay(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={allDay:e},{maintainDuration:r}=t;null==r&&(r=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(n.hasEnd=r),this.mutate({standardProps:n})}formatRange(e){let{dateEnv:t}=this._context,n=this._instance,r=nn(e);return this._def.hasEnd?t.formatRange(n.range.start,n.range.end,r,{forcedStartTzo:n.forcedStartTzo,forcedEndTzo:n.forcedEndTzo}):t.format(n.range.start,r,{forcedTzo:n.forcedStartTzo})}mutate(e){let t=this._instance;if(t){let n=this._def,r=this._context,{eventStore:i}=r.getCurrentData(),o=mr(i,t.instanceId);o=jr(o,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,r);let s=new Vr(r,n,t);this._def=o.defs[n.defId],this._instance=o.instances[t.instanceId],r.dispatch({type:"MERGE_EVENTS",eventStore:o}),r.emitter.trigger("eventChange",{oldEvent:s,event:this,relatedEvents:$r(o,r,t),revert(){r.dispatch({type:"RESET_EVENTS",eventStore:i})}})}}remove(){let e=this._context,t=Wr(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:t}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:t})}})}get source(){let{sourceId:e}=this._def;return e?new qr(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._def,{ui:n}=t,{startStr:r,endStr:i}=this,o={allDay:t.allDay};return t.title&&(o.title=t.title),r&&(o.start=r),i&&(o.end=i),t.publicId&&(o.id=t.publicId),t.groupId&&(o.groupId=t.groupId),t.url&&(o.url=t.url),n.display&&"auto"!==n.display&&(o.display=n.display),e.collapseColor&&n.backgroundColor&&n.backgroundColor===n.borderColor?o.color=n.backgroundColor:(n.backgroundColor&&(o.backgroundColor=n.backgroundColor),n.borderColor&&(o.borderColor=n.borderColor)),n.textColor&&(o.textColor=n.textColor),n.classNames.length&&(o.classNames=n.classNames),Object.keys(t.extendedProps).length&&(e.collapseExtendedProps?Object.assign(o,t.extendedProps):o.extendedProps=t.extendedProps),o}toJSON(){return this.toPlainObject()}}function Wr(e){let t=e._def,n=e._instance;return{defs:{[t.defId]:t},instances:n?{[n.instanceId]:n}:{}}}function $r(e,t,n){let{defs:r,instances:i}=e,o=[],s=n?n.instanceId:"";for(let a in i){let e=i[a],n=r[e.defId];e.instanceId!==s&&o.push(new Vr(t,n,e))}return o}function Gr(e,t,n,r){let i={},o={},s={},a=[],l=[],c=Yr(e.defs,t);for(let u in e.defs){let t=e.defs[u];"inverse-background"===c[t.defId].display&&(t.groupId?(i[t.groupId]=[],s[t.groupId]||(s[t.groupId]=t)):o[u]=[])}for(let u in e.instances){let t=e.instances[u],s=e.defs[t.defId],d=c[s.defId],h=t.range,f=!s.allDay&&r?tr(h,r):h,p=Qn(f,n);p&&("inverse-background"===d.display?s.groupId?i[s.groupId].push(p):o[t.defId].push(p):"none"!==d.display&&("background"===d.display?a:l).push({def:s,ui:d,instance:t,range:p,isStart:f.start&&f.start.valueOf()===p.start.valueOf(),isEnd:f.end&&f.end.valueOf()===p.end.valueOf()}))}for(let u in i){let e=Gn(i[u],n);for(let t of e){let e=s[u],n=c[e.defId];a.push({def:e,ui:n,instance:null,range:t,isStart:!1,isEnd:!1})}}for(let u in o){let t=Gn(o[u],n);for(let n of t)a.push({def:e.defs[u],ui:c[u],instance:null,range:n,isStart:!1,isEnd:!1})}return{bg:a,fg:l}}function Kr(e,t){e.fcSeg=t}function Qr(e){return e.fcSeg||e.parentNode.fcSeg||null}function Yr(e,t){return yn(e,e=>Jr(e,t))}function Jr(e,t){let n=[];return t[""]&&n.push(t[""]),t[e.defId]&&n.push(t[e.defId]),n.push(e.ui),Tr(n)}function Xr(e,t){let n=e.map(Zr);return n.sort((e,n)=>ot(e,n,t)),n.map(e=>e._seg)}function Zr(e){let{eventRange:t}=e,n=t.def,r=t.instance?t.instance.range:t.range,i=r.start?r.start.valueOf():0,o=r.end?r.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},n.extendedProps),n),{id:n.publicId,start:i,end:o,duration:o-i,allDay:Number(n.allDay),_seg:e})}function ei(e,t){let{pluginHooks:n}=t,r=n.isDraggableTransformers,{def:i,ui:o}=e.eventRange,s=o.startEditable;for(let a of r)s=a(s,i,o,t);return s}function ti(e,t){return e.isStart&&e.eventRange.ui.durationEditable&&t.options.eventResizableFromStart}function ni(e,t){return e.isEnd&&e.eventRange.ui.durationEditable}function ri(e,t,n,r,i,o,s){let{dateEnv:a,options:l}=n,{displayEventTime:c,displayEventEnd:u}=l,d=e.eventRange.def,h=e.eventRange.instance;null==c&&(c=!1!==r),null==u&&(u=!1!==i);let f=h.range.start,p=h.range.end,g=o||e.start||e.eventRange.range.start,m=s||e.end||e.eventRange.range.end,v=kt(f).valueOf()===kt(g).valueOf(),y=kt(_t(p,-1)).valueOf()===kt(_t(m,-1)).valueOf();return c&&!d.allDay&&(v||y)?(g=v?f:g,m=y?p:m,u&&d.hasEnd?a.formatRange(g,m,t,{forcedStartTzo:o?null:h.forcedStartTzo,forcedEndTzo:s?null:h.forcedEndTzo}):a.format(g,t,{forcedTzo:o?null:h.forcedStartTzo})):""}function ii(e,t,n){let r=e.eventRange.range;return{isPast:r.end<=(n||t.start),isFuture:r.start>=(n||t.end),isToday:t&&Zn(t,r.start)}}function oi(e){let t=["fc-event"];return e.isMirror&&t.push("fc-event-mirror"),e.isDraggable&&t.push("fc-event-draggable"),(e.isStartResizable||e.isEndResizable)&&t.push("fc-event-resizable"),e.isDragging&&t.push("fc-event-dragging"),e.isResizing&&t.push("fc-event-resizing"),e.isSelected&&t.push("fc-event-selected"),e.isStart&&t.push("fc-event-start"),e.isEnd&&t.push("fc-event-end"),e.isPast&&t.push("fc-event-past"),e.isToday&&t.push("fc-event-today"),e.isFuture&&t.push("fc-event-future"),t}function si(e){return e.instance?e.instance.instanceId:`${e.def.defId}:${e.range.start.toISOString()}`}function ai(e,t){let{def:n,instance:r}=e.eventRange,{url:i}=n;if(i)return{href:i};let{emitter:o,options:s}=t,{eventInteractive:a}=s;return null==a&&(a=n.interactive,null==a&&(a=Boolean(o.hasHandlers("eventClick")))),a?Ze(e=>{o.trigger("eventClick",{el:e.target,event:new Vr(t,n,r),jsEvent:e,view:t.viewApi})}):{}}const li={start:pn,end:pn,allDay:Boolean};function ci(e,t,n){let r=function(e,t){let{refined:n,extra:r}=fn(e,li),i=n.start?t.createMarkerMeta(n.start):null,o=n.end?t.createMarkerMeta(n.end):null,{allDay:s}=n;null==s&&(s=i&&i.isTimeUnspecified&&(!o||o.isTimeUnspecified));return Object.assign({range:{start:i?i.marker:null,end:o?o.marker:null},allDay:s},r)}(e,t),{range:i}=r;if(!i.start)return null;if(!i.end){if(null==n)return null;i.end=t.add(i.start,n)}return r}function ui(e,t,n){return Object.assign(Object.assign({},di(e,t,n)),{timeZone:t.timeZone})}function di(e,t,n){return{start:t.toDate(e.start),end:t.toDate(e.end),startStr:t.formatIso(e.start,{omitTime:n}),endStr:t.formatIso(e.end,{omitTime:n})}}function hi(e,t,n){let r=!1,i=function(e){r||(r=!0,t(e))},o=function(e){r||(r=!0,n(e))},s=e(i,o);s&&"function"===typeof s.then&&s.then(i,o)}class fi extends Error{constructor(e,t){super(e),this.response=t}}function pi(e,t,n){const r={method:e=e.toUpperCase()};return"GET"===e?t+=(-1===t.indexOf("?")?"?":"&")+new URLSearchParams(n):(r.body=new URLSearchParams(n),r.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(t,r).then(e=>{if(e.ok)return e.json().then(t=>[t,e],()=>{throw new fi("Failure parsing JSON",e)});throw new fi("Request failed",e)})}let gi;function mi(){return null==gi&&(gi=function(){if("undefined"===typeof document)return!0;let e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.innerHTML="<table><tr><td><div></div></td></tr></table>",e.querySelector("table").style.height="100px",e.querySelector("div").style.height="100%",document.body.appendChild(e);let t=e.querySelector("div").offsetHeight>0;return document.body.removeChild(e),t}()),gi}class vi extends Ln{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{Rn(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{Rn(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:t}=e,{forPrint:n}=this.state,r=n||"auto"===t.height||"auto"===t.contentHeight,i=r||null==t.height?"":t.height,o=["fc",n?"fc-media-print":"fc-media-screen",`fc-direction-${t.direction}`,e.theme.getClass("root")];return mi()||o.push("fc-liquid-hack"),e.children(o,i,r,n)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}}class yi{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}}function wi(e){return{[e.component.uid]:e}}const bi={};class Ci extends A{constructor(e,t){super(e,t),this.handleRefresh=()=>{let e=this.computeTiming();e.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(e.state),this.clearTimeout(),this.setTimeout(e.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:e,state:t}=this;return e.children(t.nowDate,t.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(e){e.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let{props:e,context:t}=this,n=t.nowManager.getDateMarker(),r=t.dateEnv.startOf(n,e.unit),i=t.dateEnv.add(r,gt(1,e.unit)).valueOf()-n.valueOf();return i=Math.min(864e5,i),{state:{nowDate:r,todayRange:Si(r)},waitMs:i}}setTimeout(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.computeTiming().waitMs;this.timeoutId=setTimeout(()=>{const e=this.computeTiming();this.setState(e.state,()=>{this.setTimeout(e.waitMs)})},e)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}}function Si(e){let t=kt(e);return{start:t,end:Tt(t,1)}}Ci.contextType=On;class Ei{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,t){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:t})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,t){let{currentDataManager:n}=this;n.currentCalendarOptionsRefiners[e]?n.emitter.on(e,t):console.warn(`Unknown listener name '${e}'`)}off(e,t){this.currentDataManager.emitter.off(e,t)}trigger(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.currentDataManager.emitter.trigger(e,...n)}changeView(e,t){this.batchRendering(()=>{if(this.unselect(),t)if(t.start&&t.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:t});else{let{dateEnv:n}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:n.createMarker(t)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,t){let n;t=t||"day",n=this.getCurrentData().viewSpecs[t]||this.getUnitViewSpec(t),this.unselect(),n?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:n.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let t,n,{viewSpecs:r,toolbarConfig:i}=this.getCurrentData(),o=[].concat(i.header?i.header.viewsWithButtons:[],i.footer?i.footer.viewsWithButtons:[]);for(let s in r)o.push(s);for(t=0;t<o.length;t+=1)if(n=r[o[t]],n&&n.singleUnit===e)return n;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let t=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.createMarker(e)})}incrementDate(e){let t=this.getCurrentData(),n=gt(e);n&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.add(t.currentDate,n)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,t){let{dateEnv:n}=this.getCurrentData();return n.format(n.createMarker(e),nn(t))}formatRange(e,t,n){let{dateEnv:r}=this.getCurrentData();return r.formatRange(r.createMarker(e),r.createMarker(t),nn(n),n)}formatIso(e,t){let{dateEnv:n}=this.getCurrentData();return n.formatIso(n.createMarker(e),{omitTime:t})}select(e,t){let n;n=null==t?null!=e.start?e:{start:e,end:null}:{start:e,end:t};let r=this.getCurrentData(),i=ci(n,r.dateEnv,gt({days:1}));i&&(this.dispatch({type:"SELECT_DATES",selection:i}),Ur(i,null,r))}unselect(e){let t=this.getCurrentData();t.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),function(e,t){t.emitter.trigger("unselect",{jsEvent:e?e.origEvent:null,view:t.viewApi||t.calendarApi.view})}(e,t))}addEvent(e,t){if(e instanceof Vr){let t=e._def,n=e._instance;return this.getCurrentData().eventStore.defs[t.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:gr({def:t,instance:n})}),this.triggerEventAdd(e)),e}let n,r=this.getCurrentData();if(t instanceof qr)n=t.internalEventSource;else if("boolean"===typeof t)t&&([n]=bn(r.eventSources));else if(null!=t){let e=this.getEventSourceById(t);if(!e)return console.warn(`Could not find an event source with ID "${t}"`),null;n=e.internalEventSource}let i=ur(e,n,r,!1);if(i){let e=new Vr(r,i.def,i.def.recurringDef?null:i.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:gr(i)}),this.triggerEventAdd(e),e}return null}triggerEventAdd(e){let{emitter:t}=this.getCurrentData();t.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:Wr(e)})}})}getEventById(e){let t=this.getCurrentData(),{defs:n,instances:r}=t.eventStore;e=String(e);for(let i in n){let o=n[i];if(o.publicId===e){if(o.recurringDef)return new Vr(t,o,null);for(let e in r){let n=r[e];if(n.defId===o.defId)return new Vr(t,o,n)}}}return null}getEvents(){let e=this.getCurrentData();return $r(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),t=e.eventSources,n=[];for(let r in t)n.push(new qr(e,t[r]));return n}getEventSourceById(e){let t=this.getCurrentData(),n=t.eventSources;e=String(e);for(let r in n)if(n[r].publicId===e)return new qr(t,n[r]);return null}addEventSource(e){let t=this.getCurrentData();if(e instanceof qr)return t.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let n=Ar(e,t);return n?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[n]}),new qr(t,n)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let t=gt(e);t&&this.trigger("_scrollRequest",{time:t})}}function Ti(e,t){return e.left>=t.left&&e.left<t.right&&e.top>=t.top&&e.top<t.bottom}function _i(e,t){let n={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)};return n.left<n.right&&n.top<n.bottom&&n}const Ii={defs:{},instances:{}};class Ai{constructor(){this.getKeysForEventDefs=Bt(this._getKeysForEventDefs),this.splitDateSelection=Bt(this._splitDateSpan),this.splitEventStore=Bt(this._splitEventStore),this.splitIndividualUi=Bt(this._splitIndividualUi),this.splitEventDrag=Bt(this._splitInteraction),this.splitEventResize=Bt(this._splitInteraction),this.eventUiBuilders={}}splitProps(e){let t=this.getKeyInfo(e),n=this.getKeysForEventDefs(e.eventStore),r=this.splitDateSelection(e.dateSelection),i=this.splitIndividualUi(e.eventUiBases,n),o=this.splitEventStore(e.eventStore,n),s=this.splitEventDrag(e.eventDrag),a=this.splitEventResize(e.eventResize),l={};this.eventUiBuilders=yn(t,(e,t)=>this.eventUiBuilders[t]||Bt(ki));for(let c in t){let n=t[c],u=o[c]||Ii,d=this.eventUiBuilders[c];l[c]={businessHours:n.businessHours||e.businessHours,dateSelection:r[c]||null,eventStore:u,eventUiBases:d(e.eventUiBases[""],n.ui,i[c]),eventSelection:u.instances[e.eventSelection]?e.eventSelection:"",eventDrag:s[c]||null,eventResize:a[c]||null}}return l}_splitDateSpan(e){let t={};if(e){let n=this.getKeysForDateSpan(e);for(let r of n)t[r]=e}return t}_getKeysForEventDefs(e){return yn(e.defs,e=>this.getKeysForEventDef(e))}_splitEventStore(e,t){let{defs:n,instances:r}=e,i={};for(let o in n)for(let e of t[o])i[e]||(i[e]=vr()),i[e].defs[o]=n[o];for(let o in r){let e=r[o];for(let n of t[e.defId])i[n]&&(i[n].instances[o]=e)}return i}_splitIndividualUi(e,t){let n={};for(let r in e)if(r)for(let i of t[r])n[i]||(n[i]={}),n[i][r]=e[r];return n}_splitInteraction(e){let t={};if(e){let n=this._splitEventStore(e.affectedEvents,this._getKeysForEventDefs(e.affectedEvents)),r=this._getKeysForEventDefs(e.mutatedEvents),i=this._splitEventStore(e.mutatedEvents,r),o=r=>{t[r]||(t[r]={affectedEvents:n[r]||Ii,mutatedEvents:i[r]||Ii,isEvent:e.isEvent})};for(let e in n)o(e);for(let e in i)o(e)}return t}}function ki(e,t,n){let r=[];e&&r.push(e),t&&r.push(t);let i={"":Tr(r)};return n&&Object.assign(i,n),i}function Ri(e,t,n,r){return{dow:e.getUTCDay(),isDisabled:Boolean(r&&(!r.activeRange||!Zn(r.activeRange,e))),isOther:Boolean(r&&!Zn(r.currentRange,e)),isToday:Boolean(t&&Zn(t,e)),isPast:Boolean(n?e<n:!!t&&e<t.start),isFuture:Boolean(n?e>n:!!t&&e>=t.end)}}function Di(e,t){let n=["fc-day",`fc-day-${Et[e.dow]}`];return e.isDisabled?n.push("fc-day-disabled"):(e.isToday&&(n.push("fc-day-today"),n.push(t.getClass("today"))),e.isPast&&n.push("fc-day-past"),e.isFuture&&n.push("fc-day-future"),e.isOther&&n.push("fc-day-other")),n}const Pi=nn({year:"numeric",month:"long",day:"numeric"}),xi=nn({week:"long"});function Oi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day",r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{dateEnv:i,options:o,calendarApi:s}=e;let a=i.format(t,"week"===n?xi:Pi);if(o.navLinks){let e=i.toDate(t);const l=e=>{let r="day"===n?o.navLinkDayClick:"week"===n?o.navLinkWeekClick:null;"function"===typeof r?r.call(s,i.toDate(t),e):("string"===typeof r&&(n=r),s.zoomTo(t,n))};return Object.assign({title:ct(o.navLinkHint,[a,e],a),"data-navlink":""},r?Xe(l):{onClick:l})}return{"aria-label":a}}let Ni,Mi=null;function Li(){return null===Mi&&(Mi=function(){let e=document.createElement("div");Ve(e,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),e.innerHTML="<div></div>",document.body.appendChild(e);let t=e.firstChild.getBoundingClientRect().left>e.getBoundingClientRect().left;return je(e),t}()),Mi}function Ui(){return Ni||(Ni=function(){let e=document.createElement("div");e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",e.style.left="-9999px",document.body.appendChild(e);let t=Fi(e);return document.body.removeChild(e),t}()),Ni}function Fi(e){return{x:e.offsetHeight-e.clientHeight,y:e.offsetWidth-e.clientWidth}}function Hi(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(arguments.length>2?arguments[2]:void 0)?e.getBoundingClientRect():ji(e),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window.getComputedStyle(e),r=parseInt(n.borderLeftWidth,10)||0,i=parseInt(n.borderRightWidth,10)||0,o=parseInt(n.borderTopWidth,10)||0,s=parseInt(n.borderBottomWidth,10)||0,a=Fi(e),l=a.y-r-i,c={borderLeft:r,borderRight:i,borderTop:o,borderBottom:s,scrollbarBottom:a.x-o-s,scrollbarLeft:0,scrollbarRight:0};return Li()&&"rtl"===n.direction?c.scrollbarLeft=l:c.scrollbarRight=l,t&&(c.paddingLeft=parseInt(n.paddingLeft,10)||0,c.paddingRight=parseInt(n.paddingRight,10)||0,c.paddingTop=parseInt(n.paddingTop,10)||0,c.paddingBottom=parseInt(n.paddingBottom,10)||0),c}(e,t),i={left:n.left+r.borderLeft+r.scrollbarLeft,right:n.right-r.borderRight-r.scrollbarRight,top:n.top+r.borderTop,bottom:n.bottom-r.borderBottom-r.scrollbarBottom};return t&&(i.left+=r.paddingLeft,i.right-=r.paddingRight,i.top+=r.paddingTop,i.bottom-=r.paddingBottom),i}function ji(e){let t=e.getBoundingClientRect();return{left:t.left+window.scrollX,top:t.top+window.scrollY,right:t.right+window.scrollX,bottom:t.bottom+window.scrollY}}function Bi(e){let t=[];for(;e instanceof HTMLElement;){let n=window.getComputedStyle(e);if("fixed"===n.position)break;/(auto|scroll)/.test(n.overflow+n.overflowY+n.overflowX)&&t.push(e),e=e.parentNode}return t}class zi{constructor(e,t,n,r){this.els=t;let i=this.originClientRect=e.getBoundingClientRect();n&&this.buildElHorizontals(i.left),r&&this.buildElVerticals(i.top)}buildElHorizontals(e){let t=[],n=[];for(let r of this.els){let i=r.getBoundingClientRect();t.push(i.left-e),n.push(i.right-e)}this.lefts=t,this.rights=n}buildElVerticals(e){let t=[],n=[];for(let r of this.els){let i=r.getBoundingClientRect();t.push(i.top-e),n.push(i.bottom-e)}this.tops=t,this.bottoms=n}leftToIndex(e){let t,{lefts:n,rights:r}=this,i=n.length;for(t=0;t<i;t+=1)if(e>=n[t]&&e<r[t])return t}topToIndex(e){let t,{tops:n,bottoms:r}=this,i=n.length;for(t=0;t<i;t+=1)if(e>=n[t]&&e<r[t])return t}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return qi(this.tops||[],e.tops||[])&&qi(this.bottoms||[],e.bottoms||[])&&qi(this.lefts||[],e.lefts||[])&&qi(this.rights||[],e.rights||[])}}function qi(e,t){const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(Math.round(e[r])!==Math.round(t[r]))return!1;return!0}class Vi{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}}class Wi extends Vi{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}}class $i extends Vi{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}}class Gi extends Ln{constructor(){super(...arguments),this.uid=tt()}prepareHits(){}queryHit(e,t,n,r){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!Be(e,".fc-event-mirror")}isValidDateDownEl(e){return!Be(e,".fc-event:not(.fc-bg-event)")&&!Be(e,".fc-more-link")&&!Be(e,"a[data-navlink]")&&!Be(e,".fc-popover")}}class Ki{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e.thickness||1;this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let t=[];for(let n of e)this.insertEntry(n,t);return t}insertEntry(e,t){let n=this.findInsertion(e);this.isInsertionValid(n,e)?this.insertEntryAt(e,n):this.handleInvalidInsertion(n,e,t)}isInsertionValid(e,t){return(-1===this.maxCoord||e.levelCoord+this.getEntryThickness(t)<=this.maxCoord)&&(-1===this.maxStackCnt||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,t,n){if(this.allowReslicing&&e.touchingEntry){const r=Object.assign(Object.assign({},t),{span:Xi(t.span,e.touchingEntry.span)});n.push(r),this.splitEntry(t,e.touchingEntry,n)}else n.push(t)}splitEntry(e,t,n){let r=e.span,i=t.span;r.start<i.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:r.start,end:i.start}},n),r.end>i.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:i.end,end:r.end}},n)}insertEntryAt(e,t){let{entriesByLevel:n,levelCoords:r}=this;-1===t.lateral?(Zi(r,t.level,t.levelCoord),Zi(n,t.level,[e])):Zi(n[t.level],t.lateral,e),this.stackCnts[Yi(e)]=t.stackCnt}findInsertion(e){let{levelCoords:t,entriesByLevel:n,strictOrder:r,stackCnts:i}=this,o=t.length,s=0,a=-1,l=-1,c=null,u=0;for(let f=0;f<o;f+=1){const o=t[f];if(!r&&o>=s+this.getEntryThickness(e))break;let d,h=n[f],p=eo(h,e.span.start,Qi),g=p[0]+p[1];for(;(d=h[g])&&d.span.start<e.span.end;){let e=o+this.getEntryThickness(d);e>s&&(s=e,c=d,a=f,l=g),e===s&&(u=Math.max(u,i[Yi(d)]+1)),g+=1}}let d=0;if(c)for(d=a+1;d<o&&t[d]<s;)d+=1;let h=-1;return d<o&&t[d]===s&&(h=eo(n[d],e.span.end,Qi)[0]),{touchingLevel:a,touchingLateral:l,touchingEntry:c,stackCnt:u,levelCoord:s,level:d,lateral:h}}toRects(){let{entriesByLevel:e,levelCoords:t}=this,n=e.length,r=[];for(let i=0;i<n;i+=1){let n=e[i],o=t[i];for(let e of n)r.push(Object.assign(Object.assign({},e),{thickness:this.getEntryThickness(e),levelCoord:o}))}return r}}function Qi(e){return e.span.end}function Yi(e){return e.index+":"+e.span.start}function Ji(e,t){return{start:Math.min(e.start,t.start),end:Math.max(e.end,t.end)}}function Xi(e,t){let n=Math.max(e.start,t.start),r=Math.min(e.end,t.end);return n<r?{start:n,end:r}:null}function Zi(e,t,n){e.splice(t,0,n)}function eo(e,t,n){let r=0,i=e.length;if(!i||t<n(e[r]))return[0,0];if(t>n(e[i-1]))return[i,0];for(;r<i;){let o=Math.floor(r+(i-r)/2),s=n(e[o]);if(t<s)i=o;else{if(!(t>s))return[o,1];r=o+1}}return[r,0]}class to{constructor(e,t){this.emitter=new Nr}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}}const no={};Boolean;function ro(e,t){return nn(!e||t>10?{weekday:"short"}:t>1?{weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}:{weekday:"long"})}const io="fc-col-header-cell";function oo(e){return e.text}class so extends Ln{render(){let{dateEnv:e,options:t,theme:n,viewApi:r}=this.context,{props:i}=this,{date:o,dateProfile:s}=i,a=Ri(o,i.todayRange,null,s),l=[io].concat(Di(a,n)),c=e.format(o,i.dayHeaderFormat),u=!a.isDisabled&&i.colCnt>1?Oi(this.context,o):{},d=e.toDate(o);e.namedTimeZoneImpl&&(d=_t(d,36e5));let h=Object.assign(Object.assign(Object.assign({date:d,view:r},i.extraRenderProps),{text:c}),a);return b(qn,{elTag:"th",elClasses:l,elAttrs:Object.assign({role:"columnheader",colSpan:i.colSpan,"data-date":a.isDisabled?void 0:Ft(o)},i.extraDataAttrs),renderProps:h,generatorName:"dayHeaderContent",customGenerator:t.dayHeaderContent,defaultGenerator:oo,classNameGenerator:t.dayHeaderClassNames,didMount:t.dayHeaderDidMount,willUnmount:t.dayHeaderWillUnmount},e=>b("div",{className:"fc-scrollgrid-sync-inner"},!a.isDisabled&&b(e,{elTag:"a",elAttrs:u,elClasses:["fc-col-header-cell-cushion",i.isSticky&&"fc-sticky"]})))}}const ao=nn({weekday:"long"});class lo extends Ln{render(){let{props:e}=this,{dateEnv:t,theme:n,viewApi:r,options:i}=this.context,o=Tt(new Date(2592e5),e.dow),s={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},a=t.format(o,e.dayHeaderFormat),l=Object.assign(Object.assign(Object.assign(Object.assign({date:o},s),{view:r}),e.extraRenderProps),{text:a});return b(qn,{elTag:"th",elClasses:[io,...Di(s,n),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:l,generatorName:"dayHeaderContent",customGenerator:i.dayHeaderContent,defaultGenerator:oo,classNameGenerator:i.dayHeaderClassNames,didMount:i.dayHeaderDidMount,willUnmount:i.dayHeaderWillUnmount},n=>b("div",{className:"fc-scrollgrid-sync-inner"},b(n,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":t.format(o,ao)}})))}}class co extends Ln{constructor(){super(...arguments),this.createDayHeaderFormatter=Bt(uo)}render(){let{context:e}=this,{dates:t,dateProfile:n,datesRepDistinctDays:r,renderIntro:i}=this.props,o=this.createDayHeaderFormatter(e.options.dayHeaderFormat,r,t.length);return b(Ci,{unit:"day"},(e,s)=>b("tr",{role:"row"},i&&i("day"),t.map(e=>r?b(so,{key:e.toISOString(),date:e,dateProfile:n,todayRange:s,colCnt:t.length,dayHeaderFormat:o}):b(lo,{key:e.getUTCDay(),dow:e.getUTCDay(),dayHeaderFormat:o}))))}}function uo(e,t,n){return e||ro(t,n)}class ho{constructor(e,t){let n=e.start,{end:r}=e,i=[],o=[],s=-1;for(;n<r;)t.isHiddenDay(n)?i.push(s+.5):(s+=1,i.push(s),o.push(n)),n=Tt(n,1);this.dates=o,this.indices=i,this.cnt=o.length}sliceRange(e){let t=this.getDateDayIndex(e.start),n=this.getDateDayIndex(Tt(e.end,-1)),r=Math.max(0,t),i=Math.min(this.cnt-1,n);return r=Math.ceil(r),i=Math.floor(i),r<=i?{firstIndex:r,lastIndex:i,isStart:t===r,isEnd:n===i}:null}getDateDayIndex(e){let{indices:t}=this,n=Math.floor(It(this.dates[0],e));return n<0?t[0]-1:n>=t.length?t[t.length-1]+1:t[n]}}class fo{constructor(e,t){let n,r,i,{dates:o}=e;if(t){for(r=o[0].getUTCDay(),n=1;n<o.length&&o[n].getUTCDay()!==r;n+=1);i=Math.ceil(o.length/n)}else i=1,n=o.length;this.rowCnt=i,this.colCnt=n,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let t=0;t<this.rowCnt;t+=1){let n=[];for(let e=0;e<this.colCnt;e+=1)n.push(this.buildCell(t,e));e.push(n)}return e}buildCell(e,t){let n=this.daySeries.dates[e*this.colCnt+t];return{key:n.toISOString(),date:n}}buildHeaderDates(){let e=[];for(let t=0;t<this.colCnt;t+=1)e.push(this.cells[0][t].date);return e}sliceRange(e){let{colCnt:t}=this,n=this.daySeries.sliceRange(e),r=[];if(n){let{firstIndex:e,lastIndex:i}=n,o=e;for(;o<=i;){let s=Math.floor(o/t),a=Math.min((s+1)*t,i+1);r.push({row:s,firstCol:o%t,lastCol:(a-1)%t,isStart:n.isStart&&o===e,isEnd:n.isEnd&&a-1===i}),o=a}}return r}}class po{constructor(){this.sliceBusinessHours=Bt(this._sliceBusinessHours),this.sliceDateSelection=Bt(this._sliceDateSpan),this.sliceEventStore=Bt(this._sliceEventStore),this.sliceEventDrag=Bt(this._sliceInteraction),this.sliceEventResize=Bt(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,t,n,r){let{eventUiBases:i}=e;for(var o=arguments.length,s=new Array(o>4?o-4:0),a=4;a<o;a++)s[a-4]=arguments[a];let l=this.sliceEventStore(e.eventStore,i,t,n,...s);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,t,n,i,r,...s),businessHourSegs:this.sliceBusinessHours(e.businessHours,t,n,r,...s),fgEventSegs:l.fg,bgEventSegs:l.bg,eventDrag:this.sliceEventDrag(e.eventDrag,i,t,n,...s),eventResize:this.sliceEventResize(e.eventResize,i,t,n,...s),eventSelection:e.eventSelection}}sliceNowDate(e,t,n,r){for(var i=arguments.length,o=new Array(i>4?i-4:0),s=4;s<i;s++)o[s-4]=arguments[s];return this._sliceDateSpan({range:{start:e,end:_t(e,1)},allDay:!1},t,n,{},r,...o)}_sliceBusinessHours(e,t,n,r){if(!e)return[];for(var i=arguments.length,o=new Array(i>4?i-4:0),s=4;s<i;s++)o[s-4]=arguments[s];return this._sliceEventStore(or(e,go(t,Boolean(n)),r),{},t,n,...o).bg}_sliceEventStore(e,t,n,r){if(e){let a=Gr(e,t,go(n,Boolean(r)),r);for(var i=arguments.length,o=new Array(i>4?i-4:0),s=4;s<i;s++)o[s-4]=arguments[s];return{bg:this.sliceEventRanges(a.bg,o),fg:this.sliceEventRanges(a.fg,o)}}return{bg:[],fg:[]}}_sliceInteraction(e,t,n,r){if(!e)return null;let i=Gr(e.mutatedEvents,t,go(n,Boolean(r)),r);for(var o=arguments.length,s=new Array(o>4?o-4:0),a=4;a<o;a++)s[a-4]=arguments[a];return{segs:this.sliceEventRanges(i.fg,s),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,t,n,r,i){if(!e)return[];let o=go(t,Boolean(n)),s=Qn(e.range,o);if(s){let t=function(e,t,n){let r=dr({editable:!1},n),i=fr(r.refined,r.extra,"",e.allDay,!0,n);return{def:i,ui:Jr(i,t),instance:ir(i.defId,e.range),range:e.range,isStart:!0,isEnd:!0}}(e=Object.assign(Object.assign({},e),{range:s}),r,i);for(var a=arguments.length,l=new Array(a>5?a-5:0),c=5;c<a;c++)l[c-5]=arguments[c];let n=this.sliceRange(e.range,...l);for(let e of n)e.eventRange=t;return n}return[]}sliceEventRanges(e,t){let n=[];for(let r of e)n.push(...this.sliceEventRange(r,t));return n}sliceEventRange(e,t){let n=e.range;this.forceDayIfListItem&&"list-item"===e.ui.display&&(n={start:n.start,end:Tt(n.start,1)});let r=this.sliceRange(n,...t);for(let i of r)i.eventRange=e,i.isStart=e.isStart&&i.isStart,i.isEnd=e.isEnd&&i.isEnd;return r}}function go(e,t){let n=e.activeRange;return t?n:{start:_t(n.start,e.slotMinTime.milliseconds),end:_t(n.end,e.slotMaxTime.milliseconds-864e5)}}function mo(e,t,n){let{instances:r}=e.mutatedEvents;for(let i in r)if(!Xn(t.validRange,r[i].range))return!1;return vo({eventDrag:e},n)}function vo(e,t){let n=t.getCurrentData(),r=Object.assign({businessHours:n.businessHours,dateSelection:"",eventStore:n.eventStore,eventUiBases:n.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},e);return(t.pluginHooks.isPropsValid||yo)(r,t)}function yo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;return!(e.eventDrag&&!function(e,t,n,r){let i=t.getCurrentData(),o=e.eventDrag,s=o.mutatedEvents,a=s.defs,l=s.instances,c=Yr(a,o.isEvent?e.eventUiBases:{"":i.selectionConfig});r&&(c=yn(c,r));let u=(p=e.eventStore,g=o.affectedEvents.instances,{defs:p.defs,instances:vn(p.instances,e=>!g[e.instanceId])}),d=u.defs,h=u.instances,f=Yr(d,e.eventUiBases);var p,g;for(let m in l){let r=l[m],s=r.range,p=c[r.defId],g=a[r.defId];if(!wo(p.constraints,s,u,e.businessHours,t))return!1;let{eventOverlap:v}=t.options,y="function"===typeof v?v:null;for(let e in h){let n=h[e];if(Jn(s,n.range)){if(!1===f[n.defId].overlap&&o.isEvent)return!1;if(!1===p.overlap)return!1;if(y&&!y(new Vr(t,d[n.defId],n),new Vr(t,g,r)))return!1}}let w=i.eventStore;for(let e of p.allows){let i,o=Object.assign(Object.assign({},n),{range:r.range,allDay:g.allDay}),s=w.defs[g.defId],a=w.instances[m];if(i=s?new Vr(t,s,a):new Vr(t,g),!e(Fr(o,t),i))return!1}}return!0}(e,t,n,r))&&!(e.dateSelection&&!function(e,t,n,r){let i=e.eventStore,o=i.defs,s=i.instances,a=e.dateSelection,l=a.range,{selectionConfig:c}=t.getCurrentData();r&&(c=r(c));if(!wo(c.constraints,l,i,e.businessHours,t))return!1;let{selectOverlap:u}=t.options,d="function"===typeof u?u:null;for(let h in s){let e=s[h];if(Jn(l,e.range)){if(!1===c.overlap)return!1;if(d&&!d(new Vr(t,o[e.defId],e),null))return!1}}for(let h of c.allows){if(!h(Fr(Object.assign(Object.assign({},n),a),t),null))return!1}return!0}(e,t,n,r))}function wo(e,t,n,r,i){for(let o of e)if(!So(bo(o,t,n,r,i),t))return!1;return!0}function bo(e,t,n,r,i){return"businessHours"===e?Co(or(r,t,i)):"string"===typeof e?Co(wr(n,t=>t.groupId===e)):"object"===typeof e&&e?Co(or(e,t,i)):[]}function Co(e){let{instances:t}=e,n=[];for(let r in t)n.push(t[r].range);return n}function So(e,t){for(let n of e)if(Xn(n,t))return!0;return!1}const Eo=/^(visible|hidden)$/;class To extends Ln{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,Un(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:t,liquidIsAbsolute:n}=e,r=t&&n,i=["fc-scroller"];return t&&(n?i.push("fc-scroller-liquid-absolute"):i.push("fc-scroller-liquid")),b("div",{ref:this.handleEl,className:i.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:r&&-(e.overcomeLeft||0)||"",right:r&&-(e.overcomeRight||0)||"",bottom:r&&-(e.overcomeBottom||0)||"",marginLeft:!r&&-(e.overcomeLeft||0)||"",marginRight:!r&&-(e.overcomeRight||0)||"",marginBottom:!r&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(Eo.test(this.props.overflowX))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:n}=e;for(let r=0;r<n.length;r+=1){if(n[r].getBoundingClientRect().width>t)return!0}return!1}needsYScrolling(){if(Eo.test(this.props.overflowY))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:n}=e;for(let r=0;r<n.length;r+=1){if(n[r].getBoundingClientRect().height>t)return!0}return!1}getXScrollbarWidth(){return Eo.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return Eo.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}}class _o{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(e,t)=>{let{depths:n,currentMap:r}=this,i=!1,o=!1;null!==e?(i=t in r,r[t]=e,n[t]=(n[t]||0)+1,o=!0):(n[t]-=1,n[t]||(delete r[t],delete this.callbackMap[t],i=!0)),this.masterCallback&&(i&&this.masterCallback(null,String(t)),o&&this.masterCallback(e,String(t)))}}createRef(e){let t=this.callbackMap[e];return t||(t=this.callbackMap[e]=t=>{this.handleValue(t,String(e))}),t}collect(e,t,n){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=[];null==n&&(n=Object.keys(e).length);for(let o=t;o<n;o+=r){let t=e[o];void 0!==t&&i.push(t)}return i}(this.currentMap,e,t,n)}getAll(){return bn(this.currentMap)}}function Io(e){let t=function(e,t){let n=e instanceof HTMLElement?[e]:e,r=[];for(let i=0;i<n.length;i+=1){let e=n[i].querySelectorAll(t);for(let t=0;t<e.length;t+=1)r.push(e[t])}return r}(e,".fc-scrollgrid-shrink"),n=0;for(let r of t)n=Math.max(n,ht(r));return Math.ceil(n)}function Ao(e,t){return e.liquid&&t.liquid}function ko(e,t){return St(e,t,Cn)}function Ro(e,t){let n=[];for(let r of e){let e=r.span||1;for(let i=0;i<e;i+=1)n.push(b("col",{style:{width:"shrink"===r.width?Do(t):r.width||"",minWidth:r.minWidth||""}}))}return b("colgroup",{},...n)}function Do(e){return null==e?4:e}function Po(e,t){let n=["fc-scrollgrid-section",`fc-scrollgrid-section-${e.type}`,e.className];return t&&e.liquid&&null==e.maxHeight&&n.push("fc-scrollgrid-section-liquid"),e.isSticky&&n.push("fc-scrollgrid-section-sticky"),n}function xo(e){return b("div",{className:"fc-scrollgrid-sticky-shim",style:{width:e.clientWidth,minWidth:e.tableMinWidth}})}function Oo(e){let{stickyHeaderDates:t}=e;return null!=t&&"auto"!==t||(t="auto"===e.height||"auto"===e.viewHeight),t}function No(e){let{stickyFooterScrollbar:t}=e;return null!=t&&"auto"!==t||(t="auto"===e.height||"auto"===e.viewHeight),t}class Mo extends Ln{constructor(){super(...arguments),this.processCols=Bt(e=>e,ko),this.renderMicroColGroup=Bt(Ro),this.scrollerRefs=new _o,this.scrollerElRefs=new _o(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:t,context:n}=this,r=e.sections||[],i=this.processCols(e.cols),o=this.renderMicroColGroup(i,t.shrinkWidth),s=function(e,t){let n=["fc-scrollgrid",t.theme.getClass("table")];return e&&n.push("fc-scrollgrid-liquid"),n}(e.liquid,n);e.collapsibleWidth&&s.push("fc-scrollgrid-collapsible");let a,l=r.length,c=0,u=[],d=[],h=[];for(;c<l&&"header"===(a=r[c]).type;)u.push(this.renderSection(a,o,!0)),c+=1;for(;c<l&&"body"===(a=r[c]).type;)d.push(this.renderSection(a,o,!1)),c+=1;for(;c<l&&"footer"===(a=r[c]).type;)h.push(this.renderSection(a,o,!0)),c+=1;let f=!mi();const p={role:"rowgroup"};return b("table",{role:"grid",className:s.join(" "),style:{height:e.height}},Boolean(!f&&u.length)&&b("thead",p,...u),Boolean(!f&&d.length)&&b("tbody",p,...d),Boolean(!f&&h.length)&&b("tfoot",p,...h),f&&b("tbody",p,...u,...d,...h))}renderSection(e,t,n){return"outerContent"in e?b(S,{key:e.key},e.outerContent):b("tr",{key:e.key,role:"presentation",className:Po(e,this.props.liquid).join(" ")},this.renderChunkTd(e,t,e.chunk,n))}renderChunkTd(e,t,n,r){if("outerContent"in n)return n.outerContent;let{props:i}=this,{forceYScrollbars:o,scrollerClientWidths:s,scrollerClientHeights:a}=this.state,l=function(e,t){return null!=t.maxHeight||Ao(e,t)}(i,e),c=Ao(i,e),u=i.liquid?o?"scroll":l?"auto":"hidden":"visible",d=e.key,h=function(e,t,n,r){let{expandRows:i}=n;return"function"===typeof t.content?t.content(n):b("table",{role:"presentation",className:[t.tableClassName,e.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:n.tableMinWidth,width:n.clientWidth,height:i?n.clientHeight:""}},n.tableColGroupNode,b(r?"thead":"tbody",{role:"presentation"},"function"===typeof t.rowContent?t.rowContent(n):t.rowContent))}(e,n,{tableColGroupNode:t,tableMinWidth:"",clientWidth:i.collapsibleWidth||void 0===s[d]?null:s[d],clientHeight:void 0!==a[d]?a[d]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},r);return b(r?"th":"td",{ref:n.elRef,role:"presentation"},b("div",{className:"fc-scroller-harness"+(c?" fc-scroller-harness-liquid":"")},b(To,{ref:this.scrollerRefs.createRef(d),elRef:this.scrollerElRefs.createRef(d),overflowY:u,overflowX:i.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:c,liquidIsAbsolute:!0},h)))}_handleScrollerEl(e,t){let n=function(e,t){for(let n of e)if(n.key===t)return n;return null}(this.props.sections,t);n&&Un(n.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return function(e){for(let t of e)if("shrink"===t.width)return!0;return!1}(this.props.cols)?Io(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=Ui(),{scrollerRefs:t,scrollerElRefs:n}=this,r=!1,i={},o={};for(let s in t.currentMap){let e=t.currentMap[s];if(e&&e.needsYScrolling()){r=!0;break}}for(let s of this.props.sections){let t=s.key,a=n.currentMap[t];if(a){let n=a.parentNode;i[t]=Math.floor(n.getBoundingClientRect().width-(r?e.y:0)),o[t]=Math.floor(n.getBoundingClientRect().height)}}return{forceYScrollbars:r,scrollerClientWidths:i,scrollerClientHeights:o}}}Mo.addStateEquality({scrollerClientWidths:Cn,scrollerClientHeights:Cn});class Lo extends Ln{constructor(){super(...arguments),this.buildPublicEvent=Bt((e,t,n)=>new Vr(e,t,n)),this.handleEl=e=>{this.el=e,Un(this.props.elRef,e),e&&Kr(e,this.props.seg)}}render(){const{props:e,context:t}=this,{options:n}=t,{seg:r}=e,{eventRange:i}=r,{ui:o}=i,s={event:this.buildPublicEvent(t,i.def,i.instance),view:t.viewApi,timeText:e.timeText,textColor:o.textColor,backgroundColor:o.backgroundColor,borderColor:o.borderColor,isDraggable:!e.disableDragging&&ei(r,t),isStartResizable:!e.disableResizing&&ti(r,t),isEndResizable:!e.disableResizing&&ni(r),isMirror:Boolean(e.isDragging||e.isResizing||e.isDateSelecting),isStart:Boolean(r.isStart),isEnd:Boolean(r.isEnd),isPast:Boolean(e.isPast),isFuture:Boolean(e.isFuture),isToday:Boolean(e.isToday),isSelected:Boolean(e.isSelected),isDragging:Boolean(e.isDragging),isResizing:Boolean(e.isResizing)};return b(qn,{elRef:this.handleEl,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:[...oi(s),...r.eventRange.ui.classNames,...e.elClasses||[]],elStyle:e.elStyle,renderProps:s,generatorName:"eventContent",customGenerator:n.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:n.eventClassNames,didMount:n.eventDidMount,willUnmount:n.eventWillUnmount},e.children)}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&Kr(this.el,this.props.seg)}}class Uo extends Ln{render(){let{props:e,context:t}=this,{options:n}=t,{seg:r}=e,{ui:i}=r.eventRange,o=ri(r,n.eventTimeFormat||e.defaultTimeFormat,t,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return b(Lo,Object.assign({},e,{elTag:"a",elStyle:{borderColor:i.borderColor,backgroundColor:i.backgroundColor},elAttrs:ai(r,t),defaultGenerator:Fo,timeText:o}),(e,t)=>b(S,null,b(e,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:t.textColor}}),Boolean(t.isStartResizable)&&b("div",{className:"fc-event-resizer fc-event-resizer-start"}),Boolean(t.isEndResizable)&&b("div",{className:"fc-event-resizer fc-event-resizer-end"})))}}function Fo(e){return b("div",{className:"fc-event-main-frame"},e.timeText&&b("div",{className:"fc-event-time"},e.timeText),b("div",{className:"fc-event-title-container"},b("div",{className:"fc-event-title fc-sticky"},e.event.title||b(S,null,"\xa0"))))}Uo.addPropsEquality({seg:Cn});const Ho=e=>b(On.Consumer,null,t=>{let{options:n}=t,r={isAxis:e.isAxis,date:t.dateEnv.toDate(e.date),view:t.viewApi};return b(qn,{elRef:e.elRef,elTag:e.elTag||"div",elAttrs:e.elAttrs,elClasses:e.elClasses,elStyle:e.elStyle,renderProps:r,generatorName:"nowIndicatorContent",customGenerator:n.nowIndicatorContent,classNameGenerator:n.nowIndicatorClassNames,didMount:n.nowIndicatorDidMount,willUnmount:n.nowIndicatorWillUnmount},e.children)}),jo=nn({day:"numeric"});class Bo extends Ln{constructor(){super(...arguments),this.refineRenderProps=zt(qo)}render(){let{props:e,context:t}=this,{options:n}=t,r=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:t.viewApi,dateEnv:t.dateEnv,monthStartFormat:n.monthStartFormat});return b(qn,{elRef:e.elRef,elTag:e.elTag,elAttrs:Object.assign(Object.assign({},e.elAttrs),r.isDisabled?{}:{"data-date":Ft(e.date)}),elClasses:[...Di(r,t.theme),...e.elClasses||[]],elStyle:e.elStyle,renderProps:r,generatorName:"dayCellContent",customGenerator:n.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:r.isDisabled?void 0:n.dayCellClassNames,didMount:n.dayCellDidMount,willUnmount:n.dayCellWillUnmount},e.children)}}function zo(e){return Boolean(e.dayCellContent||Hn("dayCellContent",e))}function qo(e){let{date:t,dateEnv:n,dateProfile:r,isMonthStart:i}=e,o=Ri(t,e.todayRange,null,r),s=e.showDayNumber?n.format(t,i?e.monthStartFormat:jo):"";return Object.assign(Object.assign(Object.assign({date:n.toDate(t),view:e.viewApi},o),{isMonthStart:i,dayNumberText:s}),e.extraRenderProps)}class Vo extends Ln{render(){let{props:e}=this,{seg:t}=e;return b(Lo,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:t.eventRange.ui.backgroundColor},defaultGenerator:Wo,seg:t,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}}function Wo(e){let{title:t}=e.event;return t&&b("div",{className:"fc-event-title"},e.event.title)}function $o(e){return b("div",{className:`fc-${e}`})}const Go=e=>b(On.Consumer,null,t=>{let{dateEnv:n,options:r}=t,{date:i}=e,o=r.weekNumberFormat||e.defaultFormat,s={num:n.computeWeekNumber(i),text:n.format(i,o),date:i};return b(qn,{elRef:e.elRef,elTag:e.elTag,elAttrs:e.elAttrs,elClasses:e.elClasses,elStyle:e.elStyle,renderProps:s,generatorName:"weekNumberContent",customGenerator:r.weekNumberContent,defaultGenerator:Ko,classNameGenerator:r.weekNumberClassNames,didMount:r.weekNumberDidMount,willUnmount:r.weekNumberWillUnmount},e.children)});function Ko(e){return e.text}class Qo extends Ln{constructor(){super(...arguments),this.state={titleId:Ke()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&Un(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{const t=$e(e);this.rootEl.contains(t)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{"Escape"===e.key&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:t}=this.context,{props:n,state:r}=this,i=["fc-popover",e.getClass("popover")].concat(n.extraClassNames||[]);return Ce(b("div",Object.assign({},n.extraAttrs,{id:n.id,className:i.join(" "),"aria-labelledby":r.titleId,ref:this.handleRootEl}),b("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},b("span",{className:"fc-popover-title",id:r.titleId},n.title),b("span",{className:"fc-popover-close "+e.getIconClass("close"),title:t.closeHint,onClick:this.handleCloseClick})),b("div",{className:"fc-popover-body "+e.getClass("popoverContent")},n.children)),n.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:t,alignGridTop:n}=this.props,{rootEl:r}=this,i=function(e){let t=Bi(e),n=e.getBoundingClientRect();for(let r of t){let e=_i(n,r.getBoundingClientRect());if(!e)return null;n=e}return n}(t);if(i){let o=r.getBoundingClientRect(),s=n?Be(t,".fc-scrollgrid").getBoundingClientRect().top:i.top,a=e?i.right-o.width:i.left;s=Math.max(s,10),a=Math.min(a,document.documentElement.clientWidth-10-o.width),a=Math.max(a,10);let l=r.offsetParent.getBoundingClientRect();Ve(r,{top:s-l.top,left:a-l.left})}}}class Yo extends Gi{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:t}=this.context,{props:n}=this,{startDate:r,todayRange:i,dateProfile:o}=n,s=t.format(r,e.dayPopoverFormat);return b(Bo,{elRef:this.handleRootEl,date:r,dateProfile:o,todayRange:i},(t,r,i)=>b(Qo,{elRef:i.ref,id:n.id,title:s,extraClassNames:["fc-more-popover"].concat(i.className||[]),extraAttrs:i,parentEl:n.parentEl,alignmentEl:n.alignmentEl,alignGridTop:n.alignGridTop,onClose:n.onClose},zo(e)&&b(t,{elTag:"div",elClasses:["fc-more-popover-misc"]}),n.children))}queryHit(e,t,n,r){let{rootEl:i,props:o}=this;return e>=0&&e<n&&t>=0&&t<r?{dateProfile:o.dateProfile,dateSpan:Object.assign({allDay:!o.forceTimed,range:{start:o.startDate,end:o.endDate}},o.extraDateSpan),dayEl:i,rect:{left:0,top:0,right:n,bottom:r},layer:1}:null}}class Jo extends Ln{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:Ke()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&Un(this.props.elRef,e)},this.handleClick=e=>{let{props:t,context:n}=this,{moreLinkClick:r}=n.options,i=Zo(t).start;function o(e){let{def:t,instance:r,range:i}=e.eventRange;return{event:new Vr(n,t,r),start:n.dateEnv.toDate(i.start),end:n.dateEnv.toDate(i.end),isStart:e.isStart,isEnd:e.isEnd}}"function"===typeof r&&(r=r({date:i,allDay:Boolean(t.allDayDate),allSegs:t.allSegs.map(o),hiddenSegs:t.hiddenSegs.map(o),jsEvent:e,view:n.viewApi})),r&&"popover"!==r?"string"===typeof r&&n.calendarApi.zoomTo(i,r):this.setState({isPopoverOpen:!0})},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:t}=this;return b(On.Consumer,null,n=>{let{viewApi:r,options:i,calendarApi:o}=n,{moreLinkText:s}=i,{moreCnt:a}=e,l=Zo(e),c="function"===typeof s?s.call(o,a):`+${a} ${s}`,u=ct(i.moreLinkHint,[a],c),d={num:a,shortText:`+${a}`,text:c,view:r};return b(S,null,Boolean(e.moreCnt)&&b(qn,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),Xe(this.handleClick)),{title:u,"aria-expanded":t.isPopoverOpen,"aria-controls":t.isPopoverOpen?t.popoverId:""}),renderProps:d,generatorName:"moreLinkContent",customGenerator:i.moreLinkContent,defaultGenerator:e.defaultGenerator||Xo,classNameGenerator:i.moreLinkClassNames,didMount:i.moreLinkDidMount,willUnmount:i.moreLinkWillUnmount},e.children),t.isPopoverOpen&&b(Yo,{id:t.popoverId,startDate:l.start,endDate:l.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=Be(this.linkEl,".fc-view-harness"))}}function Xo(e){return e.text}function Zo(e){if(e.allDayDate)return{start:e.allDayDate,end:Tt(e.allDayDate,1)};let{hiddenSegs:t}=e;return{start:es(t),end:(n=t,n.reduce(ns).eventRange.range.end)};var n}function es(e){return e.reduce(ts).eventRange.range.start}function ts(e,t){return e.eventRange.range.start<t.eventRange.range.start?e:t}function ns(e,t){return e.eventRange.range.end>t.eventRange.range.end?e:t}class rs{constructor(){this.handlers=[]}set(e){this.currentValue=e;for(let t of this.handlers)t(e)}subscribe(e){this.handlers.push(e),void 0!==this.currentValue&&e(this.currentValue)}}class is extends rs{constructor(){super(...arguments),this.map=new Map}handle(e){const{map:t}=this;let n=!1;e.isActive?(t.set(e.id,e),n=!0):t.has(e.id)&&(t.delete(e.id),n=!0),n&&this.set(t)}}const os=[],ss={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},as=Object.assign(Object.assign({},ss),{buttonHints:{prev:"Previous $0",next:"Next $0",today:(e,t)=>"day"===t?"Today":`This ${e}`},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint:e=>`Show ${e} more event${1===e?"":"s"}`});function ls(e){let t=e.length>0?e[0].code:"en",n=os.concat(e),r={en:as};for(let i of n)r[i.code]=i;return{map:r,defaultCode:t}}function cs(e,t){return"object"!==typeof e||Array.isArray(e)?function(e,t){let n=[].concat(e||[]),r=function(e,t){for(let n=0;n<e.length;n+=1){let r=e[n].toLocaleLowerCase().split("-");for(let e=r.length;e>0;e-=1){let n=r.slice(0,e).join("-");if(t[n])return t[n]}}return null}(n,t)||as;return us(e,n,r)}(e,t):us(e.code,[e.code],e)}function us(e,t,n){let r=mn([ss,n],["buttonText"]);delete r.code;let{week:i}=r;return delete r.week,{codeArg:e,codes:t,week:i,simpleNumberFormat:new Intl.NumberFormat(e),options:r}}function ds(e){return{id:tt(),name:e.name,premiumReleaseDate:e.premiumReleaseDate?new Date(e.premiumReleaseDate):void 0,deps:e.deps||[],reducers:e.reducers||[],isLoadingFuncs:e.isLoadingFuncs||[],contextInit:[].concat(e.contextInit||[]),eventRefiners:e.eventRefiners||{},eventDefMemberAdders:e.eventDefMemberAdders||[],eventSourceRefiners:e.eventSourceRefiners||{},isDraggableTransformers:e.isDraggableTransformers||[],eventDragMutationMassagers:e.eventDragMutationMassagers||[],eventDefMutationAppliers:e.eventDefMutationAppliers||[],dateSelectionTransformers:e.dateSelectionTransformers||[],datePointTransforms:e.datePointTransforms||[],dateSpanTransforms:e.dateSpanTransforms||[],views:e.views||{},viewPropsTransformers:e.viewPropsTransformers||[],isPropsValid:e.isPropsValid||null,externalDefTransforms:e.externalDefTransforms||[],viewContainerAppends:e.viewContainerAppends||[],eventDropTransformers:e.eventDropTransformers||[],componentInteractions:e.componentInteractions||[],calendarInteractions:e.calendarInteractions||[],themeClasses:e.themeClasses||{},eventSourceDefs:e.eventSourceDefs||[],cmdFormatter:e.cmdFormatter,recurringTypes:e.recurringTypes||[],namedTimeZonedImpl:e.namedTimeZonedImpl,initialView:e.initialView||"",elementDraggingImpl:e.elementDraggingImpl,optionChangeHandlers:e.optionChangeHandlers||{},scrollGridImpl:e.scrollGridImpl||null,listenerRefiners:e.listenerRefiners||{},optionRefiners:e.optionRefiners||{},propSetHandlers:e.propSetHandlers||{}}}function hs(){let e,t=[],n=[];return(r,i)=>(e&&St(r,t)&&St(i,n)||(e=function(e,t){let n={},r={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function i(e){for(let t of e){const e=t.name,o=n[e];void 0===o?(n[e]=t.id,i(t.deps),r=fs(r,t)):o!==t.id&&console.warn(`Duplicate plugin '${e}'`)}}return e&&i(e),i(t),r}(r,i)),t=r,n=i,e)}function fs(e,t){return{premiumReleaseDate:ps(e.premiumReleaseDate,t.premiumReleaseDate),reducers:e.reducers.concat(t.reducers),isLoadingFuncs:e.isLoadingFuncs.concat(t.isLoadingFuncs),contextInit:e.contextInit.concat(t.contextInit),eventRefiners:Object.assign(Object.assign({},e.eventRefiners),t.eventRefiners),eventDefMemberAdders:e.eventDefMemberAdders.concat(t.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},e.eventSourceRefiners),t.eventSourceRefiners),isDraggableTransformers:e.isDraggableTransformers.concat(t.isDraggableTransformers),eventDragMutationMassagers:e.eventDragMutationMassagers.concat(t.eventDragMutationMassagers),eventDefMutationAppliers:e.eventDefMutationAppliers.concat(t.eventDefMutationAppliers),dateSelectionTransformers:e.dateSelectionTransformers.concat(t.dateSelectionTransformers),datePointTransforms:e.datePointTransforms.concat(t.datePointTransforms),dateSpanTransforms:e.dateSpanTransforms.concat(t.dateSpanTransforms),views:Object.assign(Object.assign({},e.views),t.views),viewPropsTransformers:e.viewPropsTransformers.concat(t.viewPropsTransformers),isPropsValid:t.isPropsValid||e.isPropsValid,externalDefTransforms:e.externalDefTransforms.concat(t.externalDefTransforms),viewContainerAppends:e.viewContainerAppends.concat(t.viewContainerAppends),eventDropTransformers:e.eventDropTransformers.concat(t.eventDropTransformers),calendarInteractions:e.calendarInteractions.concat(t.calendarInteractions),componentInteractions:e.componentInteractions.concat(t.componentInteractions),themeClasses:Object.assign(Object.assign({},e.themeClasses),t.themeClasses),eventSourceDefs:e.eventSourceDefs.concat(t.eventSourceDefs),cmdFormatter:t.cmdFormatter||e.cmdFormatter,recurringTypes:e.recurringTypes.concat(t.recurringTypes),namedTimeZonedImpl:t.namedTimeZonedImpl||e.namedTimeZonedImpl,initialView:e.initialView||t.initialView,elementDraggingImpl:e.elementDraggingImpl||t.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},e.optionChangeHandlers),t.optionChangeHandlers),scrollGridImpl:t.scrollGridImpl||e.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},e.listenerRefiners),t.listenerRefiners),optionRefiners:Object.assign(Object.assign({},e.optionRefiners),t.optionRefiners),propSetHandlers:Object.assign(Object.assign({},e.propSetHandlers),t.propSetHandlers)}}function ps(e,t){return void 0===e?t:void 0===t?e:new Date(Math.max(e.valueOf(),t.valueOf()))}class gs extends kn{}function ms(e,t,n,r){if(t[e])return t[e];let i=function(e,t,n,r){let i=n[e],o=r[e],s=e=>i&&null!==i[e]?i[e]:o&&null!==o[e]?o[e]:null,a=s("component"),l=s("superType"),c=null;if(l){if(l===e)throw new Error("Can't have a custom view type that references itself");c=ms(l,t,n,r)}!a&&c&&(a=c.component);if(!a)return null;return{type:e,component:a,defaults:Object.assign(Object.assign({},c?c.defaults:{}),i?i.rawOptions:{}),overrides:Object.assign(Object.assign({},c?c.overrides:{}),o?o.rawOptions:{})}}(e,t,n,r);return i&&(t[e]=i),i}function vs(e){return yn(e,ys)}function ys(e){let t="function"===typeof e?{component:e}:e,{component:n}=t;return t.content?n=ws(t):!n||n.prototype instanceof Ln||(n=ws(Object.assign(Object.assign({},t),{content:n}))),{superType:t.type,component:n,rawOptions:t}}function ws(e){return t=>b(On.Consumer,null,n=>b(qn,{elTag:"div",elClasses:$n(n.viewSpec),renderProps:Object.assign(Object.assign({},t),{nextDayThreshold:n.options.nextDayThreshold}),generatorName:void 0,customGenerator:e.content,classNameGenerator:e.classNames,didMount:e.didMount,willUnmount:e.willUnmount}))}function bs(e,t,n,r){let i=vs(e),o=vs(t.views),s=function(e,t){let n,r={};for(n in e)ms(n,r,e,t);for(n in t)ms(n,r,e,t);return r}(i,o);return yn(s,e=>function(e,t,n,r,i){let o=e.overrides.duration||e.defaults.duration||r.duration||n.duration,s=null,a="",l="",c={};if(o&&(s=function(e){let t=JSON.stringify(e),n=Cs[t];void 0===n&&(n=gt(e),Cs[t]=n);return n}(o),s)){let e=Ct(s);a=e.unit,1===e.value&&(l=a,c=t[a]?t[a].rawOptions:{})}let u=t=>{let n=t.buttonText||{},r=e.defaults.buttonTextKey;return null!=r&&null!=n[r]?n[r]:null!=n[e.type]?n[e.type]:null!=n[l]?n[l]:null},d=t=>{let n=t.buttonHints||{},r=e.defaults.buttonTextKey;return null!=r&&null!=n[r]?n[r]:null!=n[e.type]?n[e.type]:null!=n[l]?n[l]:null};return{type:e.type,component:e.component,duration:s,durationUnit:a,singleUnit:l,optionDefaults:e.defaults,optionOverrides:Object.assign(Object.assign({},c),e.overrides),buttonTextOverride:u(r)||u(n)||e.overrides.buttonText,buttonTextDefault:u(i)||e.defaults.buttonText||u(on)||e.type,buttonTitleOverride:d(r)||d(n)||e.overrides.buttonHint,buttonTitleDefault:d(i)||e.defaults.buttonHint||d(on)}}(e,o,t,n,r))}gs.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"},gs.prototype.baseIconClass="fc-icon",gs.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"},gs.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"},gs.prototype.iconOverrideOption="buttonIcons",gs.prototype.iconOverrideCustomButtonOption="icon",gs.prototype.iconOverridePrefix="fc-icon-";let Cs={};function Ss(e,t,n){let r=t?t.activeRange:null;return _s({},function(e,t){let n=kr(t),r=[].concat(e.eventSources||[]),i=[];e.initialEvents&&r.unshift(e.initialEvents);e.events&&r.unshift(e.events);for(let o of r){let e=Ar(o,t,n);e&&i.push(e)}return i}(e,n),r,n)}function Es(e,t,n,r){let i=n?n.activeRange:null;switch(t.type){case"ADD_EVENT_SOURCES":return _s(e,t.sources,i,r);case"REMOVE_EVENT_SOURCE":return o=e,s=t.sourceId,vn(o,e=>e.sourceId!==s);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return n?Is(e,i,r):e;case"FETCH_EVENT_SOURCES":return As(e,t.sourceIds?wn(t.sourceIds):Rs(e,r),i,t.isRefetch||!1,r);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return function(e,t,n,r){let i=e[t];if(i&&n===i.latestFetchId)return Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},i),{isFetching:!1,fetchRange:r})});return e}(e,t.sourceId,t.fetchId,t.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return e}var o,s}function Ts(e){for(let t in e)if(e[t].isFetching)return!0;return!1}function _s(e,t,n,r){let i={};for(let o of t)i[o.sourceId]=o;return n&&(i=Is(i,n,r)),Object.assign(Object.assign({},e),i)}function Is(e,t,n){return As(e,vn(e,e=>function(e,t,n){if(!Ds(e,n))return!e.latestFetchId;return!n.options.lazyFetching||!e.fetchRange||e.isFetching||t.start<e.fetchRange.start||t.end>e.fetchRange.end}(e,t,n)),t,!1,n)}function As(e,t,n,r,i){let o={};for(let s in e){let a=e[s];t[s]?o[s]=ks(a,n,r,i):o[s]=a}return o}function ks(e,t,n,r){let{options:i,calendarApi:o}=r,s=r.pluginHooks.eventSourceDefs[e.sourceDefId],a=tt();return s.fetch({eventSource:e,range:t,isRefetch:n,context:r},n=>{let{rawEvents:s}=n;i.eventSourceSuccess&&(s=i.eventSourceSuccess.call(o,s,n.response)||s),e.success&&(s=e.success.call(o,s,n.response)||s),r.dispatch({type:"RECEIVE_EVENTS",sourceId:e.sourceId,fetchId:a,fetchRange:t,rawEvents:s})},n=>{let s=!1;i.eventSourceFailure&&(i.eventSourceFailure.call(o,n),s=!0),e.failure&&(e.failure(n),s=!0),s||console.warn(n.message,n),r.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:e.sourceId,fetchId:a,fetchRange:t,error:n})}),Object.assign(Object.assign({},e),{isFetching:!0,latestFetchId:a})}function Rs(e,t){return vn(e,e=>Ds(e,t))}function Ds(e,t){return!t.pluginHooks.eventSourceDefs[e.sourceDefId].ignoreRange}function Ps(e,t){switch(t.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return t.selection;default:return e}}function xs(e,t){switch(t.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return t.eventInstanceId;default:return e}}function Os(e,t){let n;switch(t.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return n=t.state,{affectedEvents:n.affectedEvents,mutatedEvents:n.mutatedEvents,isEvent:n.isEvent};default:return e}}function Ns(e,t){let n;switch(t.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return n=t.state,{affectedEvents:n.affectedEvents,mutatedEvents:n.mutatedEvents,isEvent:n.isEvent};default:return e}}function Ms(e,t,n,r,i){return{header:e.headerToolbar?Ls(e.headerToolbar,e,t,n,r,i):null,footer:e.footerToolbar?Ls(e.footerToolbar,e,t,n,r,i):null}}function Ls(e,t,n,r,i,o){let s={},a=[],l=!1;for(let c in e){let u=Us(e[c],t,n,r,i,o);s[c]=u.widgets,a.push(...u.viewsWithButtons),l=l||u.hasTitle}return{sectionWidgets:s,viewsWithButtons:a,hasTitle:l}}function Us(e,t,n,r,i,o){let s="rtl"===t.direction,a=t.customButtons||{},l=n.buttonText||{},c=t.buttonText||{},u=n.buttonHints||{},d=t.buttonHints||{},h=e?e.split(" "):[],f=[],p=!1;return{widgets:h.map(e=>e.split(",").map(e=>{if("title"===e)return p=!0,{buttonName:e};let n,h,g,m,v,y;if(n=a[e])g=e=>{n.click&&n.click.call(e.target,e,e.target)},(m=r.getCustomButtonIconClass(n))||(m=r.getIconClass(e,s))||(v=n.text),y=n.hint||n.text;else if(h=i[e]){f.push(e),g=()=>{o.changeView(e)},(v=h.buttonTextOverride)||(m=r.getIconClass(e,s))||(v=h.buttonTextDefault);let n=h.buttonTextOverride||h.buttonTextDefault;y=ct(h.buttonTitleOverride||h.buttonTitleDefault||t.viewHint,[n,e],n)}else if(o[e])if(g=()=>{o[e]()},(v=l[e])||(m=r.getIconClass(e,s))||(v=c[e]),"prevYear"===e||"nextYear"===e){let t="prevYear"===e?"prev":"next";y=ct(u[t]||d[t],[c.year||"year","year"],c[e])}else y=t=>ct(u[e]||d[e],[c[t]||t,t],c[e]);return{buttonName:e,buttonClick:g,buttonIcon:m,buttonText:v,buttonHint:y}})),viewsWithButtons:f,hasTitle:p}}class Fs{constructor(e,t,n){this.type=e,this.getCurrentData=t,this.dateEnv=n}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}}const Hs={daysOfWeek:pn,startTime:gt,endTime:gt,duration:gt,startRecur:pn,endRecur:pn};function js(e,t){let n=bn(t.getCurrentData().eventSources);if(1===n.length&&1===e.length&&Array.isArray(n[0]._raw)&&Array.isArray(e[0]))return void t.dispatch({type:"RESET_RAW_EVENTS",sourceId:n[0].sourceId,rawEvents:e[0]});let r=[];for(let i of e){let e=!1;for(let t=0;t<n.length;t+=1)if(n[t]._raw===i){n.splice(t,1),e=!0;break}e||r.push(i)}for(let i of n)t.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:i.sourceId});for(let i of r)t.calendarApi.addEventSource(i)}const Bs=[ds({name:"array-event-source",eventSourceDefs:[{ignoreRange:!0,parseMeta:e=>Array.isArray(e.events)?e.events:null,fetch(e,t){t({rawEvents:e.eventSource.meta})}}]}),ds({name:"func-event-source",eventSourceDefs:[{parseMeta:e=>"function"===typeof e.events?e.events:null,fetch(e,t,n){const{dateEnv:r}=e.context;hi(e.eventSource.meta.bind(null,ui(e.range,r)),e=>t({rawEvents:e}),n)}}]}),ds({name:"json-event-source",eventSourceRefiners:{method:String,extraParams:pn,startParam:String,endParam:String,timeZoneParam:String},eventSourceDefs:[{parseMeta:e=>!e.url||"json"!==e.format&&e.format?null:{url:e.url,format:"json",method:(e.method||"GET").toUpperCase(),extraParams:e.extraParams,startParam:e.startParam,endParam:e.endParam,timeZoneParam:e.timeZoneParam},fetch(e,t,n){const{meta:r}=e.eventSource,i=function(e,t,n){let r,i,o,s,{dateEnv:a,options:l}=n,c={};r=e.startParam,null==r&&(r=l.startParam);i=e.endParam,null==i&&(i=l.endParam);o=e.timeZoneParam,null==o&&(o=l.timeZoneParam);s="function"===typeof e.extraParams?e.extraParams():e.extraParams||{};Object.assign(c,s),c[r]=a.formatIso(t.start),c[i]=a.formatIso(t.end),"local"!==a.timeZone&&(c[o]=a.timeZone);return c}(r,e.range,e.context);pi(r.method,r.url,i).then(e=>{let[n,r]=e;t({rawEvents:n,response:r})},n)}}]}),ds({name:"simple-recurring-event",recurringTypes:[{parse(e,t){if(e.daysOfWeek||e.startTime||e.endTime||e.startRecur||e.endRecur){let i,o={daysOfWeek:e.daysOfWeek||null,startTime:e.startTime||null,endTime:e.endTime||null,startRecur:e.startRecur?t.createMarker(e.startRecur):null,endRecur:e.endRecur?t.createMarker(e.endRecur):null,dateEnv:t};return e.duration&&(i=e.duration),!i&&e.startTime&&e.endTime&&(n=e.endTime,r=e.startTime,i={years:n.years-r.years,months:n.months-r.months,days:n.days-r.days,milliseconds:n.milliseconds-r.milliseconds}),{allDayGuess:Boolean(!e.startTime&&!e.endTime),duration:i,typeData:o}}var n,r;return null},expand(e,t,n){let r=Qn(t,{start:e.startRecur,end:e.endRecur});return r?function(e,t,n,r,i){let o=e?wn(e):null,s=kt(i.start),a=i.end,l=[];for(;s<a;){let e;o&&!o[s.getUTCDay()]||(e=t?r.add(s,t):s,l.push(r.createMarker(n.toDate(e)))),s=Tt(s,1)}return l}(e.daysOfWeek,e.startTime,e.dateEnv,n,r):[]}}],eventRefiners:Hs}),ds({name:"change-handler",optionChangeHandlers:{events(e,t){js([e],t)},eventSources:js}}),ds({name:"misc",isLoadingFuncs:[e=>Ts(e.eventSources)],propSetHandlers:{dateProfile:function(e,t){t.emitter.trigger("datesSet",Object.assign(Object.assign({},ui(e.activeRange,t.dateEnv)),{view:t.viewApi}))},eventStore:function(e,t){let{emitter:n}=t;n.hasHandlers("eventsSet")&&n.trigger("eventsSet",$r(e,t))}}})];class zs{constructor(e,t){this.runTaskOption=e,this.drainedOption=t,this.queue=[],this.delayedRunner=new He(this.drain.bind(this))}request(e,t){this.queue.push(e),this.delayedRunner.request(t)}pause(e){this.delayedRunner.pause(e)}resume(e,t){this.delayedRunner.resume(e,t)}drain(){let{queue:e}=this;for(;e.length;){let t,n=[];for(;t=e.shift();)this.runTask(t),n.push(t);this.drained(n)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}}function qs(e,t,n){let r;return r=/^(year|month)$/.test(e.currentRangeUnit)?e.currentRange:e.activeRange,n.formatRange(r.start,r.end,nn(t.titleFormat||function(e){let{currentRangeUnit:t}=e;if("year"===t)return{year:"numeric"};if("month"===t)return{year:"numeric",month:"long"};let n=At(e.currentRange.start,e.currentRange.end);if(null!==n&&n>1)return{year:"numeric",month:"short",day:"numeric"};return{year:"numeric",month:"long",day:"numeric"}}(e)),{isEndExclusive:e.isRangeAllDay,defaultSeparator:t.titleRangeSeparator})}class Vs{constructor(){this.resetListeners=new Set}handleInput(e,t){const n=this.dateEnv;if(e!==n&&("function"===typeof t?this.nowFn=t:n||(this.nowAnchorDate=e.toDate(t?e.createMarker(t):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,n))for(const r of this.resetListeners.values())r()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}}class Ws{constructor(e){this.computeCurrentViewData=Bt(this._computeCurrentViewData),this.organizeRawLocales=Bt(ls),this.buildLocale=Bt(cs),this.buildPluginHooks=hs(),this.buildDateEnv=Bt($s),this.buildTheme=Bt(Gs),this.parseToolbars=Bt(Ms),this.buildViewSpecs=Bt(bs),this.buildDateProfileGenerator=zt(Ks),this.buildViewApi=Bt(Qs),this.buildViewUiProps=zt(Xs),this.buildEventUiBySource=Bt(Ys,Cn),this.buildEventUiBases=Bt(Js),this.parseContextBusinessHours=zt(ea),this.buildTitle=Bt(qs),this.nowManager=new Vs,this.emitter=new Nr,this.actionRunner=new zs(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=e=>{this.actionRunner.request(e)},this.props=e,this.actionRunner.pause(),this.nowManager=new Vs;let t={},n=this.computeOptionsData(e.optionOverrides,t,e.calendarApi),r=n.calendarOptions.initialView||n.pluginHooks.initialView,i=this.computeCurrentViewData(r,n,e.optionOverrides,t);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(i.options);let o={nowManager:this.nowManager,dateEnv:n.dateEnv,options:n.calendarOptions,pluginHooks:n.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},s=function(e,t,n){let r=e.initialDate;return null!=r?t.createMarker(r):n.getDateMarker()}(n.calendarOptions,n.dateEnv,this.nowManager),a=i.dateProfileGenerator.build(s);Zn(a.activeRange,s)||(s=a.currentRange.start);for(let d of n.pluginHooks.contextInit)d(o);let l=Ss(n.calendarOptions,a,o),c={dynamicOptionOverrides:t,currentViewType:r,currentDate:s,dateProfile:a,businessHours:this.parseContextBusinessHours(o),eventSources:l,eventUiBases:{},eventStore:{defs:{},instances:{}},renderableEventStore:{defs:{},instances:{}},dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(o).selectionConfig},u=Object.assign(Object.assign({},o),c);for(let d of n.pluginHooks.reducers)Object.assign(c,d(null,null,u));Zs(c,o)&&this.emitter.trigger("loading",!0),this.state=c,this.updateData(),this.actionRunner.resume()}resetOptions(e,t){let{props:n}=this;void 0===t?n.optionOverrides=e:(n.optionOverrides=Object.assign(Object.assign({},n.optionOverrides||{}),e),this.optionsForRefining.push(...t)),(void 0===t||t.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:t,state:n,emitter:r}=this,i=function(e,t){return"SET_OPTION"===t.type?Object.assign(Object.assign({},e),{[t.optionName]:t.rawOptionValue}):e}(n.dynamicOptionOverrides,e),o=this.computeOptionsData(t.optionOverrides,i,t.calendarApi),s=function(e,t){"CHANGE_VIEW_TYPE"===t.type&&(e=t.viewType);return e}(n.currentViewType,e),a=this.computeCurrentViewData(s,o,t.optionOverrides,i);t.calendarApi.currentDataManager=this,r.setThisContext(t.calendarApi),r.setOptions(a.options);let l={nowManager:this.nowManager,dateEnv:o.dateEnv,options:o.calendarOptions,pluginHooks:o.pluginHooks,calendarApi:t.calendarApi,dispatch:this.dispatch,emitter:r,getCurrentData:this.getCurrentData},{currentDate:c,dateProfile:u}=n;this.data&&this.data.dateProfileGenerator!==a.dateProfileGenerator&&(u=a.dateProfileGenerator.build(c)),c=function(e,t){return"CHANGE_DATE"===t.type?t.dateMarker:e}(c,e),u=function(e,t,n,r){let i;switch(t.type){case"CHANGE_VIEW_TYPE":return r.build(t.dateMarker||n);case"CHANGE_DATE":return r.build(t.dateMarker);case"PREV":if(i=r.buildPrev(e,n),i.isValid)return i;break;case"NEXT":if(i=r.buildNext(e,n),i.isValid)return i}return e}(u,e,c,a.dateProfileGenerator),"PREV"!==e.type&&"NEXT"!==e.type&&Zn(u.currentRange,c)||(c=u.currentRange.start);let d=Es(n.eventSources,e,u,l),h=Rr(n.eventStore,e,d,u,l),f=Ts(d)&&!a.options.progressiveEventRendering&&n.renderableEventStore||h,{eventUiSingleBase:p,selectionConfig:g}=this.buildViewUiProps(l),m=this.buildEventUiBySource(d),v={dynamicOptionOverrides:i,currentViewType:s,currentDate:c,dateProfile:u,eventSources:d,eventStore:h,renderableEventStore:f,selectionConfig:g,eventUiBases:this.buildEventUiBases(f.defs,p,m),businessHours:this.parseContextBusinessHours(l),dateSelection:Ps(n.dateSelection,e),eventSelection:xs(n.eventSelection,e),eventDrag:Os(n.eventDrag,e),eventResize:Ns(n.eventResize,e)},y=Object.assign(Object.assign({},l),v);for(let C of o.pluginHooks.reducers)Object.assign(v,C(n,e,y));let w=Zs(n,l),b=Zs(v,l);!w&&b?r.trigger("loading",!0):w&&!b&&r.trigger("loading",!1),this.state=v,t.onAction&&t.onAction(e)}updateData(){let{props:e,state:t}=this,n=this.data,r=this.computeOptionsData(e.optionOverrides,t.dynamicOptionOverrides,e.calendarApi),i=this.computeCurrentViewData(t.currentViewType,r,e.optionOverrides,t.dynamicOptionOverrides),o=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(t.dateProfile,i.options,r.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},r),i),t),s=r.pluginHooks.optionChangeHandlers,a=n&&n.calendarOptions,l=r.calendarOptions;if(a&&a!==l){a.timeZone!==l.timeZone&&(t.eventSources=o.eventSources=function(e,t,n){let r=t?t.activeRange:null;return As(e,Rs(e,n),r,!0,n)}(o.eventSources,t.dateProfile,o),t.eventStore=o.eventStore=xr(o.eventStore,n.dateEnv,o.dateEnv),t.renderableEventStore=o.renderableEventStore=xr(o.renderableEventStore,n.dateEnv,o.dateEnv));for(let e in s)-1===this.optionsForHandling.indexOf(e)&&a[e]===l[e]||s[e](l[e],o)}this.optionsForHandling=[],e.onData&&e.onData(o)}computeOptionsData(e,t,n){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&t===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:r,pluginHooks:i,localeDefaults:o,availableLocaleData:s,extra:a}=this.processRawCalendarOptions(e,t);ta(a);let l=this.buildDateEnv(r.timeZone,r.locale,r.weekNumberCalculation,r.firstDay,r.weekText,i,s,r.defaultRangeSeparator),c=this.buildViewSpecs(i.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,o),u=this.buildTheme(r,i),d=this.parseToolbars(r,this.stableOptionOverrides,u,c,n);return this.stableCalendarOptionsData={calendarOptions:r,pluginHooks:i,dateEnv:l,viewSpecs:c,theme:u,toolbarConfig:d,localeDefaults:o,availableRawLocales:s.map}}processRawCalendarOptions(e,t){let{locales:n,locale:r}=hn([on,e,t]),i=this.organizeRawLocales(n),o=i.map,s=this.buildLocale(r||i.defaultCode,o).options,a=this.buildPluginHooks(e.plugins||[],Bs),l=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},rn),sn),an),a.listenerRefiners),a.optionRefiners),c={},u=hn([on,s,e,t]),d={},h=this.currentCalendarOptionsInput,f=this.currentCalendarOptionsRefined,p=!1;for(let g in u)-1===this.optionsForRefining.indexOf(g)&&(u[g]===h[g]||ln[g]&&g in h&&ln[g](h[g],u[g]))?d[g]=f[g]:l[g]?(d[g]=l[g](u[g]),p=!0):c[g]=h[g];return p&&(this.currentCalendarOptionsInput=u,this.currentCalendarOptionsRefined=d,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=t),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:a,availableLocaleData:i,localeDefaults:s,extra:c}}_computeCurrentViewData(e,t,n,r){let i=t.viewSpecs[e];if(!i)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:o,extra:s}=this.processRawViewOptions(i,t.pluginHooks,t.localeDefaults,n,r);return ta(s),this.nowManager.handleInput(t.dateEnv,o.now),{viewSpec:i,options:o,dateProfileGenerator:this.buildDateProfileGenerator({dateProfileGeneratorClass:i.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:i.duration,durationUnit:i.durationUnit,usesMinMaxTime:i.optionDefaults.usesMinMaxTime,dateEnv:t.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:o.slotMinTime,slotMaxTime:o.slotMaxTime,showNonCurrentDates:o.showNonCurrentDates,dayCount:o.dayCount,dateAlignment:o.dateAlignment,dateIncrement:o.dateIncrement,hiddenDays:o.hiddenDays,weekends:o.weekends,validRangeInput:o.validRange,visibleRangeInput:o.visibleRange,fixedWeekCount:o.fixedWeekCount}),viewApi:this.buildViewApi(e,this.getCurrentData,t.dateEnv)}}processRawViewOptions(e,t,n,r,i){let o=hn([on,e.optionDefaults,n,r,e.optionOverrides,i]),s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},rn),sn),an),dn),t.listenerRefiners),t.optionRefiners),a={},l=this.currentViewOptionsInput,c=this.currentViewOptionsRefined,u=!1,d={};for(let h in o)o[h]===l[h]||ln[h]&&ln[h](o[h],l[h])?a[h]=c[h]:(o[h]===this.currentCalendarOptionsInput[h]||ln[h]&&ln[h](o[h],this.currentCalendarOptionsInput[h])?h in this.currentCalendarOptionsRefined&&(a[h]=this.currentCalendarOptionsRefined[h]):s[h]?a[h]=s[h](o[h]):d[h]=o[h],u=!0);return u&&(this.currentViewOptionsInput=o,this.currentViewOptionsRefined=a),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:d}}}function $s(e,t,n,r,i,o,s,a){let l=cs(t||s.defaultCode,s.map);return new An({calendarSystem:"gregory",timeZone:e,namedTimeZoneImpl:o.namedTimeZonedImpl,locale:l,weekNumberCalculation:n,firstDay:r,weekText:i,cmdFormatter:o.cmdFormatter,defaultSeparator:a})}function Gs(e,t){return new(t.themeClasses[e.themeSystem]||gs)(e)}function Ks(e){return new(e.dateProfileGeneratorClass||rr)(e)}function Qs(e,t,n){return new Fs(e,t,n)}function Ys(e){return yn(e,e=>e.ui)}function Js(e,t,n){let r={"":t};for(let i in e){let t=e[i];t.sourceId&&n[t.sourceId]&&(r[i]=n[t.sourceId])}return r}function Xs(e){let{options:t}=e;return{eventUiSingleBase:Er({display:t.eventDisplay,editable:t.editable,startEditable:t.eventStartEditable,durationEditable:t.eventDurationEditable,constraint:t.eventConstraint,overlap:"boolean"===typeof t.eventOverlap?t.eventOverlap:void 0,allow:t.eventAllow,backgroundColor:t.eventBackgroundColor,borderColor:t.eventBorderColor,textColor:t.eventTextColor,color:t.eventColor},e),selectionConfig:Er({constraint:t.selectConstraint,overlap:"boolean"===typeof t.selectOverlap?t.selectOverlap:void 0,allow:t.selectAllow},e)}}function Zs(e,t){for(let n of t.pluginHooks.isLoadingFuncs)if(n(e))return!0;return!1}function ea(e){return Lr(e.options.businessHours,e)}function ta(e,t){for(let n in e)console.warn(`Unknown option '${n}'`+(t?` for view '${t}'`:""))}class na extends Ln{render(){return b("div",{className:"fc-toolbar-chunk"},...this.props.widgetGroups.map(e=>this.renderWidgetGroup(e)))}renderWidgetGroup(e){let{props:t}=this,{theme:n}=this.context,r=[],i=!0;for(let o of e){let{buttonName:e,buttonClick:s,buttonText:a,buttonIcon:l,buttonHint:c}=o;if("title"===e)i=!1,r.push(b("h2",{className:"fc-toolbar-title",id:t.titleId},t.title));else{let i=e===t.activeButton,o=!t.isTodayEnabled&&"today"===e||!t.isPrevEnabled&&"prev"===e||!t.isNextEnabled&&"next"===e,u=[`fc-${e}-button`,n.getClass("button")];i&&u.push(n.getClass("buttonActive")),r.push(b("button",{type:"button",title:"function"===typeof c?c(t.navUnit):c,disabled:o,"aria-pressed":i,className:u.join(" "),onClick:s},a||(l?b("span",{className:l,role:"img"}):"")))}}if(r.length>1){return b("div",{className:i&&n.getClass("buttonGroup")||""},...r)}return r[0]}}class ra extends Ln{render(){let e,t,{model:n,extraClassName:r}=this.props,i=!1,o=n.sectionWidgets,s=o.center;return o.left?(i=!0,e=o.left):e=o.start,o.right?(i=!0,t=o.right):t=o.end,b("div",{className:[r||"","fc-toolbar",i?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",e||[]),this.renderSection("center",s||[]),this.renderSection("end",t||[]))}renderSection(e,t){let{props:n}=this;return b(na,{key:e,widgetGroups:t,title:n.title,navUnit:n.navUnit,activeButton:n.activeButton,isTodayEnabled:n.isTodayEnabled,isPrevEnabled:n.isPrevEnabled,isNextEnabled:n.isNextEnabled,titleId:n.titleId})}}class ia extends Ln{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,Un(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:t}=this,{aspectRatio:n}=e,r=["fc-view-harness",n||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],i="",o="";return n?null!==t.availableWidth?i=t.availableWidth/n:o=1/n*100+"%":i=e.height||"",b("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:r.join(" "),style:{height:i,paddingBottom:o}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}}class oa extends yi{constructor(e){super(e),this.handleSegClick=(e,t)=>{let{component:n}=this,{context:r}=n,i=Qr(t);if(i&&n.isValidSegDownEl(e.target)){let o=Be(e.target,".fc-event-forced-url"),s=o?o.querySelector("a[href]").href:"";r.emitter.trigger("eventClick",{el:t,event:new Vr(n.context,i.eventRange.def,i.eventRange.instance),jsEvent:e,view:r.viewApi}),s&&!e.defaultPrevented&&(window.location.href=s)}},this.destroy=Ye(e.el,"click",".fc-event",this.handleSegClick)}}class sa extends yi{constructor(e){super(e),this.handleEventElRemove=e=>{e===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(e,t)=>{Qr(t)&&(this.currentSegEl=t,this.triggerEvent("eventMouseEnter",e,t))},this.handleSegLeave=(e,t)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",e,t))},this.removeHoverListeners=function(e,t,n,r){let i;return Ye(e,"mouseover",t,(e,t)=>{if(t!==i){i=t,n(e,t);let o=e=>{i=null,r(e,t),t.removeEventListener("mouseleave",o)};t.addEventListener("mouseleave",o)}})}(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,t,n){let{component:r}=this,{context:i}=r,o=Qr(n);t&&!r.isValidSegDownEl(t.target)||i.emitter.trigger(e,{el:n,event:new Vr(i,o.eventRange.def,o.eventRange.instance),jsEvent:t,view:i.viewApi})}}class aa extends Mn{constructor(){super(...arguments),this.buildViewContext=Bt(Nn),this.buildViewPropTransformers=Bt(ca),this.buildToolbarProps=Bt(la),this.headerRef={current:null},this.footerRef={current:null},this.interactionsStore={},this.state={viewLabelId:Ke()},this.registerInteractiveComponent=(e,t)=>{let n=function(e,t){return{component:e,el:t.el,useEventCenter:null==t.useEventCenter||t.useEventCenter,isHitComboAllowed:t.isHitComboAllowed||null}}(e,t),r=[oa,sa].concat(this.props.pluginHooks.componentInteractions).map(e=>new e(n));this.interactionsStore[e.uid]=r,bi[e.uid]=n},this.unregisterInteractiveComponent=e=>{let t=this.interactionsStore[e.uid];if(t){for(let e of t)e.destroy();delete this.interactionsStore[e.uid]}delete bi[e.uid]},this.resizeRunner=new He(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:t}=this.props;t.handleWindowResize&&e.target===window&&this.resizeRunner.request(t.windowResizeDelay)}}render(){let e,{props:t}=this,{toolbarConfig:n,options:r}=t,i=!1,o="";t.isHeightAuto||t.forPrint?o="":null!=r.height?i=!0:null!=r.contentHeight?o=r.contentHeight:e=Math.max(r.aspectRatio,.5);let s=this.buildViewContext(t.viewSpec,t.viewApi,t.options,t.dateProfileGenerator,t.dateEnv,t.nowManager,t.theme,t.pluginHooks,t.dispatch,t.getCurrentData,t.emitter,t.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),a=n.header&&n.header.hasTitle?this.state.viewLabelId:void 0;return b(On.Provider,{value:s},b(Ci,{unit:"day"},r=>{let s=this.buildToolbarProps(t.viewSpec,t.dateProfile,t.dateProfileGenerator,t.currentDate,r,t.viewTitle);return b(S,null,n.header&&b(ra,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:n.header,titleId:a},s)),b(ia,{liquid:i,height:o,aspectRatio:e,labeledById:a},this.renderView(t),this.buildAppendContent()),n.footer&&b(ra,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:n.footer,titleId:""},s)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(t=>new t(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:t}=e.pluginHooks;for(let n in t)t[n](e[n],e)}componentDidUpdate(e){let{props:t}=this,{propSetHandlers:n}=t.pluginHooks;for(let r in n)t[r]!==e[r]&&n[r](t[r],t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this;return b(S,{},...e.pluginHooks.viewContainerAppends.map(t=>t(e)))}renderView(e){let{pluginHooks:t}=e,{viewSpec:n}=e,r={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},i=this.buildViewPropTransformers(t.viewPropsTransformers);for(let o of i)Object.assign(r,o.transform(r,e));return b(n.component,Object.assign({},r))}}function la(e,t,n,r,i,o){let s=n.build(i,void 0,!1),a=n.buildPrev(t,r,!1),l=n.buildNext(t,r,!1);return{title:o,activeButton:e.type,navUnit:e.singleUnit,isTodayEnabled:s.isValid&&!Zn(t.currentRange,i),isPrevEnabled:a.isValid,isNextEnabled:l.isValid}}function ca(e){return e.map(e=>new e)}class ua extends Ei{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=e=>{switch(e.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=e=>{this.currentData=e,this.renderRunner.request(e.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:e}=this;Rn(()=>{V(b(vi,{options:e.calendarOptions,theme:e.theme,emitter:e.emitter},(t,n,r,i)=>(this.setClassNames(t),this.setHeight(n),b(zn.Provider,{value:this.customContentRenderId},b(aa,Object.assign({isHeightAuto:r,forPrint:i},e))))),this.el)})}else this.isRendered&&(this.isRendered=!1,V(null,this.el),this.setClassNames([]),this.setHeight(""))},function(e){e.isConnected&&e.getRootNode&&Le(e.getRootNode())}(e),this.el=e,this.renderRunner=new He(this.handleRenderRequest),new Ws({optionOverrides:t,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){Rn(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,t){this.currentDataManager.resetOptions(e,t)}setClassNames(e){if(!St(e,this.currentClassNames)){let{classList:t}=this.el;for(let e of this.currentClassNames)t.remove(e);for(let n of e)t.add(n);this.currentClassNames=e}}setHeight(e){We(this.el,"height",e)}}const da=parseInt(String(h.version).split(".")[0])<18;class ha extends h.Component{constructor(){super(...arguments),this.elRef=(0,h.createRef)(),this.isUpdating=!1,this.isUnmounting=!1,this.state={customRenderingMap:new Map},this.requestResize=()=>{this.isUnmounting||(this.cancelResize(),this.resizeId=requestAnimationFrame(()=>{this.doResize()}))}}render(){const e=[];for(const t of this.state.customRenderingMap.values())e.push(h.createElement(fa,{key:t.id,customRendering:t}));return h.createElement("div",{ref:this.elRef},e)}componentDidMount(){this.isUnmounting=!1;const e=new is;let t;this.handleCustomRendering=e.handle.bind(e),this.calendar=new ua(this.elRef.current,Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.calendar.render(),this.calendar.on("_beforeprint",()=>{(0,p.flushSync)(()=>{})}),e.subscribe(e=>{const n=Date.now(),r=!t;(da||r||this.isUpdating||this.isUnmounting||n-t<100?pa:p.flushSync)(()=>{this.setState({customRenderingMap:e},()=>{t=n,r?this.doResize():this.requestResize()})})})}componentDidUpdate(){this.isUpdating=!0,this.calendar.resetOptions(Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.isUpdating=!1}componentWillUnmount(){this.isUnmounting=!0,this.cancelResize(),this.calendar.destroy()}doResize(){this.calendar.updateSize()}cancelResize(){void 0!==this.resizeId&&(cancelAnimationFrame(this.resizeId),this.resizeId=void 0)}getApi(){return this.calendar}}ha.act=pa;class fa extends h.PureComponent{render(){const{customRendering:e}=this.props,{generatorMeta:t}=e,n="function"===typeof t?t(e.renderProps):t;return(0,p.createPortal)(n,e.containerEl)}}function pa(e){e()}function ga(e,t){let n=[];for(let r=0;r<t;r+=1)n[r]=[];for(let r of e)n[r.row].push(r);return n}function ma(e,t){let n=[];for(let r=0;r<t;r+=1)n[r]=[];for(let r of e)n[r.firstCol].push(r);return n}function va(e,t){let n=[];if(e){for(let r=0;r<t;r+=1)n[r]={affectedInstances:e.affectedInstances,isEvent:e.isEvent,segs:[]};for(let t of e.segs)n[t.row].segs.push(t)}else for(let r=0;r<t;r+=1)n[r]=null;return n}const ya=nn({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function wa(e){let{display:t}=e.eventRange.ui;return"list-item"===t||"auto"===t&&!e.eventRange.def.allDay&&e.firstCol===e.lastCol&&e.isStart&&e.isEnd}class ba extends Ln{render(){let{props:e}=this;return b(Uo,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:ya,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class Ca extends Ln{render(){let{props:e,context:t}=this,{options:n}=t,{seg:r}=e,i=ri(r,n.eventTimeFormat||ya,t,!0,e.defaultDisplayEventEnd);return b(Lo,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:ai(e.seg,t),defaultGenerator:Sa,timeText:i,isResizing:!1,isDateSelecting:!1}))}}function Sa(e){return b(S,null,b("div",{className:"fc-daygrid-event-dot",style:{borderColor:e.borderColor||e.backgroundColor}}),e.timeText&&b("div",{className:"fc-event-time"},e.timeText),b("div",{className:"fc-event-title"},e.event.title||b(S,null,"\xa0")))}class Ea extends Ln{constructor(){super(...arguments),this.compileSegs=Bt(Ta)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:n}=this.compileSegs(e.singlePlacements);return b(Jo,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:n,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let n=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return b(S,null,t.map(t=>{let r=t.eventRange.instance.instanceId;return b("div",{className:"fc-daygrid-event-harness",key:r,style:{visibility:n[r]?"hidden":""}},wa(t)?b(Ca,Object.assign({seg:t,isDragging:!1,isSelected:r===e.eventSelection,defaultDisplayEventEnd:!1},ii(t,e.todayRange))):b(ba,Object.assign({seg:t,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:r===e.eventSelection,defaultDisplayEventEnd:!1},ii(t,e.todayRange))))}))}})}}function Ta(e){let t=[],n=[];for(let r of e)t.push(r.seg),r.isVisible||n.push(r.seg);return{allSegs:t,invisibleSegs:n}}const _a=nn({week:"narrow"});class Ia extends Gi{constructor(){super(...arguments),this.rootElRef={current:null},this.state={dayNumberId:Ke()},this.handleRootEl=e=>{Un(this.rootElRef,e),Un(this.props.elRef,e)}}render(){let{context:e,props:t,state:n,rootElRef:r}=this,{options:i,dateEnv:o}=e,{date:s,dateProfile:a}=t;const l=t.showDayNumber&&function(e,t,n){const{start:r,end:i}=t,o=_t(i,-1),s=n.getYear(r),a=n.getMonth(r),l=n.getYear(o),c=n.getMonth(o);return!(s===l&&a===c)&&Boolean(e.valueOf()===r.valueOf()||1===n.getDay(e)&&e.valueOf()<i.valueOf())}(s,a.currentRange,o);return b(Bo,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":n.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:Aa,date:s,dateProfile:a,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:l,extraRenderProps:t.extraRenderProps},(o,a)=>b("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&b(Go,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:Oi(e,s,"week"),date:s,defaultFormat:_a}),!a.isDisabled&&(t.showDayNumber||zo(i)||t.forceDayTop)?b("div",{className:"fc-daygrid-day-top"},b(o,{elTag:"a",elClasses:["fc-daygrid-day-number",l&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},Oi(e,s)),{id:n.dayNumberId})})):t.showDayNumber?b("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},b("a",{className:"fc-daygrid-day-number"},"\xa0")):void 0,b("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,b("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},b(Ea,{allDayDate:s,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:r,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),b("div",{className:"fc-daygrid-day-bg"},t.bgContent)))}}function Aa(e){return e.dayNumberText||b(S,null,"\xa0")}function ka(e){return e.eventRange.instance.instanceId+":"+e.firstCol}function Ra(e){return ka(e)+":"+e.lastCol}function Da(e,t,n,r,i,o,s){let a=new xa(t=>{let n=e[t.index].eventRange.instance.instanceId+":"+t.span.start+":"+(t.span.end-1);return i[n]||1});a.allowReslicing=!0,a.strictOrder=r,!0===t||!0===n?(a.maxCoord=o,a.hiddenConsumes=!0):"number"===typeof t?a.maxStackCnt=t:"number"===typeof n&&(a.maxStackCnt=n,a.hiddenConsumes=!0);let l=[],c=[];for(let v=0;v<e.length;v+=1){let t=e[v],n=Ra(t);null!=i[n]?l.push({index:v,span:{start:t.firstCol,end:t.lastCol+1}}):c.push(t)}let u=a.addSegs(l),d=a.toRects(),{singleColPlacements:h,multiColPlacements:f,leftoverMargins:p}=function(e,t,n){let r=function(e,t){let n=[];for(let r=0;r<t;r+=1)n.push([]);for(let r of e)for(let e=r.span.start;e<r.span.end;e+=1)n[e].push(r);return n}(e,n.length),i=[],o=[],s=[];for(let a=0;a<n.length;a+=1){let e=r[a],l=[],c=0,u=0;for(let r of e){let e=t[r.index];l.push({seg:Pa(e,a,a+1,n),isVisible:!0,isAbsolute:!1,absoluteTop:r.levelCoord,marginTop:r.levelCoord-c}),c=r.levelCoord+r.thickness}let d=[];c=0,u=0;for(let r of e){let e=t[r.index],i=r.span.end-r.span.start>1,o=r.span.start===a;u+=r.levelCoord-c,c=r.levelCoord+r.thickness,i?(u+=r.thickness,o&&d.push({seg:Pa(e,r.span.start,r.span.end,n),isVisible:!0,isAbsolute:!0,absoluteTop:r.levelCoord,marginTop:0})):o&&(d.push({seg:Pa(e,r.span.start,r.span.end,n),isVisible:!0,isAbsolute:!1,absoluteTop:r.levelCoord,marginTop:u}),u=0)}i.push(l),o.push(d),s.push(u)}return{singleColPlacements:i,multiColPlacements:o,leftoverMargins:s}}(d,e,s),g=[],m=[];for(let v of c){f[v.firstCol].push({seg:v,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let e=v.firstCol;e<=v.lastCol;e+=1)h[e].push({seg:Pa(v,e,e+1,s),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let v=0;v<s.length;v+=1)g.push(0);for(let v of u){let t=e[v.index],n=v.span;f[n.start].push({seg:Pa(t,n.start,n.end,s),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let e=n.start;e<n.end;e+=1)g[e]+=1,h[e].push({seg:Pa(t,e,e+1,s),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let v=0;v<s.length;v+=1)m.push(p[v]);return{singleColPlacements:h,multiColPlacements:f,moreCnts:g,moreMarginTops:m}}function Pa(e,t,n,r){if(e.firstCol===t&&e.lastCol===n-1)return e;let i=e.eventRange,o=i.range,s=Qn(o,{start:r[t].date,end:Tt(r[n-1].date,1)});return Object.assign(Object.assign({},e),{firstCol:t,lastCol:n-1,eventRange:{def:i.def,ui:Object.assign(Object.assign({},i.ui),{durationEditable:!1}),instance:i.instance,range:s},isStart:e.isStart&&s.start.valueOf()===o.start.valueOf(),isEnd:e.isEnd&&s.end.valueOf()===o.end.valueOf()})}class xa extends Ki{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const t=super.addSegs(e),{entriesByLevel:n}=this,r=e=>!this.forceHidden[Yi(e)];for(let i=0;i<n.length;i+=1)n[i]=n[i].filter(r);return t}handleInvalidInsertion(e,t,n){const{entriesByLevel:r,forceHidden:i}=this,{touchingEntry:o,touchingLevel:s,touchingLateral:a}=e;if(this.hiddenConsumes&&o){const e=Yi(o);if(!i[e])if(this.allowReslicing){const e=Object.assign(Object.assign({},o),{span:Xi(o.span,t.span)});i[Yi(e)]=!0,r[s][a]=e,n.push(e),this.splitEntry(o,t,n)}else i[e]=!0,n.push(o)}super.handleInvalidInsertion(e,t,n)}}class Oa extends Gi{constructor(){super(...arguments),this.cellElRefs=new _o,this.frameElRefs=new _o,this.fgElRefs=new _o,this.segHarnessRefs=new _o,this.rootElRef={current:null},this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:n}=this,{options:r}=n,i=e.cells.length,o=ma(e.businessHourSegs,i),s=ma(e.bgEventSegs,i),a=ma(this.getHighlightSegs(),i),l=ma(this.getMirrorSegs(),i),{singleColPlacements:c,multiColPlacements:u,moreCnts:d,moreMarginTops:h}=Da(Xr(e.fgEventSegs,r.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,r.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),f=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return b("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((t,n)=>{let r=this.renderFgSegs(n,e.forPrint?c[n]:u[n],e.todayRange,f),i=this.renderFgSegs(n,function(e,t){if(!e.length)return[];let n=function(e){let t={};for(let n of e)for(let e of n)t[e.seg.eventRange.instance.instanceId]=e.absoluteTop;return t}(t);return e.map(e=>({seg:e,isVisible:!0,isAbsolute:!0,absoluteTop:n[e.eventRange.instance.instanceId],marginTop:0}))}(l[n],u),e.todayRange,{},Boolean(e.eventDrag),Boolean(e.eventResize),!1);return b(Ia,{key:t.key,elRef:this.cellElRefs.createRef(t.key),innerElRef:this.frameElRefs.createRef(t.key),dateProfile:e.dateProfile,date:t.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&0===n,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:t.extraRenderProps,extraDataAttrs:t.extraDataAttrs,extraClassNames:t.extraClassNames,extraDateSpan:t.extraDateSpan,moreCnt:d[n],moreMarginTop:h[n],singlePlacements:c[n],fgContentElRef:this.fgElRefs.createRef(t.key),fgContent:b(S,null,b(S,null,r),b(S,null,i)),bgContent:b(S,null,this.renderFillSegs(a[n],"highlight"),this.renderFillSegs(o[n],"non-business"),this.renderFillSegs(s[n],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let n=this.props;this.updateSizing(!Cn(e,n))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,n,r,i,o,s){let{context:a}=this,{eventSelection:l}=this.props,{framePositions:c}=this.state,u=1===this.props.cells.length,d=i||o||s,h=[];if(c)for(let f of t){let{seg:e}=f,{instanceId:t}=e.eventRange.instance,p=f.isVisible&&!r[t],g=f.isAbsolute,m="",v="";g&&(a.isRtl?(v=0,m=c.lefts[e.lastCol]-c.lefts[e.firstCol]):(m=0,v=c.rights[e.firstCol]-c.rights[e.lastCol])),h.push(b("div",{className:"fc-daygrid-event-harness"+(g?" fc-daygrid-event-harness-abs":""),key:ka(e),ref:d?null:this.segHarnessRefs.createRef(Ra(e)),style:{visibility:p?"":"hidden",marginTop:g?"":f.marginTop,top:g?f.absoluteTop:"",left:m,right:v}},wa(e)?b(Ca,Object.assign({seg:e,isDragging:i,isSelected:t===l,defaultDisplayEventEnd:u},ii(e,n))):b(ba,Object.assign({seg:e,isDragging:i,isResizing:o,isDateSelecting:s,isSelected:t===l,defaultDisplayEventEnd:u},ii(e,n)))))}return h}renderFillSegs(e,t){let{isRtl:n}=this.context,{todayRange:r}=this.props,{framePositions:i}=this.state,o=[];if(i)for(let s of e){let e=n?{right:0,left:i.lefts[s.lastCol]-i.lefts[s.firstCol]}:{left:0,right:i.rights[s.firstCol]-i.rights[s.lastCol]};o.push(b("div",{key:si(s.eventRange),className:"fc-daygrid-bg-harness",style:e},"bg-event"===t?b(Vo,Object.assign({seg:s},ii(s,r))):$o(t)))}return b(S,{},...o)}updateSizing(e){let{props:t,state:n,frameElRefs:r}=this;if(!t.forPrint&&null!==t.clientWidth){if(e){let e=t.cells.map(e=>r.currentMap[e.key]);if(e.length){let t=this.rootElRef.current,r=new zi(t,e,!0,!1);n.framePositions&&n.framePositions.similarTo(r)||this.setState({framePositions:new zi(t,e,!0,!1)})}}const i=this.state.segHeights,o=this.querySegHeights(),s=!0===t.dayMaxEvents||!0===t.dayMaxEventRows;this.safeSetState({segHeights:Object.assign(Object.assign({},i),o),maxContentHeight:s?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let n in e){let r=Math.round(e[n].getBoundingClientRect().height);t[n]=Math.max(t[n]||0,r)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],n=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-n.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(t=>e[t.key])}}Oa.addStateEquality({segHeights:Cn});class Na extends Gi{constructor(){super(...arguments),this.splitBusinessHourSegs=Bt(ga),this.splitBgEventSegs=Bt(Ma),this.splitFgEventSegs=Bt(ga),this.splitDateSelectionSegs=Bt(ga),this.splitEventDrag=Bt(va),this.splitEventResize=Bt(va),this.rowRefs=new _o}render(){let{props:e,context:t}=this,n=e.cells.length,r=this.splitBusinessHourSegs(e.businessHourSegs,n),i=this.splitBgEventSegs(e.bgEventSegs,n),o=this.splitFgEventSegs(e.fgEventSegs,n),s=this.splitDateSelectionSegs(e.dateSelectionSegs,n),a=this.splitEventDrag(e.eventDrag,n),l=this.splitEventResize(e.eventResize,n),c=n>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return b(Ci,{unit:"day"},(t,u)=>b(S,null,e.cells.map((t,d)=>b(Oa,{ref:this.rowRefs.createRef(d),key:t.length?t[0].date.toISOString():d,showDayNumbers:n>1,showWeekNumbers:e.showWeekNumbers,todayRange:u,dateProfile:e.dateProfile,cells:t,renderIntro:e.renderRowIntro,businessHourSegs:r[d],eventSelection:e.eventSelection,bgEventSegs:i[d],fgEventSegs:o[d],dateSelectionSegs:s[d],eventDrag:a[d],eventResize:l[d],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:c,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new zi(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new zi(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:n,rowPositions:r}=this,i=n.leftToIndex(e),o=r.topToIndex(t);if(null!=o&&null!=i){let e=this.props.cells[o][i];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(o,i),allDay:!0},e.extraDateSpan),dayEl:this.getCellEl(o,i),rect:{left:n.lefts[i],right:n.rights[i],top:r.tops[o],bottom:r.bottoms[o]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let n=this.props.cells[e][t].date;return{start:n,end:Tt(n,1)}}}function Ma(e,t){return ga(e.filter(La),t)}function La(e){return e.eventRange.def.allDay}class Ua extends Gi{constructor(){super(...arguments),this.elRef={current:null},this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:n,expandRows:r}=e,i=!0===n||!0===t;i&&!r&&(i=!1,t=null,n=null);let o=["fc-daygrid-body",i?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",r?"":"fc-daygrid-body-natural"];return b("div",{ref:this.elRef,className:o.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},b("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:r?e.clientHeight:""}},e.colGroupNode,b("tbody",{role:"presentation"},b(Na,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:n,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=function(e,t){let n;t.currentRangeUnit.match(/year|month/)&&(n=e.querySelector(`[data-date="${r=t.currentDate,r.toISOString().match(/^\d{4}-\d{2}/)[0]}-01"]`));var r;n||(n=e.querySelector(`[data-date="${Ft(t.currentDate)}"]`));return n}(this.elRef.current,this.props.dateProfile);if(e){const t=e.closest(".fc-daygrid-body"),n=t.closest(".fc-scroller"),r=e.getBoundingClientRect().top-t.getBoundingClientRect().top;n.scrollTop=r?r+1:0}this.needsScrollReset=!1}}}class Fa extends po{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}}class Ha extends Gi{constructor(){super(...arguments),this.slicer=new Fa,this.tableRef={current:null}}render(){let{props:e,context:t}=this;return b(Ua,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}Me(':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}');class ja extends Ai{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?"background"===(t=e).ui.display||"inverse-background"===t.ui.display?["timed","allDay"]:["allDay"]:["timed"];var t}}const Ba=nn({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function za(e){let t=["fc-timegrid-slot","fc-timegrid-slot-label",e.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return b(On.Consumer,null,n=>{if(!e.isLabeled)return b("td",{className:t.join(" "),"data-time":e.isoTimeStr});let{dateEnv:r,options:i,viewApi:o}=n,s=null==i.slotLabelFormat?Ba:Array.isArray(i.slotLabelFormat)?nn(i.slotLabelFormat[0]):nn(i.slotLabelFormat),a={level:0,time:e.time,date:r.toDate(e.date),view:o,text:r.format(e.date,s)};return b(qn,{elTag:"td",elClasses:t,elAttrs:{"data-time":e.isoTimeStr},renderProps:a,generatorName:"slotLabelContent",customGenerator:i.slotLabelContent,defaultGenerator:qa,classNameGenerator:i.slotLabelClassNames,didMount:i.slotLabelDidMount,willUnmount:i.slotLabelWillUnmount},e=>b("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},b(e,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]})))})}function qa(e){return e.text}class Va extends Ln{render(){return this.props.slatMetas.map(e=>b("tr",{key:e.key},b(za,Object.assign({},e))))}}const Wa=nn({week:"short"});class $a extends Gi{constructor(){var e;super(...arguments),e=this,this.allDaySplitter=new ja,this.headerElRef={current:null},this.rootElRef={current:null},this.scrollerElRef={current:null},this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let t=this.scrollerElRef.current;t&&(t.scrollTop=e)},this.renderHeadAxis=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",{options:r}=e.context,{dateProfile:i}=e.props,o=i.renderRange,s=1===It(o.start,o.end)?Oi(e.context,o.start,"week"):{};return r.weekNumbers&&"day"===t?b(Go,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:o.start,defaultFormat:Wa},e=>b("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:n}},b(e,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:s}))):b("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},b("div",{className:"fc-timegrid-axis-frame",style:{height:n}}))},this.renderTableRowAxis=e=>{let{options:t,viewApi:n}=this.context,r={text:t.allDayText,view:n};return b(qn,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:r,generatorName:"allDayContent",customGenerator:t.allDayContent,defaultGenerator:Ga,classNameGenerator:t.allDayClassNames,didMount:t.allDayDidMount,willUnmount:t.allDayWillUnmount},t=>b("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",null==e?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},b(t,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]})))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,t,n){let{context:r,props:i}=this,o=[],s=Oo(r.options);return e&&o.push({type:"header",key:"header",isSticky:s,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),t&&(o.push({type:"body",key:"all-day",chunk:{content:t}}),o.push({type:"body",key:"all-day-divider",outerContent:b("tr",{role:"presentation",className:"fc-scrollgrid-section"},b("td",{className:"fc-timegrid-divider "+r.theme.getClass("tableCellShaded")}))})),o.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(r.options.expandRows),chunk:{scrollerElRef:this.scrollerElRef,content:n}}),b(Wn,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:r.viewSpec},b(Mo,{liquid:!i.isHeightAuto&&!i.forPrint,collapsibleWidth:i.forPrint,cols:[{width:"shrink"}],sections:o}))}renderHScrollLayout(e,t,n,r,i,o,s){let a=this.context.pluginHooks.scrollGridImpl;if(!a)throw new Error("No ScrollGrid implementation");let{context:l,props:c}=this,u=!c.forPrint&&Oo(l.options),d=!c.forPrint&&No(l.options),h=[];e&&h.push({type:"header",key:"header",isSticky:u,syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>b("tr",{role:"presentation"},this.renderHeadAxis("day",e.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),t&&(h.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:e=>b("tr",{role:"presentation"},this.renderTableRowAxis(e.rowSyncHeights[0]))},{key:"cols",content:t}]}),h.push({key:"all-day-divider",type:"body",outerContent:b("tr",{role:"presentation",className:"fc-scrollgrid-section"},b("td",{colSpan:2,className:"fc-timegrid-divider "+l.theme.getClass("tableCellShaded")}))}));let f=l.options.nowIndicator;return h.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(l.options.expandRows),chunks:[{key:"axis",content:e=>b("div",{className:"fc-timegrid-axis-chunk"},b("table",{"aria-hidden":!0,style:{height:e.expandRows?e.clientHeight:""}},e.tableColGroupNode,b("tbody",null,b(Va,{slatMetas:o}))),b("div",{className:"fc-timegrid-now-indicator-container"},b(Ci,{unit:f?"minute":"day"},e=>{let t=f&&s&&s.safeComputeTop(e);return"number"===typeof t?b(Ho,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:t},isAxis:!0,date:e}):null})))},{key:"cols",scrollerElRef:this.scrollerElRef,content:n}]}),d&&h.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:xo},{key:"cols",content:xo}]}),b(Wn,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:l.viewSpec},b(a,{liquid:!c.isHeightAuto&&!c.forPrint,forPrint:c.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:r,minWidth:i}]}],sections:h}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:t}=this.context.options;return!0!==e&&!0!==t||(e=void 0,t=5),{dayMaxEvents:e,dayMaxEventRows:t}}}function Ga(e){return e.text}class Ka{constructor(e,t,n){this.positions=e,this.dateProfile=t,this.slotDuration=n}safeComputeTop(e){let{dateProfile:t}=this;if(Zn(t.currentRange,e)){let n=kt(e),r=e.valueOf()-n.valueOf();if(r>=wt(t.slotMinTime)&&r<wt(t.slotMaxTime))return this.computeTimeTop(gt(r))}return null}computeDateTop(e,t){return t||(t=kt(e)),this.computeTimeTop(gt(e.valueOf()-t.valueOf()))}computeTimeTop(e){let t,n,{positions:r,dateProfile:i}=this,o=r.els.length,s=(e.milliseconds-wt(i.slotMinTime))/wt(this.slotDuration);return s=Math.max(0,s),s=Math.min(o,s),t=Math.floor(s),t=Math.min(t,o-1),n=s-t,r.tops[t]+r.getHeight(t)*n}}class Qa extends Ln{render(){let{props:e,context:t}=this,{options:n}=t,{slatElRefs:r}=e;return b("tbody",null,e.slatMetas.map((i,o)=>{let s={time:i.time,date:t.dateEnv.toDate(i.date),view:t.viewApi};return b("tr",{key:i.key,ref:r.createRef(i.key)},e.axis&&b(za,Object.assign({},i)),b(qn,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!i.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":i.isoTimeStr},renderProps:s,generatorName:"slotLaneContent",customGenerator:n.slotLaneContent,classNameGenerator:n.slotLaneClassNames,didMount:n.slotLaneDidMount,willUnmount:n.slotLaneWillUnmount}))}))}}class Ya extends Ln{constructor(){super(...arguments),this.rootElRef={current:null},this.slatElRefs=new _o}render(){let{props:e,context:t}=this;return b("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},b("table",{"aria-hidden":!0,className:t.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,b(Qa,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:t}=this;if(t.onCoords&&null!==t.clientWidth){this.rootElRef.current.offsetHeight&&t.onCoords(new Ka(new zi(this.rootElRef.current,(n=this.slatElRefs.currentMap,t.slatMetas.map(e=>n[e.key])),!1,!0),this.props.dateProfile,e.options.slotDuration))}var n}}function Ja(e,t){let n,r=[];for(n=0;n<t;n+=1)r.push([]);if(e)for(n=0;n<e.length;n+=1)r[e[n].col].push(e[n]);return r}function Xa(e,t){let n=[];if(e){for(let r=0;r<t;r+=1)n[r]={affectedInstances:e.affectedInstances,isEvent:e.isEvent,segs:[]};for(let t of e.segs)n[t.col].segs.push(t)}else for(let r=0;r<t;r+=1)n[r]=null;return n}class Za extends Ln{render(){let{props:e}=this;return b(Jo,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>ul(e.hiddenSegs,e),defaultGenerator:el,forceTimed:!0},e=>b(e,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]}))}}function el(e){return e.shortText}function tl(e,t,n){let r=new Ki;null!=t&&(r.strictOrder=t),null!=n&&(r.maxStackCnt=n);let i=function(e){let t=[];for(let n of e){let e=[],r={span:n.span,entries:[n]};for(let n of t)Xi(n.span,r.span)?r={entries:n.entries.concat(r.entries),span:Ji(n.span,r.span)}:e.push(n);e.push(r),t=e}return t}(r.addSegs(e)),o=function(e){const{entriesByLevel:t}=e,n=ol((e,t)=>e+":"+t,(r,i)=>{let o=function(e,t,n){let{levelCoords:r,entriesByLevel:i}=e,o=i[t][n],s=r[t]+o.thickness,a=r.length,l=t;for(;l<a&&r[l]<s;l+=1);for(;l<a;l+=1){let e,t=i[l],n=eo(t,o.span.start,Qi),r=n[0]+n[1],s=r;for(;(e=t[s])&&e.span.start<o.span.end;)s+=1;if(r<s)return{level:l,lateralStart:r,lateralEnd:s}}return null}(e,r,i),s=nl(o,n),a=t[r][i];return[Object.assign(Object.assign({},a),{nextLevelNodes:s[0]}),a.thickness+s[1]]});return nl(t.length?{level:0,lateralStart:0,lateralEnd:t[0].length}:null,n)[0]}(r);return o=function(e,t){const n=ol((e,t,n)=>Yi(e),(e,r,i)=>{let o,{nextLevelNodes:s,thickness:a}=e,l=a+i,c=a/l,u=[];if(s.length)for(let t of s)if(void 0===o){let e=n(t,r,l);o=e[0],u.push(e[1])}else{let e=n(t,o,0);u.push(e[1])}else o=t;let d=(o-r)*c;return[o-d,Object.assign(Object.assign({},e),{thickness:d,nextLevelNodes:u})]});return e.map(e=>n(e,0,0)[1])}(o,1),{segRects:function(e){let t=[];const n=ol((e,t,n)=>Yi(e),(e,n,i)=>{let o=Object.assign(Object.assign({},e),{levelCoord:n,stackDepth:i,stackForward:0});return t.push(o),o.stackForward=r(e.nextLevelNodes,n+e.thickness,i+1)+1});function r(e,t,r){let i=0;for(let o of e)i=Math.max(n(o,t,r),i);return i}return r(e,0,0),t}(o),hiddenGroups:i}}function nl(e,t){if(!e)return[[],0];let{level:n,lateralStart:r,lateralEnd:i}=e,o=r,s=[];for(;o<i;)s.push(t(n,o)),o+=1;return s.sort(rl),[s.map(il),s[0][1]]}function rl(e,t){return t[1]-e[1]}function il(e){return e[0]}function ol(e,t){const n={};return function(){let r=e(...arguments);return r in n?n[r]:n[r]=t(...arguments)}}function sl(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=[];if(n)for(let o=0;o<e.length;o+=1){let s=e[o],a=n.computeDateTop(s.start,t),l=Math.max(a+(r||0),n.computeDateTop(s.end,t));i.push({start:Math.round(a),end:Math.round(l)})}return i}const al=nn({hour:"numeric",minute:"2-digit",meridiem:!1});class ll extends Ln{render(){return b(Uo,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:al}))}}class cl extends Ln{constructor(){super(...arguments),this.sortEventSegs=Bt(Xr)}render(){let{props:e,context:t}=this,{options:n}=t,r=n.selectMirror,i=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||r&&e.dateSelectionSegs||[],o=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},s=this.sortEventSegs(e.fgEventSegs,n.eventOrder);return b(Bo,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},t=>b("div",{className:"fc-timegrid-col-frame"},b("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),b("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(s,o,!1,!1,!1)),b("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(i,{},Boolean(e.eventDrag),Boolean(e.eventResize),Boolean(r),"mirror")),b("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),zo(n)&&b(t,{elTag:"div",elClasses:["fc-timegrid-col-misc"]})))}renderFgSegs(e,t,n,r,i,o){let{props:s}=this;return s.forPrint?ul(e,s):this.renderPositionedFgSegs(e,t,n,r,i,o)}renderPositionedFgSegs(e,t,n,r,i,o){let{eventMaxStack:s,eventShortHeight:a,eventOrderStrict:l,eventMinHeight:c}=this.context.options,{date:u,slatCoords:d,eventSelection:h,todayRange:f,nowDate:p}=this.props,g=n||r||i,m=sl(e,u,d,c),{segPlacements:v,hiddenGroups:y}=function(e,t,n,r){let i=[],o=[];for(let c=0;c<e.length;c+=1){let n=t[c];n?i.push({index:c,thickness:1,span:n}):o.push(e[c])}let{segRects:s,hiddenGroups:a}=tl(i,n,r),l=[];for(let c of s)l.push({seg:e[c.index],rect:c});for(let c of o)l.push({seg:c,rect:null});return{segPlacements:l,hiddenGroups:a}}(e,m,l,s);return b(S,null,this.renderHiddenGroups(y,e),v.map(e=>{let{seg:s,rect:l}=e,c=s.eventRange.instance.instanceId,u=g||Boolean(!t[c]&&l),d=dl(l&&l.span),m=!g&&l?this.computeSegHStyle(l):{left:0,right:0},v=Boolean(l)&&l.stackForward>0,y=Boolean(l)&&l.span.end-l.span.start<a;return b("div",{className:"fc-timegrid-event-harness"+(v?" fc-timegrid-event-harness-inset":""),key:o||c,style:Object.assign(Object.assign({visibility:u?"":"hidden"},d),m)},b(ll,Object.assign({seg:s,isDragging:n,isResizing:r,isDateSelecting:i,isSelected:c===h,isShort:y},ii(s,f,p))))}))}renderHiddenGroups(e,t){let{extraDateSpan:n,dateProfile:r,todayRange:i,nowDate:o,eventSelection:s,eventDrag:a,eventResize:l}=this.props;return b(S,null,e.map(e=>{let c=dl(e.span),u=(d=e.entries,h=t,d.map(e=>h[e.index]));var d,h;return b(Za,{key:Ut(es(u)),hiddenSegs:u,top:c.top,bottom:c.bottom,extraDateSpan:n,dateProfile:r,todayRange:i,nowDate:o,eventSelection:s,eventDrag:a,eventResize:l})}))}renderFillSegs(e,t){let{props:n,context:r}=this,i=sl(e,n.date,n.slatCoords,r.options.eventMinHeight).map((r,i)=>{let o=e[i];return b("div",{key:si(o.eventRange),className:"fc-timegrid-bg-harness",style:dl(r)},"bg-event"===t?b(Vo,Object.assign({seg:o},ii(o,n.todayRange,n.nowDate))):$o(t))});return b(S,null,i)}renderNowIndicator(e){let{slatCoords:t,date:n}=this.props;return t?e.map((e,r)=>b(Ho,{key:r,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:t.computeDateTop(e.start,n)},isAxis:!1,date:n})):null}computeSegHStyle(e){let t,n,{isRtl:r,options:i}=this.context,o=i.slotEventOverlap,s=e.levelCoord,a=e.levelCoord+e.thickness;o&&(a=Math.min(1,s+2*(a-s))),r?(t=1-a,n=s):(t=s,n=1-a);let l={zIndex:e.stackDepth+1,left:100*t+"%",right:100*n+"%"};return o&&!e.stackForward&&(l[r?"marginLeft":"marginRight"]=20),l}}function ul(e,t){let{todayRange:n,nowDate:r,eventSelection:i,eventDrag:o,eventResize:s}=t,a=(o?o.affectedInstances:null)||(s?s.affectedInstances:null)||{};return b(S,null,e.map(e=>{let t=e.eventRange.instance.instanceId;return b("div",{key:t,style:{visibility:a[t]?"hidden":""}},b(ll,Object.assign({seg:e,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:t===i,isShort:!1},ii(e,n,r))))}))}function dl(e){return e?{top:e.start,bottom:-e.end}:{top:"",bottom:""}}class hl extends Ln{constructor(){super(...arguments),this.splitFgEventSegs=Bt(Ja),this.splitBgEventSegs=Bt(Ja),this.splitBusinessHourSegs=Bt(Ja),this.splitNowIndicatorSegs=Bt(Ja),this.splitDateSelectionSegs=Bt(Ja),this.splitEventDrag=Bt(Xa),this.splitEventResize=Bt(Xa),this.rootElRef={current:null},this.cellElRefs=new _o}render(){let{props:e,context:t}=this,n=t.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),r=e.cells.length,i=this.splitFgEventSegs(e.fgEventSegs,r),o=this.splitBgEventSegs(e.bgEventSegs,r),s=this.splitBusinessHourSegs(e.businessHourSegs,r),a=this.splitNowIndicatorSegs(e.nowIndicatorSegs,r),l=this.splitDateSelectionSegs(e.dateSelectionSegs,r),c=this.splitEventDrag(e.eventDrag,r),u=this.splitEventResize(e.eventResize,r);return b("div",{className:"fc-timegrid-cols",ref:this.rootElRef},b("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,b("tbody",{role:"presentation"},b("tr",{role:"row"},e.axis&&b("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},b("div",{className:"fc-timegrid-col-frame"},b("div",{className:"fc-timegrid-now-indicator-container"},"number"===typeof n&&b(Ho,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:n},isAxis:!0,date:e.nowDate})))),e.cells.map((t,n)=>b(cl,{key:t.key,elRef:this.cellElRefs.createRef(t.key),dateProfile:e.dateProfile,date:t.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:t.extraRenderProps,extraDataAttrs:t.extraDataAttrs,extraClassNames:t.extraClassNames,extraDateSpan:t.extraDateSpan,fgEventSegs:i[n],bgEventSegs:o[n],businessHourSegs:s[n],nowIndicatorSegs:a[n],dateSelectionSegs:l[n],eventDrag:c[n],eventResize:u[n],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint}))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;var t;e.onColCoords&&null!==e.clientWidth&&e.onColCoords(new zi(this.rootElRef.current,(t=this.cellElRefs.currentMap,e.cells.map(e=>t[e.key])),!0,!1))}}class fl extends Gi{constructor(){super(...arguments),this.processSlotOptions=Bt(pl),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:t}=this.props,{slatCoords:n}=this.state;if(t&&n){if(e.time){let r=n.computeTimeTop(e.time);r=Math.ceil(r),r&&(r+=1),t(r)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:t}=this;return b("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},b(Ya,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),b(hl,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:t.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,t){let{dateEnv:n,options:r}=this.context,{colCoords:i}=this,{dateProfile:o}=this.props,{slatCoords:s}=this.state,{snapDuration:a,snapsPerSlot:l}=this.processSlotOptions(this.props.slotDuration,r.snapDuration),c=i.leftToIndex(e),u=s.positions.topToIndex(t);if(null!=c&&null!=u){let e=this.props.cells[c],r=s.positions.tops[u],d=s.positions.getHeight(u),h=(t-r)/d,f=u*l+Math.floor(h*l),p=this.props.cells[c].date,g=vt(o.slotMinTime,function(e,t){return{years:e.years*t,months:e.months*t,days:e.days*t,milliseconds:e.milliseconds*t}}(a,f)),m=n.add(p,g),v=n.add(m,a);return{dateProfile:o,dateSpan:Object.assign({range:{start:m,end:v},allDay:!1},e.extraDateSpan),dayEl:i.els[c],rect:{left:i.lefts[c],right:i.rights[c],top:r,bottom:r+d},layer:0}}return null}}function pl(e,t){let n=t||e,r=bt(e,n);return null===r&&(n=e,r=1),{snapDuration:n,snapsPerSlot:r}}class gl extends po{sliceRange(e,t){let n=[];for(let r=0;r<t.length;r+=1){let i=Qn(e,t[r]);i&&n.push({start:i.start,end:i.end,isStart:i.start.valueOf()===e.start.valueOf(),isEnd:i.end.valueOf()===e.end.valueOf(),col:r})}return n}}class ml extends Gi{constructor(){super(...arguments),this.buildDayRanges=Bt(vl),this.slicer=new gl,this.timeColsRef={current:null}}render(){let{props:e,context:t}=this,{dateProfile:n,dayTableModel:r}=e,{nowIndicator:i,nextDayThreshold:o}=t.options,s=this.buildDayRanges(r,n,t.dateEnv);return b(Ci,{unit:i?"minute":"day"},(a,l)=>b(fl,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,n,null,t,s),{forPrint:e.forPrint,axis:e.axis,dateProfile:n,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:r.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:a,nowIndicatorSegs:i&&this.slicer.sliceNowDate(a,n,o,t,s),todayRange:l,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords})))}}function vl(e,t,n){let r=[];for(let i of e.headerDates)r.push({start:n.add(i,t.slotMinTime),end:n.add(i,t.slotMaxTime)});return r}const yl=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function wl(e,t,n,r,i){let o=new Date(0),s=e,a=gt(0),l=n||function(e){let t,n,r;for(t=yl.length-1;t>=0;t-=1)if(n=gt(yl[t]),r=bt(n,e),null!==r&&r>1)return n;return e}(r),c=[];for(;wt(s)<wt(t);){let e=i.add(o,s),t=null!==bt(a,l);c.push({date:e,time:s,key:e.toISOString(),isoTimeStr:Ht(e),isLabeled:t}),s=vt(s,r),a=vt(a,r)}return c}function bl(e,t){let n=new ho(e.renderRange,t);return new fo(n,!1)}Me('.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-arrow,.fc .fc-timegrid-now-indicator-line{pointer-events:none}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}');var Cl=ds({name:"@fullcalendar/timegrid",initialView:"timeGridWeek",optionRefiners:{allDaySlot:Boolean},views:{timeGrid:{component:class extends $a{constructor(){super(...arguments),this.buildTimeColsModel=Bt(bl),this.buildSlatMetas=Bt(wl)}render(){let{options:e,dateEnv:t,dateProfileGenerator:n}=this.context,{props:r}=this,{dateProfile:i}=r,o=this.buildTimeColsModel(i,n),s=this.allDaySplitter.splitProps(r),a=this.buildSlatMetas(i.slotMinTime,i.slotMaxTime,e.slotLabelInterval,e.slotDuration,t),{dayMinWidth:l}=e,c=!l,u=l,d=e.dayHeaders&&b(co,{dates:o.headerDates,dateProfile:i,datesRepDistinctDays:!0,renderIntro:c?this.renderHeadAxis:null}),h=!1!==e.allDaySlot&&(t=>b(Ha,Object.assign({},s.allDay,{dateProfile:i,dayTableModel:o,nextDayThreshold:e.nextDayThreshold,tableMinWidth:t.tableMinWidth,colGroupNode:t.tableColGroupNode,renderRowIntro:c?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:r.forPrint},this.getAllDayMaxEventProps()))),f=t=>b(ml,Object.assign({},s.timed,{dayTableModel:o,dateProfile:i,axis:c,slotDuration:e.slotDuration,slatMetas:a,forPrint:r.forPrint,tableColGroupNode:t.tableColGroupNode,tableMinWidth:t.tableMinWidth,clientWidth:t.clientWidth,clientHeight:t.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:t.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return u?this.renderHScrollLayout(d,h,f,o.colCnt,l,a,this.state.slatCoords):this.renderSimpleLayout(d,h,f)}},usesMinMaxTime:!0,allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0},timeGridDay:{type:"timeGrid",duration:{days:1}},timeGridWeek:{type:"timeGrid",duration:{weeks:1}}}});no.touchMouseIgnoreWait=500;let Sl=0,El=0,Tl=!1;class _l{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=e=>{if(!this.shouldIgnoreMouse()&&function(e){return 0===e.button&&!e.ctrlKey}(e)&&this.tryStart(e)){let t=this.createEventFromMouse(e,!0);this.emitter.trigger("pointerdown",t),this.initScrollWatch(t),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=e=>{let t=this.createEventFromMouse(e);this.recordCoords(t),this.emitter.trigger("pointermove",t)},this.handleMouseUp=e=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(e)),this.cleanup()},this.handleTouchStart=e=>{if(this.tryStart(e)){this.isTouchDragging=!0;let t=this.createEventFromTouch(e,!0);this.emitter.trigger("pointerdown",t),this.initScrollWatch(t);let n=e.target;this.shouldIgnoreMove||n.addEventListener("touchmove",this.handleTouchMove),n.addEventListener("touchend",this.handleTouchEnd),n.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=e=>{let t=this.createEventFromTouch(e);this.recordCoords(t),this.emitter.trigger("pointermove",t)},this.handleTouchEnd=e=>{if(this.isDragging){let t=e.target;t.removeEventListener("touchmove",this.handleTouchMove),t.removeEventListener("touchend",this.handleTouchEnd),t.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(e)),this.cleanup(),this.isTouchDragging=!1,Sl+=1,setTimeout(()=>{Sl-=1},no.touchMouseIgnoreWait)}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=e=>{if(!this.shouldIgnoreMove){let t=window.scrollX-this.prevScrollX+this.prevPageX,n=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:e,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:t,pageY:n,deltaX:t-this.origPageX,deltaY:n-this.origPageY})}},this.containerEl=e,this.emitter=new Nr,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),El+=1,1===El&&window.addEventListener("touchmove",Il,{passive:!1})}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),El-=1,El||window.removeEventListener("touchmove",Il,{passive:!1})}tryStart(e){let t=this.querySubjectEl(e),n=e.target;return!(!t||this.handleSelector&&!Be(n,this.handleSelector))&&(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0)}cleanup(){Tl=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?Be(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return Sl||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(Tl=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let n=0,r=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(n=e.pageX-this.origPageX,r=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:n,deltaY:r}}createEventFromTouch(e,t){let n,r,i=e.touches,o=0,s=0;return i&&i.length?(n=i[0].pageX,r=i[0].pageY):(n=e.pageX,r=e.pageY),t?(this.origPageX=n,this.origPageY=r):(o=n-this.origPageX,s=r-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:n,pageY:r,deltaX:o,deltaY:s}}}function Il(e){Tl&&e.preventDefault()}class Al{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,n){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=n-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let n=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(n,this.revertDuration):setTimeout(n,0)}doRevertAnimation(e,t){let n=this.mirrorEl,r=this.sourceEl.getBoundingClientRect();n.style.transition="top "+t+"ms,left "+t+"ms",Ve(n,{left:r.left,top:r.top}),function(e,t){let n=r=>{t(r),Je.forEach(t=>{e.removeEventListener(t,n)})};Je.forEach(t=>{e.addEventListener(t,n)})}(n,()=>{n.style.transition="",e()})}cleanup(){this.mirrorEl&&(je(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&Ve(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),Ve(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class kl extends Vi{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class Rl extends kl{constructor(e,t){super(new Wi(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return Hi(this.scrollController.el)}}class Dl extends kl{constructor(e){super(new $i,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const Pl="function"===typeof performance?performance.now:Date.now;class xl{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=Pl();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,n){this.isEnabled&&(this.scrollCaches=this.buildCaches(n),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let n=e-window.scrollX,r=t-window.scrollY,i=null===this.pointerScreenY?0:r-this.pointerScreenY,o=null===this.pointerScreenX?0:n-this.pointerScreenX;i<0?this.everMovedUp=!0:i>0&&(this.everMovedDown=!0),o<0?this.everMovedLeft=!0:o>0&&(this.everMovedRight=!0),this.pointerScreenX=n,this.pointerScreenY=r,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(Pl()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:n}=e,{edgeThreshold:r}=this,i=r-e.distance,o=i*i/(r*r)*this.maxVelocity*t,s=1;switch(e.name){case"left":s=-1;case"right":n.setScrollLeft(n.getScrollLeft()+o*s);break;case"top":s=-1;case"bottom":n.setScrollTop(n.getScrollTop()+o*s)}}computeBestEdge(e,t){let{edgeThreshold:n}=this,r=null,i=this.scrollCaches||[];for(let o of i){let i=o.clientRect,s=e-i.left,a=i.right-e,l=t-i.top,c=i.bottom-t;s>=0&&a>=0&&l>=0&&c>=0&&(l<=n&&this.everMovedUp&&o.canScrollUp()&&(!r||r.distance>l)&&(r={scrollCache:o,name:"top",distance:l}),c<=n&&this.everMovedDown&&o.canScrollDown()&&(!r||r.distance>c)&&(r={scrollCache:o,name:"bottom",distance:c}),s<=n&&this.everMovedLeft&&o.canScrollLeft()&&(!r||r.distance>s)&&(r={scrollCache:o,name:"left",distance:s}),a<=n&&this.everMovedRight&&o.canScrollRight()&&(!r||r.distance>a)&&(r={scrollCache:o,name:"right",distance:a}))}return r}buildCaches(e){return this.queryScrollEls(e).map(e=>e===window?new Dl(!1):new Rl(e,!1))}queryScrollEls(e){let t=[];for(let n of this.scrollQuery)"object"===typeof n?t.push(n):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(n)));return t}}class Ol extends to{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=e=>{var t;this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,(t=document.body).style.userSelect="none",t.style.webkitUserSelect="none",t.addEventListener("selectstart",Qe),function(e){e.addEventListener("contextmenu",Qe)}(document.body),e.isTouch||e.origEvent.preventDefault(),this.emitter.trigger("pointerdown",e),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(e.subjectEl,e.pageX,e.pageY),this.startDelay(e),this.minDistance||this.handleDistanceSurpassed(e)))},this.onPointerMove=e=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",e),!this.isDistanceSurpassed){let t,n=this.minDistance,{deltaX:r,deltaY:i}=e;t=r*r+i*i,t>=n*n&&this.handleDistanceSurpassed(e)}this.isDragging&&("scroll"!==e.origEvent.type&&(this.mirror.handleMove(e.pageX,e.pageY),this.autoScroller.handleMove(e.pageX,e.pageY)),this.emitter.trigger("dragmove",e))}},this.onPointerUp=e=>{var t;this.isInteracting&&(this.isInteracting=!1,(t=document.body).style.userSelect="",t.style.webkitUserSelect="",t.removeEventListener("selectstart",Qe),function(e){e.removeEventListener("contextmenu",Qe)}(document.body),this.emitter.trigger("pointerup",e),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(e)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let n=this.pointer=new _l(e);n.emitter.on("pointerdown",this.onPointerDown),n.emitter.on("pointermove",this.onPointerMove),n.emitter.on("pointerup",this.onPointerUp),t&&(n.selector=t),this.mirror=new Al,this.autoScroller=new xl}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){"number"===typeof this.delay?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(this.pointer.wasTouchScroll&&!this.touchScrollAllowed||(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),!1===this.touchScrollAllowed&&this.pointer.cancelTouchScroll()))}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class Nl{constructor(e){this.el=e,this.origRect=ji(e),this.scrollCaches=Bi(e).map(e=>new Rl(e,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let n={left:e,top:t};for(let r of this.scrollCaches)if(!Ml(r.getEventTarget())&&!Ti(n,r.clientRect))return!1;return!0}}function Ml(e){let t=e.tagName;return"HTML"===t||"BODY"===t}class Ll{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=e=>{let{dragging:t}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(e),this.initialHit||!this.requireInitial?(t.setIgnoreMove(!1),this.emitter.trigger("pointerdown",e)):t.setIgnoreMove(!0)},this.handleDragStart=e=>{this.emitter.trigger("dragstart",e),this.handleMove(e,!0)},this.handleDragMove=e=>{this.emitter.trigger("dragmove",e),this.handleMove(e)},this.handlePointerUp=e=>{this.releaseHits(),this.emitter.trigger("pointerup",e)},this.handleDragEnd=e=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,e),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",e)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Nr}processFirstCoord(e){let t,n={left:e.pageX,top:e.pageY},r=n,i=e.subjectEl;var o,s;i instanceof HTMLElement&&(t=ji(i),o=r,s=t,r={left:Math.min(Math.max(o.left,s.left),s.right),top:Math.min(Math.max(o.top,s.top),s.bottom)});let a=this.initialHit=this.queryHitForOffset(r.left,r.top);if(a){if(this.useSubjectCenter&&t){let e=_i(t,a.rect);e&&(r=function(e){return{left:(e.left+e.right)/2,top:(e.top+e.bottom)/2}}(e))}this.coordAdjust=(c=n,{left:(l=r).left-c.left,top:l.top-c.top})}else this.coordAdjust={left:0,top:0};var l,c}handleMove(e,t){let n=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);!t&&Ul(this.movingHit,n)||(this.movingHit=n,this.emitter.trigger("hitupdate",n,!1,e))}prepareHits(){this.offsetTrackers=yn(this.droppableStore,e=>(e.component.prepareHits(),new Nl(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:n,offsetTrackers:r}=this,i=null;for(let o in n){let s=n[o].component,a=r[o];if(a&&a.isWithinClipping(e,t)){let n=a.computeLeft(),r=a.computeTop(),l=e-n,c=t-r,{origRect:u}=a,d=u.right-u.left,h=u.bottom-u.top;if(l>=0&&l<d&&c>=0&&c<h){let e=s.queryHit(l,c,d,h);e&&Xn(e.dateProfile.activeRange,e.dateSpan.range)&&(this.disablePointCheck||a.el.contains(a.el.getRootNode().elementFromPoint(l+n-window.scrollX,c+r-window.scrollY)))&&(!i||e.layer>i.layer)&&(e.componentId=o,e.context=s.context,e.rect.left+=n,e.rect.right+=n,e.rect.top+=r,e.rect.bottom+=r,i=e)}}}return i}}function Ul(e,t){return!e&&!t||Boolean(e)===Boolean(t)&&(n=e.dateSpan,r=t.dateSpan,Yn(n.range,r.range)&&n.allDay===r.allDay&&function(e,t){for(let n in t)if("range"!==n&&"allDay"!==n&&e[n]!==t[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}(n,r));var n,r}function Fl(e,t){let n={};for(let o of t.pluginHooks.datePointTransforms)Object.assign(n,o(e,t));var r,i;return Object.assign(n,(r=e,{date:(i=t.dateEnv).toDate(r.range.start),dateStr:i.formatIso(r.range.start,{omitTime:r.allDay}),allDay:r.allDay})),n}class Hl extends yi{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=e=>{let t=e.origEvent.target,{component:n,dragging:r}=this,{mirror:i}=r,{options:o}=n.context,s=n.context;this.subjectEl=e.subjectEl;let a=this.subjectSeg=Qr(e.subjectEl),l=(this.eventRange=a.eventRange).instance.instanceId;this.relevantEvents=mr(s.getCurrentData().eventStore,l),r.minDistance=e.isTouch?0:o.eventDragMinDistance,r.delay=e.isTouch&&l!==n.props.eventSelection?function(e){let{options:t}=e.context,n=t.eventLongPressDelay;null==n&&(n=t.longPressDelay);return n}(n):null,o.fixedMirrorParent?i.parentNode=o.fixedMirrorParent:i.parentNode=Be(t,".fc"),i.revertDuration=o.dragRevertDuration;let c=n.isValidSegDownEl(t)&&!Be(t,".fc-event-resizer");r.setIgnoreMove(!c),this.isDragging=c&&e.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=e=>{let t=this.component.context,n=this.eventRange,r=n.instance.instanceId;e.isTouch?r!==this.component.props.eventSelection&&t.dispatch({type:"SELECT_EVENT",eventInstanceId:r}):t.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(t.calendarApi.unselect(e),t.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new Vr(t,n.def,n.instance),jsEvent:e.origEvent,view:t.viewApi}))},this.handleHitUpdate=(e,t)=>{if(!this.isDragging)return;let n=this.relevantEvents,r=this.hitDragging.initialHit,i=this.component.context,o=null,s=null,a=null,l=!1,c={affectedEvents:n,mutatedEvents:{defs:{},instances:{}},isEvent:!0};if(e){o=e.context;let t=o.options;i===o||t.editable&&t.droppable?(s=function(e,t,n,r){let i=e.dateSpan,o=t.dateSpan,s=i.range.start,a=o.range.start,l={};i.allDay!==o.allDay&&(l.allDay=o.allDay,l.hasEnd=t.context.options.allDayMaintainDuration,s=o.allDay?kt(n):n);let c=nr(s,a,e.context.dateEnv,e.componentId===t.componentId?e.largeUnit:null);c.milliseconds&&(l.allDay=!1);let u={datesDelta:c,standardProps:l};for(let d of r)d(u,e,t);return u}(r,e,this.eventRange.instance.range.start,o.getCurrentData().pluginHooks.eventDragMutationMassagers),s&&(a=jr(n,o.getCurrentData().eventUiBases,s,o),c.mutatedEvents=a,mo(c,e.dateProfile,o)||(l=!0,s=null,a=null,c.mutatedEvents={defs:{},instances:{}}))):o=null}this.displayDrag(o,c),l?nt():rt(),t||(i===o&&Ul(r,e)&&(s=null),this.dragging.setMirrorNeedsRevert(!s),this.dragging.setMirrorIsVisible(!e||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=o,this.validMutation=s,this.mutatedRelevantEvents=a)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=e=>{if(this.isDragging){let t=this.component.context,n=t.viewApi,{receivingContext:r,validMutation:i}=this,o=this.eventRange.def,s=this.eventRange.instance,a=new Vr(t,o,s),l=this.relevantEvents,c=this.mutatedRelevantEvents,{finalHit:u}=this.hitDragging;if(this.clearDrag(),t.emitter.trigger("eventDragStop",{el:this.subjectEl,event:a,jsEvent:e.origEvent,view:n}),i){if(r===t){let r=new Vr(t,c.defs[o.defId],s?c.instances[s.instanceId]:null);t.dispatch({type:"MERGE_EVENTS",eventStore:c});let u={oldEvent:a,event:r,relatedEvents:$r(c,t,s),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})}},d={};for(let e of t.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(d,e(i,t));t.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},u),d),{el:e.subjectEl,delta:i.datesDelta,jsEvent:e.origEvent,view:n})),t.emitter.trigger("eventChange",u)}else if(r){let i={event:a,relatedEvents:$r(l,t,s),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:l})}};t.emitter.trigger("eventLeave",Object.assign(Object.assign({},i),{draggedEl:e.subjectEl,view:n})),t.dispatch({type:"REMOVE_EVENTS",eventStore:l}),t.emitter.trigger("eventRemove",i);let d=c.defs[o.defId],h=c.instances[s.instanceId],f=new Vr(r,d,h);r.dispatch({type:"MERGE_EVENTS",eventStore:c});let p={event:f,relatedEvents:$r(c,r,h),revert(){r.dispatch({type:"REMOVE_EVENTS",eventStore:c})}};r.emitter.trigger("eventAdd",p),e.isTouch&&r.dispatch({type:"SELECT_EVENT",eventInstanceId:s.instanceId}),r.emitter.trigger("drop",Object.assign(Object.assign({},Fl(u.dateSpan,r)),{draggedEl:e.subjectEl,jsEvent:e.origEvent,view:u.context.viewApi})),r.emitter.trigger("eventReceive",Object.assign(Object.assign({},p),{draggedEl:e.subjectEl,view:u.context.viewApi}))}}else t.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:n}=t.context,r=this.dragging=new Ol(e.el);r.pointer.selector=Hl.SELECTOR,r.touchScrollAllowed=!1,r.autoScroller.isEnabled=n.dragScroll;let i=this.hitDragging=new Ll(this.dragging,bi);i.useSubjectCenter=e.useEventCenter,i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("pointerup",this.handlePointerUp),i.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let n=this.component.context,r=this.receivingContext;r&&r!==e&&(r===n?r.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:{defs:{},instances:{}},isEvent:!0}}):r.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}Hl.SELECTOR=".fc-event-draggable, .fc-event-resizable";const jl={fixedMirrorParent:pn},Bl={dateClick:pn,eventDragStart:pn,eventDragStop:pn,eventDrop:pn,eventResizeStart:pn,eventResizeStop:pn,eventResize:pn,drop:pn,eventReceive:pn,eventLeave:pn};no.dataAttrPrefix="";var zl=ds({name:"@fullcalendar/interaction",componentInteractions:[class extends yi{constructor(e){super(e),this.handlePointerDown=e=>{let{dragging:t}=this,n=e.origEvent.target;t.setIgnoreMove(!this.component.isValidDateDownEl(n))},this.handleDragEnd=e=>{let{component:t}=this,{pointer:n}=this.dragging;if(!n.wasTouchScroll){let{initialHit:n,finalHit:r}=this.hitDragging;if(n&&r&&Ul(n,r)){let{context:r}=t,i=Object.assign(Object.assign({},Fl(n.dateSpan,r)),{dayEl:n.dayEl,jsEvent:e.origEvent,view:r.viewApi||r.calendarApi.view});r.emitter.trigger("dateClick",i)}}},this.dragging=new Ol(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new Ll(this.dragging,wi(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}},class extends yi{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=e=>{let{component:t,dragging:n}=this,{options:r}=t.context,i=r.selectable&&t.isValidDateDownEl(e.origEvent.target);n.setIgnoreMove(!i),n.delay=e.isTouch?function(e){let{options:t}=e.context,n=t.selectLongPressDelay;null==n&&(n=t.longPressDelay);return n}(t):null},this.handleDragStart=e=>{this.component.context.calendarApi.unselect(e)},this.handleHitUpdate=(e,t)=>{let{context:n}=this.component,r=null,i=!1;if(e){let t=this.hitDragging.initialHit;e.componentId===t.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(t,e)||(r=function(e,t,n){let r=e.dateSpan,i=t.dateSpan,o=[r.range.start,r.range.end,i.range.start,i.range.end];o.sort(ut);let s={};for(let a of n){let n=a(e,t);if(!1===n)return null;n&&Object.assign(s,n)}return s.range={start:o[0],end:o[3]},s.allDay=r.allDay,s}(t,e,n.pluginHooks.dateSelectionTransformers)),r&&function(e,t,n){return!!Xn(t.validRange,e.range)&&vo({dateSelection:e},n)}(r,e.dateProfile,n)||(i=!0,r=null)}r?n.dispatch({type:"SELECT_DATES",selection:r}):t||n.dispatch({type:"UNSELECT_DATES"}),i?nt():rt(),t||(this.dragSelection=r)},this.handlePointerUp=e=>{this.dragSelection&&(Ur(this.dragSelection,e,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:n}=t.context,r=this.dragging=new Ol(e.el);r.touchScrollAllowed=!1,r.minDistance=n.selectMinDistance||0,r.autoScroller.isEnabled=n.dragScroll;let i=this.hitDragging=new Ll(this.dragging,wi(e));i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}},Hl,class extends yi{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=e=>{let{component:t}=this,n=Qr(this.querySegEl(e)),r=this.eventRange=n.eventRange;this.dragging.minDistance=t.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(e.origEvent.target)||e.isTouch&&this.component.props.eventSelection!==r.instance.instanceId)},this.handleDragStart=e=>{let{context:t}=this.component,n=this.eventRange;this.relevantEvents=mr(t.getCurrentData().eventStore,this.eventRange.instance.instanceId);let r=this.querySegEl(e);this.draggingSegEl=r,this.draggingSeg=Qr(r),t.calendarApi.unselect(),t.emitter.trigger("eventResizeStart",{el:r,event:new Vr(t,n.def,n.instance),jsEvent:e.origEvent,view:t.viewApi})},this.handleHitUpdate=(e,t,n)=>{let{context:r}=this.component,i=this.relevantEvents,o=this.hitDragging.initialHit,s=this.eventRange.instance,a=null,l=null,c=!1,u={affectedEvents:i,mutatedEvents:{defs:{},instances:{}},isEvent:!0};if(e){e.componentId===o.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(o,e)||(a=function(e,t,n,r){let i=e.context.dateEnv,o=e.dateSpan.range.start,s=t.dateSpan.range.start,a=nr(o,s,i,e.largeUnit);if(n){if(i.add(r.start,a)<r.end)return{startDelta:a}}else if(i.add(r.end,a)>r.start)return{endDelta:a};return null}(o,e,n.subjectEl.classList.contains("fc-event-resizer-start"),s.range))}a&&(l=jr(i,r.getCurrentData().eventUiBases,a,r),u.mutatedEvents=l,mo(u,e.dateProfile,r)||(c=!0,a=null,l=null,u.mutatedEvents=null)),l?r.dispatch({type:"SET_EVENT_RESIZE",state:u}):r.dispatch({type:"UNSET_EVENT_RESIZE"}),c?nt():rt(),t||(a&&Ul(o,e)&&(a=null),this.validMutation=a,this.mutatedRelevantEvents=l)},this.handleDragEnd=e=>{let{context:t}=this.component,n=this.eventRange.def,r=this.eventRange.instance,i=new Vr(t,n,r),o=this.relevantEvents,s=this.mutatedRelevantEvents;if(t.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:i,jsEvent:e.origEvent,view:t.viewApi}),this.validMutation){let a=new Vr(t,s.defs[n.defId],r?s.instances[r.instanceId]:null);t.dispatch({type:"MERGE_EVENTS",eventStore:s});let l={oldEvent:i,event:a,relatedEvents:$r(s,t,r),revert(){t.dispatch({type:"MERGE_EVENTS",eventStore:o})}};t.emitter.trigger("eventResize",Object.assign(Object.assign({},l),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||gt(0),endDelta:this.validMutation.endDelta||gt(0),jsEvent:e.origEvent,view:t.viewApi})),t.emitter.trigger("eventChange",l)}else t.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,n=this.dragging=new Ol(e.el);n.pointer.selector=".fc-event-resizer",n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.context.options.dragScroll;let r=this.hitDragging=new Ll(this.dragging,wi(e));r.emitter.on("pointerdown",this.handlePointerDown),r.emitter.on("dragstart",this.handleDragStart),r.emitter.on("hitupdate",this.handleHitUpdate),r.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return Be(e.subjectEl,".fc-event")}}],calendarInteractions:[class{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=e=>{e.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=e=>{let t=this.context.options.unselectCancel,n=$e(e.origEvent);this.matchesCancel=!!Be(n,t),this.matchesEvent=!!Be(n,Hl.SELECTOR)},this.onDocumentPointerUp=e=>{let{context:t}=this,{documentPointer:n}=this,r=t.getCurrentData();if(!n.wasTouchScroll){if(r.dateSelection&&!this.isRecentPointerDateSelect){let n=t.options.unselectAuto;!n||n&&this.matchesCancel||t.calendarApi.unselect(e)}r.eventSelection&&!this.matchesEvent&&t.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new _l(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}],elementDraggingImpl:Ol,optionRefiners:jl,listenerRefiners:Bl});const ql=["GPL-My-Project-Is-Open-Source","CC-Attribution-NonCommercial-NoDerivatives"],Vl={position:"absolute",zIndex:99999,bottom:"1px",left:"1px",background:"#eee",borderColor:"#ddd",borderStyle:"solid",borderWidth:"1px 1px 0 0",padding:"2px 4px",fontSize:"12px",borderTopRightRadius:"3px"};var Wl=ds({name:"@fullcalendar/premium-common",premiumReleaseDate:"2025-06-30",optionRefiners:{schedulerLicenseKey:String},viewContainerAppends:[function(e){let t=e.options.schedulerLicenseKey,n="undefined"!==typeof window?window.location.href:"";if(!/\w+:\/\/fullcalendar\.io\/|\/examples\/[\w-]+\.html$/.test(n)){let n=function(e,t){if(-1!==ql.indexOf(e))return"valid";const n=(e||"").match(/^(\d+)-fcs-(\d+)$/);if(n&&10===n[1].length){const e=new Date(1e3*parseInt(n[2],10)),r=no.mockSchedulerReleaseDate||t;if(Mt(r)){return Tt(r,-372)<e?"valid":"outdated"}}return"invalid"}(t,e.pluginHooks.premiumReleaseDate);if("valid"!==n)return b("div",{className:"fc-license-message",style:Vl},"outdated"===n?b(S,null,"Your license key is too old to work with this version. ",b("a",{href:"https://fullcalendar.io/docs/schedulerLicenseKey#outdated"},"More Info")):b(S,null,"Your license key is invalid. ",b("a",{href:"https://fullcalendar.io/docs/schedulerLicenseKey#invalid"},"More Info")))}return null}]});const $l="_fc:",Gl={id:String,parentId:String,children:pn,title:String,businessHours:pn,extendedProps:pn,eventEditable:Boolean,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventConstraint:pn,eventOverlap:Boolean,eventAllow:pn,eventClassNames:br,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String};function Kl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,{refined:i,extra:o}=fn(e,Gl),s={id:i.id||$l+tt(),parentId:i.parentId||t,title:i.title||"",businessHours:i.businessHours?Lr(i.businessHours,r):null,ui:Er({editable:i.eventEditable,startEditable:i.eventStartEditable,durationEditable:i.eventDurationEditable,constraint:i.eventConstraint,overlap:i.eventOverlap,allow:i.eventAllow,classNames:i.eventClassNames,backgroundColor:i.eventBackgroundColor,borderColor:i.eventBorderColor,textColor:i.eventTextColor,color:i.eventColor},r),extendedProps:Object.assign(Object.assign({},o),i.extendedProps)};if(Object.freeze(s.ui.classNames),Object.freeze(s.extendedProps),n[s.id]);else if(n[s.id]=s,i.children)for(let a of i.children)Kl(a,s.id,n,r);return s}class Ql{constructor(e,t){this._context=e,this._resource=t}setProp(e,t){let n=this._resource;this._context.dispatch({type:"SET_RESOURCE_PROP",resourceId:n.id,propName:e,propValue:t}),this.sync(n)}setExtendedProp(e,t){let n=this._resource;this._context.dispatch({type:"SET_RESOURCE_EXTENDED_PROP",resourceId:n.id,propName:e,propValue:t}),this.sync(n)}sync(e){let t=this._context,n=e.id;this._resource=t.getCurrentData().resourceStore[n],t.emitter.trigger("resourceChange",{oldResource:new Ql(t,e),resource:this,revert(){t.dispatch({type:"ADD_RESOURCE",resourceHash:{[n]:e}})}})}remove(){let e=this._context,t=this._resource,n=t.id;e.dispatch({type:"REMOVE_RESOURCE",resourceId:n}),e.emitter.trigger("resourceRemove",{resource:this,revert(){e.dispatch({type:"ADD_RESOURCE",resourceHash:{[n]:t}})}})}getParent(){let e=this._context,t=this._resource.parentId;return t?new Ql(e,e.getCurrentData().resourceStore[t]):null}getChildren(){let e=this._resource.id,t=this._context,{resourceStore:n}=t.getCurrentData(),r=[];for(let i in n)n[i].parentId===e&&r.push(new Ql(t,n[i]));return r}getEvents(){let e=this._resource.id,t=this._context,{defs:n,instances:r}=t.getCurrentData().eventStore,i=[];for(let o in r){let s=r[o],a=n[s.defId];-1!==a.resourceIds.indexOf(e)&&i.push(new Vr(t,a,s))}return i}get id(){return 0===(e=this._resource.id).indexOf($l)?"":e;var e}get title(){return this._resource.title}get eventConstraint(){return this._resource.ui.constraints[0]||null}get eventOverlap(){return this._resource.ui.overlap}get eventAllow(){return this._resource.ui.allows[0]||null}get eventBackgroundColor(){return this._resource.ui.backgroundColor}get eventBorderColor(){return this._resource.ui.borderColor}get eventTextColor(){return this._resource.ui.textColor}get eventClassNames(){return this._resource.ui.classNames}get extendedProps(){return this._resource.extendedProps}toPlainObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._resource,{ui:n}=t,r=this.id,i={};return r&&(i.id=r),t.title&&(i.title=t.title),e.collapseEventColor&&n.backgroundColor&&n.backgroundColor===n.borderColor?i.eventColor=n.backgroundColor:(n.backgroundColor&&(i.eventBackgroundColor=n.backgroundColor),n.borderColor&&(i.eventBorderColor=n.borderColor)),n.textColor&&(i.eventTextColor=n.textColor),n.classNames.length&&(i.eventClassNames=n.classNames),Object.keys(t.extendedProps).length&&(e.collapseExtendedProps?Object.assign(i,t.extendedProps):i.extendedProps=t.extendedProps),i}toJSON(){return this.toPlainObject()}}class Yl extends Ai{getKeyInfo(e){return Object.assign({"":{}},e.resourceStore)}getKeysForDateSpan(e){return[e.resourceId||""]}getKeysForEventDef(e){let t=e.resourceIds;return t.length?t:[""]}}const Jl=it("id,title");class Xl extends Ln{constructor(){super(...arguments),this.refineRenderProps=zt(ec)}render(){const{props:e}=this;return b(On.Consumer,null,t=>{let{options:n}=t,r=this.refineRenderProps({resource:e.resource,date:e.date,context:t});return b(qn,{elRef:e.elRef,elTag:e.elTag,elAttrs:Object.assign(Object.assign({},e.elAttrs),{"data-resource-id":e.resource.id,"data-date":e.date?Ft(e.date):void 0}),elClasses:e.elClasses,elStyle:e.elStyle,renderProps:r,generatorName:"resourceLabelContent",customGenerator:n.resourceLabelContent,defaultGenerator:Zl,classNameGenerator:n.resourceLabelClassNames,didMount:n.resourceLabelDidMount,willUnmount:n.resourceLabelWillUnmount},e.children)})}}function Zl(e){return e.resource.title||e.resource.id}function ec(e){return{resource:new Ql(e.context,e.resource),date:e.date?e.context.dateEnv.toDate(e.date):null,view:e.context.viewApi}}class tc extends Ln{render(){let{props:e}=this;return b(Xl,{elTag:"th",elClasses:["fc-col-header-cell","fc-resource"],elAttrs:{role:"columnheader",colSpan:e.colSpan},resource:e.resource,date:e.date},t=>b("div",{className:"fc-scrollgrid-sync-inner"},b(t,{elTag:"span",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"]})))}}class nc extends Ln{constructor(){super(...arguments),this.buildDateFormat=Bt(rc)}render(){let{props:e,context:t}=this,n=this.buildDateFormat(t.options.dayHeaderFormat,e.datesRepDistinctDays,e.dates.length);return b(Ci,{unit:"day"},(r,i)=>1===e.dates.length?this.renderResourceRow(e.resources,e.dates[0]):t.options.datesAboveResources?this.renderDayAndResourceRows(e.dates,n,i,e.resources):this.renderResourceAndDayRows(e.resources,e.dates,n,i))}renderResourceRow(e,t){let n=e.map(e=>b(tc,{key:e.id,resource:e,colSpan:1,date:t}));return this.buildTr(n,"resources")}renderDayAndResourceRows(e,t,n,r){let i=[],o=[];for(let s of e){i.push(this.renderDateCell(s,t,n,r.length,null,!0));for(let e of r)o.push(b(tc,{key:e.id+":"+s.toISOString(),resource:e,colSpan:1,date:s}))}return b(S,null,this.buildTr(i,"day"),this.buildTr(o,"resources"))}renderResourceAndDayRows(e,t,n,r){let i=[],o=[];for(let s of e){i.push(b(tc,{key:s.id,resource:s,colSpan:t.length,isSticky:!0}));for(let e of t)o.push(this.renderDateCell(e,n,r,1,s))}return b(S,null,this.buildTr(i,"resources"),this.buildTr(o,"day"))}renderDateCell(e,t,n,r,i,o){let{props:s}=this,a=i?`:${i.id}`:"",l=i?{resource:new Ql(this.context,i)}:{},c=i?{"data-resource-id":i.id}:{};return s.datesRepDistinctDays?b(so,{key:e.toISOString()+a,date:e,dateProfile:s.dateProfile,todayRange:n,colCnt:s.dates.length*s.resources.length,dayHeaderFormat:t,colSpan:r,isSticky:o,extraRenderProps:l,extraDataAttrs:c}):b(lo,{key:e.getUTCDay()+a,dow:e.getUTCDay(),dayHeaderFormat:t,colSpan:r,isSticky:o,extraRenderProps:l,extraDataAttrs:c})}buildTr(e,t){let{renderIntro:n}=this.props;return e.length||(e=[b("td",{key:0},"\xa0")]),b("tr",{key:t,role:"row"},n&&n(t),e)}}function rc(e,t,n){return e||ro(t,n)}class ic{constructor(e){let t={},n=[];for(let r=0;r<e.length;r+=1){let i=e[r].id;n.push(i),t[i]=r}this.ids=n,this.indicesById=t,this.length=e.length}}class oc{constructor(e,t,n){this.dayTableModel=e,this.resources=t,this.context=n,this.resourceIndex=new ic(t),this.rowCnt=e.rowCnt,this.colCnt=e.colCnt*t.length,this.cells=this.buildCells()}buildCells(){let{rowCnt:e,dayTableModel:t,resources:n}=this,r=[];for(let i=0;i<e;i+=1){let e=[];for(let r=0;r<t.colCnt;r+=1)for(let o=0;o<n.length;o+=1){let s=n[o],a={resource:new Ql(this.context,s)},l={"data-resource-id":s.id},c=["fc-resource"],u={resourceId:s.id},d=t.cells[i][r].date;e[this.computeCol(r,o)]={key:s.id+":"+d.toISOString(),date:d,extraRenderProps:a,extraDataAttrs:l,extraClassNames:c,extraDateSpan:u}}r.push(e)}return r}}class sc extends oc{computeCol(e,t){return t*this.dayTableModel.colCnt+e}computeColRanges(e,t,n){return[{firstCol:this.computeCol(e,n),lastCol:this.computeCol(t,n),isStart:!0,isEnd:!0}]}}class ac extends oc{computeCol(e,t){return e*this.resources.length+t}computeColRanges(e,t,n){let r=[];for(let i=e;i<=t;i+=1){let o=this.computeCol(i,n);r.push({firstCol:o,lastCol:o,isStart:i===e,isEnd:i===t})}return r}}const lc=[];class cc{constructor(){this.joinDateSelection=Bt(this.joinSegs),this.joinBusinessHours=Bt(this.joinSegs),this.joinFgEvents=Bt(this.joinSegs),this.joinBgEvents=Bt(this.joinSegs),this.joinEventDrags=Bt(this.joinInteractions),this.joinEventResizes=Bt(this.joinInteractions)}joinProps(e,t){let n=[],r=[],i=[],o=[],s=[],a=[],l="",c=t.resourceIndex.ids.concat([""]);for(let u of c){let t=e[u];n.push(t.dateSelectionSegs),r.push(u?t.businessHourSegs:lc),i.push(u?t.fgEventSegs:lc),o.push(t.bgEventSegs),s.push(t.eventDrag),a.push(t.eventResize),l=l||t.eventSelection}return{dateSelectionSegs:this.joinDateSelection(t,...n),businessHourSegs:this.joinBusinessHours(t,...r),fgEventSegs:this.joinFgEvents(t,...i),bgEventSegs:this.joinBgEvents(t,...o),eventDrag:this.joinEventDrags(t,...s),eventResize:this.joinEventResizes(t,...a),eventSelection:l}}joinSegs(e){let t=e.resources.length,n=[];for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(let s=0;s<t;s+=1){for(let t of i[s])n.push(...this.transformSeg(t,e,s));for(let r of i[t])n.push(...this.transformSeg(r,e,s))}return n}expandSegs(e,t){let n=e.resources.length,r=[];for(let i=0;i<n;i+=1)for(let n of t)r.push(...this.transformSeg(n,e,i));return r}joinInteractions(e){let t=e.resources.length,n={},r=[],i=!1,o=!1;for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];for(let c=0;c<t;c+=1){let s=a[c];if(s){i=!0;for(let t of s.segs)r.push(...this.transformSeg(t,e,c));Object.assign(n,s.affectedInstances),o=o||s.isEvent}if(a[t])for(let n of a[t].segs)r.push(...this.transformSeg(n,e,c))}return i?{affectedInstances:n,segs:r,isEvent:o}:null}}class uc extends Ai{getKeyInfo(e){let{resourceDayTableModel:t}=e,n=yn(t.resourceIndex.indicesById,e=>t.resources[e]);return n[""]={},n}getKeysForDateSpan(e){return[e.resourceId||""]}getKeysForEventDef(e){let t=e.resourceIds;return t.length?t:[""]}}function dc(e,t){return function(e,t,n,r,i,o){let s=function(e,t,n,r){let i=function(e,t){let n={};for(let r in e){let t=e[r];n[r]={resource:t,resourceFields:gc(t),children:[]}}for(let r in e){let i=e[r];if(i.parentId){let e=n[i.parentId];e&&pc(n[r],e.children,t)}}return n}(e,r),o=[];for(let s in i){let e=i[s];e.resource.parentId||fc(e,o,n,0,t,r)}return o}(e,r?-1:1,t,n),a=[];return hc(s,a,r,[],0,i,o),a}(e,[],t,!1,{},!0).map(e=>e.resource)}function hc(e,t,n,r,i,o,s){for(let a=0;a<e.length;a+=1){let l=e[a],c=l.group;if(c)if(n){let e=t.length,a=r.length;if(hc(l.children,t,n,r.concat(0),i,o,s),e<t.length){let n=t[e];(n.rowSpans=n.rowSpans.slice())[a]=t.length-e}}else{let e=c.spec.field+":"+c.value,a=null!=o[e]?o[e]:s;t.push({id:e,group:c,isExpanded:a}),a&&hc(l.children,t,n,r,i+1,o,s)}else if(l.resource){let e=l.resource.id,a=null!=o[e]?o[e]:s;t.push({id:e,rowSpans:r,depth:i,isExpanded:a,hasChildren:Boolean(l.children.length),resource:l.resource,resourceFields:l.resourceFields}),a&&hc(l.children,t,n,r,i+1,o,s)}}}function fc(e,t,n,r,i,o){if(n.length&&(-1===i||r<=i)){let s=function(e,t,n){let r,i,o=e.resourceFields[n.field];if(n.order)for(i=0;i<t.length;i+=1){let e=t[i];if(e.group){let t=at(o,e.group.value)*n.order;if(0===t){r=e;break}if(t<0)break}}else for(i=0;i<t.length;i+=1){let e=t[i];if(e.group&&o===e.group.value){r=e;break}}r||(r={group:{value:o,spec:n},children:[]},t.splice(i,0,r));return r}(e,t,n[0]);fc(e,s.children,n.slice(1),r+1,i,o)}else pc(e,t,o)}function pc(e,t,n){let r;for(r=0;r<t.length;r+=1){if(ot(t[r].resourceFields,e.resourceFields,n)>0)break}t.splice(r,0,e)}function gc(e){let t=Object.assign(Object.assign(Object.assign({},e.extendedProps),e.ui),e);return delete t.ui,delete t.extendedProps,t}function mc(e,t){let{resourceEditable:n}=e;if(null==n){let r=e.sourceId&&t.getCurrentData().eventSources[e.sourceId];r&&(n=r.extendedProps.resourceEditable),null==n&&(n=t.options.eventResourceEditable,null==n&&(n=t.options.editable))}return n}function vc(e,t,n,r){if(t){let t=function(e,t){return vn(e,e=>Jn(e.range,t))}(n.instances,r),i=function(e,t){let n={};for(let r in e){let i=e[r];for(let e of t[i.defId].resourceIds)n[e]=!0}return n}(t,n.defs);return Object.assign(i,function(e,t){let n={};for(let r in e){let e;for(;(e=t[r])&&(r=e.parentId,r);)n[r]=!0}return n}(i,e)),vn(e,(e,t)=>i[t])}return e}function yc(e){return yn(e,e=>e.ui)}function wc(e,t,n){return yn(e,(e,r)=>r?function(e,t,n){let r=[];for(let i of t.resourceIds)n[i]&&r.unshift(n[i]);return r.unshift(e),Tr(r)}(e,t[r],n):e)}let bc=[];function Cc(e){bc.push(e)}function Sc(e){return bc[e]}function Ec(){return bc}const Tc={id:String,resources:pn,url:String,method:String,startParam:String,endParam:String,timeZoneParam:String,extraParams:pn};function _c(e){let t;if("string"===typeof e?t={url:e}:"function"===typeof e||Array.isArray(e)?t={resources:e}:"object"===typeof e&&e&&(t=e),t){let{refined:n,extra:r}=fn(t,Tc);!function(e){for(let t in e)console.warn(`Unknown resource prop '${t}'`)}(r);let i=function(e){let t=Ec();for(let n=t.length-1;n>=0;n-=1){let r=t[n].parseMeta(e);if(r)return{meta:r,sourceDefId:n}}return null}(n);if(i)return{_raw:e,sourceId:tt(),sourceDefId:i.sourceDefId,meta:i.meta,publicId:n.id||"",isFetching:!1,latestFetchId:"",fetchRange:null}}return null}function Ic(e,t,n){let{options:r,dateProfile:i}=n;if(!e||!t)return Ac(r.initialResources||r.resources,i.activeRange,r.refetchResourcesOnNavigate,n);switch(t.type){case"RESET_RESOURCE_SOURCE":return Ac(t.resourceSourceInput,i.activeRange,r.refetchResourcesOnNavigate,n);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return function(e,t,n,r){if(n&&!function(e){return Boolean(Sc(e.sourceDefId).ignoreRange)}(e)&&(!e.fetchRange||!Yn(e.fetchRange,t)))return kc(e,t,r);return e}(e,i.activeRange,r.refetchResourcesOnNavigate,n);case"RECEIVE_RESOURCES":case"RECEIVE_RESOURCE_ERROR":return function(e,t,n){if(t===e.latestFetchId)return Object.assign(Object.assign({},e),{isFetching:!1,fetchRange:n});return e}(e,t.fetchId,t.fetchRange);case"REFETCH_RESOURCES":return kc(e,i.activeRange,n);default:return e}}function Ac(e,t,n,r){if(e){let i=_c(e);return i=kc(i,n?t:null,r),i}return null}function kc(e,t,n){let r=Sc(e.sourceDefId),i=tt();return r.fetch({resourceSource:e,range:t,context:n},e=>{n.dispatch({type:"RECEIVE_RESOURCES",fetchId:i,fetchRange:t,rawResources:e.rawResources})},e=>{n.dispatch({type:"RECEIVE_RESOURCE_ERROR",fetchId:i,fetchRange:t,error:e})}),Object.assign(Object.assign({},e),{isFetching:!0,latestFetchId:i})}function Rc(e,t,n,r){if(!e||!t)return{};switch(t.type){case"RECEIVE_RESOURCES":return function(e,t,n,r,i){if(r.latestFetchId===n){let e={};for(let n of t)Kl(n,"",e,i);return e}return e}(e,t.rawResources,t.fetchId,n,r);case"ADD_RESOURCE":return i=e,o=t.resourceHash,Object.assign(Object.assign({},i),o);case"REMOVE_RESOURCE":return function(e,t){let n=Object.assign({},e);delete n[t];for(let r in n)n[r].parentId===t&&(n[r]=Object.assign(Object.assign({},n[r]),{parentId:""}));return n}(e,t.resourceId);case"SET_RESOURCE_PROP":return function(e,t,n,r){let i=e[t];if(i)return Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},i),{[n]:r})});return e}(e,t.resourceId,t.propName,t.propValue);case"SET_RESOURCE_EXTENDED_PROP":return function(e,t,n,r){let i=e[t];if(i)return Object.assign(Object.assign({},e),{[t]:Object.assign(Object.assign({},i),{extendedProps:Object.assign(Object.assign({},i.extendedProps),{[n]:r})})});return e}(e,t.resourceId,t.propName,t.propValue);default:return e}var i,o}const Dc={resourceId:String,resourceIds:pn,resourceEditable:Boolean};function Pc(e,t){return Object.assign(Object.assign({},t),{constraints:xc(e,t.constraints)})}function xc(e,t){return t.map(t=>{let n=t.defs;if(n)for(let r in n){let t=n[r].resourceIds;if(t.length&&-1===t.indexOf(e))return!1}return t})}Ei.prototype.addResource=function(e){let t,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.getCurrentData();e instanceof Ql?(n=e._resource,t={[n.id]:n}):(t={},n=Kl(e,"",t,i)),this.dispatch({type:"ADD_RESOURCE",resourceHash:t}),r&&this.trigger("_scrollRequest",{resourceId:n.id});let o=new Ql(i,n);return i.emitter.trigger("resourceAdd",{resource:o,revert:()=>{this.dispatch({type:"REMOVE_RESOURCE",resourceId:n.id})}}),o},Ei.prototype.getResourceById=function(e){e=String(e);let t=this.getCurrentData();if(t.resourceStore){let n=t.resourceStore[e];if(n)return new Ql(t,n)}return null},Ei.prototype.getResources=function(){let e=this.getCurrentData(),{resourceStore:t}=e,n=[];if(t)for(let r in t)n.push(new Ql(e,t[r]));return n},Ei.prototype.getTopLevelResources=function(){let e=this.getCurrentData(),{resourceStore:t}=e,n=[];if(t)for(let r in t)t[r].parentId||n.push(new Ql(e,t[r]));return n},Ei.prototype.refetchResources=function(){this.dispatch({type:"REFETCH_RESOURCES"})};const Oc={resources:function(e,t){t.getCurrentData().resourceSource._raw!==e&&t.dispatch({type:"RESET_RESOURCE_SOURCE",resourceSourceInput:e})}};const Nc={initialResources:pn,resources:pn,eventResourceEditable:Boolean,refetchResourcesOnNavigate:Boolean,resourceOrder:it,filterResourcesWithEvents:Boolean,resourceGroupField:String,resourceAreaWidth:pn,resourceAreaColumns:pn,resourcesInitiallyExpanded:Boolean,datesAboveResources:Boolean,needsResourceData:Boolean,resourceAreaHeaderClassNames:pn,resourceAreaHeaderContent:pn,resourceAreaHeaderDidMount:pn,resourceAreaHeaderWillUnmount:pn,resourceGroupLabelClassNames:pn,resourceGroupLabelContent:pn,resourceGroupLabelDidMount:pn,resourceGroupLabelWillUnmount:pn,resourceLabelClassNames:pn,resourceLabelContent:pn,resourceLabelDidMount:pn,resourceLabelWillUnmount:pn,resourceLaneClassNames:pn,resourceLaneContent:pn,resourceLaneDidMount:pn,resourceLaneWillUnmount:pn,resourceGroupLaneClassNames:pn,resourceGroupLaneContent:pn,resourceGroupLaneDidMount:pn,resourceGroupLaneWillUnmount:pn},Mc={resourcesSet:pn,resourceAdd:pn,resourceChange:pn,resourceRemove:pn};Vr.prototype.getResources=function(){let{calendarApi:e}=this._context;return this._def.resourceIds.map(t=>e.getResourceById(t))},Vr.prototype.setResources=function(e){let t=[];for(let n of e){let e=null;"string"===typeof n?e=n:"number"===typeof n?e=String(n):n instanceof Ql?e=n.id:console.warn("unknown resource type: "+n),e&&t.push(e)}this.mutate({standardProps:{resourceIds:t}})},Cc({ignoreRange:!0,parseMeta:e=>Array.isArray(e.resources)?e.resources:null,fetch(e,t){t({rawResources:e.resourceSource.meta})}}),Cc({parseMeta:e=>"function"===typeof e.resources?e.resources:null,fetch(e,t,n){const r=e.context.dateEnv,i=e.resourceSource.meta,o=e.range?{start:r.toDate(e.range.start),end:r.toDate(e.range.end),startStr:r.formatIso(e.range.start),endStr:r.formatIso(e.range.end),timeZone:r.timeZone}:{};hi(i.bind(null,o),e=>t({rawResources:e}),n)}}),Cc({parseMeta:e=>e.url?{url:e.url,method:(e.method||"GET").toUpperCase(),extraParams:e.extraParams}:null,fetch(e,t,n){const r=e.resourceSource.meta,i=function(e,t,n){let r,i,o,s,{dateEnv:a,options:l}=n,c={};t&&(r=e.startParam,null==r&&(r=l.startParam),i=e.endParam,null==i&&(i=l.endParam),o=e.timeZoneParam,null==o&&(o=l.timeZoneParam),c[r]=a.formatIso(t.start),c[i]=a.formatIso(t.end),"local"!==a.timeZone&&(c[o]=a.timeZone));s="function"===typeof e.extraParams?e.extraParams():e.extraParams||{};return Object.assign(c,s),c}(r,e.range,e.context);pi(r.method,r.url,i).then(e=>{let[n,r]=e;t({rawResources:n,response:r})},n)}});var Lc=ds({name:"@fullcalendar/resource",premiumReleaseDate:"2025-06-30",deps:[Wl],reducers:[function(e,t,n){let r=Ic(e&&e.resourceSource,t,n),i=Rc(e&&e.resourceStore,t,r,n),o=function(e,t){return e&&t?"SET_RESOURCE_ENTITY_EXPANDED"===t.type?Object.assign(Object.assign({},e),{[t.id]:t.isExpanded}):e:{}}(e&&e.resourceEntityExpansions,t);return{resourceSource:r,resourceStore:i,resourceEntityExpansions:o}}],isLoadingFuncs:[e=>e.resourceSource&&e.resourceSource.isFetching],eventRefiners:Dc,eventDefMemberAdders:[function(e){return{resourceIds:(t=e.resourceIds,(t||[]).map(e=>String(e))).concat(e.resourceId?[e.resourceId]:[]),resourceEditable:e.resourceEditable};var t}],isDraggableTransformers:[function(e,t,n,r){if(!e){let e=r.getCurrentData();if(e.viewSpecs[e.currentViewType].optionDefaults.needsResourceData&&mc(t,r))return!0}return e}],eventDragMutationMassagers:[function(e,t,n){let r=t.dateSpan.resourceId,i=n.dateSpan.resourceId;r&&i&&r!==i&&(e.resourceMutation={matchResourceId:r,setResourceId:i})}],eventDefMutationAppliers:[function(e,t,n){let r=t.resourceMutation;if(r&&mc(e,n)){let t=e.resourceIds.indexOf(r.matchResourceId);if(-1!==t){let n=e.resourceIds.slice();n.splice(t,1),-1===n.indexOf(r.setResourceId)&&n.push(r.setResourceId),e.resourceIds=n}}}],dateSelectionTransformers:[function(e,t){let n=e.dateSpan.resourceId,r=t.dateSpan.resourceId;return n&&r?{resourceId:n}:null}],datePointTransforms:[function(e,t){return e.resourceId?{resource:t.calendarApi.getResourceById(e.resourceId)}:{}}],dateSpanTransforms:[function(e,t){return e.resourceId?{resource:t.calendarApi.getResourceById(e.resourceId)}:{}}],viewPropsTransformers:[class{constructor(){this.filterResources=Bt(vc)}transform(e,t){return t.viewSpec.optionDefaults.needsResourceData?{resourceStore:this.filterResources(t.resourceStore,t.options.filterResourcesWithEvents,t.eventStore,t.dateProfile.activeRange),resourceEntityExpansions:t.resourceEntityExpansions}:null}},class{constructor(){this.buildResourceEventUis=Bt(yc,Cn),this.injectResourceEventUis=Bt(wc)}transform(e,t){return t.viewSpec.optionDefaults.needsResourceData?null:{eventUiBases:this.injectResourceEventUis(e.eventUiBases,e.eventStore.defs,this.buildResourceEventUis(t.resourceStore))}}}],isPropsValid:function(e,t){let n=(new Yl).splitProps(Object.assign(Object.assign({},e),{resourceStore:t.getCurrentData().resourceStore}));for(let r in n){let e=n[r];if(r&&n[""]&&(e=Object.assign(Object.assign({},e),{eventStore:yr(n[""].eventStore,e.eventStore),eventUiBases:Object.assign(Object.assign({},n[""].eventUiBases),e.eventUiBases)})),!yo(e,t,{resourceId:r},Pc.bind(null,r)))return!1}return!0},externalDefTransforms:[function(e){return e.resourceId?{resourceId:e.resourceId}:{}}],eventDropTransformers:[function(e,t){let{resourceMutation:n}=e;if(n){let{calendarApi:e}=t;return{oldResource:e.getResourceById(n.matchResourceId),newResource:e.getResourceById(n.setResourceId)}}return{oldResource:null,newResource:null}}],optionChangeHandlers:Oc,optionRefiners:Nc,listenerRefiners:Mc,propSetHandlers:{resourceStore:function(e,t){let{emitter:n}=t;n.hasHandlers("resourcesSet")&&n.trigger("resourcesSet",function(e,t){let n=[];for(let r in e)n.push(new Ql(t,e[r]));return n}(e,t))}}});class Uc extends cc{transformSeg(e,t,n){return t.computeColRanges(e.firstCol,e.lastCol,n).map(t=>Object.assign(Object.assign(Object.assign({},e),t),{isStart:e.isStart&&t.isStart,isEnd:e.isEnd&&t.isEnd}))}}class Fc extends Gi{constructor(){super(...arguments),this.splitter=new uc,this.slicers={},this.joiner=new Uc,this.tableRef={current:null},this.isHitComboAllowed=(e,t)=>1===this.props.resourceDayTableModel.dayTableModel.colCnt||e.dateSpan.resourceId===t.dateSpan.resourceId}render(){let{props:e,context:t}=this,{resourceDayTableModel:n,nextDayThreshold:r,dateProfile:i}=e,o=this.splitter.splitProps(e);this.slicers=yn(o,(e,t)=>this.slicers[t]||new Fa);let s=yn(this.slicers,(e,s)=>e.sliceProps(o[s],i,r,t,n.dayTableModel));return b(Ua,Object.assign({forPrint:e.forPrint,ref:this.tableRef},this.joiner.joinProps(s,n),{cells:n.cells,dateProfile:i,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,isHitComboAllowed:this.isHitComboAllowed}))}}class Hc extends cc{transformSeg(e,t,n){return[Object.assign(Object.assign({},e),{col:t.computeCol(e.col,n)})]}}class jc extends Gi{constructor(){super(...arguments),this.buildDayRanges=Bt(vl),this.splitter=new uc,this.slicers={},this.joiner=new Hc,this.timeColsRef={current:null},this.isHitComboAllowed=(e,t)=>1===this.dayRanges.length||e.dateSpan.resourceId===t.dateSpan.resourceId}render(){let{props:e,context:t}=this,{dateEnv:n,options:r}=t,{dateProfile:i,resourceDayTableModel:o}=e,s=this.dayRanges=this.buildDayRanges(o.dayTableModel,i,n),a=this.splitter.splitProps(e);this.slicers=yn(a,(e,t)=>this.slicers[t]||new gl);let l=yn(this.slicers,(e,n)=>e.sliceProps(a[n],i,null,t,s));return b(Ci,{unit:r.nowIndicator?"minute":"day"},(t,n)=>b(fl,Object.assign({ref:this.timeColsRef},this.joiner.joinProps(l,o),{dateProfile:i,axis:e.axis,slotDuration:e.slotDuration,slatMetas:e.slatMetas,cells:o.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:t,nowIndicatorSegs:r.nowIndicator&&this.buildNowIndicatorSegs(t),todayRange:n,onScrollTopRequest:e.onScrollTopRequest,forPrint:e.forPrint,onSlatCoords:e.onSlatCoords,isHitComboAllowed:this.isHitComboAllowed})))}buildNowIndicatorSegs(e){let t=this.slicers[""].sliceNowDate(e,this.props.dateProfile,this.context.options.nextDayThreshold,this.context,this.dayRanges);return this.joiner.expandSegs(this.props.resourceDayTableModel,t)}}function Bc(e,t,n,r,i){let o=bl(e,t);return r?new ac(o,n,i):new sc(o,n,i)}var zc=ds({name:"@fullcalendar/resource-timegrid",premiumReleaseDate:"2025-06-30",deps:[Wl,Lc,Cl],initialView:"resourceTimeGridDay",views:{resourceTimeGrid:{type:"timeGrid",component:class extends $a{constructor(){super(...arguments),this.flattenResources=Bt(dc),this.buildResourceTimeColsModel=Bt(Bc),this.buildSlatMetas=Bt(wl)}render(){let{props:e,context:t}=this,{options:n,dateEnv:r}=t,{dateProfile:i}=e,o=this.allDaySplitter.splitProps(e),s=n.resourceOrder||Jl,a=this.flattenResources(e.resourceStore,s),l=this.buildResourceTimeColsModel(i,t.dateProfileGenerator,a,n.datesAboveResources,t),c=this.buildSlatMetas(i.slotMinTime,i.slotMaxTime,n.slotLabelInterval,n.slotDuration,r),{dayMinWidth:u}=n,d=!u,h=u,f=n.dayHeaders&&b(nc,{resources:a,dates:l.dayTableModel.headerDates,dateProfile:i,datesRepDistinctDays:!0,renderIntro:d?this.renderHeadAxis:null}),p=!1!==n.allDaySlot&&(t=>b(Fc,Object.assign({},o.allDay,{dateProfile:i,resourceDayTableModel:l,nextDayThreshold:n.nextDayThreshold,tableMinWidth:t.tableMinWidth,colGroupNode:t.tableColGroupNode,renderRowIntro:d?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:t.clientWidth,clientHeight:t.clientHeight,forPrint:e.forPrint},this.getAllDayMaxEventProps()))),g=t=>b(jc,Object.assign({},o.timed,{dateProfile:i,axis:d,slotDuration:n.slotDuration,slatMetas:c,resourceDayTableModel:l,tableColGroupNode:t.tableColGroupNode,tableMinWidth:t.tableMinWidth,clientWidth:t.clientWidth,clientHeight:t.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:t.expandRows,forPrint:e.forPrint,onScrollTopRequest:this.handleScrollTopRequest}));return h?this.renderHScrollLayout(f,p,g,l.colCnt,u,c,this.state.slatCoords):this.renderSimpleLayout(f,p,g)}},needsResourceData:!0},resourceTimeGridDay:{type:"resourceTimeGrid",duration:{days:1}},resourceTimeGridWeek:{type:"resourceTimeGrid",duration:{weeks:1}}}}),qc=n(579);const Vc=function(e){let{events:t,onSelectSlot:n,isAdmin:r,currentUser:i,setSelectedEvent:o}=e;return(0,qc.jsx)("div",{className:"calendar-wrapper",children:(0,qc.jsx)("div",{className:"calendar-scroll",children:(0,qc.jsxs)("div",{className:"calendar-page",children:[(0,qc.jsxs)("div",{className:"calendar-header",children:[(0,qc.jsx)("div",{id:"calendar-toolbar"}),i&&(0,qc.jsxs)("div",{className:"user-info",children:["Logged in as: ",(0,qc.jsx)("strong",{children:i.name})]})]}),(0,qc.jsx)("div",{className:"calendar-container",children:(0,qc.jsx)(ha,{plugins:[Cl,zl,zc],initialView:"resourceTimeGridDay",schedulerLicenseKey:"GPL-My-Project-Is-Open-Source",slotMinTime:"08:00:00",slotMaxTime:"18:00:00",longPressDelay:100,selectMinDistance:1,selectAllow:()=>!0,allDaySlot:!1,selectable:!0,selectMirror:!0,height:"61vh",headerToolbar:{left:"prev,next today",center:"title",right:""},resources:[{id:"Room 1",title:"Room 1"},{id:"Room 2",title:"Room 2"},{id:"Room 3",title:"Room 3"}],events:t.map(e=>({...e,resourceId:e.room||"Room 1"})),eventContent:e=>{const{status:t}=e.event.extendedProps,n="approved"===t;return(0,qc.jsx)("div",{className:"event-container",children:(0,qc.jsxs)("div",{className:"event-content "+(n?"approved":"pending"),children:[e.event.title," ",!n&&"(Pending)"]})})},select:e=>{var t;n({start:e.startStr,end:e.endStr,resourceId:(null===(t=e.resource)||void 0===t?void 0:t.id)||"Room 1"})},eventClick:e=>{if(!r)return;const n=t.find(t=>t.id===e.event.id);o(n)}})})]})})})};const Wc=function(e){let{slot:t,events:n,onClose:r,onSubmit:i,lastUsedData:o}=e;const[s,a]=(0,h.useState)({name:"",cpr:"",phone:"",department:""}),[l,c]=(0,h.useState)(60),[u,d]=(0,h.useState)(!1),[f,p]=(0,h.useState)(""),[g,m]=(0,h.useState)(!1);(0,h.useEffect)(()=>{o&&a(e=>({...e,...o,department:e.department||o.department||""}))},[o]),(0,h.useEffect)(()=>{if(!t||!t.start||!t.end)return;const e=new Date(t.start),n=new Date(t.end);if(isNaN(e.getTime())||isNaN(n.getTime()))return;const r=n-e,i=Math.round(r/6e4),o=Math.min(i,300);c(o),v(o)},[t]),(0,h.useEffect)(()=>{v(l)},[l]);const v=e=>{if(!t||!t.start)return;const r=new Date(t.start);if(isNaN(r.getTime()))return;const i=new Date(r.getTime()+6e4*e);p(i.toISOString());const o=n.some(e=>{const n=new Date(e.start),o=new Date(e.end);return r<o&&i>n&&e.room===t.resourceId&&"approved"===e.status}),s=n.filter(e=>{const n=new Date(e.start),o=new Date(e.end);return r<o&&i>n&&e.room===t.resourceId&&"pending"===e.status}).length;s>=4&&alert("This slot already has 4 pending bookings. Please contact the Admin."),d(o||s>=4)},y=e=>{a(t=>({...t,[e.target.name]:e.target.value}))};return t&&t.start?(0,qc.jsx)("div",{className:"overlay",children:(0,qc.jsxs)("div",{className:"form-container",children:[(0,qc.jsx)("button",{className:"close-btn",onClick:r,children:"\xd7"}),(0,qc.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!u&&!g){m(!0);try{await i({...s,room:t.resourceId},f)}finally{m(!1)}}},children:[(0,qc.jsx)("h3",{children:"Book Time Slot"}),(0,qc.jsxs)("p",{children:[(0,qc.jsx)("strong",{children:"Room:"})," ",t.resourceId||"Unspecified"]}),(0,qc.jsxs)("p",{children:[(0,qc.jsx)("strong",{children:"Start:"})," ",new Date(t.start).toLocaleString()]}),(0,qc.jsxs)("p",{children:[(0,qc.jsx)("strong",{children:"End:"})," ",f?new Date(f).toLocaleString():"\u2014"]}),(0,qc.jsx)("label",{children:"Duration:"}),(0,qc.jsx)("select",{value:l,onChange:e=>c(Number(e.target.value)),children:[...Array(10)].map((e,t)=>{const n=30+30*t;return(0,qc.jsx)("option",{value:n,children:n%60===0?`${n/60} hour${n>60?"s":""}`:`${Math.floor(n/60)}h ${n%60}m`},n)})}),(0,qc.jsx)("label",{children:"Name:"}),(0,qc.jsx)("input",{type:"text",name:"name",value:s.name,readOnly:!0,style:{backgroundColor:"#f0f0f0",cursor:"not-allowed"}}),(0,qc.jsx)("label",{children:"CPR:"}),(0,qc.jsx)("input",{type:"text",name:"cpr",placeholder:"Enter CPR Number",value:s.cpr,onChange:y,required:!0}),(0,qc.jsx)("label",{children:"Phone Number:"}),(0,qc.jsx)("input",{type:"tel",name:"phone",value:s.phone,onChange:e=>{const t=e.target.value.replace(/\D/g,"").slice(0,8);a(e=>({...e,phone:t}))},maxLength:8,pattern:"\\d{8}",title:"Please enter an 8-digit phone number",required:!0}),(0,qc.jsx)("input",{type:"text",name:"department",value:s.department,onChange:y,placeholder:"Enter Department",required:!0}),u&&(0,qc.jsx)("p",{className:"conflict",children:"This slot is already booked in this room."}),(0,qc.jsxs)("div",{className:"form-actions",children:[(0,qc.jsx)("button",{type:"submit",disabled:u||g,children:g?"Booking\u2026":"Confirm"}),(0,qc.jsx)("button",{type:"button",onClick:r,children:"Cancel"})]})]})]})}):null};const $c=function(e){let{onClose:t,onSubmit:n}=e;const[r,i]=(0,h.useState)("Room 1"),[o,s]=(0,h.useState)(""),[a,l]=(0,h.useState)(""),[c,u]=(0,h.useState)(30);return(0,qc.jsx)("div",{className:"overlay",children:(0,qc.jsxs)("div",{className:"form-container",children:[(0,qc.jsx)("button",{className:"close-btn",onClick:t,children:"\xd7"}),(0,qc.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!o||!a)return;const i=new Date(`${o}T${a}`),s=new Date(i.getTime()+6e4*c);n({start:i.toISOString(),end:s.toISOString(),resourceId:r}),t()},children:[(0,qc.jsx)("h3",{children:"Manual Booking"}),(0,qc.jsx)("label",{children:"Date:"}),(0,qc.jsx)("input",{type:"date",value:o,onChange:e=>s(e.target.value),required:!0}),(0,qc.jsx)("label",{children:"Start Time:"}),(0,qc.jsx)("input",{type:"time",value:a,onChange:e=>l(e.target.value),required:!0}),(0,qc.jsx)("label",{children:"Room:"}),(0,qc.jsxs)("select",{value:r,onChange:e=>i(e.target.value),children:[(0,qc.jsx)("option",{value:"Room 1",children:"Room 1"}),(0,qc.jsx)("option",{value:"Room 2",children:"Room 2"}),(0,qc.jsx)("option",{value:"Room 3",children:"Room 3"})]}),(0,qc.jsx)("label",{children:"Duration (minutes):"}),(0,qc.jsx)("select",{value:c,onChange:e=>u(Number(e.target.value)),children:[30,60,90,120].map(e=>(0,qc.jsxs)("option",{value:e,children:[e," minutes"]},e))}),(0,qc.jsxs)("div",{className:"form-actions",children:[(0,qc.jsx)("button",{type:"submit",children:"Continue"}),(0,qc.jsx)("button",{type:"button",onClick:t,children:"Cancel"})]})]})]})})},Gc=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Kc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],o=i+1<e.length,s=o?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|s>>4;let d=(15&s)<<2|l>>6,h=63&l;a||(h=64,o||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Gc(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0;++i;const s=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==o||null==s||null==a)throw new Qc;const l=t<<2|o>>4;if(r.push(l),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==a){const e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Qc extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Yc=function(e){return function(e){const t=Gc(e);return Kc.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Jc=function(e){try{return Kc.decodeString(e,!0)}catch(d){console.error("base64Decode failed: ",d)}return null};function Xc(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const Zc=()=>{try{return Xc().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(d){return}const t=e&&Jc(e[1]);return t&&JSON.parse(t)})()}catch(d){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${d}`)}},eu=e=>{var t,n;return null===(n=null===(t=Zc())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},tu=()=>{var e;return null===(e=Zc())||void 0===e?void 0:e.config},nu=e=>{var t;return null===(t=Zc())||void 0===t?void 0:t[`_${e}`]};class ru{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function iu(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function ou(e){return(await fetch(e,{credentials:"include"})).ok}const su={};let au=!1;function lu(e,t){if("undefined"===typeof window||"undefined"===typeof document||!iu(window.location.host)||su[e]===t||su[e]||au)return;function n(e){return`__firebase__banner__${e}`}su[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(su))su[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function o(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{au=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function s(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),s=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),l=document.getElementById(a)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,a);const n=o();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,s,l,n),document.body.appendChild(t)}i?(s.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',s.innerText="Preview backend running in this workspace."),s.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function cu(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function uu(){var e;const t=null===(e=Zc())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(d){return!1}}function du(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function hu(){return!uu()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fu(){try{return"object"===typeof indexedDB}catch(d){return!1}}function pu(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}class gu extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,gu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mu.prototype.create)}}class mu{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(vu,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(r,t):"Error",o=`${this.serviceName}: ${i} (${n}).`;return new gu(n,o,t)}}const vu=/\{\$([^}]+)}/g;function yu(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(wu(n)&&wu(o)){if(!yu(n,o))return!1}else if(n!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function wu(e){return null!==e&&"object"===typeof e}function bu(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Cu(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function Su(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Eu{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Tu),void 0===r.error&&(r.error=Tu),void 0===r.complete&&(r.complete=Tu);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(d){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(d){"undefined"!==typeof console&&console.error&&console.error(d)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Tu(){}function _u(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),r=Math.round(.5*n*(Math.random()-.5)*2);return Math.min(144e5,n+r)}function Iu(e){return e&&e._delegate?e._delegate:e}class Au{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ku="[DEFAULT]";class Ru{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new ru;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(d){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(d){if(r)return null;throw d}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ku})}catch(d){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(d){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ku;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ku;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ku;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&o.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===ku?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(o){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ku;return this.component?this.component.multipleInstances?e:ku:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Du{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ru(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Pu=[];var xu;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(xu||(xu={}));const Ou={debug:xu.DEBUG,verbose:xu.VERBOSE,info:xu.INFO,warn:xu.WARN,error:xu.ERROR,silent:xu.SILENT},Nu=xu.INFO,Mu={[xu.DEBUG]:"log",[xu.VERBOSE]:"log",[xu.INFO]:"info",[xu.WARN]:"warn",[xu.ERROR]:"error"},Lu=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=Mu[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];console[r](`[${n}]  ${e.name}:`,...o)};class Uu{constructor(e){this.name=e,this._logLevel=Nu,this._logHandler=Lu,this._userLogHandler=null,Pu.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xu))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Ou[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xu.DEBUG,...t),this._logHandler(this,xu.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xu.VERBOSE,...t),this._logHandler(this,xu.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xu.INFO,...t),this._logHandler(this,xu.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xu.WARN,...t),this._logHandler(this,xu.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,xu.ERROR,...t),this._logHandler(this,xu.ERROR,...t)}}let Fu,Hu;const ju=new WeakMap,Bu=new WeakMap,zu=new WeakMap,qu=new WeakMap,Vu=new WeakMap;let Wu={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Bu.get(e);if("objectStoreNames"===t)return e.objectStoreNames||zu.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ku(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function $u(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Hu||(Hu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Qu(this),n),Ku(ju.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ku(e.apply(Qu(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.call(Qu(this),t,...r);return zu.set(o,t.sort?t.sort():[t]),Ku(o)}}function Gu(e){return"function"===typeof e?$u(e):(e instanceof IDBTransaction&&function(e){if(Bu.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)});Bu.set(e,t)}(e),t=e,(Fu||(Fu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,Wu):e);var t}function Ku(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(Ku(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)});return t.then(t=>{t instanceof IDBCursor&&ju.set(t,e)}).catch(()=>{}),Vu.set(t,e),t}(e);if(qu.has(e))return qu.get(e);const t=Gu(e);return t!==e&&(qu.set(e,t),Vu.set(t,e)),t}const Qu=e=>Vu.get(e);function Yu(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),a=Ku(s);return r&&s.addEventListener("upgradeneeded",e=>{r(Ku(s.result),e.oldVersion,e.newVersion,Ku(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{o&&e.addEventListener("close",()=>o()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}const Ju=["get","getKey","getAll","getAllKeys","count"],Xu=["put","add","delete","clear"],Zu=new Map;function ed(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Zu.get(t))return Zu.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Xu.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Ju.includes(n))return;const o=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let o=t.store;for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return r&&(o=o.index(a.shift())),(await Promise.all([o[n](...a),i&&t.done]))[0]};return Zu.set(t,o),o}Wu=(e=>({...e,get:(t,n,r)=>ed(t,n)||e.get(t,n,r),has:(t,n)=>!!ed(t,n)||e.has(t,n)}))(Wu);class td{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const nd="@firebase/app",rd="0.13.2",id=new Uu("@firebase/app"),od="@firebase/app-compat",sd="@firebase/analytics-compat",ad="@firebase/analytics",ld="@firebase/app-check-compat",cd="@firebase/app-check",ud="@firebase/auth",dd="@firebase/auth-compat",hd="@firebase/database",fd="@firebase/data-connect",pd="@firebase/database-compat",gd="@firebase/functions",md="@firebase/functions-compat",vd="@firebase/installations",yd="@firebase/installations-compat",wd="@firebase/messaging",bd="@firebase/messaging-compat",Cd="@firebase/performance",Sd="@firebase/performance-compat",Ed="@firebase/remote-config",Td="@firebase/remote-config-compat",_d="@firebase/storage",Id="@firebase/storage-compat",Ad="@firebase/firestore",kd="@firebase/ai",Rd="@firebase/firestore-compat",Dd="firebase",Pd="[DEFAULT]",xd={[nd]:"fire-core",[od]:"fire-core-compat",[ad]:"fire-analytics",[sd]:"fire-analytics-compat",[cd]:"fire-app-check",[ld]:"fire-app-check-compat",[ud]:"fire-auth",[dd]:"fire-auth-compat",[hd]:"fire-rtdb",[fd]:"fire-data-connect",[pd]:"fire-rtdb-compat",[gd]:"fire-fn",[md]:"fire-fn-compat",[vd]:"fire-iid",[yd]:"fire-iid-compat",[wd]:"fire-fcm",[bd]:"fire-fcm-compat",[Cd]:"fire-perf",[Sd]:"fire-perf-compat",[Ed]:"fire-rc",[Td]:"fire-rc-compat",[_d]:"fire-gcs",[Id]:"fire-gcs-compat",[Ad]:"fire-fst",[Rd]:"fire-fst-compat",[kd]:"fire-vertex","fire-js":"fire-js",[Dd]:"fire-js-all"},Od=new Map,Nd=new Map,Md=new Map;function Ld(e,t){try{e.container.addComponent(t)}catch(d){id.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,d)}}function Ud(e){const t=e.name;if(Md.has(t))return id.debug(`There were multiple attempts to register component ${t}.`),!1;Md.set(t,e);for(const n of Od.values())Ld(n,e);for(const n of Nd.values())Ld(n,e);return!0}function Fd(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Hd(e){return null!==e&&void 0!==e&&void 0!==e.settings}const jd=new mu("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Bd{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Au("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jd.create("app-deleted",{appName:this._name})}}const zd="11.10.0";function qd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Pd,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw jd.create("bad-app-name",{appName:String(i)});if(n||(n=tu()),!n)throw jd.create("no-options");const o=Od.get(i);if(o){if(yu(n,o.options)&&yu(r,o.config))return o;throw jd.create("duplicate-app",{appName:i})}const s=new Du(i);for(const l of Md.values())s.addComponent(l);const a=new Bd(n,r,s);return Od.set(i,a),a}function Vd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pd;const t=Od.get(e);if(!t&&e===Pd&&tu())return qd();if(!t)throw jd.create("no-app",{appName:e});return t}function Wd(e,t,n){var r;let i=null!==(r=xd[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=[`Unable to register library "${i}" with version "${t}":`];return o&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void id.warn(e.join(" "))}Ud(new Au(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const $d="firebase-heartbeat-store";let Gd=null;function Kd(){return Gd||(Gd=Yu("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore($d)}catch(d){console.warn(d)}}}).catch(e=>{throw jd.create("idb-open",{originalErrorMessage:e.message})})),Gd}async function Qd(e,t){try{const n=(await Kd()).transaction($d,"readwrite"),r=n.objectStore($d);await r.put(t,Yd(e)),await n.done}catch(d){if(d instanceof gu)id.warn(d.message);else{const t=jd.create("idb-set",{originalErrorMessage:null===d||void 0===d?void 0:d.message});id.warn(t.message)}}}function Yd(e){return`${e.name}!${e.options.appId}`}class Jd{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Zd(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Xd();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(d){id.warn(d)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Xd(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),eh(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),eh(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Yc(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(d){return id.warn(d),""}}}function Xd(){return(new Date).toISOString().substring(0,10)}class Zd{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!fu()&&pu().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Kd()).transaction($d),n=await t.objectStore($d).get(Yd(e));return await t.done,n}catch(d){if(d instanceof gu)id.warn(d.message);else{const t=jd.create("idb-get",{originalErrorMessage:null===d||void 0===d?void 0:d.message});id.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Qd(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Qd(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function eh(e){return Yc(JSON.stringify({version:2,heartbeats:e})).length}var th;th="",Ud(new Au("platform-logger",e=>new td(e),"PRIVATE")),Ud(new Au("heartbeat",e=>new Jd(e),"PRIVATE")),Wd(nd,rd,th),Wd(nd,rd,"esm2017"),Wd("fire-js","");Wd("firebase","11.10.0","app");function nh(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function rh(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ih=rh,oh=new mu("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),sh=new Uu("@firebase/auth");function ah(e){if(sh.logLevel<=xu.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];sh.error(`Auth (${zd}): ${e}`,...n)}}function lh(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw hh(e,...n)}function ch(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return hh(e,...n)}function uh(e,t,n){const r=Object.assign(Object.assign({},ih()),{[t]:n});return new mu("auth","Firebase",r).create(t,{appName:e.name})}function dh(e){return uh(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hh(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return oh.create(e,...n)}function fh(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw hh(t,...r)}}function ph(e){const t="INTERNAL ASSERTION FAILED: "+e;throw ah(t),new Error(t)}function gh(e,t){e||ph(t)}function mh(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function vh(){return"http:"===yh()||"https:"===yh()}function yh(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class wh{constructor(e,t){this.shortDelay=e,this.longDelay=t,gh(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cu())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(vh()||du()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function bh(e,t){gh(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Ch{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void ph("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void ph("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void ph("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Sh={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Eh=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Th=new wh(3e4,6e4);function _h(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Ih(e,t,n,r){return Ah(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},o={};r&&("GET"===t?o=r:i={body:JSON.stringify(r)});const s=bu(Object.assign({key:e.config.apiKey},o)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&iu(e.emulatorConfig.host)&&(l.credentials="include"),Ch.fetch()(await Rh(e,e.config.apiHost,n,s),l)})}async function Ah(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Sh),t);try{const t=new Ph(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw xh(e,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const t=i.ok?o.errorMessage:o.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw xh(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw xh(e,"email-already-in-use",o);if("USER_DISABLED"===n)throw xh(e,"user-disabled",o);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw uh(e,a,s);lh(e,a)}}catch(d){if(d instanceof gu)throw d;lh(e,"network-request-failed",{message:String(d)})}}async function kh(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const o=await Ih(e,t,n,r,i);return"mfaPendingCredential"in o&&lh(e,"multi-factor-auth-required",{_serverResponse:o}),o}async function Rh(e,t,n,r){const i=`${t}${n}?${r}`,o=e,s=o.config.emulator?bh(e.config,i):`${e.config.apiScheme}://${i}`;if(Eh.includes(n)&&(await o._persistenceManagerAvailable,"COOKIE"===o._getPersistenceType())){return o._getPersistence()._getFinalTarget(s).toString()}return s}function Dh(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ph{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(ch(this.auth,"network-request-failed")),Th.get())})}}function xh(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=ch(e,t,r);return i.customData._tokenResponse=n,i}function Oh(e){return void 0!==e&&void 0!==e.enterprise}class Nh{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Dh(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Mh(e,t){return Ih(e,"GET","/v2/recaptchaConfig",_h(e,t))}async function Lh(e,t){return Ih(e,"POST","/v1/accounts:lookup",t)}function Uh(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(d){}}function Fh(e){return 1e3*Number(e)}function Hh(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return ah("JWT malformed, contained fewer than 3 sections"),null;try{const e=Jc(n);return e?JSON.parse(e):(ah("Failed to decode base64 JWT payload"),null)}catch(d){return ah("Caught error parsing JWT payload as JSON",null===d||void 0===d?void 0:d.toString()),null}}function jh(e){const t=Hh(e);return fh(t,"internal-error"),fh("undefined"!==typeof t.exp,"internal-error"),fh("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Bh(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(d){throw d instanceof gu&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(d)&&e.auth.currentUser===e&&await e.auth.signOut(),d}}class zh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(d){return void("auth/network-request-failed"===(null===d||void 0===d?void 0:d.code)&&this.schedule(!0))}this.schedule()}}class qh{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Uh(this.lastLoginAt),this.creationTime=Uh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Vh(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Bh(e,Lh(n,{idToken:r}));fh(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const s=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?Wh(o.providerUserInfo):[],a=function(e,t){const n=e.filter(e=>!t.some(t=>t.providerId===e.providerId));return[...n,...t]}(e.providerData,s),l=e.isAnonymous,c=!(e.email&&o.passwordHash)&&!(null===a||void 0===a?void 0:a.length),u=!!l&&c,d={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new qh(o.createdAt,o.lastLoginAt),isAnonymous:u};Object.assign(e,d)}function Wh(e){return e.map(e=>{var{providerId:t}=e,n=nh(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class $h{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fh(e.idToken,"internal-error"),fh("undefined"!==typeof e.idToken,"internal-error"),fh("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):jh(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){fh(0!==e.length,"internal-error");const t=jh(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(fh(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Ah(e,{},async()=>{const n=bu({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,o=await Rh(e,r,"/v1/token",`key=${i}`),s=await e._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:s,body:n};return e.emulatorConfig&&iu(e.emulatorConfig.host)&&(a.credentials="include"),Ch.fetch()(o,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,o=new $h;return n&&(fh("string"===typeof n,"internal-error",{appName:e}),o.refreshToken=n),r&&(fh("string"===typeof r,"internal-error",{appName:e}),o.accessToken=r),i&&(fh("number"===typeof i,"internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $h,this.toJSON())}_performRefresh(){return ph("not implemented")}}function Gh(e,t){fh("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Kh{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=nh(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new qh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Bh(this,this.stsTokenManager.getToken(this.auth,e));return fh(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Iu(e),r=await n.getIdToken(t),i=Hh(r);fh(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const o="object"===typeof i.firebase?i.firebase:void 0,s=null===o||void 0===o?void 0:o.sign_in_provider;return{claims:i,token:r,authTime:Uh(Fh(i.auth_time)),issuedAtTime:Uh(Fh(i.iat)),expirationTime:Uh(Fh(i.exp)),signInProvider:s||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Iu(e);await Vh(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(fh(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Kh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){fh(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Vh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hd(this.auth.app))return Promise.reject(dh(this.auth));const e=await this.getIdToken();return await Bh(this,async function(e,t){return Ih(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,o,s,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(o=t.photoURL)&&void 0!==o?o:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:w,isAnonymous:b,providerData:C,stsTokenManager:S}=t;fh(y&&S,e,"internal-error");const E=$h.fromJSON(this.name,S);fh("string"===typeof y,e,"internal-error"),Gh(u,e.name),Gh(d,e.name),fh("boolean"===typeof w,e,"internal-error"),fh("boolean"===typeof b,e,"internal-error"),Gh(h,e.name),Gh(f,e.name),Gh(p,e.name),Gh(g,e.name),Gh(m,e.name),Gh(v,e.name);const T=new Kh({uid:y,auth:e,email:d,emailVerified:w,displayName:u,isAnonymous:b,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:E,createdAt:m,lastLoginAt:v});return C&&Array.isArray(C)&&(T.providerData=C.map(e=>Object.assign({},e))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new $h;r.updateFromServerResponse(t);const i=new Kh({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Vh(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];fh(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Wh(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),s=new $h;s.updateFromIdToken(n);const a=new Kh({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:o}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new qh(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const Qh=new Map;function Yh(e){gh(e instanceof Function,"Expected a class definition");let t=Qh.get(e);return t?(gh(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Qh.set(e,t),t)}class Jh{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Jh.type="NONE";const Xh=Jh;function Zh(e,t,n){return`firebase:${e}:${t}:${n}`}class ef{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Zh(this.userKey,r.apiKey,i),this.fullPersistenceKey=Zh("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Lh(this.auth,{idToken:e}).catch(()=>{});return t?Kh._fromGetAccountInfoResponse(this.auth,t,e):null}return Kh._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ef(Yh(Xh),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||Yh(Xh);const o=Zh(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(o);if(t){let n;if("string"===typeof t){const r=await Lh(e,{idToken:t}).catch(()=>{});if(!r)break;n=await Kh._fromGetAccountInfoResponse(e,r,t)}else n=Kh._fromJSON(e,t);c!==i&&(s=n),i=c;break}}catch(l){}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],s&&await i._set(o,s.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(o)}catch(l){}})),new ef(i,e,n)):new ef(i,e,n)}}function tf(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(sf(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(nf(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(lf(t))return"Blackberry";if(cf(t))return"Webos";if(rf(t))return"Safari";if((t.includes("chrome/")||of(t))&&!t.includes("edge/"))return"Chrome";if(af(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function nf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu();return/firefox\//i.test(e)}function rf(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function of(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu();return/crios\//i.test(e)}function sf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu();return/iemobile/i.test(e)}function af(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu();return/android/i.test(e)}function lf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu();return/blackberry/i.test(e)}function cf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu();return/webos/i.test(e)}function uf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function df(){return function(){const e=cu();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function hf(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu();return uf(e)||af(e)||cf(e)||lf(e)||/windows phone/i.test(e)||sf(e)}function ff(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=tf(cu());break;case"Worker":t=`${tf(cu())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${zd}/${r}`}class pf{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(d){r(d)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(d){t.reverse();for(const n of t)try{n()}catch(S){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===d||void 0===d?void 0:d.message})}}}class gf{constructor(e){var t,n,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=o.minPasswordLength)&&void 0!==t?t:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,o,s;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(o=a.containsNumericCharacter)||void 0===o||o),a.isValid&&(a.isValid=null===(s=a.containsNonAlphanumericCharacter)||void 0===s||s),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class mf{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yf(this),this.idTokenSubscription=new yf(this),this.beforeStateQueue=new pf(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oh,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yh(t)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await ef.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(d){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Lh(this,{idToken:e}),n=await Kh._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Hd(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,o=null===r||void 0===r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==o||!(null===s||void 0===s?void 0:s.user)||(r=s.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(d){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return fh(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(d){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(d){if("auth/network-request-failed"!==(null===d||void 0===d?void 0:d.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hd(this.app))return Promise.reject(dh(this));const t=e?Iu(e):null;return t&&fh(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&fh(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hd(this.app)?Promise.reject(dh(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hd(this.app)?Promise.reject(dh(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Yh(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Ih(e,"GET","/v2/passwordPolicy",_h(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new gf(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new mu("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Ih(e,"POST","/v2/accounts:revokeToken",_h(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Yh(e)||this._popupRedirectResolver;fh(t,this,"argument-error"),this.redirectPersistenceManager=await ef.create(this,[Yh(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(fh(s,this,"internal-error"),s.then(()=>{o||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{o=!0,i()}}{const n=e.addObserver(t);return()=>{o=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fh(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ff(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(Hd(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(sh.logLevel<=xu.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];sh.warn(`Auth (${zd}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function vf(e){return Iu(e)}class yf{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Eu(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return fh(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let wf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bf(e){return wf.loadJS(e)}function Cf(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Sf{constructor(){this.enterprise=new Ef}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Ef{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Tf="NO_RECAPTCHA";class _f{constructor(e){this.type="recaptcha-enterprise",this.auth=vf(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Oh(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Tf)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Sf).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Mh(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Nh(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Oh(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=wf.recaptchaEnterpriseScript;0!==t.length&&(t+=i),bf(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function If(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const o=new _f(e);let s;if(i)s=Tf;else try{s=await o.verify(n)}catch(l){s=await o.verify(n,!0)}const a=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Af(e,t,n,r,i){var o,s;if("EMAIL_PASSWORD_PROVIDER"===i){if(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await If(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await If(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("PHONE_PROVIDER")){const i=await If(e,t,n);return r(e,i).catch(async i=>{var o;if("AUDIT"===(null===(o=e._getRecaptchaConfig())||void 0===o?void 0:o.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await If(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await If(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function kf(e){const t=vf(e),n=await Mh(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Nh(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new _f(t).verify()}}function Rf(e,t,n){const r=vf(e);fh(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),o=Df(t),{host:s,port:a}=function(e){const t=Df(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Pf(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Pf(t)}}}(t),l=null===a?"":`:${a}`,c={url:`${o}//${s}${l}/`},u=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return fh(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void fh(yu(c,r.config.emulator)&&yu(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,iu(s)?(ou(`${o}//${s}${l}`),lu("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Df(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Pf(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class xf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ph("not implemented")}_getIdTokenResponse(e){return ph("not implemented")}_linkToIdToken(e,t){return ph("not implemented")}_getReauthenticationResolver(e){return ph("not implemented")}}async function Of(e,t){return Ih(e,"POST","/v1/accounts:signUp",t)}async function Nf(e,t){return kh(e,"POST","/v1/accounts:signInWithPassword",_h(e,t))}class Mf extends xf{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Mf(e,t,"password")}static _fromEmailAndCode(e,t){return new Mf(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Af(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Nf,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return kh(e,"POST","/v1/accounts:signInWithEmailLink",_h(e,t))}(e,{email:this._email,oobCode:this._password});default:lh(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Af(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Of,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return kh(e,"POST","/v1/accounts:signInWithEmailLink",_h(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:lh(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Lf(e,t){return kh(e,"POST","/v1/accounts:signInWithIdp",_h(e,t))}class Uf extends xf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Uf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):lh("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=nh(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new Uf(n,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){return Lf(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Lf(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Lf(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=bu(t)}return e}}async function Ff(e,t){return Ih(e,"POST","/v1/accounts:sendVerificationCode",_h(e,t))}const Hf={USER_NOT_FOUND:"user-not-found"};class jf extends xf{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new jf({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new jf({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return kh(e,"POST","/v1/accounts:signInWithPhoneNumber",_h(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await kh(e,"POST","/v1/accounts:signInWithPhoneNumber",_h(e,t));if(n.temporaryProof)throw xh(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return kh(e,"POST","/v1/accounts:signInWithPhoneNumber",_h(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Hf)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new jf({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Bf{constructor(e){var t,n,r,i,o,s;const a=Cu(Su(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);fh(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=a.lang)&&void 0!==o?o:null,this.tenantId=null!==(s=a.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=Cu(Su(e)).link,n=t?Cu(Su(t)).deep_link_id:null,r=Cu(Su(e)).deep_link_id;return(r?Cu(Su(r)).link:null)||r||n||t||e}(e);try{return new Bf(t)}catch(n){return null}}}class zf{constructor(){this.providerId=zf.PROVIDER_ID}static credential(e,t){return Mf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Bf.parseLink(t);return fh(n,"argument-error"),Mf._fromEmailAndCode(e,n.code,n.tenantId)}}zf.PROVIDER_ID="password",zf.EMAIL_PASSWORD_SIGN_IN_METHOD="password",zf.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class qf{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Vf extends qf{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Wf extends Vf{constructor(){super("facebook.com")}static credential(e){return Uf._fromParams({providerId:Wf.PROVIDER_ID,signInMethod:Wf.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wf.credentialFromTaggedObject(e)}static credentialFromError(e){return Wf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Wf.credential(t.oauthAccessToken)}catch(n){return null}}}Wf.FACEBOOK_SIGN_IN_METHOD="facebook.com",Wf.PROVIDER_ID="facebook.com";class $f extends Vf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Uf._fromParams({providerId:$f.PROVIDER_ID,signInMethod:$f.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return $f.credentialFromTaggedObject(e)}static credentialFromError(e){return $f.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return $f.credential(n,r)}catch(i){return null}}}$f.GOOGLE_SIGN_IN_METHOD="google.com",$f.PROVIDER_ID="google.com";class Gf extends Vf{constructor(){super("github.com")}static credential(e){return Uf._fromParams({providerId:Gf.PROVIDER_ID,signInMethod:Gf.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gf.credentialFromTaggedObject(e)}static credentialFromError(e){return Gf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Gf.credential(t.oauthAccessToken)}catch(n){return null}}}Gf.GITHUB_SIGN_IN_METHOD="github.com",Gf.PROVIDER_ID="github.com";class Kf extends Vf{constructor(){super("twitter.com")}static credential(e,t){return Uf._fromParams({providerId:Kf.PROVIDER_ID,signInMethod:Kf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Kf.credentialFromTaggedObject(e)}static credentialFromError(e){return Kf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Kf.credential(n,r)}catch(i){return null}}}Kf.TWITTER_SIGN_IN_METHOD="twitter.com",Kf.PROVIDER_ID="twitter.com";class Qf{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await Kh._fromIdTokenResponse(e,n,r),o=Yf(n);return new Qf({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Yf(n);return new Qf({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Yf(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Jf extends gu{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Jf.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Jf(e,t,n,r)}}function Xf(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Jf._fromErrorAndOperation(e,n,t,r);throw n})}async function Zf(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Bh(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Qf._forOperation(e,"link",r)}async function ep(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Hd(r.app))return Promise.reject(dh(r));const i="reauthenticate";try{const o=await Bh(e,Xf(r,i,t,e),n);fh(o.idToken,r,"internal-error");const s=Hh(o.idToken);fh(s,r,"internal-error");const{sub:a}=s;return fh(e.uid===a,r,"user-mismatch"),Qf._forOperation(e,i,o)}catch(d){throw"auth/user-not-found"===(null===d||void 0===d?void 0:d.code)&&lh(r,"user-mismatch"),d}}async function tp(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Hd(e.app))return Promise.reject(dh(e));const r="signIn",i=await Xf(e,r,t),o=await Qf._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(o.user),o}function np(e,t){return Ih(e,"POST","/v2/accounts/mfaEnrollment:start",_h(e,t))}new WeakMap;const rp="__sak";class ip{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(rp,"1"),this.storage.removeItem(rp),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class op extends ip{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hf(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);df()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}op.type="LOCAL";const sp=op;function ap(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp(`${r}=([^;]+)`);return null!==(n=null===(t=document.cookie.match(i))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function lp(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class cp{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=lp(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return ap(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=lp(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=lp(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=ap(n);const i=setInterval(()=>{const e=ap(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}cp.type="COOKIE";class up extends ip{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}up.type="SESSION";const dp=up;class hp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new hp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!(null===o||void 0===o?void 0:o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(o).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function fp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}hp.receivers=[];class pp{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((s,a)=>{const l=fp("",20);r.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);o={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),s(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function gp(){return window}function mp(){return"undefined"!==typeof gp().WorkerGlobalScope&&"function"===typeof gp().importScripts}const vp="firebaseLocalStorageDb",yp="firebaseLocalStorage",wp="fbase_key";class bp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Cp(e,t){return e.transaction([yp],t?"readwrite":"readonly").objectStore(yp)}function Sp(){const e=indexedDB.open(vp,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(yp,{keyPath:wp})}catch(d){n(d)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(yp)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(vp);return new bp(e).toPromise()}(),t(await Sp()))})})}async function Ep(e,t,n){const r=Cp(e,!0).put({[wp]:t,value:n});return new bp(r).toPromise()}function Tp(e,t){const n=Cp(e,!0).delete(t);return new bp(n).toPromise()}class _p{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Sp()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(d){if(t++>3)throw d;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hp._getInstance(mp()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new pp(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await Ep(e,rp,"1"),await Tp(e,rp),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ep(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Cp(e,!1).get(t),r=await new bp(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Tp(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Cp(e,!1).getAll();return new bp(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}_p.type="LOCAL";const Ip=_p;function Ap(e,t){return Ih(e,"POST","/v2/accounts/mfaSignIn:start",_h(e,t))}Cf("rcb"),new wh(3e4,6e4);const kp="recaptcha";async function Rp(e,t,n){var r;if(!e._getRecaptchaConfig())try{await kf(e)}catch(i){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){fh("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},o=Af(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Tf){fh((null===n||void 0===n?void 0:n.type)===kp,e,"argument-error");return np(e,await Dp(e,t,n))}return np(e,t)},"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{fh("signin"===t.type,e,"internal-error");const o=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;fh(o,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:o,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},a=Af(e,s,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Tf){fh((null===n||void 0===n?void 0:n.type)===kp,e,"argument-error");return Ap(e,await Dp(e,t,n))}return Ap(e,t)},"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Af(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Tf){fh((null===n||void 0===n?void 0:n.type)===kp,e,"argument-error");return Ff(e,await Dp(e,t,n))}return Ff(e,t)},"PHONE_PROVIDER");return(await r.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Dp(e,t,n){fh(n.type===kp,e,"argument-error");const r=await n.verify();fh("string"===typeof r,e,"argument-error");const i=Object.assign({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,o=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:o}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Pp{constructor(e){this.providerId=Pp.PROVIDER_ID,this.auth=vf(e)}verifyPhoneNumber(e,t){return Rp(this.auth,e,Iu(t))}static credential(e,t){return jf._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Pp.credentialFromTaggedObject(t)}static credentialFromError(e){return Pp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?jf._fromTokenResponse(n,r):null}}function xp(e,t){return t?Yh(t):(fh(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Pp.PROVIDER_ID="phone",Pp.PHONE_SIGN_IN_METHOD="phone";class Op extends xf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lf(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Lf(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Lf(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Np(e){return tp(e.auth,new Op(e),e.bypassAuthState)}function Mp(e){const{auth:t,user:n}=e;return fh(n,t,"internal-error"),ep(n,new Op(e),e.bypassAuthState)}async function Lp(e){const{auth:t,user:n}=e;return fh(n,t,"internal-error"),Zf(n,new Op(e),e.bypassAuthState)}class Up{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(d){this.reject(d)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:o,type:s}=e;if(o)return void this.reject(o);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(a))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Np;case"linkViaPopup":case"linkViaRedirect":return Lp;case"reauthViaPopup":case"reauthViaRedirect":return Mp;default:lh(this.auth,"internal-error")}}resolve(e){gh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){gh(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Fp=new wh(2e3,1e4);class Hp extends Up{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Hp.currentPopupAction&&Hp.currentPopupAction.cancel(),Hp.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fh(e,this.auth,"internal-error"),e}async onExecution(){gh(1===this.filter.length,"Popup operations only handle one event");const e=fp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(ch(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(ch(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hp.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ch(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Fp.get())};e()}}Hp.currentPopupAction=null;const jp=new Map;class Bp extends Up{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=jp.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Vp(t),r=qp(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(d){e=()=>Promise.reject(d)}jp.set(this.auth._key(),e)}return this.bypassAuthState||jp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function zp(e,t){jp.set(e._key(),t)}function qp(e){return Yh(e._redirectPersistence)}function Vp(e){return Zh("pendingRedirect",e.config.apiKey,e.name)}async function Wp(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Hd(e.app))return Promise.reject(dh(e));const r=vf(e),i=xp(r,t),o=new Bp(r,i,n),s=await o.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class $p{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Kp(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Kp(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(ch(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Gp(e))}saveEventToCache(e){this.cachedEventUids.add(Gp(e)),this.lastProcessedEventTime=Date.now()}}function Gp(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Kp(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}const Qp=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Yp=/^https?/;async function Jp(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Ih(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Xp(r))return}catch(n){}lh(e,"unauthorized-domain")}function Xp(e){const t=mh(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Yp.test(n))return!1;if(Qp.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Zp=new wh(3e4,6e4);function eg(){const e=gp().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function tg(e){return new Promise((t,n)=>{var r,i,o;function s(){eg(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{eg(),n(ch(e,"network-request-failed"))},timeout:Zp.get()})}if(null===(i=null===(r=gp().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(o=gp().gapi)||void 0===o?void 0:o.load)){const t=Cf("iframefcb");return gp()[t]=()=>{gapi.load?s():n(ch(e,"network-request-failed"))},bf(`${wf.gapiScript}?onload=${t}`).catch(e=>n(e))}s()}}).catch(e=>{throw ng=null,e})}let ng=null;const rg=new wh(5e3,15e3),ig={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},og=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function sg(e){const t=e.config;fh(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?bh(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:zd},i=og.get(e.config.apiHost);i&&(r.eid=i);const o=e._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${bu(r).slice(1)}`}async function ag(e){const t=await function(e){return ng=ng||tg(e),ng}(e),n=gp().gapi;return fh(n,e,"internal-error"),t.open({where:document.body,url:sg(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ig,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=ch(e,"network-request-failed"),o=gp().setTimeout(()=>{r(i)},rg.get());function s(){gp().clearTimeout(o),n(t)}t.ping(s).then(s,()=>{r(i)})}))}const lg={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class cg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(d){}}}function ug(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},lg),{width:r.toString(),height:i.toString(),top:o,left:s}),c=cu().toLowerCase();n&&(a=of(c)?"_blank":n),nf(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`},"");if(function(){var e;return uf(arguments.length>0&&void 0!==arguments[0]?arguments[0]:cu())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new cg(null);const h=window.open(t||"",a,u);fh(h,e,"popup-blocked");try{h.focus()}catch(d){}return new cg(h)}const dg="__/auth/handler",hg="emulator/auth/handler",fg=encodeURIComponent("fac");async function pg(e,t,n,r,i,o){fh(e.config.authDomain,e,"auth-domain-config-required"),fh(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:zd,eventId:i};if(t instanceof qf){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))s[e]=t}if(t instanceof Vf){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const a=s;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?`#${fg}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${dg}`;return bh(t,hg)}(e)}?${bu(a).slice(1)}${c}`}const gg="webStorageSupport";const mg=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=dp,this._completeRedirectFn=Wp,this._overrideRedirectResult=zp}async _openPopup(e,t,n,r){var i;gh(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return ug(e,await pg(e,t,n,mh(),r),fp())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){gp().location.href=e}(await pg(e,t,n,mh(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(gh(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await ag(e),n=new $p(e);return t.register("authEvent",t=>{fh(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gg,{type:gg},n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[gg];void 0!==i&&t(!!i),lh(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Jp(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return hf()||rf()||uf()}};var vg="@firebase/auth",yg="1.10.8";class wg{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){fh(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const bg=nu("authIdTokenMaxAge")||300;let Cg=null;var Sg;!function(e){wf=e}({loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=ch("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Sg="Browser",Ud(new Au("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;fh(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:s,authDomain:a,clientPlatform:Sg,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ff(Sg)},c=new mf(r,i,o,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Yh);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Ud(new Au("auth-internal",e=>(e=>new wg(e))(vf(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Wd(vg,yg,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Sg)),Wd(vg,yg,"esm2017");var Eg,Tg,_g="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ig={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var o=e.g[3],s=t+(o^n&(i^o))+r[0]+3614090360&4294967295;s=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=n+(s<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^o&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^i^o)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(n|~o))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~o))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~o))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(t=n+((s=t+(i^(n|~o))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=o+((s=i+(t^(o|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var o=0|e[i];r&&o==t||(n[i]=o,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,o=this.h,s=0;s<t;){if(0==o)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(i[o++]=e.charCodeAt(s++),o==this.blockSize){n(this,i),o=0;break}}else for(;s<t;)if(i[o++]=e[s++],o==this.blockSize){n(this,i),o=0;break}}this.h=o,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function o(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],0>e?-1:0)}):new r([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return h(s(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=o(0),l=o(1),c=o(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function d(e){return-1==e.h}function h(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(h(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function g(e,t){this.g=e,this.h=t}function m(e,t){if(u(t))throw Error("division by zero");if(u(e))return new g(a,a);if(d(e))return t=m(h(e),t),new g(h(t.g),h(t.h));if(d(t))return t=m(e,h(t)),new g(h(t.g),t.h);if(30<e.g.length){if(d(e)||d(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var i=y(n,1),o=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=o.add(r);0>=c.l(e)&&(i=i.add(n),o=c),r=y(r,1),n=y(n,1)}return t=f(e,i.j(t)),new g(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(o=s(n)).j(t);d(c)||0<c.l(e);)c=(o=s(n-=r)).j(t);u(o)&&(o=l),i=i.add(o),e=f(e,c)}return new g(i,e)}function v(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,o=[],s=0;s<i;s++)o[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new r(o,e.h)}(e=r.prototype).m=function(){if(d(this))return-h(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(d(this))return"-"+h(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,r="";;){var i=m(n,t).g,o=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return o+r;for(;6>o.length;)o="0"+o;r=o+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return d(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return d(this)?h(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,o=0;o<=t;o++){var s=i+(65535&this.i(o))+(65535&e.i(o)),a=(s>>>16)+(this.i(o)>>>16)+(e.i(o)>>>16);i=a>>>16,s&=65535,a&=65535,n[o]=a<<16|s}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(d(this))return d(e)?h(this).j(h(e)):h(h(this).j(e));if(d(e))return h(this.j(h(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var o=0;o<e.g.length;o++){var l=this.i(i)>>>16,f=65535&this.i(i),g=e.i(o)>>>16,m=65535&e.i(o);n[2*i+2*o]+=f*m,p(n,2*i+2*o),n[2*i+2*o+1]+=l*m,p(n,2*i+2*o+1),n[2*i+2*o+1]+=f*g,p(n,2*i+2*o+1),n[2*i+2*o+2]+=l*g,p(n,2*i+2*o+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return m(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Tg=Ig.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return h(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=s(Math.pow(n,8)),i=a,o=0;o<t.length;o+=8){var l=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+l),n);8>l?(l=s(Math.pow(n,l)),i=i.j(l).add(s(c))):i=(i=i.j(r)).add(s(c))}return i},Eg=Ig.Integer=r}).apply("undefined"!==typeof _g?_g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Ag,kg,Rg,Dg,Pg,xg,Og,Ng,Mg="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Lg={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Mg&&Mg];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var o=0;o<e.length-1;o++){var s=e[o];if(!(s in i))break e;i=i[s]}(r=r(o=i[e=e[e.length-1]]))!=o&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(e,t){return t})}});var r=r||{},o=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function l(e,t,n){return e.call.apply(e.bind,arguments)}function c(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function h(e,t,n){return(h=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?l:c).apply(null,arguments)}function f(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function p(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function m(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function y(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function w(e){return/^[\s\xa0]*$/.test(e)}function b(){var e=o.navigator;return e&&(e=e.userAgent)?e:""}function C(e){return C[" "](e),e}C[" "]=function(){};var S=-1!=b().indexOf("Gecko")&&!(-1!=b().toLowerCase().indexOf("webkit")&&-1==b().indexOf("Edge"))&&!(-1!=b().indexOf("Trident")||-1!=b().indexOf("MSIE"))&&-1==b().indexOf("Edge");function T(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function A(e){const t={};for(const n in e)t[n]=e[n];return t}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<k.length;t++)n=k[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function D(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function P(e){o.setTimeout(()=>{throw e},0)}function x(){var e=U;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var O=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new N,e=>e.reset());class N{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let M,L=!1,U=new class{constructor(){this.h=this.g=null}add(e,t){const n=O.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},F=()=>{const e=o.Promise.resolve(void 0);M=()=>{e.then(H)}};var H=()=>{for(var e;e=x();){try{e.h.call(e.g)}catch(g){P(g)}var t=O;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}L=!1};function j(){this.s=this.s,this.C=this.C}function B(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},B.prototype.h=function(){this.defaultPrevented=!0};var z=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};o.addEventListener("test",e,t),o.removeEventListener("test",e,t)}catch(g){}return e}();function q(e,t){if(B.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(S){e:{try{C(t.nodeName);var i=!0;break e}catch(u){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:V[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&q.aa.h.call(this)}}p(q,B);var V={2:"touch",3:"pen",4:"mouse"};q.prototype.h=function(){q.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var W="closure_listenable_"+(1e6*Math.random()|0),$=0;function G(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++$,this.da=this.fa=!1}function K(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function Q(e){this.src=e,this.g={},this.h=0}function Y(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],o=Array.prototype.indexOf.call(i,t,void 0);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(K(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function J(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.da&&o.listener==t&&o.capture==!!n&&o.ha==r)return i}return-1}Q.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var s=J(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new G(t,this.src,o,!!r,i)).fa=n,e.push(t)),t};var X="closure_lm_"+(1e6*Math.random()|0),Z={};function ee(e,t,n,r,i){if(r&&r.once)return ne(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)ee(e,t[o],n,r,i);return null}return n=ce(n),e&&e[W]?e.K(t,n,a(r)?!!r.capture:!!r,i):te(e,t,n,!1,r,i)}function te(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=a(i)?!!i.capture:!!i,l=ae(e);if(l||(e[X]=l=new Q(e)),(n=l.add(t,n,r,s,o)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=se;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)z||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(oe(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ne(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)ne(e,t[o],n,r,i);return null}return n=ce(n),e&&e[W]?e.L(t,n,a(r)?!!r.capture:!!r,i):te(e,t,n,!0,r,i)}function re(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)re(e,t[o],n,r,i);else r=a(r)?!!r.capture:!!r,n=ce(n),e&&e[W]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=J(o=e.g[t],n,r,i))&&(K(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--)))):e&&(e=ae(e))&&(t=e.g[t.toString()],e=-1,t&&(e=J(t,n,r,i)),(n=-1<e?t[e]:null)&&ie(n))}function ie(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[W])Y(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(oe(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ae(t))?(Y(n,e),0==n.h&&(n.src=null,t[X]=null)):K(e)}}}function oe(e){return e in Z?Z[e]:Z[e]="on"+e}function se(e,t){if(e.da)e=!0;else{t=new q(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&ie(e),e=n.call(r,t)}return e}function ae(e){return(e=e[X])instanceof Q?e:null}var le="__closure_events_fn_"+(1e9*Math.random()>>>0);function ce(e){return"function"===typeof e?e:(e[le]||(e[le]=function(t){return e.handleEvent(t)}),e[le])}function ue(){j.call(this),this.i=new Q(this),this.M=this,this.F=null}function de(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new B(t,e);else if(t instanceof B)t.target=t.target||e;else{var i=t;R(t=new B(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.g=n[o];i=he(s,r,!0,t)&&i}if(i=he(s=t.g=e,r,!0,t)&&i,i=he(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=he(s=t.g=n[o],r,!1,t)&&i}function he(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.da&&s.capture==n){var a=s.listener,l=s.ha||s.src;s.fa&&Y(e.i,s),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function fe(e,t,n){if("function"===typeof e)n&&(e=h(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=h(e.handleEvent,e)}return 2147483647<Number(t)?-1:o.setTimeout(e,t||0)}function pe(e){e.g=fe(()=>{e.g=null,e.i&&(e.i=!1,pe(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}p(ue,j),ue.prototype[W]=!0,ue.prototype.removeEventListener=function(e,t,n,r){re(this,e,t,n,r)},ue.prototype.N=function(){if(ue.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)K(n[r]);delete t.g[e],t.h--}}this.F=null},ue.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ue.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ge extends j{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:pe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function me(e){j.call(this),this.h=e,this.g={}}p(me,j);var ve=[];function ye(e){T(e.g,function(e,t){this.g.hasOwnProperty(t)&&ie(e)},e),e.g={}}me.prototype.N=function(){me.aa.N.call(this),ye(this)},me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var we=o.JSON.stringify,be=o.JSON.parse,Ce=class{stringify(e){return o.JSON.stringify(e,void 0)}parse(e){return o.JSON.parse(e,void 0)}};function Se(){}function Ee(e){return e.h||(e.h=e.i())}function Te(){}Se.prototype.h=null;var _e={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ie(){B.call(this,"d")}function Ae(){B.call(this,"c")}p(Ie,B),p(Ae,B);var ke={},Re=null;function De(){return Re=Re||new ue}function Pe(e){B.call(this,ke.La,e)}function xe(e){const t=De();de(t,new Pe(t))}function Oe(e,t){B.call(this,ke.STAT_EVENT,e),this.stat=t}function Ne(e){const t=De();de(t,new Oe(t,e))}function Me(e,t){B.call(this,ke.Ma,e),this.size=t}function Le(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){e()},t)}function Ue(){this.g=!0}function Fe(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return we(n)}catch(_){return t}}(e,n)+(r?" "+r:"")})}ke.La="serverreachability",p(Pe,B),ke.STAT_EVENT="statevent",p(Oe,B),ke.Ma="timingevent",p(Me,B),Ue.prototype.xa=function(){this.g=!1},Ue.prototype.info=function(){};var He,je={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Be={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function ze(){}function qe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new me(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ve}function Ve(){this.i=null,this.g="",this.h=!1}p(ze,Se),ze.prototype.g=function(){return new XMLHttpRequest},ze.prototype.i=function(){return{}},He=new ze;var We={},$e={};function Ge(e,t,n){e.L=1,e.v=wt(pt(t)),e.m=n,e.P=!0,Ke(e,null)}function Ke(e,t){e.F=Date.now(),Je(e),e.A=pt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),xt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Ve,e.g=bn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ge(h(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ve[0]=i.toString()),i=ve);for(var o=0;o<i.length;o++){var s=ee(n,i[o],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?A(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),xe(),function(e,t,n,r,i,o){e.info(function(){if(e.g)if(o)for(var s="",a=o.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");s=2<=d.length&&"type"==d[1]?s+(u+"=")+c+"&":s+(u+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Qe(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ye(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?$e:(n=Number(t.substring(n,r)),isNaN(n)?We:(r+=1)+n>t.length?$e:(t=t.slice(r,r+n),e.C=r+n,t))}function Je(e){e.S=Date.now()+e.I,Xe(e,e.I)}function Xe(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Le(h(e.ba,e),t)}function Ze(e){e.B&&(o.clearTimeout(e.B),e.B=null)}function et(e){0==e.j.G||e.J||gn(e.j,e)}function tt(e){Ze(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ye(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function nt(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||at(n.h,e)))if(!e.K&&at(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(i){r=null}if(Array.isArray(r)&&3==r.length){var o=r;if(0==o[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;pn(n),rn(n)}dn(n),Ne(18)}}else n.za=o[1],0<n.za-n.T&&37500>o[2]&&n.F&&0==n.v&&!n.C&&(n.C=Le(h(n.Za,n),6e3));if(1>=st(n.h)&&n.ca){try{n.ca()}catch(i){}n.ca=void 0}}else vn(n,11)}else if((e.K||n.g==e)&&pn(n),!w(t))for(o=n.Da.g.parse(t),t=0;t<o.length;t++){let i=o[t];if(n.T=i[0],i=i[1],2==n.G)if("c"==i[0]){n.K=i[1],n.ia=i[2];const t=i[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const o=i[4];null!=o&&(n.Aa=o,n.j.info("SVER="+n.Aa));const u=i[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(lt(s,s.h),s.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,yt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=wn(r,r.J?r.ia:null,r.W),a.K){ct(r.h,a);var l=a,c=r.L;c&&(l.I=c),l.B&&(Ze(l),Je(l)),r.g=a}else un(r);0<n.i.length&&sn(n)}else"stop"!=i[0]&&"close"!=i[0]||vn(n,7);else 3==n.G&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?vn(n,7):nn(n):"noop"!=i[0]&&n.l&&n.l.ta(i),n.v=0)}xe()}catch(i){}}qe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Xt(e)?t.j():this.Y(e)},qe.prototype.Y=function(e){try{if(e==this.g)e:{const h=Xt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Zt(this.g)))){this.J||4!=h||7==t||xe(),Ze(this);var n=this.g.Z();this.X=n;t:if(Qe(this)){var r=Zt(this.g);e="";var i=r.length,s=4==Xt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){tt(this),et(this);var a="";break t}this.h.i=new o.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(s&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,o,s){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+s})}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ne(12),tt(this),et(this);break e}Fe(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nt(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=Ye(this,a),e==$e){4==h&&(this.s=4,Ne(14),n=!1),Fe(this.i,this.l,null,"[Incomplete Response]");break}if(e==We){this.s=4,Ne(15),Fe(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Fe(this.i,this.l,e,null),nt(this,e)}if(Qe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=a.length||this.h.h||(this.s=1,Ne(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),hn(d),d.M=!0,Ne(11))}}else Fe(this.i,this.l,a,"[Invalid Chunked Response]"),tt(this),et(this)}else Fe(this.i,this.l,a,null),nt(this,a);4==h&&tt(this),this.o&&!this.J&&(4==h?gn(this.j,this):(this.o=!1,Je(this)))}else(function(e){const t={};e=(e.g&&2<=Xt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(w(e[r]))continue;var n=D(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const o=t[i]||[];t[i]=o,o.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Ne(12)):(this.s=0,Ne(13)),tt(this),et(this)}}}catch(I){}},qe.prototype.cancel=function(){this.J=!0,tt(this)},qe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(xe(),Ne(17)),tt(this),this.s=2,et(this)):Xe(this,this.S-e)};var rt=class{constructor(e,t){this.g=e,this.map=t}};function it(e){this.l=e||10,o.PerformanceNavigationTiming?e=0<(e=o.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ot(e){return!!e.h||!!e.g&&e.g.size>=e.j}function st(e){return e.h?1:e.g?e.g.size:0}function at(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function lt(e,t){e.g?e.g.add(t):e.h=t}function ct(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ut(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return m(e.i)}function dt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}it.prototype.cancel=function(){if(this.i=ut(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ft(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof ft){this.h=e.h,gt(this,e.j),this.o=e.o,this.g=e.g,mt(this,e.s),this.l=e.l;var t=e.i,n=new kt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),vt(this,n),this.m=e.m}else e&&(t=String(e).match(ht))?(this.h=!1,gt(this,t[1]||"",!0),this.o=bt(t[2]||""),this.g=bt(t[3]||"",!0),mt(this,t[4]),this.l=bt(t[5]||"",!0),vt(this,t[6]||"",!0),this.m=bt(t[7]||"")):(this.h=!1,this.i=new kt(null,this.h))}function pt(e){return new ft(e)}function gt(e,t,n){e.j=n?bt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function mt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function vt(e,t,n){t instanceof kt?(e.i=t,function(e,t){t&&!e.j&&(Rt(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Dt(this,t),xt(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=Ct(t,It)),e.i=new kt(t,e.h))}function yt(e,t,n){e.i.set(t,n)}function wt(e){return yt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function bt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ct(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,St),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function St(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ft.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ct(t,Et,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(Ct(t,Et,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ct(n,"/"==n.charAt(0)?_t:Tt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",Ct(n,At)),e.join("")};var Et=/[#\/\?@]/g,Tt=/[#\?:]/g,_t=/[#\?]/g,It=/[#\?@]/g,At=/#/g;function kt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Rt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Dt(e,t){Rt(e),t=Ot(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Pt(e,t){return Rt(e),t=Ot(e,t),e.g.has(t)}function xt(e,t,n){Dt(e,t),0<n.length&&(e.i=null,e.g.set(Ot(e,t),m(n)),e.h+=n.length)}function Ot(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Nt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(u){}}function Mt(){this.g=new Ce}function Lt(e,t,n){const r=n||"";try{dt(e,function(e,n){let i=e;a(e)&&(i=we(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(d){throw t.push(r+"type="+encodeURIComponent("_badmap")),d}}function Ut(e){this.l=e.Ub||null,this.j=e.eb||!1}function Ft(e,t){ue.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Ht(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function jt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Bt(e)}function Bt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function zt(e){let t="";return T(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function qt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=zt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):yt(e,t,n))}function Vt(e){ue.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=kt.prototype).add=function(e,t){Rt(this),this.i=null,e=Ot(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Rt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.na=function(){Rt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Rt(this);let t=[];if("string"===typeof e)Pt(this,e)&&(t=t.concat(this.g.get(Ot(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Rt(this),this.i=null,Pt(this,e=Ot(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const o=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var i=o;""!==s[r]&&(i+="="+encodeURIComponent(String(s[r]))),e.push(i)}}return this.i=e.join("&")},p(Ut,Se),Ut.prototype.g=function(){return new Ft(this.l,this.j)},Ut.prototype.i=function(e){return function(){return e}}({}),p(Ft,ue),(e=Ft.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Bt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||o).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,jt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Bt(this)),this.g&&(this.readyState=3,Bt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof o.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ht(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?jt(this):Bt(this),3==this.readyState&&Ht(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,jt(this))},e.Qa=function(e){this.g&&(this.response=e,jt(this))},e.ga=function(){this.g&&jt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ft.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),p(Vt,ue);var Wt=/^https?$/i,$t=["POST","PUT"];function Gt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Kt(e),Yt(e)}function Kt(e){e.A||(e.A=!0,de(e,"complete"),de(e,"error"))}function Qt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Xt(e)||2!=e.Z()))if(e.u&&4==Xt(e))fe(e.Ea,0,e);else if(de(e,"readystatechange"),4==Xt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var s=String(e.D).match(ht)[1]||null;!s&&o.self&&o.self.location&&(s=o.self.location.protocol.slice(0,-1)),i=!Wt.test(s?s.toLowerCase():"")}n=i}if(n)de(e,"complete"),de(e,"success");else{e.m=6;try{var a=2<Xt(e)?e.g.statusText:""}catch(_){a=""}e.l=a+" ["+e.Z()+"]",Kt(e)}}finally{Yt(e)}}}function Yt(e,t){if(e.g){Jt(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||de(e,"ready");try{n.onreadystatechange=r}catch(d){}}}function Jt(e){e.I&&(o.clearTimeout(e.I),e.I=null)}function Xt(e){return e.g?e.g.readyState:0}function Zt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(E){return null}}function en(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function tn(e){this.Aa=0,this.i=[],this.j=new Ue,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=en("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=en("baseRetryDelayMs",5e3,e),this.cb=en("retryDelaySeedMs",1e4,e),this.Wa=en("forwardChannelMaxRetries",2,e),this.wa=en("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new it(e&&e.concurrentRequestLimit),this.Da=new Mt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function nn(e){if(on(e),3==e.G){var t=e.U++,n=pt(e.I);if(yt(n,"SID",e.K),yt(n,"RID",t),yt(n,"TYPE","terminate"),ln(e,n),(t=new qe(e,e.j,t)).L=2,t.v=wt(pt(n)),n=!1,o.navigator&&o.navigator.sendBeacon)try{n=o.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&o.Image&&((new Image).src=t.v,n=!0),n||(t.g=bn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Je(t)}yn(e)}function rn(e){e.g&&(hn(e),e.g.cancel(),e.g=null)}function on(e){rn(e),e.u&&(o.clearTimeout(e.u),e.u=null),pn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&o.clearTimeout(e.s),e.s=null)}function sn(e){if(!ot(e.h)&&!e.s){e.s=!0;var t=e.Ga;M||F(),L||(M(),L=!0),U.add(t,e),e.B=0}}function an(e,t){var n;n=t?t.l:e.U++;const r=pt(e.I);yt(r,"SID",e.K),yt(r,"RID",n),yt(r,"AID",e.T),ln(e,r),e.m&&e.o&&qt(r,e.m,e.o),n=new qe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=cn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),lt(e.h,n),Ge(n,r,t)}function ln(e,t){e.H&&T(e.H,function(e,n){yt(t,n,e)}),e.l&&dt({},function(e,n){yt(t,n,e)})}function cn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?h(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let s=0;s<n;s++){let n=i[s].g;const a=i[s].map;if(n-=t,0>n)t=Math.max(0,i[s].g-100),o=!1;else try{Lt(a,e,"req"+n+"_")}catch(I){r&&r(a)}}if(o){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function un(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;M||F(),L||(M(),L=!0),U.add(t,e),e.v=0}}function dn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Le(h(e.Fa,e),mn(e,e.v)),e.v++,!0)}function hn(e){null!=e.A&&(o.clearTimeout(e.A),e.A=null)}function fn(e){e.g=new qe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=pt(e.qa);yt(t,"RID","rpc"),yt(t,"SID",e.K),yt(t,"AID",e.T),yt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&yt(t,"TO",e.ja),yt(t,"TYPE","xmlhttp"),ln(e,t),e.m&&e.o&&qt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=wt(pt(t)),n.m=null,n.P=!0,Ke(n,e)}function pn(e){null!=e.C&&(o.clearTimeout(e.C),e.C=null)}function gn(e,t){var n=null;if(e.g==t){pn(e),hn(e),e.g=null;var r=2}else{if(!at(e.h,t))return;n=t.D,ct(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;de(r=De(),new Me(r,n)),sn(e)}else un(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(st(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Le(h(e.Ga,e,t),mn(e,e.B)),e.B++,!0))}(e,t)||2==r&&dn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:vn(e,5);break;case 4:vn(e,10);break;case 3:vn(e,6);break;default:vn(e,2)}}function mn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function vn(e,t){if(e.j.info("Error code "+t),2==t){var n=h(e.fb,e),r=e.Xa;const t=!r;r=new ft(r||"//www.google.com/images/cleardot.gif"),o.location&&"http"==o.location.protocol||gt(r,"https"),wt(r),t?function(e,t){const n=new Ue;if(o.Image){const r=new Image;r.onload=f(Nt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=f(Nt,n,"TestLoadImage: error",!1,t,r),r.onabort=f(Nt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=f(Nt,n,"TestLoadImage: timeout",!1,t,r),o.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ue;const n=new AbortController,r=setTimeout(()=>{n.abort(),Nt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?Nt(0,0,!0,t):Nt(0,0,!1,t)}).catch(()=>{clearTimeout(r),Nt(0,0,!1,t)})}(r.toString(),n)}else Ne(2);e.G=0,e.l&&e.l.sa(t),yn(e),on(e)}function yn(e){if(e.G=0,e.ka=[],e.l){const t=ut(e.h);0==t.length&&0==e.i.length||(y(e.ka,t),y(e.ka,e.i),e.h.i.length=0,m(e.i),e.i.length=0),e.l.ra()}}function wn(e,t,n){var r=n instanceof ft?pt(n):new ft(n);if(""!=r.g)t&&(r.g=t+"."+r.g),mt(r,r.s);else{var i=o.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new ft(null);r&&gt(s,r),t&&(s.g=t),i&&mt(s,i),n&&(s.l=n),r=s}return n=e.D,t=e.ya,n&&t&&yt(r,n,t),yt(r,"VER",e.la),ln(e,r),r}function bn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Vt(new Ut({eb:n})):new Vt(e.pa)).Ha(e.J),t}function Cn(){}function Sn(){}function En(e,t){ue.call(this),this.g=new tn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!w(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!w(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new In(this)}function Tn(e){Ie.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function _n(){Ae.call(this),this.status=1}function In(e){this.g=e}(e=Vt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():He.g(),this.v=this.o?Ee(this.o):Ee(He),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(u){return void Gt(this,u)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=o.FormData&&e instanceof o.FormData,!(0<=Array.prototype.indexOf.call($t,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,s]of n)this.g.setRequestHeader(o,s);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Jt(this),this.u=!0,this.g.send(e),this.u=!1}catch(u){Gt(this,u)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,de(this,"complete"),de(this,"abort"),Yt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yt(this,!0)),Vt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Qt(this):this.bb())},e.bb=function(){Qt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Xt(this)?this.g.status:-1}catch(v){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(v){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),be(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=tn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ne(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=wn(this,null,this.W),sn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new qe(this,this.j,e);let o=this.o;if(this.S&&(o?(o=A(o),R(o,this.S)):o=this.S),null!==this.m||this.O||(i.H=o,o=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=cn(this,i,t),yt(n=pt(this.I),"RID",e),yt(n,"CVER",22),this.D&&yt(n,"X-HTTP-Session-Id",this.D),ln(this,n),o&&(this.O?t="headers="+encodeURIComponent(String(zt(o)))+"&"+t:this.m&&qt(n,this.m,o)),lt(this.h,i),this.Ua&&yt(n,"TYPE","init"),this.P?(yt(n,"$req",t),yt(n,"SID","null"),i.T=!0,Ge(i,n,null)):Ge(i,n,t),this.G=2}}else 3==this.G&&(e?an(this,e):0==this.i.length||ot(this.h)||an(this))},e.Fa=function(){if(this.u=null,fn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Le(h(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ne(10),rn(this),fn(this))},e.Za=function(){null!=this.C&&(this.C=null,rn(this),dn(this),Ne(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ne(2)):(this.j.info("Failed to ping google.com"),Ne(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=Cn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Sn.prototype.g=function(e,t){return new En(e,t)},p(En,ue),En.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},En.prototype.close=function(){nn(this.g)},En.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=we(e),e=n);t.i.push(new rt(t.Ya++,e)),3==t.G&&sn(t)},En.prototype.N=function(){this.g.l=null,delete this.j,nn(this.g),delete this.g,En.aa.N.call(this)},p(Tn,Ie),p(_n,Ae),p(In,Cn),In.prototype.ua=function(){de(this.g,"a")},In.prototype.ta=function(e){de(this.g,new Tn(e))},In.prototype.sa=function(e){de(this.g,new _n)},In.prototype.ra=function(){de(this.g,"b")},Sn.prototype.createWebChannel=Sn.prototype.g,En.prototype.send=En.prototype.o,En.prototype.open=En.prototype.m,En.prototype.close=En.prototype.close,Ng=Lg.createWebChannelTransport=function(){return new Sn},Og=Lg.getStatEventTarget=function(){return De()},xg=Lg.Event=ke,Pg=Lg.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},je.NO_ERROR=0,je.TIMEOUT=8,je.HTTP_ERROR=6,Dg=Lg.ErrorCode=je,Be.COMPLETE="complete",Rg=Lg.EventType=Be,Te.EventType=_e,_e.OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",ue.prototype.listen=ue.prototype.K,kg=Lg.WebChannel=Te,Lg.FetchXmlHttpFactory=Ut,Vt.prototype.listenOnce=Vt.prototype.L,Vt.prototype.getLastError=Vt.prototype.Ka,Vt.prototype.getLastErrorCode=Vt.prototype.Ba,Vt.prototype.getStatus=Vt.prototype.Z,Vt.prototype.getResponseJson=Vt.prototype.Oa,Vt.prototype.getResponseText=Vt.prototype.oa,Vt.prototype.send=Vt.prototype.ea,Vt.prototype.setWithCredentials=Vt.prototype.Ha,Ag=Lg.XhrIo=Vt}).apply("undefined"!==typeof Mg?Mg:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Ug="@firebase/firestore",Fg="4.8.0";class Hg{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Hg.UNAUTHENTICATED=new Hg(null),Hg.GOOGLE_CREDENTIALS=new Hg("google-credentials-uid"),Hg.FIRST_PARTY=new Hg("first-party-uid"),Hg.MOCK_USER=new Hg("mock-user");let jg="11.10.0";const Bg=new Uu("@firebase/firestore");function zg(){return Bg.logLevel}function qg(e){if(Bg.logLevel<=xu.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map($g);Bg.debug(`Firestore (${jg}): ${e}`,...i)}}function Vg(e){if(Bg.logLevel<=xu.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map($g);Bg.error(`Firestore (${jg}): ${e}`,...i)}}function Wg(e){if(Bg.logLevel<=xu.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map($g);Bg.warn(`Firestore (${jg}): ${e}`,...i)}}function $g(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(a){return e}}function Gg(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,Kg(e,r,n)}function Kg(e,t,n){let r=`FIRESTORE (${jg}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw Vg(r),new Error(r)}function Qg(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||Kg(t,i,r)}function Yg(e,t){return e}const Jg={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xg extends gu{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Zg{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class em{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tm{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Hg.UNAUTHENTICATED))}shutdown(){}}class nm{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class rm{constructor(e){this.t=e,this.currentUser=Hg.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Qg(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Zg;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Zg,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},s=e=>{qg("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(e=>s(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(qg("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Zg)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(qg("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Qg("string"==typeof t.accessToken,31837,{l:t}),new em(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qg(null===e||"string"==typeof e,2055,{h:e}),new Hg(e)}}class im{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Hg.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class om{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new im(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Hg.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sm{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class am{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hd(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Qg(void 0===this.o,3512);const n=e=>{null!=e.error&&qg("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,qg("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{qg("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):qg("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new sm(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Qg("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new sm(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function lm(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function cm(){return new TextEncoder}class um{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=lm(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function dm(e,t){return e<t?-1:e>t?1:0}function hm(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),i=t.codePointAt(n);if(r!==i){if(r<128&&i<128)return dm(r,i);{const o=cm(),s=pm(o.encode(fm(e,n)),o.encode(fm(t,n)));return 0!==s?s:dm(r,i)}}n+=r>65535?2:1}return dm(e.length,t.length)}function fm(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function pm(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return dm(e[n],t[n]);return dm(e.length,t.length)}function gm(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const mm="__name__";class vm{constructor(e,t,n){void 0===t?t=0:t>e.length&&Gg(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&Gg(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===vm.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vm?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=vm.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return dm(e.length,t.length)}static compareSegments(e,t){const n=vm.isNumericId(e),r=vm.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?vm.extractNumericId(e).compare(vm.extractNumericId(t)):hm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Eg.fromString(e.substring(4,e.length-2))}}class ym extends vm{construct(e,t,n){return new ym(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Xg(Jg.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(e=>e.length>0))}return new ym(e)}static emptyPath(){return new ym([])}}const wm=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bm extends vm{construct(e,t,n){return new bm(e,t,n)}static isValidIdentifier(e){return wm.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bm.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===mm}static keyField(){return new bm([mm])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Xg(Jg.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Xg(Jg.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Xg(Jg.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(o=!o,r++):"."!==t||o?(n+=t,r++):(i(),r++)}if(i(),o)throw new Xg(Jg.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bm(t)}static emptyPath(){return new bm([])}}class Cm{constructor(e){this.path=e}static fromPath(e){return new Cm(ym.fromString(e))}static fromName(e){return new Cm(ym.fromString(e).popFirst(5))}static empty(){return new Cm(ym.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ym.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ym.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Cm(new ym(e.slice()))}}function Sm(e,t,n){if(!n)throw new Xg(Jg.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Em(e){if(!Cm.isDocumentKey(e))throw new Xg(Jg.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Tm(e){if(Cm.isDocumentKey(e))throw new Xg(Jg.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function _m(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Im(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Gg(12329,{type:typeof e})}function Am(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Xg(Jg.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Im(e);throw new Xg(Jg.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function km(e,t){const n={typeString:e};return t&&(n.value=t),n}function Rm(e,t){if(!_m(e))throw new Xg(Jg.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,o="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const s=e[r];if(i&&typeof s!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(void 0!==o&&s!==o.value){n=`Expected '${r}' field to equal '${o.value}'`;break}}if(n)throw new Xg(Jg.INVALID_ARGUMENT,n);return!0}const Dm=-62135596800,Pm=1e6;class xm{static now(){return xm.fromMillis(Date.now())}static fromDate(e){return xm.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Pm);return new xm(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Xg(Jg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Xg(Jg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Dm)throw new Xg(Jg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xg(Jg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Pm}_compareTo(e){return this.seconds===e.seconds?dm(this.nanoseconds,e.nanoseconds):dm(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xm._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Rm(e,xm._jsonSchema))return new xm(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Dm;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xm._jsonSchemaVersion="firestore/timestamp/1.0",xm._jsonSchema={type:km("string",xm._jsonSchemaVersion),seconds:km("number"),nanoseconds:km("number")};class Om{static fromTimestamp(e){return new Om(e)}static min(){return new Om(new xm(0,0))}static max(){return new Om(new xm(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Nm=-1;class Mm{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Mm.UNKNOWN_ID=-1;function Lm(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Om.fromTimestamp(1e9===r?new xm(n+1,0):new xm(n,r));return new Fm(i,Cm.empty(),t)}function Um(e){return new Fm(e.readTime,e.key,Nm)}class Fm{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Fm(Om.min(),Cm.empty(),Nm)}static max(){return new Fm(Om.max(),Cm.empty(),Nm)}}function Hm(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Cm.comparator(e.documentKey,t.documentKey),0!==n?n:dm(e.largestBatchId,t.largestBatchId))}const jm="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Bm{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function zm(e){if(e.code!==Jg.FAILED_PRECONDITION||e.message!==jm)throw e;qg("LocalStore","Unexpectedly lost primary lease")}class qm{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Gg(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new qm((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof qm?t:qm.resolve(t)}catch(e){return qm.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):qm.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):qm.reject(t)}static resolve(e){return new qm((t,n)=>{t(e)})}static reject(e){return new qm((t,n)=>{n(e)})}static waitFor(e){return new qm((t,n)=>{let r=0,i=0,o=!1;e.forEach(e=>{++r,e.next(()=>{++i,o&&i===r&&t()},e=>n(e))}),o=!0,i===r&&t()})}static or(e){let t=qm.resolve(!1);for(const n of e)t=t.next(e=>e?qm.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new qm((n,r)=>{const i=e.length,o=new Array(i);let s=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{o[l]=e,++s,s===i&&n(o)},e=>r(e))}})}static doWhile(e,t){return new qm((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function Vm(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Wm(e){return"IndexedDbTransactionError"===e.name}class $m{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this._e(e),this.ae=e=>t.writeSequenceNumber(e))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}$m.ue=-1;const Gm=-1;function Km(e){return null==e}function Qm(e){return 0===e&&1/e==-1/0}function Ym(e){return"number"==typeof e&&Number.isInteger(e)&&!Qm(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Jm="\x01";function Xm(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=ev(t)),t=Zm(e.get(n),t);return ev(t)}function Zm(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case Jm:n+="\x01\x11";break;default:n+=t}}return n}function ev(e){return e+Jm+"\x01"}const tv="remoteDocuments",nv="owner",rv="mutationQueues",iv="mutations";const ov="documentMutations",sv="remoteDocumentsV14",av="remoteDocumentGlobal",lv="targets",cv="targetDocuments",uv="targetGlobal",dv="collectionParents",hv="clientMetadata",fv="bundles",pv="namedQueries",gv="indexConfiguration",mv="indexState",vv="indexEntries",yv="documentOverlays",wv="globals",bv=[rv,iv,ov,tv,lv,nv,uv,cv,hv,av,dv,fv,pv],Cv=[rv,iv,ov,sv,lv,nv,uv,cv,hv,av,dv,fv,pv,yv],Sv=Cv,Ev=[...Sv,gv,mv,vv];function Tv(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function _v(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Iv(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Av{constructor(e,t){this.comparator=e,this.root=t||Rv.EMPTY}insert(e,t){return new Av(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rv.BLACK,null,null))}remove(e){return new Av(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rv.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kv(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kv(this.root,e,this.comparator,!1)}getReverseIterator(){return new kv(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kv(this.root,e,this.comparator,!0)}}class kv{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rv{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Rv.RED,this.left=null!=r?r:Rv.EMPTY,this.right=null!=i?i:Rv.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Rv(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Rv.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Rv.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rv.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rv.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Gg(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Gg(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Gg(27949);return e+(this.isRed()?0:1)}}Rv.EMPTY=null,Rv.RED=!0,Rv.BLACK=!1,Rv.EMPTY=new class{constructor(){this.size=0}get key(){throw Gg(57766)}get value(){throw Gg(16141)}get color(){throw Gg(16727)}get left(){throw Gg(29726)}get right(){throw Gg(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new Rv(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Dv{constructor(e){this.comparator=e,this.data=new Av(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Pv(this.data.getIterator())}getIteratorFrom(e){return new Pv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Dv))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Dv(this.comparator);return t.data=e,t}}class Pv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class xv{constructor(e){this.fields=e,e.sort(bm.comparator)}static empty(){return new xv([])}unionWith(e){let t=new Dv(bm.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new xv(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gm(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Ov extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Nv{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ov("Invalid base64 string: "+e):e}}(e);return new Nv(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Nv(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return dm(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nv.EMPTY_BYTE_STRING=new Nv("");const Mv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Lv(e){if(Qg(!!e,39018),"string"==typeof e){let t=0;const n=Mv.exec(e);if(Qg(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Uv(e.seconds),nanos:Uv(e.nanos)}}function Uv(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Fv(e){return"string"==typeof e?Nv.fromBase64String(e):Nv.fromUint8Array(e)}const Hv="server_timestamp",jv="__type__",Bv="__previous_value__",zv="__local_write_time__";function qv(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[jv])||void 0===n?void 0:n.stringValue)===Hv}function Vv(e){const t=e.mapValue.fields[Bv];return qv(t)?Vv(t):t}function Wv(e){const t=Lv(e.mapValue.fields[zv].timestampValue);return new xm(t.seconds,t.nanos)}class $v{constructor(e,t,n,r,i,o,s,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=a,this.useFetchStreams=l,this.isUsingEmulator=c}}const Gv="(default)";class Kv{constructor(e,t){this.projectId=e,this.database=t||Gv}static empty(){return new Kv("","")}get isDefaultDatabase(){return this.database===Gv}isEqual(e){return e instanceof Kv&&e.projectId===this.projectId&&e.database===this.database}}const Qv="__type__",Yv="__max__",Jv={mapValue:{fields:{__type__:{stringValue:Yv}}}},Xv="__vector__",Zv="value";function ey(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?qv(e)?4:my(e)?9007199254740991:py(e)?10:11:Gg(28295,{value:e})}function ty(e,t){if(e===t)return!0;const n=ey(e);if(n!==ey(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Wv(e).isEqual(Wv(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Lv(e.timestampValue),r=Lv(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Fv(e.bytesValue).isEqual(Fv(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Uv(e.geoPointValue.latitude)===Uv(t.geoPointValue.latitude)&&Uv(e.geoPointValue.longitude)===Uv(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Uv(e.integerValue)===Uv(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Uv(e.doubleValue),r=Uv(t.doubleValue);return n===r?Qm(n)===Qm(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return gm(e.arrayValue.values||[],t.arrayValue.values||[],ty);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Tv(n)!==Tv(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ty(n[i],r[i])))return!1;return!0}(e,t);default:return Gg(52216,{left:e})}}function ny(e,t){return void 0!==(e.values||[]).find(e=>ty(e,t))}function ry(e,t){if(e===t)return 0;const n=ey(e),r=ey(t);if(n!==r)return dm(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return dm(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Uv(e.integerValue||e.doubleValue),r=Uv(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return iy(e.timestampValue,t.timestampValue);case 4:return iy(Wv(e),Wv(t));case 5:return hm(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Fv(e),r=Fv(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=dm(n[i],r[i]);if(0!==e)return e}return dm(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=dm(Uv(e.latitude),Uv(t.latitude));return 0!==n?n:dm(Uv(e.longitude),Uv(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return oy(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,o;const s=e.fields||{},a=t.fields||{},l=null===(n=s[Zv])||void 0===n?void 0:n.arrayValue,c=null===(r=a[Zv])||void 0===r?void 0:r.arrayValue,u=dm((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(o=null==c?void 0:c.values)||void 0===o?void 0:o.length)||0);return 0!==u?u:oy(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Jv.mapValue&&t===Jv.mapValue)return 0;if(e===Jv.mapValue)return 1;if(t===Jv.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let s=0;s<r.length&&s<o.length;++s){const e=hm(r[s],o[s]);if(0!==e)return e;const t=ry(n[r[s]],i[o[s]]);if(0!==t)return t}return dm(r.length,o.length)}(e.mapValue,t.mapValue);default:throw Gg(23264,{le:n})}}function iy(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return dm(e,t);const n=Lv(e),r=Lv(t),i=dm(n.seconds,r.seconds);return 0!==i?i:dm(n.nanos,r.nanos)}function oy(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=ry(n[i],r[i]);if(e)return e}return dm(n.length,r.length)}function sy(e){return ay(e)}function ay(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Lv(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Fv(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Cm.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=ay(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${ay(e.fields[i])}`;return n+"}"}(e.mapValue):Gg(61005,{value:e})}function ly(e){switch(ey(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Vv(e);return t?16+ly(t):16;case 5:return 2*e.stringValue.length;case 6:return Fv(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+ly(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return _v(e.fields,(e,n)=>{t+=e.length+ly(n)}),t}(e.mapValue);default:throw Gg(13486,{value:e})}}function cy(e){return!!e&&"integerValue"in e}function uy(e){return!!e&&"arrayValue"in e}function dy(e){return!!e&&"nullValue"in e}function hy(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function fy(e){return!!e&&"mapValue"in e}function py(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Qv])||void 0===n?void 0:n.stringValue)===Xv}function gy(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return _v(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=gy(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=gy(e.arrayValue.values[n]);return t}return Object.assign({},e)}function my(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Yv}class vy{constructor(e){this.value=e}static empty(){return new vy({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!fy(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gy(t)}setAll(e){let t=bm.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=gy(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());fy(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ty(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];fy(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){_v(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new vy(gy(this.value))}}function yy(e){const t=[];return _v(e.fields,(e,n)=>{const r=new bm([e]);if(fy(n)){const e=yy(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new xv(t)}class wy{constructor(e,t,n,r,i,o,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=s}static newInvalidDocument(e){return new wy(e,0,Om.min(),Om.min(),Om.min(),vy.empty(),0)}static newFoundDocument(e,t,n,r){return new wy(e,1,t,Om.min(),n,r,0)}static newNoDocument(e,t){return new wy(e,2,t,Om.min(),Om.min(),vy.empty(),0)}static newUnknownDocument(e,t){return new wy(e,3,t,Om.min(),Om.min(),vy.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Om.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=vy.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=vy.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Om.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof wy&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wy(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class by{constructor(e,t){this.position=e,this.inclusive=t}}function Cy(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const o=t[i],s=e.position[i];if(r=o.field.isKeyField()?Cm.comparator(Cm.fromName(s.referenceValue),n.key):ry(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function Sy(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!ty(e.position[n],t.position[n]))return!1;return!0}class Ey{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Ty(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class _y{}class Iy extends _y{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Ny(e,t,n):"array-contains"===t?new Fy(e,n):"in"===t?new Hy(e,n):"not-in"===t?new jy(e,n):"array-contains-any"===t?new By(e,n):new Iy(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new My(e,n):new Ly(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(ry(t,this.value)):null!==t&&ey(this.value)===ey(t)&&this.matchesComparison(ry(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Gg(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ay extends _y{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Ay(e,t)}matches(e){return ky(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function ky(e){return"and"===e.op}function Ry(e){return Dy(e)&&ky(e)}function Dy(e){for(const t of e.filters)if(t instanceof Ay)return!1;return!0}function Py(e){if(e instanceof Iy)return e.field.canonicalString()+e.op.toString()+sy(e.value);if(Ry(e))return e.filters.map(e=>Py(e)).join(",");{const t=e.filters.map(e=>Py(e)).join(",");return`${e.op}(${t})`}}function xy(e,t){return e instanceof Iy?function(e,t){return t instanceof Iy&&e.op===t.op&&e.field.isEqual(t.field)&&ty(e.value,t.value)}(e,t):e instanceof Ay?function(e,t){return t instanceof Ay&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&xy(n,t.filters[r]),!0)}(e,t):void Gg(19439)}function Oy(e){return e instanceof Iy?function(e){return`${e.field.canonicalString()} ${e.op} ${sy(e.value)}`}(e):e instanceof Ay?function(e){return e.op.toString()+" {"+e.getFilters().map(Oy).join(" ,")+"}"}(e):"Filter"}class Ny extends Iy{constructor(e,t,n){super(e,t,n),this.key=Cm.fromName(n.referenceValue)}matches(e){const t=Cm.comparator(e.key,this.key);return this.matchesComparison(t)}}class My extends Iy{constructor(e,t){super(e,"in",t),this.keys=Uy("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ly extends Iy{constructor(e,t){super(e,"not-in",t),this.keys=Uy("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Uy(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Cm.fromName(e.referenceValue))}class Fy extends Iy{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return uy(t)&&ny(t.arrayValue,this.value)}}class Hy extends Iy{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ny(this.value.arrayValue,t)}}class jy extends Iy{constructor(e,t){super(e,"not-in",t)}matches(e){if(ny(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!ny(this.value.arrayValue,t)}}class By extends Iy{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!uy(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>ny(this.value.arrayValue,e))}}class zy{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Pe=null}}function qy(e){return new zy(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Vy(e){const t=Yg(e);if(null===t.Pe){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Py(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Km(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>sy(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>sy(e)).join(",")),t.Pe=e}return t.Pe}function Wy(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Ty(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!xy(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Sy(e.startAt,t.startAt)&&Sy(e.endAt,t.endAt)}function $y(e){return Cm.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Gy{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function Ky(e,t,n,r,i,o,s,a){return new Gy(e,t,n,r,i,o,s,a)}function Qy(e){return new Gy(e)}function Yy(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Jy(e){return null!==e.collectionGroup}function Xy(e){const t=Yg(e);if(null===t.Te){t.Te=[];const e=new Set;for(const i of t.explicitOrderBy)t.Te.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Dv(bm.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Te.push(new Ey(r,n))}),e.has(bm.keyField().canonicalString())||t.Te.push(new Ey(bm.keyField(),n))}return t.Te}function Zy(e){const t=Yg(e);return t.Ie||(t.Ie=ew(t,Xy(e))),t.Ie}function ew(e,t){if("F"===e.limitType)return qy(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Ey(e.field,t)});const n=e.endAt?new by(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new by(e.startAt.position,e.startAt.inclusive):null;return qy(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function tw(e,t,n){return new Gy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function nw(e,t){return Wy(Zy(e),Zy(t))&&e.limitType===t.limitType}function rw(e){return`${Vy(Zy(e))}|lt:${e.limitType}`}function iw(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Oy(e)).join(", ")}]`),Km(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>sy(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>sy(e)).join(",")),`Target(${t})`}(Zy(e))}; limitType=${e.limitType})`}function ow(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Cm.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Xy(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Cy(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Xy(e),t))&&!(e.endAt&&!function(e,t,n){const r=Cy(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Xy(e),t))}(e,t)}function sw(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function aw(e){return(t,n)=>{let r=!1;for(const i of Xy(e)){const e=lw(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function lw(e,t,n){const r=e.field.isKeyField()?Cm.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?ry(r,i):Gg(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Gg(19790,{direction:e.dir})}}class cw{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){_v(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Iv(this.inner)}size(){return this.innerSize}}const uw=new Av(Cm.comparator);function dw(){return uw}const hw=new Av(Cm.comparator);function fw(){let e=hw;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function pw(e){let t=hw;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function gw(){return vw()}function mw(){return vw()}function vw(){return new cw(e=>e.toString(),(e,t)=>e.isEqual(t))}const yw=new Av(Cm.comparator),ww=new Dv(Cm.comparator);function bw(){let e=ww;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Cw=new Dv(dm);function Sw(){return Cw}function Ew(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qm(t)?"-0":t}}function Tw(e){return{integerValue:""+e}}function _w(e,t){return Ym(t)?Tw(t):Ew(e,t)}class Iw{constructor(){this._=void 0}}function Aw(e,t,n){return e instanceof Dw?function(e,t){const n={fields:{[jv]:{stringValue:Hv},[zv]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&qv(t)&&(t=Vv(t)),t&&(n.fields[Bv]=t),{mapValue:n}}(n,t):e instanceof Pw?xw(e,t):e instanceof Ow?Nw(e,t):function(e,t){const n=Rw(e,t),r=Lw(n)+Lw(e.Ee);return cy(n)&&cy(e.Ee)?Tw(r):Ew(e.serializer,r)}(e,t)}function kw(e,t,n){return e instanceof Pw?xw(e,t):e instanceof Ow?Nw(e,t):n}function Rw(e,t){return e instanceof Mw?function(e){return cy(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Dw extends Iw{}class Pw extends Iw{constructor(e){super(),this.elements=e}}function xw(e,t){const n=Uw(t);for(const r of e.elements)n.some(e=>ty(e,r))||n.push(r);return{arrayValue:{values:n}}}class Ow extends Iw{constructor(e){super(),this.elements=e}}function Nw(e,t){let n=Uw(t);for(const r of e.elements)n=n.filter(e=>!ty(e,r));return{arrayValue:{values:n}}}class Mw extends Iw{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Lw(e){return Uv(e.integerValue||e.doubleValue)}function Uw(e){return uy(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Fw{constructor(e,t){this.version=e,this.transformResults=t}}class Hw{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Hw}static exists(e){return new Hw(void 0,e)}static updateTime(e){return new Hw(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jw(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Bw{}function zw(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Xw(e.key,Hw.none()):new Gw(e.key,e.data,Hw.none());{const n=e.data,r=vy.empty();let i=new Dv(bm.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Kw(e.key,r,new xv(i.toArray()),Hw.none())}}function qw(e,t,n){e instanceof Gw?function(e,t,n){const r=e.value.clone(),i=Yw(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Kw?function(e,t,n){if(!jw(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Yw(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Qw(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Vw(e,t,n,r){return e instanceof Gw?function(e,t,n,r){if(!jw(e.precondition,t))return n;const i=e.value.clone(),o=Jw(e.fieldTransforms,r,t);return i.setAll(o),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Kw?function(e,t,n,r){if(!jw(e.precondition,t))return n;const i=Jw(e.fieldTransforms,r,t),o=t.data;return o.setAll(Qw(e)),o.setAll(i),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return jw(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Ww(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Rw(r.transform,e||null);null!=i&&(null===n&&(n=vy.empty()),n.set(r.field,i))}return n||null}function $w(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&gm(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Pw&&t instanceof Pw||e instanceof Ow&&t instanceof Ow?gm(e.elements,t.elements,ty):e instanceof Mw&&t instanceof Mw?ty(e.Ee,t.Ee):e instanceof Dw&&t instanceof Dw}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Gw extends Bw{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Kw extends Bw{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Qw(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Yw(e,t,n){const r=new Map;Qg(e.length===n.length,32656,{Ae:n.length,Re:e.length});for(let i=0;i<n.length;i++){const o=e[i],s=o.transform,a=t.data.field(o.field);r.set(o.field,kw(s,a,n[i]))}return r}function Jw(e,t,n){const r=new Map;for(const i of e){const e=i.transform,o=n.data.field(i.field);r.set(i.field,Aw(e,o,t))}return r}class Xw extends Bw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Zw extends Bw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class eb{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&qw(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Vw(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Vw(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=mw();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let s=this.applyToLocalView(o,i.mutatedFields);s=t.has(r.key)?null:s;const a=zw(o,s);null!==a&&n.set(r.key,a),o.isValidDocument()||o.convertToNoDocument(Om.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),bw())}isEqual(e){return this.batchId===e.batchId&&gm(this.mutations,e.mutations,(e,t)=>$w(e,t))&&gm(this.baseMutations,e.baseMutations,(e,t)=>$w(e,t))}}class tb{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Qg(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let r=yw;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,n[o].version);return new tb(e,t,n,r)}}class nb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class rb{constructor(e,t){this.count=e,this.unchangedNames=t}}var ib,ob;function sb(e){switch(e){case Jg.OK:return Gg(64938);case Jg.CANCELLED:case Jg.UNKNOWN:case Jg.DEADLINE_EXCEEDED:case Jg.RESOURCE_EXHAUSTED:case Jg.INTERNAL:case Jg.UNAVAILABLE:case Jg.UNAUTHENTICATED:return!1;case Jg.INVALID_ARGUMENT:case Jg.NOT_FOUND:case Jg.ALREADY_EXISTS:case Jg.PERMISSION_DENIED:case Jg.FAILED_PRECONDITION:case Jg.ABORTED:case Jg.OUT_OF_RANGE:case Jg.UNIMPLEMENTED:case Jg.DATA_LOSS:return!0;default:return Gg(15467,{code:e})}}function ab(e){if(void 0===e)return Vg("GRPC error has no .code"),Jg.UNKNOWN;switch(e){case ib.OK:return Jg.OK;case ib.CANCELLED:return Jg.CANCELLED;case ib.UNKNOWN:return Jg.UNKNOWN;case ib.DEADLINE_EXCEEDED:return Jg.DEADLINE_EXCEEDED;case ib.RESOURCE_EXHAUSTED:return Jg.RESOURCE_EXHAUSTED;case ib.INTERNAL:return Jg.INTERNAL;case ib.UNAVAILABLE:return Jg.UNAVAILABLE;case ib.UNAUTHENTICATED:return Jg.UNAUTHENTICATED;case ib.INVALID_ARGUMENT:return Jg.INVALID_ARGUMENT;case ib.NOT_FOUND:return Jg.NOT_FOUND;case ib.ALREADY_EXISTS:return Jg.ALREADY_EXISTS;case ib.PERMISSION_DENIED:return Jg.PERMISSION_DENIED;case ib.FAILED_PRECONDITION:return Jg.FAILED_PRECONDITION;case ib.ABORTED:return Jg.ABORTED;case ib.OUT_OF_RANGE:return Jg.OUT_OF_RANGE;case ib.UNIMPLEMENTED:return Jg.UNIMPLEMENTED;case ib.DATA_LOSS:return Jg.DATA_LOSS;default:return Gg(39323,{code:e})}}(ob=ib||(ib={}))[ob.OK=0]="OK",ob[ob.CANCELLED=1]="CANCELLED",ob[ob.UNKNOWN=2]="UNKNOWN",ob[ob.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ob[ob.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ob[ob.NOT_FOUND=5]="NOT_FOUND",ob[ob.ALREADY_EXISTS=6]="ALREADY_EXISTS",ob[ob.PERMISSION_DENIED=7]="PERMISSION_DENIED",ob[ob.UNAUTHENTICATED=16]="UNAUTHENTICATED",ob[ob.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ob[ob.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ob[ob.ABORTED=10]="ABORTED",ob[ob.OUT_OF_RANGE=11]="OUT_OF_RANGE",ob[ob.UNIMPLEMENTED=12]="UNIMPLEMENTED",ob[ob.INTERNAL=13]="INTERNAL",ob[ob.UNAVAILABLE=14]="UNAVAILABLE",ob[ob.DATA_LOSS=15]="DATA_LOSS";let lb=null;const cb=new Eg([4294967295,4294967295],0);function ub(e){const t=cm().encode(e),n=new Tg;return n.update(t),new Uint8Array(n.digest())}function db(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new Eg([n,r],0),new Eg([i,o],0)]}class hb{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new fb(`Invalid padding: ${t}`);if(n<0)throw new fb(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new fb(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new fb(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Eg.fromNumber(this.fe)}pe(e,t,n){let r=e.add(t.multiply(Eg.fromNumber(n)));return 1===r.compare(cb)&&(r=new Eg([r.getBits(0),r.getBits(1)],0)),r.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.fe)return!1;const t=ub(e),[n,r]=db(t);for(let i=0;i<this.hashCount;i++){const e=this.pe(n,r,i);if(!this.ye(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new hb(i,r,t);return n.forEach(e=>o.insert(e)),o}insert(e){if(0===this.fe)return;const t=ub(e),[n,r]=db(t);for(let i=0;i<this.hashCount;i++){const e=this.pe(n,r,i);this.we(e)}}we(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class fb extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class pb{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,gb.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new pb(Om.min(),r,new Av(dm),dw(),bw())}}class gb{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new gb(n,t,bw(),bw(),bw())}}class mb{constructor(e,t,n,r){this.Se=e,this.removedTargetIds=t,this.key=n,this.be=r}}class vb{constructor(e,t){this.targetId=e,this.De=t}}class yb{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Nv.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class wb{constructor(){this.ve=0,this.Ce=Sb(),this.Fe=Nv.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=bw(),t=bw(),n=bw();return this.Ce.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Gg(38017,{changeType:i})}}),new gb(this.Fe,this.Me,e,t,n)}ke(){this.xe=!1,this.Ce=Sb()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Qg(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class bb{constructor(e){this.We=e,this.Ge=new Map,this.ze=dw(),this.je=Cb(),this.Je=Cb(),this.He=new Av(dm)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const n=this.tt(t);switch(e.state){case 0:this.nt(t)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),n.Be(e.resumeToken));break;default:Gg(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((e,n)=>{this.nt(n)&&t(n)})}it(e){const t=e.targetId,n=e.De.count,r=this.st(t);if(r){const i=r.target;if($y(i))if(0===n){const e=new Cm(i.path);this.Xe(t,e,wy.newNoDocument(e,Om.min()))}else Qg(1===n,20013,{expectedCount:n});else{const r=this.ot(t);if(r!==n){const n=this._t(e),i=n?this.ut(n,e,r):1;if(0!==i){this.rt(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,e)}null==lb||lb.ct(function(e,t,n,r,i){var o,s,a,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(o=null==h?void 0:h.hashCount)&&void 0!==o?o:0,bitmapLength:null!==(l=null===(a=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.De,this.We.lt(),n,i))}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,s;try{o=Fv(n).toUint8Array()}catch(e){if(e instanceof Ov)return Wg("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new hb(o,r,i)}catch(e){return Wg(e instanceof fb?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.fe?null:s}ut(e,t,n){return t.De.count===n-this.ht(e,t.targetId)?0:2}ht(e,t){const n=this.We.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.We.lt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(o)||(this.Xe(t,n,null),r++)}),r}Pt(e){const t=new Map;this.Ge.forEach((n,r)=>{const i=this.st(r);if(i){if(n.current&&$y(i.target)){const t=new Cm(i.target.path);this.Tt(t).has(r)||this.It(r,t)||this.Xe(r,t,wy.newNoDocument(t,e))}n.Ne&&(t.set(r,n.Le()),n.ke())}});let n=bw();this.Je.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.st(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.ze.forEach((t,n)=>n.setReadTime(e));const r=new pb(e,t,this.He,this.ze,n);return this.ze=dw(),this.je=Cb(),this.Je=Cb(),this.He=new Av(dm),r}Ze(e,t){if(!this.nt(e))return;const n=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,n),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,n){if(!this.nt(e))return;const r=this.tt(e);this.It(e,t)?r.qe(t,1):r.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),n&&(this.ze=this.ze.insert(t,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new wb,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Dv(dm),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Dv(dm),this.je=this.je.insert(e,t)),t}nt(e){const t=null!==this.st(e);return t||qg("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new wb),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Cb(){return new Av(Cm.comparator)}function Sb(){return new Av(Cm.comparator)}const Eb={asc:"ASCENDING",desc:"DESCENDING"},Tb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_b={and:"AND",or:"OR"};class Ib{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ab(e,t){return e.useProto3Json||Km(t)?t:{value:t}}function kb(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Rb(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Db(e,t){return kb(e,t.toTimestamp())}function Pb(e){return Qg(!!e,49232),Om.fromTimestamp(function(e){const t=Lv(e);return new xm(t.seconds,t.nanos)}(e))}function xb(e,t){return Ob(e,t).canonicalString()}function Ob(e,t){const n=function(e){return new ym(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Nb(e){const t=ym.fromString(e);return Qg(eC(t),10190,{key:t.toString()}),t}function Mb(e,t){return xb(e.databaseId,t.path)}function Lb(e,t){const n=Nb(t);if(n.get(1)!==e.databaseId.projectId)throw new Xg(Jg.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Xg(Jg.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Cm(jb(n))}function Ub(e,t){return xb(e.databaseId,t)}function Fb(e){const t=Nb(e);return 4===t.length?ym.emptyPath():jb(t)}function Hb(e){return new ym(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function jb(e){return Qg(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Bb(e,t,n){return{name:Mb(e,t),fields:n.value.mapValue.fields}}function zb(e,t){let n;if(t instanceof Gw)n={update:Bb(e,t.key,t.value)};else if(t instanceof Xw)n={delete:Mb(e,t.key)};else if(t instanceof Kw)n={update:Bb(e,t.key,t.data),updateMask:Zb(t.fieldMask)};else{if(!(t instanceof Zw))return Gg(16599,{Rt:t.type});n={verify:Mb(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Dw)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Pw)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ow)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Mw)return{fieldPath:t.field.canonicalString(),increment:n.Ee};throw Gg(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Db(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Gg(27497)}(e,t.precondition)),n}function qb(e,t){return{documents:[Ub(e,t.path)]}}function Vb(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ub(e,i);const o=function(e){if(0!==e.length)return Xb(Ay.create(e,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const s=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Yb(e.field),direction:Gb(e.dir)}}(e))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const a=Ab(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{Vt:n,parent:i}}function Wb(e){let t=Fb(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Qg(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let o=[];n.where&&(o=function(e){const t=$b(e);return t instanceof Ay&&Ry(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map(e=>function(e){return new Ey(Jb(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Km(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new by(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new by(n,t)}(n.endAt)),Ky(t,i,s,o,a,"F",l,c)}function $b(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Jb(e.unaryFilter.field);return Iy.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Jb(e.unaryFilter.field);return Iy.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Jb(e.unaryFilter.field);return Iy.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Jb(e.unaryFilter.field);return Iy.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Gg(61313);default:return Gg(60726)}}(e):void 0!==e.fieldFilter?function(e){return Iy.create(Jb(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Gg(58110);default:return Gg(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ay.create(e.compositeFilter.filters.map(e=>$b(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Gg(1026)}}(e.compositeFilter.op))}(e):Gg(30097,{filter:e})}function Gb(e){return Eb[e]}function Kb(e){return Tb[e]}function Qb(e){return _b[e]}function Yb(e){return{fieldPath:e.canonicalString()}}function Jb(e){return bm.fromServerFormat(e.fieldPath)}function Xb(e){return e instanceof Iy?function(e){if("=="===e.op){if(hy(e.value))return{unaryFilter:{field:Yb(e.field),op:"IS_NAN"}};if(dy(e.value))return{unaryFilter:{field:Yb(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(hy(e.value))return{unaryFilter:{field:Yb(e.field),op:"IS_NOT_NAN"}};if(dy(e.value))return{unaryFilter:{field:Yb(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yb(e.field),op:Kb(e.op),value:e.value}}}(e):e instanceof Ay?function(e){const t=e.getFilters().map(e=>Xb(e));return 1===t.length?t[0]:{compositeFilter:{op:Qb(e.op),filters:t}}}(e):Gg(54877,{filter:e})}function Zb(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function eC(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class tC{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Om.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Om.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Nv.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=a}withSequenceNumber(e){return new tC(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new tC(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new tC(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new tC(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class nC{constructor(e){this.gt=e}}function rC(e){const t=Wb({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?tw(t,t.limit,"L"):t}class iC{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(Uv(e.integerValue));else if("doubleValue"in e){const n=Uv(e.doubleValue);isNaN(n)?this.Ct(t,13):(this.Ct(t,15),Qm(n)?t.Ft(0):t.Ft(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ct(t,20),"string"==typeof n&&(n=Lv(n)),t.Mt(`${n.seconds||""}`),t.Ft(n.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(Fv(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ct(t,45),t.Ft(n.latitude||0),t.Ft(n.longitude||0)}else"mapValue"in e?my(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):py(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):Gg(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const n=e.fields||{};this.Ct(t,55);for(const r of Object.keys(n))this.xt(r,t),this.Dt(n[r],t)}Lt(e,t){var n,r;const i=e.fields||{};this.Ct(t,53);const o=Zv,s=(null===(r=null===(n=i[o].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Ct(t,15),t.Ft(Uv(s)),this.xt(o,t),this.Dt(i[o],t)}qt(e,t){const n=e.values||[];this.Ct(t,50);for(const r of n)this.Dt(r,t)}Bt(e,t){this.Ct(t,37),Cm.fromName(e).path.forEach(e=>{this.Ct(t,60),this.$t(e,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}iC.Ut=new iC;class oC{constructor(){this.Dn=new sC}addToCollectionParentIndex(e,t){return this.Dn.add(t),qm.resolve()}getCollectionParents(e,t){return qm.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return qm.resolve()}deleteFieldIndex(e,t){return qm.resolve()}deleteAllFieldIndexes(e){return qm.resolve()}createTargetIndexes(e,t){return qm.resolve()}getDocumentsMatchingTarget(e,t){return qm.resolve(null)}getIndexType(e,t){return qm.resolve(0)}getFieldIndexes(e,t){return qm.resolve([])}getNextCollectionGroupToUpdate(e){return qm.resolve(null)}getMinOffset(e,t){return qm.resolve(Fm.min())}getMinOffsetFromCollectionGroup(e,t){return qm.resolve(Fm.min())}updateCollectionGroup(e,t,n){return qm.resolve()}updateIndexEntries(e,t){return qm.resolve()}}class sC{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Dv(ym.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Dv(ym.comparator)).toArray()}}new Uint8Array(0);const aC={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lC=41943040;class cC{static withCacheSize(e){return new cC(e,cC.DEFAULT_COLLECTION_PERCENTILE,cC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}cC.DEFAULT_COLLECTION_PERCENTILE=10,cC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cC.DEFAULT=new cC(lC,cC.DEFAULT_COLLECTION_PERCENTILE,cC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cC.DISABLED=new cC(-1,0,0);class uC{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new uC(0)}static ur(){return new uC(-1)}}const dC="LruGarbageCollector",hC=1048576;function fC(e,t){let[n,r]=e,[i,o]=t;const s=dm(n,i);return 0===s?dm(r,o):s}class pC{constructor(e){this.Tr=e,this.buffer=new Dv(fC),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();fC(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class gC{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(e){qg(dC,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Wm(e)?qg(dC,"Ignoring IndexedDB error during garbage collection: ",e):await zm(e)}await this.Rr(3e5)})}}class mC{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return qm.resolve($m.ue);const n=new pC(t);return this.Vr.forEachTarget(e,e=>n.Er(e.sequenceNumber)).next(()=>this.Vr.gr(e,e=>n.Er(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(qg("LruGarbageCollector","Garbage collection skipped; disabled"),qm.resolve(aC)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(qg("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),aC):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let n,r,i,o,s,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(qg("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,s=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),zg()<=xu.DEBUG&&qg("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-c}ms\n\tDetermined least recently used ${r} in `+(s-o)+"ms\n"+`\tRemoved ${i} targets in `+(a-s)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-c}ms`),qm.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function vC(e,t){return new mC(e,t)}class yC{constructor(){this.changes=new cw(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,wy.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?qm.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class wC{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class bC{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&Vw(n.mutation,e,xv.empty(),xm.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,bw()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bw();const r=gw();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=fw();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=gw();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,bw()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=dw();const o=vw(),s=vw();return t.forEach((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Kw)?i=i.insert(t.key,t):void 0!==s?(o.set(t.key,s.mutation.getFieldMask()),Vw(s.mutation,t,s.mutation.getFieldMask(),xm.now())):o.set(t.key,xv.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>o.set(e,t)),t.forEach((e,t)=>{var n;return s.set(e,new wC(t,null!==(n=o.get(e))&&void 0!==n?n:null))}),s))}recalculateAndSaveOverlays(e,t){const n=vw();let r=new Av((e,t)=>e-t),i=bw();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const o=t.get(e);if(null===o)return;let s=n.get(e)||xv.empty();s=i.applyToLocalView(o,s),n.set(e,s);const a=(r.get(i.batchId)||bw()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const o=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),a=r.key,l=r.value,c=mw();l.forEach(e=>{if(!i.has(e)){const r=zw(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),o.push(this.documentOverlayCache.saveOverlays(e,a,c))}return qm.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Cm.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Jy(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):qm.resolve(gw());let s=Nm,a=i;return o.next(t=>qm.forEach(t,(t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?qm.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,bw())).next(e=>({batchId:s,changes:pw(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Cm(t)).next(e=>{let t=fw();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=fw();return this.indexManager.getCollectionParents(e,i).next(s=>qm.forEach(s,s=>{const a=function(e,t){return new Gy(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{o=o.insert(e,t)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,wy.newInvalidDocument(r)))});let n=fw();return e.forEach((e,r)=>{const o=i.get(e);void 0!==o&&Vw(o.mutation,r,xv.empty(),xm.now()),ow(t,r)&&(n=n.insert(e,r))}),n})}}class CC{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return qm.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Pb(e.createTime)}}(t)),qm.resolve()}getNamedQuery(e,t){return qm.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(e){return{name:e.name,query:rC(e.bundledQuery),readTime:Pb(e.readTime)}}(t)),qm.resolve()}}class SC{constructor(){this.overlays=new Av(Cm.comparator),this.kr=new Map}getOverlay(e,t){return qm.resolve(this.overlays.get(t))}getOverlays(e,t){const n=gw();return qm.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.wt(e,t,r)}),qm.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.kr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.kr.delete(n)),qm.resolve()}getOverlaysForCollection(e,t,n){const r=gw(),i=t.length+1,o=new Cm(t.child("")),s=this.overlays.getIteratorFrom(o);for(;s.hasNext();){const e=s.getNext().value,o=e.getKey();if(!t.isPrefixOf(o.path))break;o.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return qm.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Av((e,t)=>e-t);const o=this.overlays.getIterator();for(;o.hasNext();){const e=o.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=gw(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=gw(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>s.set(e,t)),!(s.size()>=r)););return qm.resolve(s)}wt(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.kr.get(r.largestBatchId).delete(n.key);this.kr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new nb(t,n));let i=this.kr.get(t);void 0===i&&(i=bw(),this.kr.set(t,i)),this.kr.set(t,i.add(n.key))}}class EC{constructor(){this.sessionToken=Nv.EMPTY_BYTE_STRING}getSessionToken(e){return qm.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,qm.resolve()}}class TC{constructor(){this.qr=new Dv(_C.Qr),this.$r=new Dv(_C.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const n=new _C(e,t);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Wr(new _C(e,t))}Gr(e,t){e.forEach(e=>this.removeReference(e,t))}zr(e){const t=new Cm(new ym([])),n=new _C(t,e),r=new _C(t,e+1),i=[];return this.$r.forEachInRange([n,r],e=>{this.Wr(e),i.push(e.key)}),i}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Cm(new ym([])),n=new _C(t,e),r=new _C(t,e+1);let i=bw();return this.$r.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new _C(e,0),n=this.qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class _C{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Cm.comparator(e.key,t.key)||dm(e.Hr,t.Hr)}static Ur(e,t){return dm(e.Hr,t.Hr)||Cm.comparator(e.key,t.key)}}class IC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Dv(_C.Qr)}checkEmpty(e){return qm.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new eb(i,t,n,r);this.mutationQueue.push(o);for(const s of r)this.Yr=this.Yr.add(new _C(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return qm.resolve(o)}lookupMutationBatch(e,t){return qm.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Xr(n),i=r<0?0:r;return qm.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return qm.resolve(0===this.mutationQueue.length?Gm:this.er-1)}getAllMutationBatches(e){return qm.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new _C(t,0),r=new _C(t,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([n,r],e=>{const t=this.Zr(e.Hr);i.push(t)}),qm.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Dv(dm);return t.forEach(e=>{const t=new _C(e,0),r=new _C(e,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([t,r],e=>{n=n.add(e.Hr)})}),qm.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Cm.isDocumentKey(i)||(i=i.child(""));const o=new _C(new Cm(i),0);let s=new Dv(dm);return this.Yr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Hr)),!0)},o),qm.resolve(this.ei(s))}ei(e){const t=[];return e.forEach(e=>{const n=this.Zr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Qg(0===this.ti(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return qm.forEach(t.mutations,r=>{const i=new _C(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,t){const n=new _C(t,0),r=this.Yr.firstAfterOrEqual(n);return qm.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,qm.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class AC{constructor(e){this.ni=e,this.docs=new Av(Cm.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.ni(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return qm.resolve(n?n.document.mutableCopy():wy.newInvalidDocument(t))}getEntries(e,t){let n=dw();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():wy.newInvalidDocument(e))}),qm.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=dw();const o=t.path,s=new Cm(o.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(s);for(;a.hasNext();){const{key:e,value:{document:s}}=a.getNext();if(!o.isPrefixOf(e.path))break;e.path.length>o.length+1||Hm(Um(s),n)<=0||(r.has(s.key)||ow(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return qm.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Gg(9500)}ri(e,t){return qm.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new kC(this)}getSize(e){return qm.resolve(this.size)}}class kC extends yC{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Or.addEntry(e,r)):this.Or.removeEntry(n)}),qm.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}class RC{constructor(e){this.persistence=e,this.ii=new cw(e=>Vy(e),Wy),this.lastRemoteSnapshotVersion=Om.min(),this.highestTargetId=0,this.si=0,this.oi=new TC,this.targetCount=0,this._i=uC.ar()}forEachTarget(e,t){return this.ii.forEach((e,n)=>t(n)),qm.resolve()}getLastRemoteSnapshotVersion(e){return qm.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return qm.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),qm.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.si&&(this.si=t),qm.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new uC(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,qm.resolve()}updateTargetData(e,t){return this.hr(t),qm.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,qm.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.ii.forEach((o,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.ii.delete(o),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)}),qm.waitFor(i).next(()=>r)}getTargetCount(e){return qm.resolve(this.targetCount)}getTargetData(e,t){const n=this.ii.get(t)||null;return qm.resolve(n)}addMatchingKeys(e,t,n){return this.oi.Kr(t,n),qm.resolve()}removeMatchingKeys(e,t,n){this.oi.Gr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),qm.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),qm.resolve()}getMatchingKeysForTargetId(e,t){const n=this.oi.Jr(t);return qm.resolve(n)}containsKey(e,t){return qm.resolve(this.oi.containsKey(t))}}class DC{constructor(e,t){this.ai={},this.overlays={},this.ui=new $m(0),this.ci=!1,this.ci=!0,this.li=new EC,this.referenceDelegate=e(this),this.hi=new RC(this),this.indexManager=new oC,this.remoteDocumentCache=function(e){return new AC(e)}(e=>this.referenceDelegate.Pi(e)),this.serializer=new nC(t),this.Ti=new CC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new SC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ai[e.toKey()];return n||(n=new IC(t,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,n){qg("MemoryPersistence","Starting transaction:",e);const r=new PC(this.ui.next());return this.referenceDelegate.Ii(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ei(e,t){return qm.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,t)))}}class PC extends Bm{constructor(e){super(),this.currentSequenceNumber=e}}class xC{constructor(e){this.persistence=e,this.Ai=new TC,this.Ri=null}static Vi(e){return new xC(e)}get mi(){if(this.Ri)return this.Ri;throw Gg(60996)}addReference(e,t,n){return this.Ai.addReference(n,t),this.mi.delete(n.toString()),qm.resolve()}removeReference(e,t,n){return this.Ai.removeReference(n,t),this.mi.add(n.toString()),qm.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),qm.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(e=>this.mi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.mi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qm.forEach(this.mi,n=>{const r=Cm.fromPath(n);return this.fi(e,r).next(e=>{e||t.removeEntry(r,Om.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(e=>{e?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return qm.or([()=>qm.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class OC{constructor(e,t){this.persistence=e,this.gi=new cw(e=>Xm(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=vC(this,t)}static Vi(e,t){return new OC(e,t)}Ii(){}di(e){return qm.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}yr(e){let t=0;return this.gr(e,e=>{t++}).next(()=>t)}gr(e,t){return qm.forEach(this.gi,(n,r)=>this.Sr(e,n,r).next(e=>e?qm.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ri(e,r=>this.Sr(e,r,t).next(e=>{e||(n++,i.removeEntry(r,Om.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),qm.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),qm.resolve()}removeReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),qm.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),qm.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ly(e.data.value)),t}Sr(e,t,n){return qm.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.gi.get(t);return qm.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class NC{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Is=n,this.ds=r}static Es(e,t){let n=bw(),r=bw();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new NC(e,t.fromCache,n,r)}}class MC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class LC{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=hu()?8:Vm(cu())>0?6:4}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ps(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ys(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new MC;return this.ws(e,t,n).next(r=>{if(i.result=r,this.Rs)return this.Ss(e,t,n,r.size)})}).next(()=>i.result)}Ss(e,t,n,r){return n.documentReadCount<this.Vs?(zg()<=xu.DEBUG&&qg("QueryEngine","SDK will not create cache indexes for query:",iw(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),qm.resolve()):(zg()<=xu.DEBUG&&qg("QueryEngine","Query:",iw(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.fs*r?(zg()<=xu.DEBUG&&qg("QueryEngine","The SDK decides to create cache indexes for query:",iw(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zy(t))):qm.resolve())}ps(e,t){if(Yy(t))return qm.resolve(null);let n=Zy(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=tw(t,null,"F"),n=Zy(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=bw(...r);return this.gs.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const o=this.bs(t,r);return this.Ds(t,o,i,n.readTime)?this.ps(e,tw(t,null,"F")):this.vs(e,o,t,n)}))})))}ys(e,t,n,r){return Yy(t)||r.isEqual(Om.min())?qm.resolve(null):this.gs.getDocuments(e,n).next(i=>{const o=this.bs(t,i);return this.Ds(t,o,n,r)?qm.resolve(null):(zg()<=xu.DEBUG&&qg("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),iw(t)),this.vs(e,o,t,Lm(r,Nm)).next(e=>e))})}bs(e,t){let n=new Dv(aw(e));return t.forEach((t,r)=>{ow(e,r)&&(n=n.add(r))}),n}Ds(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}ws(e,t,n){return zg()<=xu.DEBUG&&qg("QueryEngine","Using full collection scan to execute query:",iw(t)),this.gs.getDocumentsMatchingQuery(e,t,Fm.min(),n)}vs(e,t,n,r){return this.gs.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const UC="LocalStore";class FC{constructor(e,t,n,r){this.persistence=e,this.Cs=t,this.serializer=r,this.Fs=new Av(dm),this.Ms=new cw(e=>Vy(e),Wy),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new bC(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function HC(e,t,n,r){return new FC(e,t,n,r)}async function jC(e,t){const n=Yg(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Ns(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],o=[];let s=bw();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){o.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next(e=>({Bs:e,removedBatchIds:i,addedBatchIds:o}))})})}function BC(e){const t=Yg(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.hi.getLastRemoteSnapshotVersion(e))}function zC(e,t,n){let r=bw(),i=bw();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=dw();return n.forEach((n,o)=>{const s=e.get(n);o.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),o.isNoDocument()&&o.version.isEqual(Om.min())?(t.removeEntry(n,o.readTime),r=r.insert(n,o)):!s.isValidDocument()||o.version.compareTo(s.version)>0||0===o.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(o),r=r.insert(n,o)):qg(UC,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)}),{Ls:r,ks:i}})}function qC(e,t){const n=Yg(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Gm),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function VC(e,t){const n=Yg(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.hi.getTargetData(e,t).next(i=>i?(r=i,qm.resolve(r)):n.hi.allocateTargetId(e).next(i=>(r=new tC(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.hi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Fs.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(e.targetId,e),n.Ms.set(t,e.targetId)),e})}async function WC(e,t,n){const r=Yg(e),i=r.Fs.get(t),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!Wm(e))throw e;qg(UC,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Fs=r.Fs.remove(t),r.Ms.delete(i.target)}function $C(e,t,n){const r=Yg(e);let i=Om.min(),o=bw();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=Yg(e),i=r.Ms.get(n);return void 0!==i?qm.resolve(r.Fs.get(i)):r.hi.getTargetData(t,n)}(r,e,Zy(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{o=e})}).next(()=>r.Cs.getDocumentsMatchingQuery(e,t,n?i:Om.min(),n?o:bw())).next(e=>(GC(r,sw(t),e),{documents:e,qs:o})))}function GC(e,t,n){let r=e.xs.get(t)||Om.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.xs.set(t,r)}class KC{constructor(){this.activeTargetIds=Sw()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class QC{constructor(){this.Fo=new KC,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,n){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new KC,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class YC{xo(e){}shutdown(){}}const JC="ConnectivityMonitor";class XC{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){qg(JC,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){qg(JC,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ZC=null;function eS(){return null===ZC?ZC=268435456+Math.round(2147483648*Math.random()):ZC++,"0x"+ZC.toString(16)}const tS="RestConnection",nS={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rS{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${n}/databases/${r}`,this.Ko=this.databaseId.database===Gv?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Wo(e,t,n,r,i){const o=eS(),s=this.Go(e,t.toUriEncodedString());qg(tS,`Sending RPC '${e}' ${o}:`,s,n);const a={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(a,r,i);const{host:l}=new URL(s),c=iu(l);return this.jo(e,s,a,n,c).then(t=>(qg(tS,`Received RPC '${e}' ${o}: `,t),t),t=>{throw Wg(tS,`RPC '${e}' ${o} failed with error: `,t,"url: ",s,"request:",n),t})}Jo(e,t,n,r,i,o){return this.Wo(e,t,n,r,i)}zo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+jg,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}Go(e,t){const n=nS[e];return`${this.$o}/v1/${t}:${n}`}terminate(){}}class iS{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}const oS="WebChannelConnection";class sS extends rS{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,n,r,i){const o=eS();return new Promise((i,s)=>{const a=new Ag;a.setWithCredentials(!0),a.listenOnce(Rg.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Dg.NO_ERROR:const t=a.getResponseJson();qg(oS,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(t)),i(t);break;case Dg.TIMEOUT:qg(oS,`RPC '${e}' ${o} timed out`),s(new Xg(Jg.DEADLINE_EXCEEDED,"Request time out"));break;case Dg.HTTP_ERROR:const n=a.getStatus();if(qg(oS,`RPC '${e}' ${o} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Jg).indexOf(t)>=0?t:Jg.UNKNOWN}(t.status);s(new Xg(e,t.message))}else s(new Xg(Jg.UNKNOWN,"Server responded with status "+a.getStatus()))}else s(new Xg(Jg.UNAVAILABLE,"Connection failed."));break;default:Gg(9055,{c_:e,streamId:o,l_:a.getLastErrorCode(),h_:a.getLastError()})}}finally{qg(oS,`RPC '${e}' ${o} completed.`)}});const l=JSON.stringify(r);qg(oS,`RPC '${e}' ${o} sending request:`,r),a.send(t,"POST",l,n,15)})}P_(e,t,n){const r=eS(),i=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Ng(),s=Og(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.zo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");qg(oS,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=o.createWebChannel(c,a);this.T_(u);let d=!1,h=!1;const f=new iS({Ho:t=>{h?qg(oS,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(qg(oS,`Opening RPC '${e}' stream ${r} transport.`),u.open(),d=!0),qg(oS,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Yo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,kg.EventType.OPEN,()=>{h||(qg(oS,`RPC '${e}' stream ${r} transport opened.`),f.s_())}),p(u,kg.EventType.CLOSE,()=>{h||(h=!0,qg(oS,`RPC '${e}' stream ${r} transport closed`),f.__(),this.I_(u))}),p(u,kg.EventType.ERROR,t=>{h||(h=!0,Wg(oS,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),f.__(new Xg(Jg.UNAVAILABLE,"The operation could not be completed")))}),p(u,kg.EventType.MESSAGE,t=>{var n;if(!h){const i=t.data[0];Qg(!!i,16349);const o=i,s=(null==o?void 0:o.error)||(null===(n=o[0])||void 0===n?void 0:n.error);if(s){qg(oS,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=ib[e];if(void 0!==t)return ab(t)}(t),i=s.message;void 0===n&&(n=Jg.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),h=!0,f.__(new Xg(n,i)),u.close()}else qg(oS,`RPC '${e}' stream ${r} received:`,i),f.a_(i)}}),p(s,xg.STAT_EVENT,t=>{t.stat===Pg.PROXY?qg(oS,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Pg.NOPROXY&&qg(oS,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.o_()},0),f}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function aS(){return"undefined"!=typeof document?document:null}function lS(e){return new Ib(e,!0)}class cS{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Fi=e,this.timerId=t,this.d_=n,this.E_=r,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),r=Math.max(0,t-n);r>0&&qg("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const uS="PersistentStream";class dS{constructor(e,t,n,r,i,o,s,a){this.Fi=e,this.w_=n,this.S_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=a,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new cS(e,t)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==e?this.F_.reset():t&&t.code===Jg.RESOURCE_EXHAUSTED?(Vg(t.toString()),Vg("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Jg.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.b_===t&&this.W_(n,r)},t=>{e(()=>{const e=new Xg(Jg.UNKNOWN,"Fetching auth token failed: "+t.message);return this.G_(e)})})}W_(e,t){const n=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(e=>{n(()=>this.G_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.C_?this.j_(e):this.onNext(e))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return qg(uS,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(qg(uS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hS extends dS{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Gg(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(Qg(void 0===t||"string"==typeof t,58123),Nv.fromBase64String(t||"")):(Qg(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Nv.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&function(e){const t=void 0===e.code?Jg.UNKNOWN:ab(e.code);return new Xg(t,e.message||"")}(s);n=new yb(r,i,o,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Lb(e,r.document.name),o=Pb(r.document.updateTime),s=r.document.createTime?Pb(r.document.createTime):Om.min(),a=new vy({mapValue:{fields:r.document.fields}}),l=wy.newFoundDocument(i,o,s,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new mb(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Lb(e,r.document),o=r.readTime?Pb(r.readTime):Om.min(),s=wy.newNoDocument(i,o),a=r.removedTargetIds||[];n=new mb([],a,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Lb(e,r.document),o=r.removedTargetIds||[];n=new mb([],o,i,null)}else{if(!("filter"in t))return Gg(11601,{At:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,o=new rb(r,i),s=e.targetId;n=new vb(s,o)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Om.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Om.min():t.readTime?Pb(t.readTime):Om.min()}(e);return this.listener.J_(t,n)}H_(e){const t={};t.database=Hb(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=$y(r)?{documents:qb(e,r)}:{query:Vb(e,r).Vt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Rb(e,t.resumeToken);const r=Ab(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Om.min())>0){n.readTime=kb(e,t.snapshotVersion.toTimestamp());const r=Ab(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Gg(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.k_(t)}Y_(e){const t={};t.database=Hb(this.serializer),t.removeTarget=e,this.k_(t)}}class fS extends dS{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Qg(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Qg(!e.writeResults||0===e.writeResults.length,55816),this.listener.ea()}onNext(e){Qg(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=function(e,t){return e&&e.length>0?(Qg(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Pb(e.updateTime):Pb(t);return n.isEqual(Om.min())&&(n=Pb(t)),new Fw(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Pb(e.commitTime);return this.listener.ta(n,t)}na(){const e={};e.database=Hb(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>zb(this.serializer,e))};this.k_(t)}}class pS{}class gS extends pS{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new Xg(Jg.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[o,s]=i;return this.connection.Wo(e,Ob(t,n),r,o,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Jg.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Xg(Jg.UNKNOWN,e.toString())})}Jo(e,t,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(o=>{let[s,a]=o;return this.connection.Jo(e,Ob(t,n),r,s,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===Jg.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Xg(Jg.UNKNOWN,e.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class mS{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,"Online"===e&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Vg(t),this._a=!1):qg("OnlineStateTracker",t)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}const vS="RemoteStore";class yS{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(e=>{n.enqueueAndForget(async()=>{AS(this)&&(qg(vS,"Restarting streams for network reachability change."),await async function(e){const t=Yg(e);t.Ia.add(4),await bS(t),t.Aa.set("Unknown"),t.Ia.delete(4),await wS(t)}(this))})}),this.Aa=new mS(n,r)}}async function wS(e){if(AS(e))for(const t of e.da)await t(!0)}async function bS(e){for(const t of e.da)await t(!1)}function CS(e,t){const n=Yg(e);n.Ta.has(t.targetId)||(n.Ta.set(t.targetId,t),IS(n)?_S(n):$S(n).x_()&&ES(n,t))}function SS(e,t){const n=Yg(e),r=$S(n);n.Ta.delete(t),r.x_()&&TS(n,t),0===n.Ta.size&&(r.x_()?r.B_():AS(n)&&n.Aa.set("Unknown"))}function ES(e,t){if(e.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Om.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}$S(e).H_(t)}function TS(e,t){e.Ra.$e(t),$S(e).Y_(t)}function _S(e){e.Ra=new bb({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.Ta.get(t)||null,lt:()=>e.datastore.serializer.databaseId}),$S(e).start(),e.Aa.aa()}function IS(e){return AS(e)&&!$S(e).M_()&&e.Ta.size>0}function AS(e){return 0===Yg(e).Ia.size}function kS(e){e.Ra=void 0}async function RS(e){e.Aa.set("Online")}async function DS(e){e.Ta.forEach((t,n)=>{ES(e,t)})}async function PS(e,t){kS(e),IS(e)?(e.Aa.la(t),_S(e)):e.Aa.set("Unknown")}async function xS(e,t,n){if(e.Aa.set("Online"),t instanceof yb&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ta.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ta.delete(r),e.Ra.removeTarget(r))}(e,t)}catch(n){qg(vS,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await OS(e,n)}else if(t instanceof mb?e.Ra.Ye(t):t instanceof vb?e.Ra.it(t):e.Ra.et(t),!n.isEqual(Om.min()))try{const t=await BC(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Ra.Pt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ta.get(r);i&&e.Ta.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ta.get(t);if(!r)return;e.Ta.set(t,r.withResumeToken(Nv.EMPTY_BYTE_STRING,r.snapshotVersion)),TS(e,t);const i=new tC(r.target,t,n,r.sequenceNumber);ES(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){qg(vS,"Failed to raise snapshot:",t),await OS(e,t)}}async function OS(e,t,n){if(!Wm(t))throw t;e.Ia.add(1),await bS(e),e.Aa.set("Offline"),n||(n=()=>BC(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{qg(vS,"Retrying IndexedDB access"),await n(),e.Ia.delete(1),await wS(e)})}function NS(e,t){return t().catch(n=>OS(e,n,t))}async function MS(e){const t=Yg(e),n=GS(t);let r=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:Gm;for(;LS(t);)try{const e=await qC(t.localStore,r);if(null===e){0===t.Pa.length&&n.B_();break}r=e.batchId,US(t,e)}catch(e){await OS(t,e)}FS(t)&&HS(t)}function LS(e){return AS(e)&&e.Pa.length<10}function US(e,t){e.Pa.push(t);const n=GS(e);n.x_()&&n.Z_&&n.X_(t.mutations)}function FS(e){return AS(e)&&!GS(e).M_()&&e.Pa.length>0}function HS(e){GS(e).start()}async function jS(e){GS(e).na()}async function BS(e){const t=GS(e);for(const n of e.Pa)t.X_(n.mutations)}async function zS(e,t,n){const r=e.Pa.shift(),i=tb.from(r,t,n);await NS(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await MS(e)}async function qS(e,t){t&&GS(e).Z_&&await async function(e,t){if(function(e){return sb(e)&&e!==Jg.ABORTED}(t.code)){const n=e.Pa.shift();GS(e).N_(),await NS(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await MS(e)}}(e,t),FS(e)&&HS(e)}async function VS(e,t){const n=Yg(e);n.asyncQueue.verifyOperationInProgress(),qg(vS,"RemoteStore received new credentials");const r=AS(n);n.Ia.add(3),await bS(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ia.delete(3),await wS(n)}async function WS(e,t){const n=Yg(e);t?(n.Ia.delete(2),await wS(n)):t||(n.Ia.add(2),await bS(n),n.Aa.set("Unknown"))}function $S(e){return e.Va||(e.Va=function(e,t,n){const r=Yg(e);return r.ia(),new hS(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:RS.bind(null,e),e_:DS.bind(null,e),n_:PS.bind(null,e),J_:xS.bind(null,e)}),e.da.push(async t=>{t?(e.Va.N_(),IS(e)?_S(e):e.Aa.set("Unknown")):(await e.Va.stop(),kS(e))})),e.Va}function GS(e){return e.ma||(e.ma=function(e,t,n){const r=Yg(e);return r.ia(),new fS(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Zo:()=>Promise.resolve(),e_:jS.bind(null,e),n_:qS.bind(null,e),ea:BS.bind(null,e),ta:zS.bind(null,e)}),e.da.push(async t=>{t?(e.ma.N_(),await MS(e)):(await e.ma.stop(),e.Pa.length>0&&(qg(vS,`Stopping write stream with ${e.Pa.length} pending writes`),e.Pa=[]))})),e.ma}class KS{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Zg,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,s=new KS(e,t,o,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Xg(Jg.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function QS(e,t){if(Vg("AsyncQueue",`${t}: ${e}`),Wm(e))return new Xg(Jg.UNAVAILABLE,`${t}: ${e}`);throw e}class YS{static emptySet(e){return new YS(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Cm.comparator(t.key,n.key):(e,t)=>Cm.comparator(e.key,t.key),this.keyedMap=fw(),this.sortedSet=new Av(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof YS))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new YS;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class JS{constructor(){this.fa=new Av(Cm.comparator)}track(e){const t=e.doc.key,n=this.fa.get(t);n?0!==e.type&&3===n.type?this.fa=this.fa.insert(t,e):3===e.type&&1!==n.type?this.fa=this.fa.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.fa=this.fa.remove(t):1===e.type&&2===n.type?this.fa=this.fa.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Gg(63341,{At:e,ga:n}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,n)=>{e.push(n)}),e}}class XS{constructor(e,t,n,r,i,o,s,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach(e=>{o.push({type:0,doc:e})}),new XS(e,t,YS.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nw(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class ZS{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class eE{constructor(){this.queries=tE(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(e,t){const n=Yg(e),r=n.queries;n.queries=tE(),r.forEach((e,n)=>{for(const r of n.wa)r.onError(t)})}(this,new Xg(Jg.ABORTED,"Firestore shutting down"))}}function tE(){return new cw(e=>rw(e),nw)}async function nE(e,t){const n=Yg(e);let r=3;const i=t.query;let o=n.queries.get(i);o?!o.Sa()&&t.ba()&&(r=2):(o=new ZS,r=t.ba()?0:1);try{switch(r){case 0:o.ya=await n.onListen(i,!0);break;case 1:o.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=QS(e,`Initialization of query '${iw(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,o),o.wa.push(t),t.va(n.onlineState),o.ya&&t.Ca(o.ya)&&sE(n)}async function rE(e,t){const n=Yg(e),r=t.query;let i=3;const o=n.queries.get(r);if(o){const e=o.wa.indexOf(t);e>=0&&(o.wa.splice(e,1),0===o.wa.length?i=t.ba()?0:1:!o.Sa()&&t.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function iE(e,t){const n=Yg(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.wa)e.Ca(i)&&(r=!0);t.ya=i}}r&&sE(n)}function oE(e,t,n){const r=Yg(e),i=r.queries.get(t);if(i)for(const o of i.wa)o.onError(n);r.queries.delete(t)}function sE(e){e.Da.forEach(e=>{e.next()})}var aE,lE;(lE=aE||(aE={})).Fa="default",lE.Cache="cache";class cE{constructor(e,t,n){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new XS(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache)return!0;if(!this.ba())return!0;const n="Offline"!==t;return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}La(e){e=XS.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==aE.Cache}}class uE{constructor(e){this.key=e}}class dE{constructor(e){this.key=e}}class hE{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=bw(),this.mutatedKeys=bw(),this.Xa=aw(e),this.eu=new YS(this.Xa)}get tu(){return this.Ha}nu(e,t){const n=t?t.ru:new JS,r=t?t.eu:this.eu;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,s=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=ow(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.iu(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Xa(u,a)>0||l&&this.Xa(u,l)<0)&&(s=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(s=!0)),f&&(u?(o=o.add(u),i=h?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const e="F"===this.query.limitType?o.last():o.first();o=o.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{eu:o,ru:n,Ds:s,mutatedKeys:i}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Gg(20277,{At:e})}};return n(e)-n(t)}(e.type,t.type)||this.Xa(e.doc,t.doc)),this.su(n),r=null!=r&&r;const s=t&&!r?this.ou():[],a=0===this.Za.size&&this.current&&!r?1:0,l=a!==this.Ya;return this.Ya=a,0!==o.length||l?{snapshot:new XS(this.query,e.eu,i,o,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:s}:{_u:s}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({eu:this.eu,ru:new JS,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(e=>this.Ha=this.Ha.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ha=this.Ha.delete(e)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=bw(),this.eu.forEach(e=>{this.au(e.key)&&(this.Za=this.Za.add(e.key))});const t=[];return e.forEach(e=>{this.Za.has(e)||t.push(new dE(e))}),this.Za.forEach(n=>{e.has(n)||t.push(new uE(n))}),t}uu(e){this.Ha=e.qs,this.Za=bw();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return XS.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}const fE="SyncEngine";class pE{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class gE{constructor(e){this.key=e,this.lu=!1}}class mE{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new cw(e=>rw(e),nw),this.Tu=new Map,this.Iu=new Set,this.du=new Av(Cm.comparator),this.Eu=new Map,this.Au=new TC,this.Ru={},this.Vu=new Map,this.mu=uC.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function vE(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=FE(e);let i;const o=r.Pu.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=await wE(r,t,n,!0),i}async function yE(e,t){const n=FE(e);await wE(n,t,!0,!1)}async function wE(e,t,n,r){const i=await VC(e.localStore,Zy(t)),o=i.targetId,s=e.sharedClientState.addLocalQueryTarget(o,n);let a;return r&&(a=await bE(e,t,o,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&CS(e.remoteStore,i),a}async function bE(e,t,n,r,i){e.gu=(t,n,r)=>async function(e,t,n,r){let i=t.view.nu(n);i.Ds&&(i=await $C(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.nu(n,i)}));const o=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,o,s);return xE(e,t.targetId,a._u),a.snapshot}(e,t,n,r);const o=await $C(e.localStore,t,!0),s=new hE(t,o.qs),a=s.nu(o.documents),l=gb.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=s.applyChanges(a,e.isPrimaryClient,l);xE(e,n,c._u);const u=new pE(t,n,s);return e.Pu.set(t,u),e.Tu.has(n)?e.Tu.get(n).push(t):e.Tu.set(n,[t]),c.snapshot}async function CE(e,t,n){const r=Yg(e),i=r.Pu.get(t),o=r.Tu.get(i.targetId);if(o.length>1)return r.Tu.set(i.targetId,o.filter(e=>!nw(e,t))),void r.Pu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await WC(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&SS(r.remoteStore,i.targetId),DE(r,i.targetId)}).catch(zm)):(DE(r,i.targetId),await WC(r.localStore,i.targetId,!0))}async function SE(e,t){const n=Yg(e),r=n.Pu.get(t),i=n.Tu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),SS(n.remoteStore,r.targetId))}async function EE(e,t){const n=Yg(e);try{const e=await function(e,t){const n=Yg(e),r=t.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const o=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const s=[];t.targetChanges.forEach((o,a)=>{const l=i.get(a);if(!l)return;s.push(n.hi.removeMatchingKeys(e,o.removedDocuments,a).next(()=>n.hi.addMatchingKeys(e,o.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(Nv.EMPTY_BYTE_STRING,Om.min()).withLastLimboFreeSnapshotVersion(Om.min()):o.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(o.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,o)&&s.push(n.hi.updateTargetData(e,c))});let a=dw(),l=bw();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),s.push(zC(e,o,t.documentUpdates).next(e=>{a=e.Ls,l=e.ks})),!r.isEqual(Om.min())){const t=n.hi.getLastRemoteSnapshotVersion(e).next(t=>n.hi.setTargetsMetadata(e,e.currentSequenceNumber,r));s.push(t)}return qm.waitFor(s).next(()=>o.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Fs=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Eu.get(t);r&&(Qg(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.lu=!0:e.modifiedDocuments.size>0?Qg(r.lu,14607):e.removedDocuments.size>0&&(Qg(r.lu,42227),r.lu=!1))}),await ME(n,e,t)}catch(e){await zm(e)}}function TE(e,t,n){const r=Yg(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Pu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Yg(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.wa)i.va(t)&&(r=!0)}),r&&sE(n)}(r.eventManager,t),e.length&&r.hu.J_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function _E(e,t,n){const r=Yg(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Eu.get(t),o=i&&i.key;if(o){let e=new Av(Cm.comparator);e=e.insert(o,wy.newNoDocument(o,Om.min()));const n=bw().add(o),i=new pb(Om.min(),new Map,new Av(dm),e,n);await EE(r,i),r.du=r.du.remove(o),r.Eu.delete(t),NE(r)}else await WC(r.localStore,t,!1).then(()=>DE(r,t,n)).catch(zm)}async function IE(e,t){const n=Yg(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Yg(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,o=i.keys();let s=qm.resolve();return o.forEach(e=>{s=s.next(()=>r.getEntry(t,e)).next(t=>{const o=n.docVersions.get(e);Qg(null!==o,48541),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),s.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=bw();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);RE(n,r,null),kE(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ME(n,e)}catch(e){await zm(e)}}async function AE(e,t,n){const r=Yg(e);try{const e=await function(e,t){const n=Yg(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Qg(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);RE(r,t,n),kE(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await ME(r,e)}catch(n){await zm(n)}}function kE(e,t){(e.Vu.get(t)||[]).forEach(e=>{e.resolve()}),e.Vu.delete(t)}function RE(e,t,n){const r=Yg(e);let i=r.Ru[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ru[r.currentUser.toKey()]=i}}function DE(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Tu.get(t))e.Pu.delete(r),n&&e.hu.pu(r,n);e.Tu.delete(t),e.isPrimaryClient&&e.Au.zr(t).forEach(t=>{e.Au.containsKey(t)||PE(e,t)})}function PE(e,t){e.Iu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(SS(e.remoteStore,n),e.du=e.du.remove(t),e.Eu.delete(n),NE(e))}function xE(e,t,n){for(const r of n)r instanceof uE?(e.Au.addReference(r.key,t),OE(e,r)):r instanceof dE?(qg(fE,"Document no longer in limbo: "+r.key),e.Au.removeReference(r.key,t),e.Au.containsKey(r.key)||PE(e,r.key)):Gg(19791,{yu:r})}function OE(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Iu.has(r)||(qg(fE,"New document in limbo: "+n),e.Iu.add(r),NE(e))}function NE(e){for(;e.Iu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Iu.values().next().value;e.Iu.delete(t);const n=new Cm(ym.fromString(t)),r=e.mu.next();e.Eu.set(r,new gE(n)),e.du=e.du.insert(n,r),CS(e.remoteStore,new tC(Zy(Qy(n.path)),r,"TargetPurposeLimboResolution",$m.ue))}}async function ME(e,t,n){const r=Yg(e),i=[],o=[],s=[];r.Pu.isEmpty()||(r.Pu.forEach((e,a)=>{s.push(r.gu(a,t,n).then(e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=NC.Es(a.targetId,e);o.push(t)}}))}),await Promise.all(s),r.hu.J_(i),await async function(e,t){const n=Yg(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>qm.forEach(t,t=>qm.forEach(t.Is,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>qm.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!Wm(e))throw e;qg(UC,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Fs.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Fs=n.Fs.insert(e,i)}}}(r.localStore,o))}async function LE(e,t){const n=Yg(e);if(!n.currentUser.isEqual(t)){qg(fE,"User change. New user:",t.toKey());const e=await jC(n.localStore,t);n.currentUser=t,function(e,t){e.Vu.forEach(e=>{e.forEach(e=>{e.reject(new Xg(Jg.CANCELLED,t))})}),e.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await ME(n,e.Bs)}}function UE(e,t){const n=Yg(e),r=n.Eu.get(t);if(r&&r.lu)return bw().add(r.key);{let e=bw();const r=n.Tu.get(t);if(!r)return e;for(const t of r){const r=n.Pu.get(t);e=e.unionWith(r.view.tu)}return e}}function FE(e){const t=Yg(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=EE.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=UE.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=_E.bind(null,t),t.hu.J_=iE.bind(null,t.eventManager),t.hu.pu=oE.bind(null,t.eventManager),t}function HE(e){const t=Yg(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=IE.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=AE.bind(null,t),t}class jE{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lS(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return HC(this.persistence,new LC,e.initialUser,this.serializer)}Du(e){return new DC(xC.Vi,this.serializer)}bu(e){return new QC}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jE.provider={build:()=>new jE};class BE extends jE{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Qg(this.persistence.referenceDelegate instanceof OC,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new gC(n,e.asyncQueue,t)}Du(e){const t=void 0!==this.cacheSizeBytes?cC.withCacheSize(this.cacheSizeBytes):cC.DEFAULT;return new DC(e=>OC.Vi(e,t),this.serializer)}}class zE{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>TE(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=LE.bind(null,this.syncEngine),await WS(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new eE}createDatastore(e){const t=lS(e.databaseInfo.databaseId),n=function(e){return new sS(e)}(e.databaseInfo);return function(e,t,n,r){return new gS(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new yS(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>TE(this.syncEngine,e,0),XC.C()?new XC:new YC)}createSyncEngine(e,t){return function(e,t,n,r,i,o,s){const a=new mE(e,t,n,r,i,o);return s&&(a.fu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Yg(e);qg(vS,"RemoteStore shutting down."),t.Ia.add(5),await bS(t),t.Ea.shutdown(),t.Aa.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}zE.provider={build:()=>new zE};class qE{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Vg("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const VE="FirestoreClient";class WE{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Hg.UNAUTHENTICATED,this.clientId=um.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{qg(VE,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(qg(VE,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zg;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(a){const n=QS(a,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function $E(e,t){e.asyncQueue.verifyOperationInProgress(),qg(VE,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await jC(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>{Wg("Terminating Firestore due to IndexedDb database deletion"),e.terminate().then(()=>{qg("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(e=>{Wg("Terminating Firestore due to IndexedDb database deletion failed",e)})}),e._offlineComponents=t}async function GE(e,t){e.asyncQueue.verifyOperationInProgress();const n=await KE(e);qg(VE,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>VS(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>VS(t.remoteStore,n)),e._onlineComponents=t}async function KE(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){qg(VE,"Using user provided OfflineComponentProvider");try{await $E(e,e._uninitializedComponentsProvider._offline)}catch(a){const n=a;if(!function(e){return"FirebaseError"===e.name?e.code===Jg.FAILED_PRECONDITION||e.code===Jg.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Wg("Error using user provided cache. Falling back to memory cache: "+n),await $E(e,new jE)}}else qg(VE,"Using default OfflineComponentProvider"),await $E(e,new BE(void 0));return e._offlineComponents}async function QE(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(qg(VE,"Using user provided OnlineComponentProvider"),await GE(e,e._uninitializedComponentsProvider._online)):(qg(VE,"Using default OnlineComponentProvider"),await GE(e,new zE))),e._onlineComponents}function YE(e){return QE(e).then(e=>e.syncEngine)}async function JE(e){const t=await QE(e),n=t.eventManager;return n.onListen=vE.bind(null,t.syncEngine),n.onUnlisten=CE.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=yE.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=SE.bind(null,t.syncEngine),n}function XE(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Zg;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const o=new qE({next:a=>{o.Ou(),t.enqueueAndForget(()=>rE(e,s));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new Xg(Jg.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new Xg(Jg.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),s=new cE(Qy(n.path),o,{includeMetadataChanges:!0,ka:!0});return nE(e,s)}(await JE(e),e.asyncQueue,t,n,r)),r.promise}function ZE(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const eT=new Map,tT="firestore.googleapis.com",nT=!0;class rT{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Xg(Jg.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=tT,this.ssl=nT}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:nT;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=lC;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<hC)throw new Xg(Jg.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Xg(Jg.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZE(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Xg(Jg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Xg(Jg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Xg(Jg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iT{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new rT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Xg(Jg.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Xg(Jg.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new rT(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new tm;switch(e.type){case"firstParty":return new om(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Xg(Jg.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=eT.get(e);t&&(qg("ComponentProvider","Removing Datastore"),eT.delete(e),t.terminate())}(this),Promise.resolve()}}function oT(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;e=Am(e,iT);const o=iu(t),s=e._getSettings(),a=Object.assign(Object.assign({},s),{emulatorOptions:e._getEmulatorOptions()}),l=`${t}:${n}`;o&&(ou(`https://${l}`),lu("Firestore",!0)),s.host!==tT&&s.host!==l&&Wg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},s),{host:l,ssl:o,emulatorOptions:r});if(!yu(c,a)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Hg.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Yc(JSON.stringify({alg:"none",type:"JWT"})),Yc(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new Xg(Jg.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Hg(o)}e._authCredentials=new nm(new em(t,n))}}class sT{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new sT(this.firestore,e,this._query)}}class aT{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lT(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new aT(this.firestore,e,this._key)}toJSON(){return{type:aT._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Rm(t,aT._jsonSchema))return new aT(e,n||null,new Cm(ym.fromString(t.referencePath)))}}aT._jsonSchemaVersion="firestore/documentReference/1.0",aT._jsonSchema={type:km("string",aT._jsonSchemaVersion),referencePath:km("string")};class lT extends sT{constructor(e,t,n){super(e,t,Qy(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new aT(this.firestore,null,new Cm(e))}withConverter(e){return new lT(this.firestore,e,this._path)}}function cT(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Iu(e),Sm("collection","path",t),e instanceof iT){const n=ym.fromString(t,...r);return Tm(n),new lT(e,null,n)}{if(!(e instanceof aT||e instanceof lT))throw new Xg(Jg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ym.fromString(t,...r));return Tm(n),new lT(e.firestore,null,n)}}function uT(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Iu(e),1===arguments.length&&(t=um.newId()),Sm("doc","path",t),e instanceof iT){const n=ym.fromString(t,...r);return Em(n),new aT(e,null,new Cm(n))}{if(!(e instanceof aT||e instanceof lT))throw new Xg(Jg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ym.fromString(t,...r));return Em(n),new aT(e.firestore,e instanceof lT?e.converter:null,new Cm(n))}}const dT="AsyncQueue";class hT{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new cS(this,"async_queue_retry"),this.oc=()=>{const e=aS();e&&qg(dT,"Visibility state changed to "+e.visibilityState),this.F_.y_()},this._c=e;const t=aS();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=aS();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new Zg;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(d){if(!Wm(d))throw d;qg(dT,"Operation failed with retryable error: "+d)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(e=>{throw this.tc=e,this.nc=!1,Vg("INTERNAL UNHANDLED ERROR: ",fT(e)),e}).then(e=>(this.nc=!1,e))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const r=KS.createAndSchedule(this,e,t,n,e=>this.lc(e));return this.ec.push(r),r}ac(){this.tc&&Gg(47125,{hc:fT(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do{e=this._c,await e}while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function fT(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function pT(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class gT extends iT{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new hT,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new hT(e),this._firestoreClient=void 0,await e}}}function mT(e){if(e._terminated)throw new Xg(Jg.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||vT(e),e._firestoreClient}function vT(e){var t,n,r;const i=e._freezeSettings(),o=function(e,t,n,r){return new $v(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,ZE(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new WE(e._authCredentials,e._appCheckCredentials,e._queue,o,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class yT{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yT(Nv.fromBase64String(e))}catch(e){throw new Xg(Jg.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new yT(Nv.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:yT._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Rm(e,yT._jsonSchema))return yT.fromBase64String(e.bytes)}}yT._jsonSchemaVersion="firestore/bytes/1.0",yT._jsonSchema={type:km("string",yT._jsonSchemaVersion),bytes:km("string")};class wT{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Xg(Jg.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bm(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class bT{constructor(e){this._methodName=e}}class CT{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Xg(Jg.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Xg(Jg.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return dm(this._lat,e._lat)||dm(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:CT._jsonSchemaVersion}}static fromJSON(e){if(Rm(e,CT._jsonSchema))return new CT(e.latitude,e.longitude)}}CT._jsonSchemaVersion="firestore/geoPoint/1.0",CT._jsonSchema={type:km("string",CT._jsonSchemaVersion),latitude:km("number"),longitude:km("number")};class ST{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ST._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Rm(e,ST._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new ST(e.vectorValues);throw new Xg(Jg.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ST._jsonSchemaVersion="firestore/vectorValue/1.0",ST._jsonSchema={type:km("string",ST._jsonSchemaVersion),vectorValues:km("object")};const ET=/^__.*__$/;class TT{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Kw(e,this.data,this.fieldMask,t,this.fieldTransforms):new Gw(e,this.data,t,this.fieldTransforms)}}class _T{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Kw(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function IT(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Gg(40011,{Ec:e})}}class AT{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ac(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new AT(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.fc(e),r}gc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Rc({path:n,mc:!1});return r.Ac(),r}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return BT(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(0===e.length)throw this.wc("Document fields must not be empty");if(IT(this.Ec)&&ET.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class kT{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||lS(e)}Dc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new AT({Ec:e,methodName:t,bc:n,path:bm.emptyPath(),mc:!1,Sc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function RT(e){const t=e._freezeSettings(),n=lS(e._databaseId);return new kT(e._databaseId,!!t.ignoreUndefinedProperties,n)}function DT(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Dc(o.merge||o.mergeFields?2:0,t,n,i);UT("Data must be an object, but it was:",s,r);const a=MT(r,s);let l,c;if(o.merge)l=new xv(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){const e=[];for(const r of o.mergeFields){const i=FT(t,r,n);if(!s.contains(i))throw new Xg(Jg.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);zT(e,i)||e.push(i)}l=new xv(e),c=s.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=s.fieldTransforms;return new TT(new vy(a),l,c)}class PT extends bT{_toFieldTransform(e){if(2!==e.Ec)throw 1===e.Ec?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof PT}}function xT(e,t,n,r){const i=e.Dc(1,t,n);UT("Data must be an object, but it was:",i,r);const o=[],s=vy.empty();_v(r,(e,r)=>{const a=jT(t,e,n);r=Iu(r);const l=i.gc(a);if(r instanceof PT)o.push(a);else{const e=NT(r,l);null!=e&&(o.push(a),s.set(a,e))}});const a=new xv(o);return new _T(s,a,i.fieldTransforms)}function OT(e,t,n,r,i,o){const s=e.Dc(1,t,n),a=[FT(t,r,n)],l=[i];if(o.length%2!=0)throw new Xg(Jg.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<o.length;h+=2)a.push(FT(t,o[h])),l.push(o[h+1]);const c=[],u=vy.empty();for(let h=a.length-1;h>=0;--h)if(!zT(c,a[h])){const e=a[h];let t=l[h];t=Iu(t);const n=s.gc(e);if(t instanceof PT)c.push(e);else{const r=NT(t,n);null!=r&&(c.push(e),u.set(e,r))}}const d=new xv(c);return new _T(u,d,s.fieldTransforms)}function NT(e,t){if(LT(e=Iu(e)))return UT("Unsupported field value:",t,e),MT(e,t);if(e instanceof bT)return function(e,t){if(!IT(t.Ec))throw t.wc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.wc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.mc&&4!==t.Ec)throw t.wc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=NT(i,t.yc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Iu(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return _w(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=xm.fromDate(e);return{timestampValue:kb(t.serializer,n)}}if(e instanceof xm){const n=new xm(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:kb(t.serializer,n)}}if(e instanceof CT)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof yT)return{bytesValue:Rb(t.serializer,e._byteString)};if(e instanceof aT){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.wc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:xb(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof ST)return function(e,t){return{mapValue:{fields:{[Qv]:{stringValue:Xv},[Zv]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.wc("VectorValues must only contain numeric values.");return Ew(t.serializer,e)})}}}}}}(e,t);throw t.wc(`Unsupported field value: ${Im(e)}`)}(e,t)}function MT(e,t){const n={};return Iv(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):_v(e,(e,r)=>{const i=NT(r,t.Vc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function LT(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof xm||e instanceof CT||e instanceof yT||e instanceof aT||e instanceof bT||e instanceof ST)}function UT(e,t,n){if(!LT(n)||!_m(n)){const r=Im(n);throw"an object"===r?t.wc(e+" a custom object"):t.wc(e+" "+r)}}function FT(e,t,n){if((t=Iu(t))instanceof wT)return t._internalPath;if("string"==typeof t)return jT(e,t);throw BT("Field path arguments must be of type string or ",e,!1,void 0,n)}const HT=new RegExp("[~\\*/\\[\\]]");function jT(e,t,n){if(t.search(HT)>=0)throw BT(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new wT(...t.split("."))._internalPath}catch(l){throw BT(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function BT(e,t,n,r,i){const o=r&&!r.isEmpty(),s=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${r}`),s&&(l+=` in document ${i}`),l+=")"),new Xg(Jg.INVALID_ARGUMENT,a+e+l)}function zT(e,t){return e.some(e=>e.isEqual(t))}class qT{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new aT(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new VT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(WT("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class VT extends qT{data(){return super.data()}}function WT(e,t){return"string"==typeof t?jT(e,t):t instanceof wT?t._internalPath:t._delegate._internalPath}function $T(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Xg(Jg.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class GT{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(ey(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Uv(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fv(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Gg(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return _v(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[Zv].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>Uv(e.doubleValue));return new ST(i)}convertGeoPoint(e){return new CT(Uv(e.latitude),Uv(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Vv(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Wv(e));default:return null}}convertTimestamp(e){const t=Lv(e);return new xm(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ym.fromString(e);Qg(eC(n),9688,{name:e});const r=new Kv(n.get(1),n.get(3)),i=new Cm(n.popFirst(5));return r.isEqual(t)||Vg(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function KT(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class QT{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class YT extends qT{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new JT(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(WT("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Xg(Jg.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=YT._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}YT._jsonSchemaVersion="firestore/documentSnapshot/1.0",YT._jsonSchema={type:km("string",YT._jsonSchemaVersion),bundleSource:km("string","DocumentSnapshot"),bundleName:km("string"),bundle:km("string")};class JT extends YT{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class XT{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new QT(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new JT(this._firestore,this._userDataWriter,n.key,n,new QT(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Xg(Jg.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new JT(e._firestore,e._userDataWriter,n.doc.key,n.doc,new QT(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new JT(e._firestore,e._userDataWriter,t.doc.key,t.doc,new QT(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,o=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),o=n.indexOf(t.doc.key)),{type:ZT(t.type),doc:r,oldIndex:i,newIndex:o}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Xg(Jg.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=XT._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=um.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ZT(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Gg(61501,{type:e})}}XT._jsonSchemaVersion="firestore/querySnapshot/1.0",XT._jsonSchema={type:km("string",XT._jsonSchemaVersion),bundleSource:km("string","QuerySnapshot"),bundleName:km("string"),bundle:km("string")};class e_ extends GT{constructor(e){super(),this.firestore=e}convertBytes(e){return new yT(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new aT(this.firestore,null,t)}}function t_(e){return r_(Am(e.firestore,gT),[new Xw(e._key,Hw.none())])}function n_(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,o,s;e=Iu(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||pT(n[l])||(a=n[l++]);const c={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(pT(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(o=e.error)||void 0===o?void 0:o.bind(e),n[l+2]=null===(s=e.complete)||void 0===s?void 0:s.bind(e)}let u,d,h;if(e instanceof aT)d=Am(e.firestore,gT),h=Qy(e._key.path),u={next:t=>{n[l]&&n[l](i_(d,e,t))},error:n[l+1],complete:n[l+2]};else{const t=Am(e,sT);d=Am(t.firestore,gT),h=t._query;const r=new e_(d);u={next:e=>{n[l]&&n[l](new XT(d,r,t,e))},error:n[l+1],complete:n[l+2]},$T(e._query)}return function(e,t,n,r){const i=new qE(r),o=new cE(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>nE(await JE(e),o)),()=>{i.Ou(),e.asyncQueue.enqueueAndForget(async()=>rE(await JE(e),o))}}(mT(d),h,c,u)}function r_(e,t){return function(e,t){const n=new Zg;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=HE(e);try{const e=await function(e,t){const n=Yg(e),r=xm.now(),i=t.reduce((e,t)=>e.add(t.key),bw());let o,s;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=dw(),l=bw();return n.Os.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{o=i;const s=[];for(const e of t){const t=Ww(e,o.get(e.key).overlayedDocument);null!=t&&s.push(new Kw(e.key,t,yy(t.value.mapValue),Hw.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)}).next(t=>{s=t;const r=t.applyToLocalDocumentSet(o,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:s.batchId,changes:pw(o)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ru[e.currentUser.toKey()];r||(r=new Av(dm)),r=r.insert(t,n),e.Ru[e.currentUser.toKey()]=r}(r,e.batchId,n),await ME(r,e.changes),await MS(r.remoteStore)}catch(e){const t=QS(e,"Failed to persist write");n.reject(t)}}(await YE(e),t,n)),n.promise}(mT(e),t)}function i_(e,t,n){const r=n.docs.get(t._key),i=new e_(e);return new YT(e,i,t._key,r,new QT(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){jg=e}(zd),Ud(new Au("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const o=e.getProvider("app").getImmediate(),s=new gT(new rm(e.getProvider("auth-internal")),new am(o,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Xg(Jg.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Kv(e.options.projectId,t)}(o,r),o);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),Wd(Ug,Fg,e),Wd(Ug,Fg,"esm2017")}();const o_="@firebase/installations",s_="0.6.18",a_=1e4,l_=`w:${s_}`,c_="FIS_v2",u_=36e5,d_=new mu("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function h_(e){return e instanceof gu&&e.code.includes("request-failed")}function f_(e){let{projectId:t}=e;return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function p_(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function g_(e,t){const n=(await t.json()).error;return d_.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function m_(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function v_(e,t){let{refreshToken:n}=t;const r=m_(e);return r.append("Authorization",function(e){return`${c_} ${e}`}(n)),r}async function y_(e){const t=await e();return t.status>=500&&t.status<600?e():t}function w_(e){return new Promise(t=>{setTimeout(t,e)})}const b_=/^[cdef][\w-]{21}$/;function C_(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return b_.test(t)?t:""}catch(e){return""}}function S_(e){return`${e.appName}!${e.appId}`}const E_=new Map;function T_(e,t){const n=S_(e);__(n,t),function(e,t){const n=A_();n&&n.postMessage({key:e,fid:t});k_()}(n,t)}function __(e,t){const n=E_.get(e);if(n)for(const r of n)r(t)}let I_=null;function A_(){return!I_&&"BroadcastChannel"in self&&(I_=new BroadcastChannel("[Firebase] FID Change"),I_.onmessage=e=>{__(e.data.key,e.data.fid)}),I_}function k_(){0===E_.size&&I_&&(I_.close(),I_=null)}const R_="firebase-installations-store";let D_=null;function P_(){return D_||(D_=Yu("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(R_)}})),D_}async function x_(e,t){const n=S_(e),r=(await P_()).transaction(R_,"readwrite"),i=r.objectStore(R_),o=await i.get(n);return await i.put(t,n),await r.done,o&&o.fid===t.fid||T_(e,t.fid),t}async function O_(e){const t=S_(e),n=(await P_()).transaction(R_,"readwrite");await n.objectStore(R_).delete(t),await n.done}async function N_(e,t){const n=S_(e),r=(await P_()).transaction(R_,"readwrite"),i=r.objectStore(R_),o=await i.get(n),s=t(o);return void 0===s?await i.delete(n):await i.put(s,n),await r.done,!s||o&&o.fid===s.fid||T_(e,s.fid),s}async function M_(e){let t;const n=await N_(e.appConfig,n=>{const r=function(e){const t=e||{fid:C_(),registrationStatus:0};return F_(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(d_.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e,{fid:i}=t;const o=f_(n),s=m_(n),a=r.getImmediate({optional:!0});if(a){const e=await a.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const l={fid:i,authVersion:c_,appId:n.appId,sdkVersion:l_},c={method:"POST",headers:s,body:JSON.stringify(l)},u=await y_(()=>fetch(o,c));if(u.ok){const e=await u.json();return{fid:e.fid||i,registrationStatus:2,refreshToken:e.refreshToken,authToken:p_(e.authToken)}}throw await g_("Create Installation",u)}(e,t);return x_(e.appConfig,n)}catch(d){throw h_(d)&&409===d.customData.serverCode?await O_(e.appConfig):await x_(e.appConfig,{fid:t.fid,registrationStatus:0}),d}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:L_(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function L_(e){let t=await U_(e.appConfig);for(;1===t.registrationStatus;)await w_(100),t=await U_(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await M_(e);return n||t}return t}function U_(e){return N_(e,e=>{if(!e)throw d_.create("installation-not-found");return F_(e)})}function F_(e){return 1===(t=e).registrationStatus&&t.registrationTime+a_<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function H_(e,t){let{appConfig:n,heartbeatServiceProvider:r}=e;const i=function(e,t){let{fid:n}=t;return`${f_(e)}/${n}/authTokens:generate`}(n,t),o=v_(n,t),s=r.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&o.append("x-firebase-client",e)}const a={installation:{sdkVersion:l_,appId:n.appId}},l={method:"POST",headers:o,body:JSON.stringify(a)},c=await y_(()=>fetch(i,l));if(c.ok){return p_(await c.json())}throw await g_("Generate Auth Token",c)}async function j_(e){let t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await N_(e.appConfig,r=>{if(!z_(r))throw d_.create("not-registered");const i=r.authToken;if(!n&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+u_}(e)}(i))return r;if(1===i.requestStatus)return t=async function(e,t){let n=await B_(e.appConfig);for(;1===n.authToken.requestStatus;)await w_(100),n=await B_(e.appConfig);const r=n.authToken;return 0===r.requestStatus?j_(e,t):r}(e,n),r;{if(!navigator.onLine)throw d_.create("app-offline");const n=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return t=async function(e,t){try{const n=await H_(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await x_(e.appConfig,r),n}catch(d){if(!h_(d)||401!==d.customData.serverCode&&404!==d.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await x_(e.appConfig,n)}else await O_(e.appConfig);throw d}}(e,n),n}});return t?await t:r.authToken}function B_(e){return N_(e,e=>{if(!z_(e))throw d_.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+a_<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n})}function z_(e){return void 0!==e&&2===e.registrationStatus}async function q_(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;await async function(e){const{registrationPromise:t}=await M_(e);t&&await t}(n);return(await j_(n,t)).token}function V_(e){return d_.create("missing-app-config-values",{valueName:e})}const W_="installations",$_=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw V_("App Configuration");if(!e.name)throw V_("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw V_(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Fd(t,"heartbeat"),_delete:()=>Promise.resolve()}},G_=e=>{const t=Fd(e.getProvider("app").getImmediate(),W_).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await M_(t);return r?r.catch(console.error):j_(t).catch(console.error),n.fid}(t),getToken:e=>q_(t,e)}};Ud(new Au(W_,$_,"PUBLIC")),Ud(new Au("installations-internal",G_,"PRIVATE")),Wd(o_,s_),Wd(o_,s_,"esm2017");const K_="analytics",Q_="https://www.googletagmanager.com/gtag/js",Y_=new Uu("@firebase/analytics"),J_=new mu("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function X_(e){if(!e.startsWith(Q_)){const t=J_.create("invalid-gtag-resource",{gtagURL:e});return Y_.warn(t.message),""}return e}function Z_(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function eI(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:X_}),r=document.createElement("script"),i=`${Q_}?l=${e}&id=${t}`;r.src=n?null===n||void 0===n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function tI(e,t,n,r){return async function(i){try{for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];if("event"===i){const[r,i]=s;await async function(e,t,n,r,i){try{let o=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await Z_(n);for(const n of e){const e=r.find(e=>e.measurementId===n),i=e&&t[e.appId];if(!i){o=[];break}o.push(i)}}0===o.length&&(o=Object.values(t)),await Promise.all(o),e("event",r,i||{})}catch(d){Y_.error(d)}}(e,t,n,r,i)}else if("config"===i){const[i,o]=s;await async function(e,t,n,r,i,o){const s=r[i];try{if(s)await t[s];else{const e=(await Z_(n)).find(e=>e.measurementId===i);e&&await t[e.appId]}}catch(d){Y_.error(d)}e("config",i,o)}(e,t,n,r,i,o)}else if("consent"===i){const[t,n]=s;e("consent",t,n)}else if("get"===i){const[t,n,r]=s;e("get",t,n,r)}else if("set"===i){const[t]=s;e("set",t)}else e(i,...s)}catch(d){Y_.error(d)}}}const nI=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function rI(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function iI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nI,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:i,measurementId:o}=e.options;if(!r)throw J_.create("no-app-id");if(!i){if(o)return{measurementId:o,appId:r};throw J_.create("no-api-key")}const s=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new sI;return setTimeout(async()=>{a.abort()},void 0!==n?n:6e4),oI({appId:r,apiKey:i,measurementId:o},s,a,t)}async function oI(e,t,n){let{throttleEndTimeMillis:r,backoffCount:i}=t,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nI;var s;const{appId:a,measurementId:l}=e;try{await function(e,t){return new Promise((n,r)=>{const i=Math.max(t-Date.now(),0),o=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(o),r(J_.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(n,r)}catch(d){if(l)return Y_.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===d||void 0===d?void 0:d.message}]`),{appId:a,measurementId:l};throw d}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:rI(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),s=await fetch(o,i);if(200!==s.status&&304!==s.status){let e="";try{const n=await s.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(a){}throw J_.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return o.deleteThrottleMetadata(a),t}catch(d){const r=d;if(!function(e){if(!(e instanceof gu)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(r)){if(o.deleteThrottleMetadata(a),l)return Y_.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${null===r||void 0===r?void 0:r.message}]`),{appId:a,measurementId:l};throw d}const c=503===Number(null===(s=null===r||void 0===r?void 0:r.customData)||void 0===s?void 0:s.httpStatus)?_u(i,o.intervalMillis,30):_u(i,o.intervalMillis),u={throttleEndTimeMillis:Date.now()+c,backoffCount:i+1};return o.setThrottleMetadata(a,u),Y_.debug(`Calling attemptFetch again in ${c} millis`),oI(e,u,n,o)}}class sI{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let aI,lI;function cI(e){lI=e}function uI(e){aI=e}async function dI(e,t,n,r,i,o,s){var a;const l=iI(e);l.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Y_.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>Y_.error(e)),t.push(l);const c=async function(){if(!fu())return Y_.warn(J_.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await pu()}catch(d){return Y_.warn(J_.create("indexeddb-unavailable",{errorInfo:null===d||void 0===d?void 0:d.toString()}).message),!1}return!0}().then(e=>e?r.getId():void 0),[u,h]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(Q_)&&n.src.includes(e))return n;return null})(o)||eI(o,u.measurementId),lI&&(i("consent","default",lI),cI(void 0)),i("js",new Date);const f=null!==(a=null===s||void 0===s?void 0:s.config)&&void 0!==a?a:{};return f.origin="firebase",f.update=!0,null!=h&&(f.firebase_id=h),i("config",u.measurementId,f),aI&&(i("set",aI),uI(void 0)),u.measurementId}class hI{constructor(e){this.app=e}_delete(){return delete fI[this.app.options.appId],Promise.resolve()}}let fI={},pI=[];const gI={};let mI,vI,yI="dataLayer",wI="gtag",bI=!1;function CI(){const e=[];if(du()&&e.push("This is a browser extension environment."),"undefined"!==typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>`(${t+1}) ${e}`).join(" "),n=J_.create("invalid-analytics-context",{errorInfo:t});Y_.warn(n.message)}}function SI(e,t,n){CI();const r=e.options.appId;if(!r)throw J_.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw J_.create("no-api-key");Y_.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=fI[r])throw J_.create("already-exists",{id:r});if(!bI){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(yI);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(o=window[i]),window[i]=tI(o,e,t,n),{gtagCore:o,wrappedGtag:window[i]}}(fI,pI,gI,yI,wI);vI=e,mI=t,bI=!0}fI[r]=dI(e,pI,gI,t,mI,yI,n);return new hI(e)}function EI(e,t,n,r){e=Iu(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(vI,fI[e.app.options.appId],t,n,r).catch(e=>Y_.error(e))}const TI="@firebase/analytics",_I="0.10.17";Ud(new Au(K_,(e,t)=>{let{options:n}=t;return SI(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),Ud(new Au("analytics-internal",function(e){try{const t=e.getProvider(K_).getImmediate();return{logEvent:(e,n,r)=>EI(t,e,n,r)}}catch(d){throw J_.create("interop-component-reg-failed",{reason:d})}},"PRIVATE")),Wd(TI,_I),Wd(TI,_I,"esm2017");const II=qd({apiKey:"AIzaSyDvWQXNk4-vcpTYHvPpz2XXw-C7ocsu6rE",authDomain:"booking-2dfd1.firebaseapp.com",projectId:"booking-2dfd1",storageBucket:"booking-2dfd1.appspot.com",messagingSenderId:"200521592031",appId:"1:200521592031:web:1d7dc53b5645a7540b0d6a",measurementId:"G-XP4VKSJV0D"}),AI=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vd();const t=Fd(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Fd(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(yu(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;lh(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:mg,persistence:[Ip,sp,dp]}),r=nu("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>bg)return;const r=null===t||void 0===t?void 0:t.token;Cg!==r&&(Cg=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Iu(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){Iu(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const o=eu("auth");o&&Rf(n,`http://${o}`)}(II),function(e,t){const n="object"==typeof e?e:Vd(),r="string"==typeof e?e:t||Gv,i=Fd(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=(e=>{const t=eu(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&oT(i,...e)}return i}(II)),kI=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vd();e=Iu(e);const t=Fd(e,K_);t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Fd(e,K_);if(n.isInitialized()){const e=n.getImmediate();if(yu(t,n.getOptions()))return e;throw J_.create("already-initialized")}const r=n.initialize({options:t})}(e)}(II),{LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"}),RI=200,DI=400,PI=400,xI=499,OI=500,NI=599,MI=[kI.OPENID_SCOPE,kI.PROFILE_SCOPE,kI.OFFLINE_ACCESS_SCOPE],LI=[...MI,kI.EMAIL_SCOPE],UI="Content-Type",FI="Content-Length",HI="Retry-After",jI="X-AnchorMailbox",BI="x-ms-request-id",zI="x-ms-httpver",qI="active-account-filters",VI="common",WI="organizations",$I="consumers",GI="access_token",KI="xms_cc",QI="login",YI="select_account",JI="consent",XI="none",ZI="no_session",eA="code",tA="id_token token refresh_token",nA="query",rA="fragment",iA="query",oA="authorization_code",sA="refresh_token",aA="MSSTS",lA="ADFS",cA="Generic",uA="-",dA=".",hA={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},fA="appmetadata",pA="1",gA="authority-metadata",mA=86400,vA="config",yA="cache",wA="network",bA="hardcoded_values",CA={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},SA={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},EA=60,TA=3600,_A="throttling",IA="retry-after, h429",AA="invalid_grant",kA="client_mismatch",RA="1",DA="3",PA="4",xA="2",OA="4",NA="5",MA="0",LA="1",UA="2",FA="3",HA="4",jA="pop";var BA;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(BA||(BA={}));class zA{constructor(e,t,n){this.level=BA.Info;const r=e||zA.createDefaultLoggerOptions();this.localCallback=r.loggerCallback||(()=>{}),this.piiLoggingEnabled=r.piiLoggingEnabled||!1,this.level="number"===typeof r.logLevel?r.logLevel:BA.Info,this.correlationId=r.correlationId||kI.EMPTY_STRING,this.packageName=t||kI.EMPTY_STRING,this.packageVersion=n||kI.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:BA.Info}}clone(e,t,n){return new zA({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const n=`${`[${(new Date).toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${BA[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,n,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:BA.Error,containsPii:!1,correlationId:t||kI.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:BA.Error,containsPii:!0,correlationId:t||kI.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:BA.Warning,containsPii:!1,correlationId:t||kI.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:BA.Warning,containsPii:!0,correlationId:t||kI.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:BA.Info,containsPii:!1,correlationId:t||kI.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:BA.Info,containsPii:!0,correlationId:t||kI.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:BA.Verbose,containsPii:!1,correlationId:t||kI.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:BA.Verbose,containsPii:!0,correlationId:t||kI.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:BA.Trace,containsPii:!1,correlationId:t||kI.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:BA.Trace,containsPii:!0,correlationId:t||kI.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}const qA="AAD",VA="OIDC",WA="EAR",$A="none",GA="unexpected_error",KA="post_request_failed",QA={[GA]:"Unexpected error in authentication.",[KA]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class YA extends Error{constructor(e,t,n){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,YA.prototype),this.errorCode=e||kI.EMPTY_STRING,this.errorMessage=t||kI.EMPTY_STRING,this.subError=n||kI.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function JA(e,t){return new YA(e,t?`${QA[e]} ${t}`:QA[e])}const XA="client_info_decoding_error",ZA="client_info_empty_error",ek="token_parsing_error",tk="null_or_empty_token",nk="endpoints_resolution_error",rk="network_error",ik="openid_config_error",ok="hash_not_deserialized",sk="invalid_state",ak="state_mismatch",lk="state_not_found",ck="nonce_mismatch",uk="auth_time_not_found",dk="max_age_transpired",hk="multiple_matching_tokens",fk="multiple_matching_accounts",pk="multiple_matching_appMetadata",gk="request_cannot_be_made",mk="cannot_remove_empty_scope",vk="cannot_append_scopeset",yk="empty_input_scopeset",wk="device_code_polling_cancelled",bk="device_code_expired",Ck="device_code_unknown_error",Sk="no_account_in_silent_request",Ek="invalid_cache_record",Tk="invalid_cache_environment",_k="no_account_found",Ik="no_crypto_object",Ak="unexpected_credential_type",kk="invalid_assertion",Rk="invalid_client_credential",Dk="token_refresh_required",Pk="user_timeout_reached",xk="token_claims_cnf_required_for_signedjwt",Ok="authorization_code_missing_from_server_response",Nk="binding_key_not_removed",Mk="end_session_endpoint_not_supported",Lk="key_id_missing",Uk="no_network_connectivity",Fk="user_canceled",Hk="missing_tenant_id_error",jk="method_not_implemented",Bk="nested_app_auth_bridge_disabled",zk={[XA]:"The client info could not be parsed/decoded correctly",[ZA]:"The client info was empty",[ek]:"Token cannot be parsed",[tk]:"The token is null or empty",[nk]:"Endpoints cannot be resolved",[rk]:"Network request failed",[ik]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[ok]:"The hash parameters could not be deserialized",[sk]:"State was not the expected format",[ak]:"State mismatch error",[lk]:"State not found",[ck]:"Nonce mismatch error",[uk]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[dk]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[hk]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[fk]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[pk]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[gk]:"Token request cannot be made without authorization code or refresh token.",[mk]:"Cannot remove null or empty scope from ScopeSet",[vk]:"Cannot append ScopeSet",[yk]:"Empty input ScopeSet cannot be processed",[wk]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[bk]:"Device code is expired.",[Ck]:"Device code stopped polling for unknown reasons.",[Sk]:"Please pass an account object, silent flow is not supported without account information",[Ek]:"Cache record object was null or undefined.",[Tk]:"Invalid environment when attempting to create cache entry",[_k]:"No account found in cache for given key.",[Ik]:"No crypto object detected.",[Ak]:"Unexpected credential type.",[kk]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Rk]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Dk]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Pk]:"User defined timeout for device code polling reached",[xk]:"Cannot generate a POP jwt if the token_claims are not populated",[Ok]:"Server response does not contain an authorization code to proceed",[Nk]:"Could not remove the credential's binding key from storage.",[Mk]:"The provided authority does not support logout",[Lk]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Uk]:"No network connectivity. Check your internet connection.",[Fk]:"User cancelled the flow.",[Hk]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[jk]:"This method has not been implemented",[Bk]:"The nested app auth bridge is disabled"};class qk extends YA{constructor(e,t){super(e,t?`${zk[e]}: ${t}`:zk[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,qk.prototype)}}function Vk(e,t){return new qk(e,t)}const Wk={createNewGuid:()=>{throw Vk(jk)},base64Decode:()=>{throw Vk(jk)},base64Encode:()=>{throw Vk(jk)},base64UrlEncode:()=>{throw Vk(jk)},encodeKid:()=>{throw Vk(jk)},async getPublicKeyThumbprint(){throw Vk(jk)},async removeTokenBindingKey(){throw Vk(jk)},async clearKeystore(){throw Vk(jk)},async signJwt(){throw Vk(jk)},async hashString(){throw Vk(jk)}},$k="@azure/msal-common",Gk="15.8.1";function Kk(e,t){const n=function(e){if(!e)throw Vk(tk);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw Vk(ek);return t[2]}(e);try{const e=t(n);return JSON.parse(e)}catch(r){throw Vk(ek)}}function Qk(e,t){if(0===t||Date.now()-3e5>e+t)throw Vk(dk)}function Yk(){return Math.round((new Date).getTime()/1e3)}function Jk(e){return e.getTime()/1e3}function Xk(e){return e?new Date(1e3*Number(e)):new Date}function Zk(e,t){const n=Number(e)||0;return Yk()+t>n}function eR(e){return[oR(e),sR(e),aR(e),lR(e),cR(e)].join(uA).toLowerCase()}function tR(e,t,n,r,i){return{credentialType:hA.ID_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n,realm:i}}function nR(e,t,n,r,i,o,s,a,l,c,u,d,h,f,p){const g={homeAccountId:e,credentialType:hA.ACCESS_TOKEN,secret:n,cachedAt:Yk().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:t,clientId:r,realm:i,target:o,tokenType:u||SA.BEARER};if(d&&(g.userAssertionHash=d),c&&(g.refreshOn=c.toString()),f&&(g.requestedClaims=f,g.requestedClaimsHash=p),g.tokenType?.toLowerCase()!==SA.BEARER.toLowerCase())switch(g.credentialType=hA.ACCESS_TOKEN_WITH_AUTH_SCHEME,g.tokenType){case SA.POP:const e=Kk(n,l);if(!e?.cnf?.kid)throw Vk(xk);g.keyId=e.cnf.kid;break;case SA.SSH:g.keyId=h}return g}function rR(e,t,n,r,i,o,s){const a={credentialType:hA.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:r,secret:n};return o&&(a.userAssertionHash=o),i&&(a.familyId=i),s&&(a.expiresOn=s.toString()),a}function iR(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function oR(e){return[e.homeAccountId,e.environment].join(uA).toLowerCase()}function sR(e){const t=e.credentialType===hA.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(uA).toLowerCase()}function aR(e){return(e.target||"").toLowerCase()}function lR(e){return(e.requestedClaimsHash||"").toLowerCase()}function cR(e){return e.tokenType&&e.tokenType.toLowerCase()!==SA.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function uR(){return Yk()+mA}function dR(e,t,n){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=n,e.jwks_uri=t.jwks_uri}function hR(e,t,n){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=n}function fR(e){return e.expiresAt<=Yk()}const pR="redirect_uri_empty",gR="claims_request_parsing_error",mR="authority_uri_insecure",vR="url_parse_error",yR="empty_url_error",wR="empty_input_scopes_error",bR="invalid_claims",CR="token_request_empty",SR="logout_request_empty",ER="invalid_code_challenge_method",TR="pkce_params_missing",_R="invalid_cloud_discovery_metadata",IR="invalid_authority_metadata",AR="untrusted_authority",kR="missing_ssh_jwk",RR="missing_ssh_kid",DR="missing_nonce_authentication_header",PR="invalid_authentication_header",xR="cannot_set_OIDCOptions",OR="cannot_allow_platform_broker",NR="authority_mismatch",MR={[pR]:"A redirect URI is required for all calls, and none has been set.",[gR]:"Could not parse the given claims request object.",[mR]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[vR]:"URL could not be parsed into appropriate segments.",[yR]:"URL was empty or null.",[wR]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[bR]:"Given claims parameter must be a stringified JSON object.",[CR]:"Token request was empty and not found in cache.",[SR]:"The logout request was null or undefined.",[ER]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[TR]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[_R]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[IR]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[AR]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[kR]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[RR]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[DR]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[PR]:"Invalid authentication header provided",[xR]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[OR]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[NR]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class LR extends YA{constructor(e){super(e,MR[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,LR.prototype)}}function UR(e){return new LR(e)}class FR{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return 0===Object.keys(t).length}catch(d){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},n=e.split("&"),r=e=>decodeURIComponent(e.replace(/\+/g," "));return n.forEach(e=>{if(e.trim()){const[n,i]=e.split(/=(.+)/g,2);n&&i&&(t[r(n)]=r(i))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(d){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class HR{constructor(e){const t=e?FR.trimArrayEntries([...e]):[],n=t?FR.removeEmptyStringsFromArray(t):[];if(!n||!n.length)throw UR(wR);this.scopes=new Set,n.forEach(e=>this.scopes.add(e))}static fromString(e){const t=(e||kI.EMPTY_STRING).split(" ");return new HR(t)}static createSearchScopes(e){const t=new HR(e);return t.containsOnlyOIDCScopes()?t.removeScope(kI.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}containsScope(e){const t=this.printScopesLowerCase().split(" "),n=new HR(t);return!!e&&n.scopes.has(e.toLowerCase())}containsScopeSet(e){return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e)))}containsOnlyOIDCScopes(){let e=0;return LI.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(d){throw Vk(vk)}}removeScope(e){if(!e)throw Vk(mk);this.scopes.delete(e.trim())}removeOIDCScopes(){LI.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw Vk(yk);const t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw Vk(yk);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),n=e.getScopeCount(),r=this.getScopeCount();return t.size<r+n}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){if(this.scopes){return this.asArray().join(" ")}return kI.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function jR(e,t){if(!e)throw Vk(ZA);try{const n=t(e);return JSON.parse(n)}catch(d){throw Vk(XA)}}function BR(e){if(!e)throw Vk(XA);const t=e.split(dA,2);return{uid:t[0],utid:t.length<2?kI.EMPTY_STRING:t[1]}}function zR(e,t){return!!e&&!!t&&e===t.split(".")[1]}function qR(e,t,n,r){if(r){const{oid:t,sub:n,tid:i,name:o,tfp:s,acr:a}=r,l=i||s||a||"";return{tenantId:l,localAccountId:t||n||"",name:o,isHomeTenant:zR(l,e)}}return{tenantId:n,localAccountId:t,isHomeTenant:zR(n,e)}}function VR(e,t,n,r){let i=e;if(t){const{isHomeTenant:n,...r}=t;i={...e,...r}}if(n){const{isHomeTenant:t,...o}=qR(e.homeAccountId,e.localAccountId,e.tenantId,n);return i={...i,...o,idTokenClaims:n,idToken:r},i}return i}const WR=0,$R=1,GR=2,KR=3;function QR(e){if(e){return e.tid||e.tfp||e.acr||null}return null}class YR{generateAccountId(){return[this.homeAccountId,this.environment].join(uA).toLowerCase()}generateAccountKey(){return YR.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(uA).toLowerCase()}static createAccount(e,t,n){const r=new YR;let i;t.authorityType===$R?r.authorityType=lA:t.protocolMode===VA?r.authorityType=cA:r.authorityType=aA,e.clientInfo&&n&&(i=jR(e.clientInfo,n)),r.clientInfo=e.clientInfo,r.homeAccountId=e.homeAccountId,r.nativeAccountId=e.nativeAccountId;const o=e.environment||t&&t.getPreferredCache();if(!o)throw Vk(Tk);r.environment=o,r.realm=i?.utid||QR(e.idTokenClaims)||"",r.localAccountId=i?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const s=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,a=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(r.username=s||a||"",r.name=e.idTokenClaims?.name||"",r.cloudGraphHostName=e.cloudGraphHostName,r.msGraphHost=e.msGraphHost,e.tenantProfiles)r.tenantProfiles=e.tenantProfiles;else{const t=qR(e.homeAccountId,r.localAccountId,r.realm,e.idTokenClaims);r.tenantProfiles=[t]}return r}static createFromAccountInfo(e,t,n){const r=new YR;return r.authorityType=e.authorityType||cA,r.homeAccountId=e.homeAccountId,r.localAccountId=e.localAccountId,r.nativeAccountId=e.nativeAccountId,r.realm=e.tenantId,r.environment=e.environment,r.username=e.username,r.name=e.name,r.cloudGraphHostName=t,r.msGraphHost=n,r.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),r}static generateHomeAccountId(e,t,n,r,i){if(t!==$R&&t!==GR){if(e)try{const t=jR(e,r.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(d){}n.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let r=!0;if(n){const n=e.idTokenClaims||{},i=t.idTokenClaims||{};r=n.iat===i.iat&&n.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&r}}function JR(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function XR(e){if(!e||e.indexOf("=")<0)return null;try{const t=JR(e),n=Object.fromEntries(new URLSearchParams(t));if(n.code||n.ear_jwe||n.error||n.error_description||n.state)return n}catch(d){throw Vk(ok)}return null}function ZR(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const r=new Array;return e.forEach((e,i)=>{!t&&n&&i in n?r.push(`${i}=${e}`):r.push(`${i}=${encodeURIComponent(e)}`)}),r.join("&")}class eD{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw UR(yR);e.includes("#")||(this._urlString=eD.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return FR.endsWith(t,"?")?t=t.slice(0,-1):FR.endsWith(t,"?/")&&(t=t.slice(0,-2)),FR.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(d){throw UR(vR)}if(!e.HostNameAndPort||!e.PathSegments)throw UR(vR);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw UR(mR)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return eD.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),n=t.PathSegments;return!e||0===n.length||n[0]!==VI&&n[0]!==WI||(n[0]=e),eD.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw UR(vR);const n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let r=n.AbsolutePath.split("/");return r=r.filter(e=>e&&e.length>0),n.PathSegments=r,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw UR(vR);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===kI.FORWARD_SLASH){const n=new eD(t).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new eD(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!XR(e)}}const tD={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},nD={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},rD=new Set;function iD(e,t,n,r){if(r?.trace(`getAliasesFromMetadata called with source: ${n}`),e&&t){const i=oD(t,e);if(i)return r?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${n}, returning aliases`),i.aliases;r?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${n}`)}return null}function oD(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.aliases.includes(t))return r}return null}nD.metadata.forEach(e=>{e.aliases.forEach(e=>{rD.add(e)})});const sD="cache_quota_exceeded",aD="cache_error_unknown",lD={[sD]:"Exceeded cache storage capacity.",[aD]:"Unexpected error occurred when using cache storage."};class cD extends YA{constructor(e,t){const n=t||(lD[e]?lD[e]:lD[aD]);super(`${e}: ${n}`),Object.setPrototypeOf(this,cD.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}}function uD(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new cD(sD):new cD(e.name,e.message):new cD(aD)}class dD{constructor(e,t,n,r,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone($k,Gk),this.staticAuthorityOptions=i,this.performanceClient=r}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){const n=this.getAllAccounts(e,t);if(n.length>1){return n.sort(e=>e.idTokenClaims?-1:1)[0]}return 1===n.length?n[0]:null}getBaseAccountInfo(e,t){const n=this.getAccountsFilteredBy(e,t);return n.length>0?n[0].getAccountInfo():null}buildTenantProfiles(e,t,n){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,n?.tenantId,n))}getTenantedAccountInfoByFilter(e,t,n,r,i){let o,s=null;if(i&&!this.tenantProfileMatchesFilter(n,i))return null;const a=this.getIdToken(e,r,t,n.tenantId);return a&&(o=Kk(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(o,i))?null:(s=VR(e,n,o,a?.secret),s)}getTenantProfilesFromAccountEntity(e,t,n,r){const i=e.getAccountInfo();let o=i.tenantProfiles||new Map;const s=this.getTokenKeys();if(n){const e=o.get(n);if(!e)return[];o=new Map([[n,e]])}const a=[];return o.forEach(e=>{const n=this.getTenantedAccountInfoByFilter(i,s,e,t,r);n&&a.push(n)}),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&((!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant))}idTokenClaimsMatchTenantProfileFilter(e,t){if(t){if(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))return!1;if(t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint))return!1;if(t.username&&!this.matchUsername(e.preferred_username,t.username))return!1;if(t.name&&!this.matchName(e,t.name))return!1;if(t.sid&&!this.matchSid(e,t.sid))return!1}return!0}async saveCacheRecord(e,t,n){if(!e)throw Vk(Ek);try{e.account&&await this.setAccount(e.account,t),e.idToken&&!1!==n?.idToken&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&!1!==n?.accessToken&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&!1!==n?.refreshToken&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(d){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),d instanceof YA?d:uD(d)}}async saveAccessToken(e,t){const n={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),i=HR.fromString(e.target);r.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,n,!1))return;const r=this.getAccessTokenCredential(e,t);if(r&&this.credentialMatchesFilter(r,n)){HR.fromString(r.target).intersectingScopeSets(i)&&this.removeAccessToken(e,t)}}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const n=this.getAccountKeys(),r=[];return n.forEach(n=>{if(!this.isAccountKey(n,e.homeAccountId))return;const i=this.getAccount(n,t);if(!i)return;if(e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId))return;if(e.username&&!this.matchUsername(i.username,e.username))return;if(e.environment&&!this.matchEnvironment(i,e.environment))return;if(e.realm&&!this.matchRealm(i,e.realm))return;if(e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId))return;if(e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;const o={localAccountId:e?.localAccountId,name:e?.name},s=i.tenantProfiles?.filter(e=>this.tenantProfileMatchesFilter(e,o));s&&0===s.length||r.push(i)}),r}isAccountKey(e,t,n){return!(e.split(uA).length<3)&&(!(t&&!e.toLowerCase().includes(t.toLowerCase()))&&!(n&&!e.toLowerCase().includes(n.toLowerCase())))}isCredentialKey(e){if(e.split(uA).length<6)return!1;const t=e.toLowerCase();if(-1===t.indexOf(hA.ID_TOKEN.toLowerCase())&&-1===t.indexOf(hA.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(hA.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(hA.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(hA.REFRESH_TOKEN.toLowerCase())>-1){const e=`${hA.REFRESH_TOKEN}${uA}${this.clientId}${uA}`,n=`${hA.REFRESH_TOKEN}${uA}${pA}${uA}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(n.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){if(t.clientId&&!this.matchClientId(e,t.clientId))return!1;if(t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash))return!1;if("string"===typeof t.homeAccountId&&!this.matchHomeAccountId(e,t.homeAccountId))return!1;if(t.environment&&!this.matchEnvironment(e,t.environment))return!1;if(t.realm&&!this.matchRealm(e,t.realm))return!1;if(t.credentialType&&!this.matchCredentialType(e,t.credentialType))return!1;if(t.familyId&&!this.matchFamilyId(e,t.familyId))return!1;if(t.target&&!this.matchTarget(e,t.target))return!1;if((t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash)return!1;if(e.credentialType===hA.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(t.tokenType&&!this.matchTokenType(e,t.tokenType))return!1;if(t.tokenType===SA.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId))return!1}return!0}getAppMetadataFilteredBy(e){const t=this.getKeys(),n={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;const r=this.getAppMetadata(t);r&&(e.environment&&!this.matchEnvironment(r,e.environment)||e.clientId&&!this.matchClientId(r,e.clientId)||(n[t]=r))}),n}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let n=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;const r=this.getAuthorityMetadata(t);r&&-1!==r.aliases.indexOf(e)&&(n=r)}),n}removeAllAccounts(e){this.getAccountKeys().forEach(t=>{this.removeAccount(t,e)})}removeAccount(e,t){const n=this.getAccount(e,t);n&&(this.removeAccountContext(n,t),this.removeItem(e,t))}removeAccountContext(e,t){const n=this.getTokenKeys(),r=e.generateAccountId();n.idToken.forEach(e=>{0===e.indexOf(r)&&this.removeIdToken(e,t)}),n.accessToken.forEach(e=>{0===e.indexOf(r)&&this.removeAccessToken(e,t)}),n.refreshToken.forEach(e=>{0===e.indexOf(r)&&this.removeRefreshToken(e,t)})}removeAccessToken(e,t){const n=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!n||n.credentialType.toLowerCase()!==hA.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||n.tokenType!==SA.POP)return;const r=n.keyId;r&&this.cryptoImpl.removeTokenBindingKey(r).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${r}`,t),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}readAccountFromCache(e,t){const n=YR.generateAccountCacheKey(e);return this.getAccount(n,t)}getIdToken(e,t,n,r,i){this.commonLogger.trace("CacheManager - getIdToken called");const o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:hA.ID_TOKEN,clientId:this.clientId,realm:r},s=this.getIdTokensByFilter(o,t,n),a=s.size;if(a<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(a>1){let n=s;if(!r){const t=new Map;s.forEach((n,r)=>{n.realm===e.tenantId&&t.set(r,n)});const r=t.size;if(r<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(1===r)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;n=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),n.forEach((e,n)=>{this.removeIdToken(n,t)}),i&&t&&i.addFields({multiMatchedID:s.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t,n){const r=n&&n.idToken||this.getTokenKeys().idToken,i=new Map;return r.forEach(n=>{if(!this.idTokenKeyMatchesFilter(n,{clientId:this.clientId,...e}))return;const r=this.getIdTokenCredential(n,t);r&&this.credentialMatchesFilter(r,e)&&i.set(n,r)}),i}idTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.clientId||-1!==n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,n,r){const i=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",i);const o=HR.createSearchScopes(t.scopes),s=t.authenticationScheme||SA.BEARER,a=s&&s.toLowerCase()!==SA.BEARER.toLowerCase()?hA.ACCESS_TOKEN_WITH_AUTH_SCHEME:hA.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:a,clientId:this.clientId,realm:r||e.tenantId,target:o,tokenType:s,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},c=n&&n.accessToken||this.getTokenKeys().accessToken,u=[];c.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){const t=this.getAccessTokenCredential(e,i);t&&this.credentialMatchesFilter(t,l)&&u.push(t)}});const d=u.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",i),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",i),u.forEach(e=>{this.removeAccessToken(eR(e),i)}),this.performanceClient.addFields({multiMatchedAT:u.length},i),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",i),u[0])}accessTokenKeyMatchesFilter(e,t,n){const r=e.toLowerCase();if(t.clientId&&-1===r.indexOf(t.clientId.toLowerCase()))return!1;if(t.homeAccountId&&-1===r.indexOf(t.homeAccountId.toLowerCase()))return!1;if(t.realm&&-1===r.indexOf(t.realm.toLowerCase()))return!1;if(t.requestedClaimsHash&&-1===r.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){const e=t.target.asArray();for(let t=0;t<e.length;t++){if(n&&!r.includes(e[t].toLowerCase()))return!1;if(!n&&r.includes(e[t].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const n=this.getTokenKeys(),r=[];return n.accessToken.forEach(n=>{if(!this.accessTokenKeyMatchesFilter(n,e,!0))return;const i=this.getAccessTokenCredential(n,t);i&&this.credentialMatchesFilter(i,e)&&r.push(i)}),r}getRefreshToken(e,t,n,r,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const o=t?pA:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:hA.REFRESH_TOKEN,clientId:this.clientId,familyId:o},a=r&&r.refreshToken||this.getTokenKeys().refreshToken,l=[];a.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,s)){const t=this.getRefreshTokenCredential(e,n);t&&this.credentialMatchesFilter(t,s)&&l.push(t)}});const c=l.length;return c<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(c>1&&i&&n&&i.addFields({multiMatchedRT:c},n),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){const n=e.toLowerCase();return(!t.familyId||-1!==n.indexOf(t.familyId.toLowerCase()))&&(!(!t.familyId&&t.clientId&&-1===n.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==n.indexOf(t.homeAccountId.toLowerCase())))}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),r=Object.keys(n).map(e=>n[e]),i=r.length;if(i<1)return null;if(i>1)throw Vk(pk);return r[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!(!t||t.familyId!==pA)}matchHomeAccountId(e,t){return!("string"!==typeof e.homeAccountId||t!==e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!(!e||"string"!==typeof e||t?.toLowerCase()!==e.toLowerCase())}matchUserAssertionHash(e,t){return!(!e.userAssertionHash||t!==e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const n=function(e,t){let n;const r=e.canonicalAuthority;if(r){const i=new eD(r).getUrlComponents().HostNameAndPort;n=iD(i,e.cloudDiscoveryMetadata?.metadata,vA,t)||iD(i,nD.metadata,bA,t)||e.knownAuthorities}return n||[]}(this.staticAuthorityOptions,this.commonLogger);if(n.includes(t)&&n.includes(e.environment))return!0}const n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!(!e.clientId||t!==e.clientId)}matchFamilyId(e,t){return!(!e.familyId||t!==e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!(!e.nativeAccountId||t!==e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||(e.preferred_username===t||e.upn===t)}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!(!e.authorityType||t.toLowerCase()!==e.authorityType.toLowerCase())}matchTarget(e,t){if(e.credentialType!==hA.ACCESS_TOKEN&&e.credentialType!==hA.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;return HR.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!(!e.tokenType||e.tokenType!==t)}matchKeyId(e,t){return!(!e.keyId||e.keyId!==t)}isAppMetadata(e){return-1!==e.indexOf(fA)}isAuthorityMetadata(e){return-1!==e.indexOf(gA)}generateAuthorityMetadataCacheKey(e){return`${gA}-${this.clientId}-${e}`}static toObject(e,t){for(const n in t)e[n]=t[n];return e}}class hD extends dD{async setAccount(){throw Vk(jk)}getAccount(){throw Vk(jk)}async setIdTokenCredential(){throw Vk(jk)}getIdTokenCredential(){throw Vk(jk)}async setAccessTokenCredential(){throw Vk(jk)}getAccessTokenCredential(){throw Vk(jk)}async setRefreshTokenCredential(){throw Vk(jk)}getRefreshTokenCredential(){throw Vk(jk)}setAppMetadata(){throw Vk(jk)}getAppMetadata(){throw Vk(jk)}setServerTelemetry(){throw Vk(jk)}getServerTelemetry(){throw Vk(jk)}setAuthorityMetadata(){throw Vk(jk)}getAuthorityMetadata(){throw Vk(jk)}getAuthorityMetadataKeys(){throw Vk(jk)}setThrottlingCache(){throw Vk(jk)}getThrottlingCache(){throw Vk(jk)}removeItem(){throw Vk(jk)}getKeys(){throw Vk(jk)}getAccountKeys(){throw Vk(jk)}getTokenKeys(){throw Vk(jk)}}const fD="acquireTokenByCode",pD="acquireTokenByRefreshToken",gD="acquireTokenSilent",mD="acquireTokenSilentAsync",vD="acquireTokenPopup",yD="acquireTokenPreRedirect",wD="acquireTokenRedirect",bD="cryptoOptsGetPublicKeyThumbprint",CD="cryptoOptsSignJwt",SD="silentCacheClientAcquireToken",ED="silentIframeClientAcquireToken",TD="awaitConcurrentIframe",_D="silentRefreshClientAcquireToken",ID="ssoSilent",AD="standardInteractionClientGetDiscoveredAuthority",kD="nativeInteractionClientAcquireToken",RD="networkClientSendPostRequestAsync",DD="refreshTokenClientExecutePostToTokenEndpoint",PD="authorizationCodeClientExecutePostToTokenEndpoint",xD="refreshTokenClientExecuteTokenRequest",OD="refreshTokenClientAcquireToken",ND="refreshTokenClientAcquireTokenWithCachedRefreshToken",MD="refreshTokenClientAcquireTokenByRefreshToken",LD="refreshTokenClientCreateTokenRequestBody",UD="acquireTokenFromCache",FD="silentFlowClientAcquireCachedToken",HD="silentFlowClientGenerateResultFromCacheRecord",jD="acquireTokenBySilentIframe",BD="initializeBaseRequest",zD="initializeSilentRequest",qD="initializeClientApplication",VD="initializeCache",WD="silentIframeClientTokenHelper",$D="silentHandlerInitiateAuthRequest",GD="silentHandlerMonitorIframeForHash",KD="silentHandlerLoadFrame",QD="silentHandlerLoadFrameSync",YD="standardInteractionClientCreateAuthCodeClient",JD="standardInteractionClientGetClientConfiguration",XD="standardInteractionClientInitializeAuthorizationRequest",ZD="getAuthCodeUrl",eP="getStandardParams",tP="handleCodeResponseFromServer",nP="handleCodeResponse",rP="handleResponseEar",iP="handleResponsePlatformBroker",oP="handleResponseCode",sP="updateTokenEndpointAuthority",aP="authClientAcquireToken",lP="authClientExecuteTokenRequest",cP="authClientCreateTokenRequestBody",uP="popTokenGenerateCnf",dP="popTokenGenerateKid",hP="handleServerTokenResponse",fP="deserializeResponse",pP="authorityFactoryCreateDiscoveredInstance",gP="authorityResolveEndpointsAsync",mP="authorityGetCloudDiscoveryMetadataFromNetwork",vP="authorityUpdateCloudDiscoveryMetadata",yP="authorityGetEndpointMetadataFromNetwork",wP="authorityUpdateEndpointMetadata",bP="authorityUpdateMetadataWithRegionalInformation",CP="regionDiscoveryDetectRegion",SP="regionDiscoveryGetRegionFromIMDS",EP="regionDiscoveryGetCurrentVersion",TP="acquireTokenByCodeAsync",_P="handleRedirectPromise",IP="handleNativeRedirectPromise",AP="nativeMessageHandlerHandshake",kP="removeHiddenIframe",RP="clearTokensAndKeysWithClaims",DP="cacheManagerGetRefreshToken",PP="importExistingCache",xP="setUserData",OP="localStorageUpdated",NP="generatePkceCodes",MP="generateCodeVerifier",LP="generateCodeChallengeFromVerifier",UP="sha256Digest",FP="getRandomValues",HP="generateHKDF",jP="generateBaseKey",BP="base64Decode",zP="urlEncodeArr",qP="encrypt",VP="decrypt",WP="generateEarKey",$P="decryptEarResponse",GP=(new Map([[fD,"ATByCode"],[pD,"ATByRT"],[gD,"ATS"],[mD,"ATSAsync"],[vD,"ATPopup"],[wD,"ATRedirect"],[bD,"CryptoGetPKThumb"],[CD,"CryptoSignJwt"],[SD,"SltCacheClientAT"],[ED,"SltIframeClientAT"],[_D,"SltRClientAT"],[ID,"SsoSlt"],[AD,"StdIntClientGetDiscAuth"],["fetchAccountIdWithNativeBroker","FetchAccIdWithNtvBroker"],[kD,"NtvIntClientAT"],["baseClientCreateTokenRequestHeaders","BaseClientCreateTReqHead"],[RD,"NetClientSendPost"],[DD,"RTClientExecPost"],[PD,"AuthCodeClientExecPost"],["brokerHandshake","BrokerHandshake"],["acquireTokenByRefreshTokenInBroker","ATByRTInBroker"],["acquireTokenByBroker","ATByBroker"],[xD,"RTClientExecTReq"],[OD,"RTClientAT"],[ND,"RTClientATWithCachedRT"],[MD,"RTClientATByRT"],[LD,"RTClientCreateTReqBody"],[UD,"ATFromCache"],[FD,"SltFlowClientATCached"],[HD,"SltFlowClientGenResFromCache"],[jD,"ATBySltIframe"],[BD,"InitBaseReq"],[zD,"InitSltReq"],[qD,"InitClientApplication"],[VD,"InitCache"],[PP,"importCache"],[xP,"setUserData"],[OP,"localStorageUpdated"],[WD,"SIClientTHelper"],[$D,"SHandlerInitAuthReq"],[GD,"SltHandlerMonitorIframeForHash"],[KD,"SHandlerLoadFrame"],[QD,"SHandlerLoadFrameSync"],[YD,"StdIntClientCreateAuthCodeClient"],[JD,"StdIntClientGetClientConf"],[XD,"StdIntClientInitAuthReq"],[ZD,"GetAuthCodeUrl"],[tP,"HandleCodeResFromServer"],[nP,"HandleCodeResp"],[rP,"HandleRespEar"],[oP,"HandleRespCode"],[iP,"HandleRespPlatBroker"],[sP,"UpdTEndpointAuth"],[aP,"AuthClientAT"],[lP,"AuthClientExecTReq"],[cP,"AuthClientCreateTReqBody"],[uP,"PopTGenCnf"],[dP,"PopTGenKid"],[hP,"HandleServerTRes"],[fP,"DeserializeRes"],[pP,"AuthFactCreateDiscInst"],[gP,"AuthResolveEndpointsAsync"],["authorityResolveEndpointsFromLocalSources","AuthResolveEndpointsFromLocal"],[mP,"AuthGetCDMetaFromNet"],[vP,"AuthUpdCDMeta"],[yP,"AuthUpdCDMetaFromNet"],[wP,"AuthUpdEndpointMeta"],[bP,"AuthUpdMetaWithRegInfo"],[CP,"RegDiscDetectReg"],[SP,"RegDiscGetRegFromIMDS"],[EP,"RegDiscGetCurrentVer"],[TP,"ATByCodeAsync"],["getEndpointMetadataFromNetwork","GetEndpointMetaFromNet"],["getCloudDiscoveryMetadataFromNetworkMeasurement","GetCDMetaFromNet"],[_P,"HandleRedirectPromise"],[IP,"HandleNtvRedirectPromise"],["updateCloudDiscoveryMetadataMeasurement","UpdateCDMeta"],["usernamePasswordClientAcquireToken","UserPassClientAT"],[AP,"NtvMsgHandlerHandshake"],["nativeGenerateAuthResult","NtvGenAuthRes"],[kP,"RemoveHiddenIframe"],[RP,"ClearTAndKeysWithClaims"],[DP,"CacheManagerGetRT"],[NP,"GenPkceCodes"],[MP,"GenCodeVerifier"],[LP,"GenCodeChallengeFromVerifier"],[UP,"Sha256Digest"],[FP,"GetRandomValues"],[HP,"genHKDF"],[jP,"genBaseKey"],[BP,"b64Decode"],[zP,"urlEncArr"],[qP,"encrypt"],[VP,"decrypt"],[WP,"genEarKey"],[$P,"decryptEarResp"]]),1);new Set(["accessTokenSize","durationMs","idTokenSize","matsSilentStatus","matsHttpStatus","refreshTokenSize","queuedTimeMs","startTimeMs","status","multiMatchedAT","multiMatchedID","multiMatchedRT","unencryptedCacheCount","encryptedCacheExpiredCount"]);class KP{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class QP{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:GP,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new KP}}startPerformanceMeasurement(){return new KP}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}const YP={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},JP={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:BA.Info,correlationId:kI.EMPTY_STRING},XP={claimsBasedCachingEnabled:!1},ZP={async sendGetRequestAsync(){throw Vk(jk)},async sendPostRequestAsync(){throw Vk(jk)}},ex={sku:kI.SKU,version:Gk,cpu:kI.EMPTY_STRING,os:kI.EMPTY_STRING},tx={clientSecret:kI.EMPTY_STRING,clientAssertion:void 0},nx={azureCloudInstance:$A,tenant:`${kI.DEFAULT_COMMON_TENANT}`},rx={application:{appName:"",appVersion:""}};function ix(e){return e.authOptions.authority.options.protocolMode===VA}const ox={sendGetRequestAsync:()=>Promise.reject(Vk(jk)),sendPostRequestAsync:()=>Promise.reject(Vk(jk))},sx="invalid_grant",ax=483,lx=600,cx="msal",ux=30,dx="msal.js.browser",hx="53ee284d-920a-4b59-9d30-a60315b26836",fx="ppnbnpeolgkicgegkbkbjmhlideopiji",px="MATS",gx="MicrosoftEntra",mx="DOM API",vx="get-token-and-sign-out",yx="PlatformAuthDOMHandler",wx="PlatformAuthExtensionHandler",bx="Handshake",Cx="HandshakeResponse",Sx="GetToken",Ex="Response",Tx="localStorage",_x="sessionStorage",Ix="memoryStorage",Ax="GET",kx="POST",Rx="signin",Dx="signout",Px="request.origin",xx="urlHash",Ox="request.params",Nx="code.verifier",Mx="interaction.status",Lx="request.native",Ux="msal.account.keys",Fx="msal.token.keys",Hx="msal.version",jx="wrapper.sku",Bx="wrapper.version",zx=861,qx=862,Vx=863,Wx=865,$x=866,Gx=61,Kx=961,Qx=962;var Yx;!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(Yx||(Yx={}));const Jx="startup",Xx="login",Zx="logout",eO="acquireToken",tO="ssoSilent",nO="handleRedirect",rO="none",iO={scopes:MI},oO="@azure/msal-react",sO="msal.db",aO=`${sO}.keys`,lO=0,cO=1,uO=2,dO=3,hO=4,fO=5,pO=[lO,fO,hO],gO="msal.browser.platform.auth.dom",mO="pkce_not_created",vO="ear_jwk_empty",yO="ear_jwe_empty",wO="crypto_nonexistent",bO="empty_navigate_uri",CO="hash_empty_error",SO="no_state_in_hash",EO="hash_does_not_contain_known_properties",TO="unable_to_parse_state",_O="state_interaction_type_mismatch",IO="interaction_in_progress",AO="popup_window_error",kO="empty_window_error",RO="user_cancelled",DO="monitor_popup_timeout",PO="monitor_window_timeout",xO="redirect_in_iframe",OO="block_iframe_reload",NO="block_nested_popups",MO="iframe_closed_prematurely",LO="silent_logout_unsupported",UO="no_account_error",FO="silent_prompt_value_error",HO="no_token_request_cache_error",jO="unable_to_parse_token_request_cache_error",BO="auth_request_not_set_error",zO="invalid_cache_type",qO="non_browser_environment",VO="database_not_open",WO="no_network_connectivity",$O="post_request_failed",GO="get_request_failed",KO="failed_to_parse_response",QO="unable_to_load_token",YO="crypto_key_not_found",JO="auth_code_required",XO="auth_code_or_nativeAccountId_required",ZO="spa_code_and_nativeAccountId_present",eN="database_unavailable",tN="unable_to_acquire_token_from_native_platform",nN="native_handshake_timeout",rN="native_extension_not_installed",iN="native_connection_not_established",oN="uninitialized_public_client_application",sN="native_prompt_not_supported",aN="invalid_base64_string",lN="invalid_pop_token_request",cN="failed_to_build_headers",uN="failed_to_parse_headers",dN="failed_to_decrypt_ear_response",hN="timed_out",fN="For more visit: aka.ms/msaljs/browser-errors",pN={[mO]:"The PKCE code challenge and verifier could not be generated.",[vO]:"No EAR encryption key provided. This is unexpected.",[yO]:"Server response does not contain ear_jwe property. This is unexpected.",[wO]:"The crypto object or function is not available.",[bO]:"Navigation URI is empty. Please check stack trace for more info.",[CO]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${fN}`,[SO]:"Hash does not contain state. Please verify that the request originated from msal.",[EO]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${fN}`,[TO]:"Unable to parse state. Please verify that the request originated from msal.",[_O]:"Hash contains state but the interaction type does not match the caller.",[IO]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${fN}`,[AO]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[kO]:"window.open returned null or undefined window object.",[RO]:"User cancelled the flow.",[DO]:`Token acquisition in popup failed due to timeout.  ${fN}`,[PO]:`Token acquisition in iframe failed due to timeout.  ${fN}`,[xO]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[OO]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${fN}`,[NO]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[MO]:"The iframe being monitored was closed prematurely.",[LO]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[UO]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[FO]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[HO]:"No token request found in cache.",[jO]:"The cached token request could not be parsed.",[BO]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[zO]:"Invalid cache type",[qO]:"Login and token requests are not supported in non-browser environments.",[VO]:"Database is not open!",[WO]:"No network connectivity. Check your internet connection.",[$O]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[GO]:"Network request failed. Please check the network trace to determine root cause.",[KO]:"Failed to parse network response. Check network trace.",[QO]:"Error loading token to cache.",[YO]:"Cryptographic Key or Keypair not found in browser storage.",[JO]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[XO]:"An authorization code or nativeAccountId must be provided to this flow.",[ZO]:"Request cannot contain both spa code and native account id.",[eN]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[tN]:`Unable to acquire token from native platform.  ${fN}`,[nN]:"Timed out while attempting to establish connection to browser extension",[rN]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[iN]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${fN}`,[oN]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${fN}`,[sN]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[aN]:"Invalid base64 encoded string.",[lN]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[cN]:"Failed to build request headers object.",[uN]:"Failed to parse response headers",[dN]:"Failed to decrypt ear response",[hN]:"The request timed out."};class gN extends YA{constructor(e,t){super(e,pN[e],t),Object.setPrototypeOf(this,gN.prototype),this.name="BrowserAuthError"}}function mN(e,t){return new gN(e,t)}class vN{navigateInternal(e,t){return vN.defaultNavigateWindow(e,t)}navigateExternal(e,t){return vN.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((e,n)=>{setTimeout(()=>{n(mN(hN,"failed_to_redirect"))},t.timeout)})}}class yN extends YA{constructor(e,t,n){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,yN.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=n}}function wN(e,t,n,r){return e.errorMessage=`${e.errorMessage}, additionalErrorInfo: error.name:${r?.name}, error.message:${r?.message}`,new yN(e,t,n)}class bN{async sendGetRequestAsync(e,t){let n,r={},i=0;const o=CN(t);try{n=await fetch(e,{method:Ax,headers:o})}catch(d){throw wN(mN(window.navigator.onLine?GO:WO),void 0,void 0,d)}r=SN(n.headers);try{return i=n.status,{headers:r,body:await n.json(),status:i}}catch(d){throw wN(mN(KO),i,r,d)}}async sendPostRequestAsync(e,t){const n=t&&t.body||"",r=CN(t);let i,o=0,s={};try{i=await fetch(e,{method:kx,headers:r,body:n})}catch(d){throw wN(mN(window.navigator.onLine?$O:WO),void 0,void 0,d)}s=SN(i.headers);try{return o=i.status,{headers:s,body:await i.json(),status:o}}catch(d){throw wN(mN(KO),o,s,d)}}}function CN(e){try{const t=new Headers;if(!e||!e.headers)return t;const n=e.headers;return Object.entries(n).forEach(e=>{let[n,r]=e;t.append(n,r)}),t}catch(d){throw wN(mN(cN),void 0,void 0,d)}}function SN(e){try{const t={};return e.forEach((e,n)=>{t[n]=e}),t}catch(d){throw mN(uN)}}function EN(e){return encodeURIComponent(_N(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function TN(e){return IN(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function _N(e){return IN((new TextEncoder).encode(e))}function IN(e){const t=Array.from(e,e=>String.fromCodePoint(e)).join("");return btoa(t)}function AN(e){return(new TextDecoder).decode(kN(e))}function kN(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw mN(aN)}const n=atob(t);return Uint8Array.from(n,e=>e.codePointAt(0)||0)}const RN="AES-GCM",DN="HKDF",PN="SHA-256",xN=new Uint8Array([1,0,1]),ON="0123456789abcdef",NN=new Uint32Array(1),MN="raw",LN="encrypt",UN="decrypt",FN={name:"RSASSA-PKCS1-v1_5",hash:PN,modulusLength:2048,publicExponent:xN};async function HN(e,t,n){t?.addQueueMeasurement(UP,n);const r=(new TextEncoder).encode(e);return window.crypto.subtle.digest(PN,r)}function jN(e){return window.crypto.getRandomValues(e)}function BN(){return window.crypto.getRandomValues(NN),NN[0]}function zN(){const e=Date.now(),t=1024*BN()+(1023&BN()),n=new Uint8Array(16),r=Math.trunc(t/2**30),i=t&2**30-1,o=BN();n[0]=e/2**40,n[1]=e/2**32,n[2]=e/2**24,n[3]=e/65536,n[4]=e/256,n[5]=e,n[6]=112|r>>>8,n[7]=r,n[8]=128|i>>>24,n[9]=i>>>16,n[10]=i>>>8,n[11]=i,n[12]=o>>>24,n[13]=o>>>16,n[14]=o>>>8,n[15]=o;let s="";for(let a=0;a<n.length;a++)s+=ON.charAt(n[a]>>>4),s+=ON.charAt(15&n[a]),3!==a&&5!==a&&7!==a&&9!==a||(s+="-");return s}async function qN(e){return window.crypto.subtle.exportKey("jwk",e)}async function VN(){const e=await $N(),t={alg:"dir",kty:"oct",k:TN(new Uint8Array(e))};return _N(JSON.stringify(t))}async function WN(e,t){const n=t.split(".");if(5!==n.length)throw mN(dN,"jwe_length");const r=await async function(e){const t=AN(e),n=kN(JSON.parse(t).k);return window.crypto.subtle.importKey(MN,n,RN,!1,[UN])}(e).catch(()=>{throw mN(dN,"import_key")});try{const e=(new TextEncoder).encode(n[0]),t=kN(n[2]),i=kN(n[3]),o=kN(n[4]),s=8*o.byteLength,a=new Uint8Array(i.length+o.length);a.set(i),a.set(o,i.length);const l=await window.crypto.subtle.decrypt({name:RN,iv:t,tagLength:s,additionalData:e},r,a);return(new TextDecoder).decode(l)}catch(d){throw mN(dN,"decrypt")}}async function $N(){const e=await window.crypto.subtle.generateKey({name:RN,length:256},!0,[LN,UN]);return window.crypto.subtle.exportKey(MN,e)}async function GN(e){return window.crypto.subtle.importKey(MN,e,DN,!1,["deriveKey"])}async function KN(e,t,n){return window.crypto.subtle.deriveKey({name:DN,salt:t,hash:PN,info:(new TextEncoder).encode(n)},e,{name:RN,length:256},!1,[LN,UN])}async function QN(e,t,n){const r=(new TextEncoder).encode(t),i=window.crypto.getRandomValues(new Uint8Array(16)),o=await KN(e,i,n),s=await window.crypto.subtle.encrypt({name:RN,iv:new Uint8Array(12)},o,r);return{data:TN(new Uint8Array(s)),nonce:TN(i)}}async function YN(e,t,n,r){const i=kN(r),o=await KN(e,kN(t),n),s=await window.crypto.subtle.decrypt({name:RN,iv:new Uint8Array(12)},o,i);return(new TextDecoder).decode(s)}async function JN(e){const t=await HN(e);return TN(new Uint8Array(t))}const XN="storage_not_supported",ZN="stubbed_public_client_application_called",eM="in_mem_redirect_unavailable",tM={[XN]:"Given storage configuration option was not supported.",[ZN]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[eM]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};class nM extends YA{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,nM.prototype)}}function rM(e){return new nM(e,tM[e])}function iM(e){e.location.hash="","function"===typeof e.history.replaceState&&e.history.replaceState(null,"",`${e.location.origin}${e.location.pathname}${e.location.search}`)}function oM(){return window.parent!==window}function sM(){return"undefined"!==typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function aM(){if("undefined"!==typeof window&&window.opener&&window.opener!==window&&"string"===typeof window.name&&0===window.name.indexOf(`${cx}.`))throw mN(NO)}function lM(){if("undefined"===typeof window)throw mN(qO)}function cM(e){if(!e)throw mN(oN)}function uM(e){lM(),function(){if(eD.hashContainsKnownProperties(window.location.hash)&&oM())throw mN(OO)}(),aM(),cM(e)}function dM(e,t){if(uM(e),function(e){if(oM()&&!e)throw mN(xO)}(t.system.allowRedirectInIframe),t.cache.cacheLocation===Ix&&!t.cache.storeAuthStateInCookie)throw rM(eM)}function hM(e){const t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch{}},1e4)}const fM=1e4;const pM="4.15.0";class gM{static loggerCallback(e,t){switch(e){case BA.Error:return void console.error(t);case BA.Info:return void console.info(t);case BA.Verbose:return void console.debug(t);case BA.Warning:return void console.warn(t);default:return void console.log(t)}}constructor(e){let t;this.browserEnvironment="undefined"!==typeof window,this.config=function(e,t){let{auth:n,cache:r,system:i,telemetry:o}=e;const s={clientId:kI.EMPTY_STRING,authority:`${kI.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:kI.EMPTY_STRING,authorityMetadata:kI.EMPTY_STRING,redirectUri:"undefined"!==typeof window?sM():"",postLogoutRedirectUri:kI.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:qA,OIDCOptions:{serverResponseType:rA,defaultScopes:[kI.OPENID_SCOPE,kI.PROFILE_SCOPE,kI.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:$A,tenant:kI.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},a={cacheLocation:_x,temporaryCacheLocation:_x,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!(!r||r.cacheLocation!==Tx),claimsBasedCachingEnabled:!1},l={loggerCallback:()=>{},logLevel:BA.Info,piiLoggingEnabled:!1},c={...{...YP,loggerOptions:l,networkClient:t?new bN:ox,navigationClient:new vN,loadFrameTimeout:0,windowHashTimeout:i?.loadFrameTimeout||6e4,iframeHashTimeout:i?.loadFrameTimeout||fM,navigateFrameWait:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:i?.nativeBrokerHandshakeTimeout||2e3,pollIntervalMilliseconds:ux},...i,loggerOptions:i?.loggerOptions||l},u={application:{appName:kI.EMPTY_STRING,appVersion:kI.EMPTY_STRING},client:new QP};n?.protocolMode!==VA&&n?.OIDCOptions&&new zA(c.loggerOptions).warning(JSON.stringify(UR(xR)));if(n?.protocolMode&&n.protocolMode===VA&&c?.allowPlatformBroker)throw UR(OR);return{auth:{...s,...n,OIDCOptions:{...s.OIDCOptions,...n?.OIDCOptions}},cache:{...a,...r},system:c,telemetry:{...u,...o}}}(e,this.browserEnvironment);try{t=window[_x]}catch(d){}const n=t?.getItem("msal.browser.log.level"),r=t?.getItem("msal.browser.log.pii")?.toLowerCase(),i="true"===r||"false"!==r&&void 0,o={...this.config.system.loggerOptions},s=n&&Object.keys(BA).includes(n)?BA[n]:void 0;s&&(o.loggerCallback=gM.loggerCallback,o.logLevel=s),void 0!==i&&(o.piiLoggingEnabled=i),this.logger=new zA(o,"@azure/msal-browser",pM),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class mM extends gM{getModuleName(){return mM.MODULE_NAME}getId(){return mM.ID}async initialize(){return this.available="undefined"!==typeof window,this.available}}mM.MODULE_NAME="",mM.ID="StandardOperatingContext";const vM="missing_kid_error",yM="missing_alg_error",wM={[vM]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[yM]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class bM extends YA{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,bM.prototype)}}function CM(e){return new bM(e,wM[e])}class SM{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw CM(vM);if(!e.alg)throw CM(yM);const t=new SM({typ:e.typ||jA,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}class EM{constructor(){this.dbName=sO,this.version=1,this.tableName=aO,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",t=>{const n=t;this.db=n.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(mN(eN)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(mN(VO));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((n,r)=>{if(!this.db)return r(mN(VO));const i=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);i.addEventListener("success",()=>{this.closeConnection(),n()}),i.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(mN(VO));const r=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);r.addEventListener("success",()=>{this.closeConnection(),t()}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(mN(VO));const n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();n.addEventListener("success",t=>{const n=t;this.closeConnection(),e(n.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(mN(VO));const r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);r.addEventListener("success",e=>{const n=e;this.closeConnection(),t(1===n.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const n=window.indexedDB.deleteDatabase(sO),r=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(r),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(r),e(!0))),n.addEventListener("error",()=>(clearTimeout(r),t(!1)))})}}class TM{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class _M{constructor(e){this.inMemoryCache=new TM,this.indexedDBCache=new EM,this.logger=e}handleDatabaseAccessError(e){if(!(e instanceof gN&&e.errorCode===eN))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(d){this.handleDatabaseAccessError(d)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(d){this.handleDatabaseAccessError(d)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(d){this.handleDatabaseAccessError(d)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(d){this.handleDatabaseAccessError(d)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(d){this.handleDatabaseAccessError(d)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(d){return this.handleDatabaseAccessError(d),!1}}}class IM{constructor(e,t,n){this.logger=e,function(e){if(!window)throw mN(qO);if(!window.crypto)throw mN(wO);if(!e&&!window.crypto.subtle)throw mN(wO,"crypto_subtle_undefined")}(n??!1),this.cache=new _M(this.logger),this.performanceClient=t}createNewGuid(){return zN()}base64Encode(e){return _N(e)}base64Decode(e){return AN(e)}base64UrlEncode(e){return EN(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(bD,e.correlationId),n=await async function(e,t){return window.crypto.subtle.generateKey(FN,e,t)}(IM.EXTRACTABLE,IM.POP_KEY_USAGES),r=await qN(n.publicKey),i=AM({e:r.e,kty:r.kty,n:r.n}),o=await this.hashString(i),s=await qN(n.privateKey),a=await async function(e,t,n){return window.crypto.subtle.importKey("jwk",e,FN,t,n)}(s,!1,["sign"]);return await this.cache.setItem(o,{privateKey:a,publicKey:n.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),o}async removeTokenBindingKey(e){await this.cache.removeItem(e);if(await this.cache.containsKey(e))throw Vk(Nk)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(d){return d instanceof Error?this.logger.error(`Clearing keystore failed with error: ${d.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,n,r){const i=this.performanceClient?.startMeasurement(CD,r),o=await this.cache.getItem(t);if(!o)throw mN(YO);const s=await qN(o.publicKey),a=AM(s),l=EN(JSON.stringify({kid:t})),c=EN(SM.getShrHeaderString({...n?.header,alg:s.alg,kid:l}));e.cnf={jwk:JSON.parse(a)};const u=`${c}.${EN(JSON.stringify(e))}`,d=(new TextEncoder).encode(u),h=await async function(e,t){return window.crypto.subtle.sign(FN,e,t)}(o.privateKey,d),f=`${u}.${TN(new Uint8Array(h))}`;return i&&i.end({success:!0}),f}async hashString(e){return JN(e)}}function AM(e){return JSON.stringify(e,Object.keys(e).sort())}IM.POP_KEY_USAGES=["sign","verify"],IM.EXTRACTABLE=!0;const kM=(e,t,n,r,i)=>function(){n.trace(`Executing function ${t}`);const o=r?.startMeasurement(t,i);if(i){const e=t+"CallCount";r?.incrementFields({[e]:1},i)}try{const r=e(...arguments);return o?.end({success:!0}),n.trace(`Returning result from ${t}`),r}catch(d){n.trace(`Error occurred in ${t}`);try{n.trace(JSON.stringify(d))}catch(d){n.trace("Unable to print error message.")}throw o?.end({success:!1},d),d}},RM=(e,t,n,r,i)=>function(){n.trace(`Executing function ${t}`);const o=r?.startMeasurement(t,i);if(i){const e=t+"CallCount";r?.incrementFields({[e]:1},i)}return r?.setPreQueueTime(t,i),e(...arguments).then(e=>(n.trace(`Returning result from ${t}`),o?.end({success:!0}),e)).catch(e=>{n.trace(`Error occurred in ${t}`);try{n.trace(JSON.stringify(e))}catch(e){n.trace("Unable to print error message.")}throw o?.end({success:!1},e),e})};class DM{constructor(e,t,n,r){this.networkInterface=e,this.logger=t,this.performanceClient=n,this.correlationId=r}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(CP,this.correlationId);let n=e;if(n)t.region_source=DA;else{const e=DM.IMDS_OPTIONS;try{const r=await RM(this.getRegionFromIMDS.bind(this),SP,this.logger,this.performanceClient,this.correlationId)(kI.IMDS_VERSION,e);if(r.status===RI&&(n=r.body,t.region_source=PA),r.status===PI){const r=await RM(this.getCurrentVersion.bind(this),EP,this.logger,this.performanceClient,this.correlationId)(e);if(!r)return t.region_source=RA,null;const i=await RM(this.getRegionFromIMDS.bind(this),SP,this.logger,this.performanceClient,this.correlationId)(r,e);i.status===RI&&(n=i.body,t.region_source=PA)}}catch(d){return t.region_source=RA,null}}return n||(t.region_source=RA),n||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(SP,this.correlationId),this.networkInterface.sendGetRequestAsync(`${kI.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,kI.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(EP,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${kI.IMDS_ENDPOINT}?format=json`,e);return t.status===PI&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch(d){return null}}}DM.IMDS_OPTIONS={headers:{Metadata:"true"}};class PM{constructor(e,t,n,r,i,o,s,a){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=r,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=s,this.correlationId=o,this.managedIdentity=a||!1,this.regionDiscovery=new DM(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(kI.CIAM_AUTH_URL))return KR;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case kI.ADFS:return $R;case kI.DSTS:return GR}return WR}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new eD(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw Vk(nk)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw Vk(nk)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw Vk(nk)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw Vk(Mk);return this.replacePath(this.metadata.end_session_endpoint)}throw Vk(nk)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw Vk(nk)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw Vk(nk)}canReplaceTenant(e){return 1===e.PathSegments.length&&!PM.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===WR&&this.protocolMode!==VA}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const n=new eD(this.metadata.canonical_authority).getUrlComponents(),r=n.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,i)=>{let o=r[i];if(0===i&&this.canReplaceTenant(n)){const e=new eD(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];o!==e&&(this.logger.verbose(`Replacing tenant domain name ${o} with id ${e}`),o=e)}e!==o&&(t=t.replace(`/${o}/`,`/${e}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===$R||this.protocolMode===VA&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(gP,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await RM(this.updateCloudDiscoveryMetadata.bind(this),vP,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const n=await RM(this.updateEndpointMetadata.bind(this),wP,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:uR(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==yA&&n?.source!==yA&&(e.expiresAt=uR(),e.canonical_authority=this.canonicalAuthority);const r=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(r,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(wP,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===bA&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){dR(e,await RM(this.updateMetadataWithRegionalInformation.bind(this),bP,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=await RM(this.getEndpointMetadataFromNetwork.bind(this),yP,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=await RM(this.updateMetadataWithRegionalInformation.bind(this),bP,this.logger,this.performanceClient,this.correlationId)(n)),dR(e,n,!0),wA;throw Vk(ik,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),dR(e,t,!1),{source:vA};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const t=this.getEndpointMetadataFromHardcodedValues();if(t)return dR(e,t,!1),{source:bA,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const n=fR(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:yA}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new eD(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(d){throw UR(IR)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(yP,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const n=await this.networkInterface.sendGetRequestAsync(t,e),r=function(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}(n.body);return r?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(d){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${d}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in tD?tD[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(bP,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==kI.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=xA,this.regionDiscoveryMetadata.region_used=t,PM.replaceWithRegionalInformation(e,t);const n=await RM(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),CP,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=OA,this.regionDiscoveryMetadata.region_used=n,PM.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=NA}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(vP,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const n=await RM(this.getCloudDiscoveryMetadataFromNetwork.bind(this),mP,this.logger,this.performanceClient,this.correlationId)();if(n)return hR(e,n,!0),wA;throw UR(AR)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||kI.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||kI.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||kI.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),hR(e,t,!1),vA;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const t=(n=this.hostnameAndPort,oD(nD.metadata,n));if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),hR(e,t,!1),bA;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}var n;const r=fR(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),yA):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===KR)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),PM.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=oD(JSON.parse(this.authorityOptions.cloudDiscoveryMetadata).metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),e)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),e;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(d){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),UR(_R)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),PM.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(mP,this.correlationId);const e=`${kI.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let n=null;try{const r=await this.networkInterface.sendGetRequestAsync(e,t);let i,o;if(function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(r.body))i=r.body,o=i.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${i.tenant_discovery_endpoint}`);else{if(!function(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}(r.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${r.status}`),i=r.body,i.error===kI.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${i.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${i.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),o=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=oD(o,this.hostnameAndPort)}catch(r){if(r instanceof YA)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.\nError: ${r.errorCode}\nError Description: ${r.errorMessage}`);else{const e=r;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.\nError: ${e.name}\nError Description: ${e.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=PM.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&eD.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==$A){const e=t.tenant?t.tenant:kI.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${e}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return kI.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw Vk(nk)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return rD.has(e)}static isPublicCloudAuthority(e){return kI.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){const r=new eD(e);r.validateAsUri();const i=r.getUrlComponents();let o=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(o=`${t}.${kI.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const s=eD.constructAuthorityUriFromObject({...r.getUrlComponents(),HostNameAndPort:o}).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(e,t){const n={...e};return n.authorization_endpoint=PM.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=PM.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=PM.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e;const n=new eD(e).getUrlComponents();if(0===n.PathSegments.length&&n.HostNameAndPort.endsWith(kI.CIAM_AUTH_URL)){t=`${t}${n.HostNameAndPort.split(".")[0]}${kI.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}function xM(e){return e.endsWith(kI.FORWARD_SLASH)?e:`${e}${kI.FORWARD_SLASH}`}PM.reservedTenantDomains=new Set(["{tenant}","{tenantid}",VI,$I,WI]);const OM="no_tokens_found",NM="native_account_unavailable",MM="refresh_token_expired",LM="ux_not_allowed",UM="bad_token",FM=["interaction_required","consent_required","login_required",UM,LM],HM=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],jM={[OM]:"No refresh token found in the cache. Please sign-in.",[NM]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[MM]:"Refresh token has expired.",[UM]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[LM]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class BM extends YA{constructor(e,t,n,r,i,o,s,a){super(e,t,n),Object.setPrototypeOf(this,BM.prototype),this.timestamp=r||kI.EMPTY_STRING,this.traceId=i||kI.EMPTY_STRING,this.correlationId=o||kI.EMPTY_STRING,this.claims=s||kI.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=a}}function zM(e,t,n){const r=!!e&&FM.indexOf(e)>-1,i=!!n&&HM.indexOf(n)>-1,o=!!t&&FM.some(e=>t.indexOf(e)>-1);return r||o||i}function qM(e){return new BM(e,jM[e])}function VM(e,t,n){return{clientId:e,authority:t.authority,scopes:t.scopes,homeAccountIdentifier:n,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid,embeddedClientId:t.embeddedClientId||t.tokenBodyParameters?.clientId}}const WM=864e5,$M="Lax",GM="None";class KM{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,n=document.cookie.split(";");for(let r=0;r<n.length;r++){const e=n[r],[i,...o]=decodeURIComponent(e).trim().split("="),s=o.join("=");if(i===t)return s}return""}getUserData(){throw Vk(jk)}setItem(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:$M,o=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${i};`;if(n){const e=function(e){const t=new Date,n=new Date(t.getTime()+e*WM);return n.toUTCString()}(n);o+=`expires=${e};`}(r||i===GM)&&(o+="Secure;"),document.cookie=o}async setUserData(){return Promise.reject(Vk(jk))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(e=>{const n=decodeURIComponent(e).trim().split("=");t.push(n[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function QM(e){const t=e.getItem(Ux);return t?JSON.parse(t):[]}function YM(e,t){const n=t.getItem(`${Fx}.${e}`);if(n){const e=JSON.parse(n);if(e&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("accessToken")&&e.hasOwnProperty("refreshToken"))return e}return{idToken:[],accessToken:[],refreshToken:[]}}const JM="msal.cache.encryption";class XM{constructor(e,t,n){if(!window.localStorage)throw rM(XN);this.memoryStorage=new TM,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=n,this.broadcast=new BroadcastChannel("msal.broadcast.cache")}async initialize(e){const t=new KM,n=t.getItem(JM);let r={key:"",id:""};if(n)try{r=JSON.parse(n)}catch(d){}if(r.key&&r.id){const t=kM(kN,BP,this.logger,this.performanceClient,e)(r.key);this.encryptionCookie={id:r.id,key:await RM(GN,HP,this.logger,this.performanceClient,e)(t)},await RM(this.importExistingCache.bind(this),PP,this.logger,this.performanceClient,e)(e)}else{this.clear();const n=zN(),r=await RM($N,jP,this.logger,this.performanceClient,e)(),i=kM(TN,zP,this.logger,this.performanceClient,e)(new Uint8Array(r));this.encryptionCookie={id:n,key:await RM(GN,HP,this.logger,this.performanceClient,e)(r)};const o={id:n,key:i};t.setItem(JM,JSON.stringify(o),0,!0,GM)}this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw mN(oN);return this.memoryStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,n,r){if(!this.initialized||!this.encryptionCookie)throw mN(oN);const{data:i,nonce:o}=await RM(QN,qP,this.logger,this.performanceClient,n)(this.encryptionCookie.key,t,this.getContext(e)),s={id:this.encryptionCookie.id,nonce:o,data:i,lastUpdatedAt:r};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(s)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear();QM(this).forEach(e=>this.removeItem(e));const e=YM(this.clientId,this);e.idToken.forEach(e=>this.removeItem(e)),e.accessToken.forEach(e=>this.removeItem(e)),e.refreshToken.forEach(e=>this.removeItem(e)),this.getKeys().forEach(e=>{(e.startsWith(kI.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeItem(e)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=QM(this);t=await this.importArray(t,e),this.setItem(Ux,JSON.stringify(t));const n=YM(this.clientId,this);n.idToken=await this.importArray(n.idToken,e),n.accessToken=await this.importArray(n.accessToken,e),n.refreshToken=await this.importArray(n.refreshToken,e),this.setItem(`${Fx}.${this.clientId}`,JSON.stringify(n))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const n=this.getItem(e);if(!n)return null;let r;try{r=JSON.parse(n)}catch(d){return null}return r.id&&r.nonce&&r.data?r.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):RM(YN,VP,this.logger,this.performanceClient,t)(this.encryptionCookie.key,r.nonce,this.getContext(e),r.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),null)}async importArray(e,t){const n=[],r=[];return e.forEach(e=>{const i=this.getItemFromEncryptedCache(e,t).then(t=>{t?(this.memoryStorage.setItem(e,t),n.push(e)):this.removeItem(e)});r.push(i)}),await Promise.all(r),n}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(OP);t.add({isBackground:!0});const{key:n,value:r,context:i}=e.data;return n?i&&i!==this.clientId?(this.logger.trace(`Ignoring broadcast event from clientId: ${i}`),void t.end({success:!1,errorCode:"contextMismatch"})):(r?(this.memoryStorage.setItem(n,r),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(n),this.logger.verbose("Removed item from internal cache")),void t.end({success:!0})):(this.logger.error("Broadcast event missing key"),void t.end({success:!1,errorCode:"noKey"}))}}class ZM{constructor(){if(!window.sessionStorage)throw rM(XN)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}const eL="msal:initializeStart",tL="msal:initializeEnd",nL="msal:accountAdded",rL="msal:accountRemoved",iL="msal:activeAccountChanged",oL="msal:loginStart",sL="msal:loginSuccess",aL="msal:loginFailure",lL="msal:acquireTokenStart",cL="msal:acquireTokenSuccess",uL="msal:acquireTokenFailure",dL="msal:acquireTokenFromNetworkStart",hL="msal:ssoSilentStart",fL="msal:ssoSilentSuccess",pL="msal:ssoSilentFailure",gL="msal:acquireTokenByCodeStart",mL="msal:acquireTokenByCodeSuccess",vL="msal:acquireTokenByCodeFailure",yL="msal:handleRedirectStart",wL="msal:handleRedirectEnd",bL="msal:popupOpened",CL="msal:logoutStart",SL="msal:logoutSuccess",EL="msal:logoutFailure",TL="msal:logoutEnd",_L="msal:restoreFromBFCache";class IL extends dD{constructor(e,t,n,r,i,o,s){super(e,n,r,i,s),this.cacheConfig=t,this.logger=r,this.internalStorage=new TM,this.browserStorage=AL(e,t.cacheLocation,r,i),this.temporaryCacheStorage=AL(e,t.temporaryCacheLocation,r,i),this.cookieStorage=new KM,this.eventHandler=o}async initialize(e){await this.browserStorage.initialize(e),this.trackVersionChanges(e)}trackVersionChanges(e){const t=this.browserStorage.getItem(Hx);t&&(this.logger.info(`MSAL.js was last initialized by version: ${t}`),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==pM&&this.setItem(Hx,pM,e)}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&"object"===typeof t?t:null}catch(t){return null}}setItem(e,t,n){let r=[];for(let i=0;i<=20;i++)try{this.browserStorage.setItem(e,t),i>0&&this.removeAccessTokenKeys(r.slice(0,i),n);break}catch(d){const s=uD(d);if(!(s.errorCode===sD&&i<20))throw s;if(r.length||(r=e===`${Fx}.${this.clientId}`?JSON.parse(t).accessToken:this.getTokenKeys().accessToken),r.length<=i)throw s;this.removeAccessToken(r[i],n,!1)}}async setUserData(e,t,n,r){let i=[];for(let o=0;o<=20;o++)try{await RM(this.browserStorage.setUserData.bind(this.browserStorage),xP,this.logger,this.performanceClient)(e,t,n,r),o>0&&this.removeAccessTokenKeys(i.slice(0,o),n);break}catch(d){const t=uD(d);if(!(t.errorCode===sD&&o<20))throw t;if(i.length||(i=this.getTokenKeys().accessToken),i.length<=o)throw t;this.removeAccessToken(i[o],n,!1)}}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const n=this.browserStorage.getUserData(e);if(!n)return this.removeAccountKeyFromMap(e,t),null;const r=this.validateAndParseJson(n);return r&&YR.isAccountEntity(r)?dD.toObject(new YR,r):null}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const n=e.generateAccountKey(),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const i=this.addAccountKeyToMap(n,t);this.cacheConfig.cacheLocation===Tx&&i&&this.eventHandler.emitEvent(nL,void 0,e.getAccountInfo())}getAccountKeys(){return QM(this.browserStorage)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const n=this.getAccountKeys();return-1===n.indexOf(e)?(n.push(e),this.setItem(Ux,JSON.stringify(n),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const n=this.getAccountKeys(),r=n.indexOf(e);if(r>-1){if(n.splice(r,1),0===n.length)return void this.removeItem(Ux);this.setItem(Ux,JSON.stringify(n),t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){super.removeAccount(e,t),this.removeAccountKeyFromMap(e,t)}removeAccountContext(e,t){super.removeAccountContext(e,t),this.cacheConfig.cacheLocation===Tx&&this.eventHandler.emitEvent(rL,void 0,e.getAccountInfo())}removeIdToken(e,t){super.removeIdToken(e,t);const n=this.getTokenKeys(),r=n.idToken.indexOf(e);r>-1&&(this.logger.info("idToken removed from tokenKeys map"),n.idToken.splice(r,1),this.setTokenKeys(n,t))}removeAccessToken(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super.removeAccessToken(e,t),n&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t){this.logger.trace("removeAccessTokenKey called");const n=this.getTokenKeys();let r=0;if(e.forEach(e=>{const t=n.accessToken.indexOf(e);t>-1&&(n.accessToken.splice(t,1),r++)}),r>0)return this.logger.info(`removed ${r} accessToken keys from tokenKeys map`),void this.setTokenKeys(n,t)}removeRefreshToken(e,t){super.removeRefreshToken(e,t);const n=this.getTokenKeys(),r=n.refreshToken.indexOf(e);r>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),n.refreshToken.splice(r,1),this.setTokenKeys(n,t))}getTokenKeys(){return YM(this.clientId,this.browserStorage)}setTokenKeys(e,t){0!==e.idToken.length||0!==e.accessToken.length||0!==e.refreshToken.length?this.setItem(`${Fx}.${this.clientId}`,JSON.stringify(e),t):this.removeItem(`${Fx}.${this.clientId}`)}getIdTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const r=this.validateAndParseJson(n);return r&&(i=r)&&iR(i)&&i.hasOwnProperty("realm")&&i.credentialType===hA.ID_TOKEN?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null);var i}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const n=eR(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const i=this.getTokenKeys();-1===i.idToken.indexOf(n)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),i.idToken.push(n),this.setTokenKeys(i,t))}getAccessTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;const r=this.validateAndParseJson(n);return r&&(i=r)&&iR(i)&&i.hasOwnProperty("realm")&&i.hasOwnProperty("target")&&(i.credentialType===hA.ACCESS_TOKEN||i.credentialType===hA.ACCESS_TOKEN_WITH_AUTH_SCHEME)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null);var i}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const n=eR(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const i=this.getTokenKeys(),o=i.accessToken.indexOf(n);-1!==o&&i.accessToken.splice(o,1),this.logger.trace(`access token ${-1===o?"added to":"updated in"} map`),i.accessToken.push(n),this.setTokenKeys(i,t)}getRefreshTokenCredential(e,t){const n=this.browserStorage.getUserData(e);if(!n)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;const r=this.validateAndParseJson(n);return r&&(i=r)&&iR(i)&&i.credentialType===hA.REFRESH_TOKEN?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null);var i}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const n=eR(e),r=Date.now().toString();e.lastUpdatedAt=r,await this.setUserData(n,JSON.stringify(e),t,r);const i=this.getTokenKeys();-1===i.refreshToken.indexOf(n)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),i.refreshToken.push(n),this.setTokenKeys(i,t))}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&(r=e,(i=n)&&0===r.indexOf(fA)&&i.hasOwnProperty("clientId")&&i.hasOwnProperty("environment"))?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null);var r,i}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const n=function(e){let{environment:t,clientId:n}=e;return[fA,t,n].join(uA).toLowerCase()}(e);this.setItem(n,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){const n=0===e.indexOf(CA.CACHE_KEY);let r=!0;return t&&(r=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,n){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),n)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){return!!t&&0===e.indexOf(gA)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(jx,e),this.internalStorage.setItem(Bx,t)}getWrapperMetadata(){return[this.internalStorage.getItem(jx)||kI.EMPTY_STRING,this.internalStorage.getItem(Bx)||kI.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(qI),n=this.browserStorage.getItem(t);if(!n)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const r=this.validateAndParseJson(n);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const n=this.generateCacheKey(qI);if(e){this.logger.verbose("setActiveAccount: Active account set");const r={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Yk().toString()};this.setItem(n,JSON.stringify(r),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(n);this.eventHandler.emitEvent(iL)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const n=this.validateAndParseJson(t);return n&&function(e,t){let n=!1;e&&(n=0===e.indexOf(_A));let r=!0;return t&&(r=t.hasOwnProperty("throttleTime")),n&&r}(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,n){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),n)}getTemporaryCache(e,t){const n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const e=this.cookieStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}const r=this.temporaryCacheStorage.getItem(n);if(!r){if(this.cacheConfig.cacheLocation===Tx){const e=this.browserStorage.getItem(n);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),r}setTemporaryCache(e,t,n){const r=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(r,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(r,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{-1===e.indexOf(kI.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{-1===e.indexOf(kI.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.browserStorage.removeItem(e)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(RP,e);const t=this.getTokenKeys();let n=0;t.accessToken.forEach(t=>{const r=this.getAccessTokenCredential(t,e);r?.requestedClaimsHash&&t.includes(r.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(t,e),n++)}),n>0&&this.logger.warning(`${n} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):FR.startsWith(e,kI.CACHE_PREFIX)?e:`${kI.CACHE_PREFIX}.${this.clientId}.${e}`}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Ox)),this.removeTemporaryItem(this.generateCacheKey(Nx)),this.removeTemporaryItem(this.generateCacheKey(Px)),this.removeTemporaryItem(this.generateCacheKey(xx)),this.removeTemporaryItem(this.generateCacheKey(Lx)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const n=_N(JSON.stringify(e));if(this.setTemporaryCache(Ox,n,!0),t){const e=_N(t);this.setTemporaryCache(Nx,e,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(Ox,!0);if(!e)throw mN(HO);const t=this.getTemporaryCache(Nx,!0);let n,r="";try{n=JSON.parse(AN(e)),t&&(r=AN(t))}catch(d){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${d}`),mN(jO)}return[n,r]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Lx,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress()?.clientId;return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${kI.CACHE_PREFIX}.${Mx}`,t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch(d){return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),iM(window),null}}setInteractionInProgress(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Rx;const n=`${kI.CACHE_PREFIX}.${Mx}`;if(e){if(this.getInteractionInProgress())throw mN(IO);this.setTemporaryCache(n,JSON.stringify({clientId:this.clientId,type:t}),!1)}else e||this.getInteractionInProgress()?.clientId!==this.clientId||this.removeTemporaryItem(n)}async hydrateCache(e,t){const n=tR(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let r;t.claims&&(r=await this.cryptoImpl.hashString(t.claims));const i={idToken:n,accessToken:nR(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?Jk(e.expiresOn):0,e.extExpiresOn?Jk(e.extExpiresOn):0,AN,void 0,e.tokenType,void 0,t.sshKid,t.claims,r)};return this.saveCacheRecord(i,e.correlationId)}async saveCacheRecord(e,t,n){try{await super.saveCacheRecord(e,t,n)}catch(d){if(d instanceof cD&&this.performanceClient&&t)try{const e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(d){}throw d}}}function AL(e,t,n,r){try{switch(t){case Tx:return new XM(e,n,r);case _x:return new ZM}}catch(d){n.error(d)}return new TM}class kL{constructor(e){this.eventCallbacks=new Map,this.logger=e||new zA({}),"undefined"!==typeof BroadcastChannel&&(this.broadcastChannel=new BroadcastChannel("msal.broadcast.event")),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,n){if("undefined"!==typeof window){const r=n||zN();return this.eventCallbacks.has(r)?(this.logger.error(`Event callback with id: ${r} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(r,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${r}`),r)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,n,r){const i={eventType:e,interactionType:t||null,payload:n||null,error:r||null,timestamp:Date.now()};switch(e){case nL:case rL:case iL:this.broadcastChannel?.postMessage(i);break;default:this.invokeCallbacks(i)}}invokeCallbacks(e){this.eventCallbacks.forEach((t,n)=>{let[r,i]=t;(0===i.length||i.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e.eventType}`),r.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}const RL="home_account_id",DL="UPN",PL="client_id",xL="redirect_uri",OL="token_type",NL="req_cnf",ML="return_spa_code",LL="x-client-xtra-sku",UL="brk_client_id",FL="brk_redirect_uri",HL="instance_aware";function jL(e,t,n){if(!t)return;const r=e.get(PL);r&&e.has(UL)&&n?.addFields({embeddedClientId:r,embeddedRedirectUri:e.get(xL)},t)}function BL(e,t){e.set("response_type",t)}function zL(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:MI;!n||r.includes("openid")||t.includes("openid")||r.push("openid");const i=n?[...t||[],...r]:t||[],o=new HR(i);e.set("scope",o.printScopes())}function qL(e,t){e.set(PL,t)}function VL(e,t){e.set(xL,t)}function WL(e,t){e.set("login_hint",t)}function $L(e,t){e.set(jI,`UPN:${t}`)}function GL(e,t){e.set(jI,`Oid:${t.uid}@${t.utid}`)}function KL(e,t){e.set("sid",t)}function QL(e,t,n){const r=function(e,t){let n;if(e)try{n=JSON.parse(e)}catch(d){throw UR(bR)}else n={};t&&t.length>0&&(n.hasOwnProperty(GI)||(n[GI]={}),n[GI][KI]={values:t});return JSON.stringify(n)}(t,n);try{JSON.parse(r)}catch(d){throw UR(bR)}e.set("claims",r)}function YL(e,t){e.set("client-request-id",t)}function JL(e,t){e.set("x-client-SKU",t.sku),e.set("x-client-VER",t.version),t.os&&e.set("x-client-OS",t.os),t.cpu&&e.set("x-client-CPU",t.cpu)}function XL(e,t){t?.appName&&e.set("x-app-name",t.appName),t?.appVersion&&e.set("x-app-ver",t.appVersion)}function ZL(e,t){t&&e.set("state",t)}function eU(e,t){e.set("client_secret",t)}function tU(e,t){t&&e.set("client_assertion",t)}function nU(e,t){t&&e.set("client_assertion_type",t)}function rU(e,t){e.set("grant_type",t)}function iU(e){e.set("client_info","1")}function oU(e){e.has(HL)||e.set(HL,"true")}function sU(e,t){Object.entries(t).forEach(t=>{let[n,r]=t;!e.has(n)&&r&&e.set(n,r)})}function aU(e,t){t&&(e.set(OL,SA.POP),e.set(NL,t))}function lU(e,t){t&&(e.set(OL,SA.SSH),e.set(NL,t))}function cU(e,t){e.set("x-client-current-telemetry",t.generateCurrentRequestHeaderValue()),e.set("x-client-last-telemetry",t.generateLastRequestHeaderValue())}function uU(e){e.set("x-ms-lib-capability",IA)}function dU(e,t,n){e.has(UL)||e.set(UL,t),e.has(FL)||e.set(FL,n)}async function hU(e,t,n,r,i,o,s){s?.addQueueMeasurement(pP,o);const a=PM.transformCIAMAuthority(xM(e)),l=new PM(a,t,n,r,i,o,s);try{return await RM(l.resolveEndpointsAsync.bind(l),gP,i,s,o)(),l}catch(d){throw Vk(nk)}}class fU extends YA{constructor(e,t,n,r,i){super(e,t,n),this.name="ServerError",this.errorNo=r,this.status=i,Object.setPrototypeOf(this,fU.prototype)}}class pU{static generateThrottlingStorageKey(e){return`${_A}.${JSON.stringify(e)}`}static preProcess(e,t,n){const r=pU.generateThrottlingStorageKey(t),i=e.getThrottlingCache(r);if(i){if(i.throttleTime<Date.now())return void e.removeItem(r,n);throw new fU(i.errorCodes?.join(" ")||kI.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n,r){if(pU.checkResponseStatus(n)||pU.checkResponseForRetryAfter(n)){const i={throttleTime:pU.calculateThrottleTime(parseInt(n.headers[HI])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(pU.generateThrottlingStorageKey(t),i,r)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&(e.headers.hasOwnProperty(HI)&&(e.status<200||e.status>=300))}static calculateThrottleTime(e){const t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(1e3*Math.min(n+(t||EA),n+TA))}static removeThrottle(e,t,n,r){const i=VM(t,n,r),o=this.generateThrottlingStorageKey(i);e.removeItem(o,n.correlationId)}}class gU{constructor(e,t){this.config=function(e){let{authOptions:t,systemOptions:n,loggerOptions:r,cacheOptions:i,storageInterface:o,networkInterface:s,cryptoInterface:a,clientCredentials:l,libraryInfo:c,telemetry:u,serverTelemetryManager:d,persistencePlugin:h,serializableCache:f}=e;const p={...JP,...r};return{authOptions:(g=t,{clientCapabilities:[],azureCloudOptions:nx,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...g}),systemOptions:{...YP,...n},loggerOptions:p,cacheOptions:{...XP,...i},storageInterface:o||new hD(t.clientId,Wk,new zA(p),new QP),networkInterface:s||ZP,cryptoInterface:a||Wk,clientCredentials:l||tx,libraryInfo:{...ex,...c},telemetry:{...rx,...u},serverTelemetryManager:d||null,persistencePlugin:h||null,serializableCache:f||null};var g}(e),this.logger=new zA(this.config.loggerOptions,$k,Gk),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[UI]=kI.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case RL:try{const n=BR(e.credential);t[jI]=`Oid:${n.uid}@${n.utid}`}catch(d){this.logger.verbose("Could not parse home account ID for CCS Header: "+d)}break;case DL:t[jI]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,n,r,i,o){o&&this.performanceClient?.addQueueMeasurement(o,i);const s=await this.sendPostRequest(r,e,{body:t,headers:n},i);return this.config.serverTelemetryManager&&s.status<500&&429!==s.status&&this.config.serverTelemetryManager.clearTelemetryCache(),s}async sendPostRequest(e,t,n,r){let i;pU.preProcess(this.cacheManager,e,r);try{i=await RM(this.networkClient.sendPostRequestAsync.bind(this.networkClient),RD,this.logger,this.performanceClient,r)(t,n);const e=i.headers||{};this.performanceClient?.addFields({refreshTokenSize:i.body.refresh_token?.length||0,httpVerToken:e[zI]||"",requestId:e[BI]||""},r)}catch(d){if(d instanceof yN){const t=d.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[zI]||"",requestId:t[BI]||"",contentTypeHeader:t[UI]||void 0,contentLengthHeader:t[FI]||void 0,httpStatus:d.httpStatus},r),d.error}throw d instanceof YA?d:Vk(rk)}return pU.postProcess(this.cacheManager,e,i,r),i}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(sP,t);const n=`https://${e}/${this.authority.tenant}/`,r=await hU(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=r}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&dU(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&sU(t,e.tokenQueryParameters),YL(t,e.correlationId),jL(t,e.correlationId,this.performanceClient),ZR(t)}}class mU{static setRequestState(e,t,n){const r=mU.generateLibraryState(e,n);return t?`${r}${kI.RESOURCE_DELIM}${t}`:r}static generateLibraryState(e,t){if(!e)throw Vk(Ik);const n={id:e.createNewGuid()};t&&(n.meta=t);const r=JSON.stringify(n);return e.base64Encode(r)}static parseRequestState(e,t){if(!e)throw Vk(Ik);if(!t)throw Vk(sk);try{const n=t.split(kI.RESOURCE_DELIM),r=n[0],i=n.length>1?n.slice(1).join(kI.RESOURCE_DELIM):kI.EMPTY_STRING,o=e.base64Decode(r),s=JSON.parse(o);return{userRequestState:i||kI.EMPTY_STRING,libraryState:s}}catch(d){throw Vk(sk)}}}const vU="sw";class yU{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(uP,e.correlationId);const n=await RM(this.generateKid.bind(this),uP,t,this.performanceClient,e.correlationId)(e),r=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:r}}async generateKid(e){this.performanceClient?.addQueueMeasurement(dP,e.correlationId);return{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:vU}}async signPopToken(e,t,n){return this.signPayload(e,t,n)}async signPayload(e,t,n,r){const{resourceRequestMethod:i,resourceRequestUri:o,shrClaims:s,shrNonce:a,shrOptions:l}=n,c=o?new eD(o):void 0,u=c?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:Yk(),m:i?.toUpperCase(),u:u?.HostNameAndPort,nonce:a||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:s||void 0,...r},t,l,n.correlationId)}}class wU{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}class bU{constructor(e,t,n,r,i,o,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=r,this.serializableCache=i,this.persistencePlugin=o,this.performanceClient=s}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const n=`Error(s): ${e.error_codes||kI.NOT_AVAILABLE} - Timestamp: ${e.timestamp||kI.NOT_AVAILABLE} - Description: ${e.error_description||kI.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||kI.NOT_AVAILABLE} - Trace ID: ${e.trace_id||kI.NOT_AVAILABLE}`,r=e.error_codes?.length?e.error_codes[0]:void 0,i=new fU(e.error,n,e.suberror,r,e.status);if(t&&e.status&&e.status>=OI&&e.status<=NI)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.\n${i}`);if(t&&e.status&&e.status>=DI&&e.status<=xI)return void this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.\n${i}`);if(zM(e.error,e.error_description,e.suberror))throw new BM(e.error,e.error_description,e.suberror,e.timestamp||kI.EMPTY_STRING,e.trace_id||kI.EMPTY_STRING,e.correlation_id||kI.EMPTY_STRING,e.claims||kI.EMPTY_STRING,r);throw i}}async handleServerTokenResponse(e,t,n,r,i,o,s,a,l){let c,u;if(this.performanceClient?.addQueueMeasurement(hP,e.correlation_id),e.id_token){if(c=Kk(e.id_token||kI.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&c.nonce!==i.nonce)throw Vk(ck);if(r.maxAge||0===r.maxAge){const e=c.auth_time;if(!e)throw Vk(uk);Qk(e,r.maxAge)}}this.homeAccountIdentifier=YR.generateHomeAccountId(e.client_info||kI.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,c),i&&i.state&&(u=mU.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||r.sshKid||void 0;const d=this.generateCacheRecord(e,t,n,r,c,o,i);let h;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),h=new wU(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(h)),s&&!a&&d.account){const e=d.account.generateAccountKey();if(!this.cacheStorage.getAccount(e,r.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await bU.generateAuthenticationResult(this.cryptoObj,t,d,!1,r,c,u,void 0,l)}await this.cacheStorage.saveCacheRecord(d,r.correlationId,r.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&h&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(h))}return bU.generateAuthenticationResult(this.cryptoObj,t,d,!1,r,c,u,e,l)}generateCacheRecord(e,t,n,r,i,o,s){const a=t.getPreferredCache();if(!a)throw Vk(Tk);const l=QR(i);let c,u;e.id_token&&i&&(c=tR(this.homeAccountIdentifier,a,e.id_token,this.clientId,l||""),u=CU(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,r.correlationId,i,e.client_info,a,l,s,void 0,this.logger));let d=null;if(e.access_token){const i=e.scope?HR.fromString(e.scope):new HR(r.scopes||[]),s=("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,c=("string"===typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,u=("string"===typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=n+s,f=h+c,p=u&&u>0?n+u:void 0;d=nR(this.homeAccountIdentifier,a,e.access_token,this.clientId,l||t.tenant||"",i.printScopes(),h,f,this.cryptoObj.base64Decode,p,e.token_type,o,e.key_id,r.claims,r.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;if(e.refresh_token_expires_in){t=n+("string"===typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)}h=rR(this.homeAccountIdentifier,a,e.refresh_token,this.clientId,e.foci,o,t)}let f=null;return e.foci&&(f={clientId:this.clientId,environment:a,familyId:e.foci}),{account:u,idToken:c,accessToken:d,refreshToken:h,appMetadata:f}}static async generateAuthenticationResult(e,t,n,r,i,o,s,a,l){let c,u,d=kI.EMPTY_STRING,h=[],f=null,p=kI.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType!==SA.POP||i.popKid)d=n.accessToken.secret;else{const t=new yU(e),{secret:r,keyId:o}=n.accessToken;if(!o)throw Vk(Lk);d=await t.signPopToken(r,o,i)}h=HR.fromString(n.accessToken.target).asArray(),f=Xk(n.accessToken.expiresOn),c=Xk(n.accessToken.extendedExpiresOn),n.accessToken.refreshOn&&(u=Xk(n.accessToken.refreshOn))}n.appMetadata&&(p=n.appMetadata.familyId===pA?pA:"");const g=o?.oid||o?.sub||"",m=o?.tid||"";a?.spa_accountid&&n.account&&(n.account.nativeAccountId=a?.spa_accountid);const v=n.account?VR(n.account.getAccountInfo(),void 0,o,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:g,tenantId:m,scopes:h,account:v,idToken:n?.idToken?.secret||"",idTokenClaims:o||{},accessToken:d,fromCache:r,expiresOn:f,extExpiresOn:c,refreshOn:u,correlationId:i.correlationId,requestId:l||kI.EMPTY_STRING,familyId:p,tokenType:n.accessToken?.tokenType||kI.EMPTY_STRING,state:s?s.userRequestState:kI.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||kI.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||kI.EMPTY_STRING,code:a?.spa_code,fromNativeBroker:!1}}}function CU(e,t,n,r,i,o,s,a,l,c,u,d){d?.verbose("setCachedAccount called");const h=e.getAccountKeys().find(e=>e.startsWith(n));let f=null;h&&(f=e.getAccount(h,i));const p=f||YR.createAccount({homeAccountId:n,idTokenClaims:o,clientInfo:s,environment:a,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:u},t,r),g=p.tenantProfiles||[],m=l||p.realm;if(m&&!g.find(e=>e.tenantId===m)){const e=qR(n,p.localAccountId,m,o);g.push(e)}return p.tenantProfiles=g,p}async function SU(e,t,n){if("string"===typeof e)return e;return e({clientId:t,tokenEndpoint:n})}class EU extends gU{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(aP,e.correlationId),!e.code)throw Vk(gk);const n=Yk(),r=await RM(this.executeTokenRequest.bind(this),lP,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=r.headers?.[BI],o=new bU(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return o.validateTokenResponse(r.body),RM(o.handleServerTokenResponse.bind(o),hP,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,n,e,t,void 0,void 0,void 0,i)}getLogoutUri(e){if(!e)throw UR(SR);const t=this.createLogoutUrlQueryString(e);return eD.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(lP,t.correlationId);const n=this.createTokenQueryParameters(t),r=eD.appendQueryString(e.tokenEndpoint,n),i=await RM(this.createTokenRequestBody.bind(this),cP,this.logger,this.performanceClient,t.correlationId)(t);let o;if(t.clientInfo)try{const e=jR(t.clientInfo,this.cryptoUtils.base64Decode);o={credential:`${e.uid}${dA}${e.utid}`,type:RL}}catch(d){this.logger.verbose("Could not parse client info for CCS Header: "+d)}const s=this.createTokenRequestHeaders(o||t.ccsCredential),a=VM(this.config.authOptions.clientId,t);return RM(this.executePostToTokenEndpoint.bind(this),PD,this.logger,this.performanceClient,t.correlationId)(r,i,s,a,t.correlationId,PD)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(cP,e.correlationId);const t=new Map;if(qL(t,e.embeddedClientId||e.tokenBodyParameters?.[PL]||this.config.authOptions.clientId),this.includeRedirectUri)VL(t,e.redirectUri);else if(!e.redirectUri)throw UR(pR);if(zL(t,e.scopes,!0,this.oidcDefaultScopes),function(e,t){e.set("code",t)}(t,e.code),JL(t,this.config.libraryInfo),XL(t,this.config.telemetry.application),uU(t),this.serverTelemetryManager&&!ix(this.config)&&cU(t,this.serverTelemetryManager),e.codeVerifier&&function(e,t){e.set("code_verifier",t)}(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&eU(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const n=this.config.clientCredentials.clientAssertion;tU(t,await SU(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),nU(t,n.assertionType)}if(rU(t,oA),iU(t),e.authenticationScheme===SA.POP){const n=new yU(this.cryptoUtils,this.performanceClient);let r;if(e.popKid)r=this.cryptoUtils.encodeKid(e.popKid);else{r=(await RM(n.generateCnf.bind(n),uP,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}aU(t,r)}else if(e.authenticationScheme===SA.SSH){if(!e.sshJwk)throw UR(kR);lU(t,e.sshJwk)}let n;if((!FR.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&QL(t,e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{const t=jR(e.clientInfo,this.cryptoUtils.base64Decode);n={credential:`${t.uid}${dA}${t.utid}`,type:RL}}catch(d){this.logger.verbose("Could not parse client info for CCS Header: "+d)}else n=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&n)switch(n.type){case RL:try{GL(t,BR(n.credential))}catch(d){this.logger.verbose("Could not parse home account ID for CCS Header: "+d)}break;case DL:$L(t,n.credential)}return e.embeddedClientId&&dU(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&sU(t,e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[ML]||sU(t,{[ML]:"1"}),jL(t,e.correlationId,this.performanceClient),ZR(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&function(e,t){e.set("post_logout_redirect_uri",t)}(t,e.postLogoutRedirectUri),e.correlationId&&YL(t,e.correlationId),e.idTokenHint&&function(e,t){e.set("id_token_hint",t)}(t,e.idTokenHint),e.state&&ZL(t,e.state),e.logoutHint&&function(e,t){e.set("logout_hint",t)}(t,e.logoutHint),e.extraQueryParameters&&sU(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&oU(t),ZR(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}function TU(e){const{skus:t,libraryName:n,libraryVersion:r,extensionName:i,extensionVersion:o}=e,s=new Map([[0,[n,r]],[2,[i,o]]]);let a=[];if(t?.length){if(a=t.split(","),a.length<4)return t}else a=Array.from({length:4},()=>"|");return s.forEach((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&function(e){const{skuArr:t,index:n,skuName:r,skuVersion:i}=e;if(n>=t.length)return;t[n]=[r,i].join("|")}({skuArr:a,index:t,skuName:e[0],skuVersion:e[1]})}),a.join(",")}class _U{constructor(e,t){this.cacheOutcome=MA,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||kI.EMPTY_STRING,this.wrapperVer=e.wrapperVer||kI.EMPTY_STRING,this.telemetryCacheKey=CA.CACHE_KEY+uA+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${CA.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);const r=t.join(CA.VALUE_SEPARATOR),i=[e,this.getRegionDiscoveryFields()].join(CA.VALUE_SEPARATOR);return[CA.SCHEMA_VERSION,i,r].join(CA.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=_U.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(CA.VALUE_SEPARATOR),r=e.errors.slice(0,t).join(CA.VALUE_SEPARATOR),i=e.errors.length,o=[i,t<i?CA.OVERFLOW_TRUE:CA.OVERFLOW_FALSE].join(CA.VALUE_SEPARATOR);return[CA.SCHEMA_VERSION,e.cacheHits,n,r,o].join(CA.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=CA.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof YA?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(CA.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||{failedRequests:[],errors:[],cacheHits:0}}clearTelemetryCache(){const e=this.getLastRequests(),t=_U.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const n={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n,this.correlationId)}}static maxErrorsToSend(e){let t,n=0,r=0;const i=e.errors.length;for(t=0;t<i;t++){const i=e.failedRequests[2*t]||kI.EMPTY_STRING,o=e.failedRequests[2*t+1]||kI.EMPTY_STRING,s=e.errors[t]||kI.EMPTY_STRING;if(r+=i.toString().length+o.toString().length+s.length+3,!(r<CA.MAX_LAST_HEADER_BYTES))break;n+=1}return n}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||kI.EMPTY_STRING),e.push(this.regionSource||kI.EMPTY_STRING),e.push(this.regionOutcome||kI.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return TU(e)}}class IU{constructor(e,t,n,r,i,o,s,a,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=o,this.platformAuthProvider=a,this.correlationId=l||zN(),this.logger=r.clone(dx,pM,this.correlationId),this.performanceClient=s}async clearCacheOnLogout(e,t){if(t){YR.accountInfoIsEqual(t,this.browserStorage.getActiveAccount(e),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,e));try{this.browserStorage.removeAccount(YR.generateAccountCacheKey(t),e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(n){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch(d){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return eD.getAbsoluteUrl(t,sM())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new _U(n,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,n=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(AD,this.correlationId);const r={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,o=n?.length?"true"===n:this.config.auth.instanceAware,s=t&&o?this.config.auth.authority.replace(eD.getDomainFromUrl(i),t.environment):i,a=PM.generateAuthority(s,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),l=await RM(hU,pP,this.logger,this.performanceClient,this.correlationId)(a,this.config.system.networkClient,this.browserStorage,r,this.logger,this.correlationId,this.performanceClient);if(t&&!l.isAlias(t.environment))throw UR(NR);return l}}async function AU(e,t,n,r){n.addQueueMeasurement(BD,e.correlationId);const i=e.authority||t.auth.authority,o=[...e&&e.scopes||[]],s={...e,correlationId:e.correlationId,authority:i,scopes:o};if(s.authenticationScheme){if(s.authenticationScheme===SA.SSH){if(!e.sshJwk)throw UR(kR);if(!e.sshKid)throw UR(RR)}r.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}else s.authenticationScheme=SA.BEARER,r.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!FR.isEmptyObj(e.claims)&&(s.requestedClaimsHash=await JN(e.claims)),s}async function kU(e,t,n,r,i){r.addQueueMeasurement(zD,e.correlationId);const o=await RM(AU,BD,i,r,e.correlationId)(e,n,r,i);return{...e,...o,account:t,forceRefresh:e.forceRefresh||!1}}class RU extends IU{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||zN(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=eD.getAbsoluteUrl(e.postLogoutRedirectUri,sM())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=eD.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,sM())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=eD.getAbsoluteUrl(sM(),sM())),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(YD,this.correlationId);const t=await RM(this.getClientConfiguration.bind(this),JD,this.logger,this.performanceClient,this.correlationId)(e);return new EU(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:i,account:o}=e;this.performanceClient.addQueueMeasurement(JD,this.correlationId);const s=await RM(this.getDiscoveredAuthority.bind(this),AD,this.logger,this.performanceClient,this.correlationId)({requestAuthority:n,requestAzureCloudOptions:r,requestExtraQueryParameters:i,account:o}),a=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:a.loggerCallback,piiLoggingEnabled:a.piiLoggingEnabled,logLevel:a.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:dx,version:pM,cpu:kI.EMPTY_STRING,os:kI.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(XD,this.correlationId);const n=this.getRedirectUri(e.redirectUri),r={interactionType:t},i=mU.setRequestState(this.browserCrypto,e&&e.state||kI.EMPTY_STRING,r),o={...await RM(AU,BD,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:n,state:i,nonce:e.nonce||zN(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return o;const s=e.account||this.browserStorage.getActiveAccount(this.correlationId);return s&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${s.homeAccountId}`,this.correlationId),o.account=s),o}}function DU(e,t,n){const r=XR(e);if(!r)throw JR(e)?(n.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),n.errorPii(`The ${t} detected is: ${e}`),mN(EO)):(n.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),mN(CO));return r}function PU(e,t,n){if(!e.state)throw mN(SO);const r=function(e,t){if(!t)return null;try{return mU.parseRequestState(e,t).libraryState.meta}catch(d){throw Vk(sk)}}(t,e.state);if(!r)throw mN(TO);if(r.interactionType!==n)throw mN(_O)}function xU(e,t,n,r){const i=t.correlationId,o=new Map;qL(o,t.embeddedClientId||t.extraQueryParameters?.[PL]||e.clientId);if(zL(o,[...t.scopes||[],...t.extraScopesToConsent||[]],!0,e.authority.options.OIDCOptions?.defaultScopes),VL(o,t.redirectUri),YL(o,i),function(e,t){e.set("response_mode",t||iA)}(o,t.responseMode),iU(o),t.prompt&&(!function(e,t){e.set("prompt",t)}(o,t.prompt),r?.addFields({prompt:t.prompt},i)),t.domainHint&&(!function(e,t){e.set("domain_hint",t)}(o,t.domainHint),r?.addFields({domainHintFromRequest:!0},i)),t.prompt!==YI)if(t.sid&&t.prompt===XI)n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),KL(o,t.sid),r?.addFields({sidFromRequest:!0},i);else if(t.account){const e=(s=t.account,s.idTokenClaims?.sid||null);let a=function(e){return e.idTokenClaims?.login_hint||null}(t.account);if(a&&t.domainHint&&(n.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),a=null),a){n.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),WL(o,a),r?.addFields({loginHintFromClaim:!0},i);try{GL(o,BR(t.account.homeAccountId))}catch(d){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e&&t.prompt===XI){n.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),KL(o,e),r?.addFields({sidFromClaim:!0},i);try{GL(o,BR(t.account.homeAccountId))}catch(d){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t.loginHint)n.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),WL(o,t.loginHint),$L(o,t.loginHint),r?.addFields({loginHintFromRequest:!0},i);else if(t.account.username){n.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),WL(o,t.account.username),r?.addFields({loginHintFromUpn:!0},i);try{GL(o,BR(t.account.homeAccountId))}catch(d){n.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else t.loginHint&&(n.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),WL(o,t.loginHint),$L(o,t.loginHint),r?.addFields({loginHintFromRequest:!0},i));else n.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");var s;return t.nonce&&function(e,t){e.set("nonce",t)}(o,t.nonce),t.state&&ZL(o,t.state),(t.claims||e.clientCapabilities&&e.clientCapabilities.length>0)&&QL(o,t.claims,e.clientCapabilities),t.embeddedClientId&&dU(o,e.clientId,e.redirectUri),!e.instanceAware||t.extraQueryParameters&&Object.keys(t.extraQueryParameters).includes(HL)||oU(o),o}function OU(e,t,n,r){const i=ZR(t,n,r);return eD.appendQueryString(e.authorizationEndpoint,i)}function NU(e,t){if(!e.state||!t)throw e.state?Vk(lk,"Cached State"):Vk(lk,"Server State");let n,r;try{n=decodeURIComponent(e.state)}catch(d){throw Vk(sk,e.state)}try{r=decodeURIComponent(t)}catch(d){throw Vk(sk,e.state)}if(n!==r)throw Vk(ak);if(e.error||e.error_description||e.suberror){const t=function(e){const t="code=",n=e.error_uri?.lastIndexOf(t);return n&&n>=0?e.error_uri?.substring(n+t.length):void 0}(e);if(zM(e.error,e.error_description,e.suberror))throw new BM(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new fU(e.error||"",e.error_description,e.suberror,t)}}class MU{constructor(e,t,n,r,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=r,this.performanceClient=i}async handleCodeResponse(e,t){let n;this.performanceClient.addQueueMeasurement(nP,t.correlationId);try{n=function(e,t){if(NU(e,t),!e.code)throw Vk(Ok);return e}(e,t.state)}catch(d){throw d instanceof fU&&d.subError===RO?mN(RO):d}return RM(this.handleCodeResponseFromServer.bind(this),tP,this.logger,this.performanceClient,t.correlationId)(n,t)}async handleCodeResponseFromServer(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.performanceClient.addQueueMeasurement(tP,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await RM(this.authModule.updateAuthority.bind(this.authModule),sP,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await RM(this.authModule.acquireToken.bind(this.authModule),aP,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:RL}:e.loginHint?{credential:e.loginHint,type:DL}:null}}const LU="user_switch",UU={[LU]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class FU extends YA{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,FU.prototype),this.name="NativeAuthError",this.ext=n}}function HU(e){return!(!e.ext||!e.ext.status||"PERSISTENT_ERROR"!==e.ext.status&&"DISABLED"!==e.ext.status)||(!(!e.ext||!e.ext.error||-2147186943!==e.ext.error)||"ContentError"===e.errorCode)}function jU(e,t,n){if(n&&n.status)switch(n.status){case"ACCOUNT_UNAVAILABLE":return qM(NM);case"USER_INTERACTION_REQUIRED":return new BM(e,t);case"USER_CANCEL":return mN(RO);case"NO_NETWORK":return mN(WO);case"UX_NOT_ALLOWED":return qM(LM)}return new FU(e,UU[e]||t,n)}class BU extends gU{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(FD,e.correlationId);let t=MA;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!FR.isEmptyObj(e.claims))throw this.setCacheOutcome(LA,e.correlationId),Vk(Dk);if(!e.account)throw Vk(Sk);const n=e.account.tenantId||function(e){const t=new eD(e).getUrlComponents(),n=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case VI:case WI:case $I:return;default:return n}}(e.authority),r=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,r,n);if(!i)throw this.setCacheOutcome(UA,e.correlationId),Vk(Dk);if(o=i.cachedAt,Number(o)>Yk()||Zk(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(FA,e.correlationId),Vk(Dk);var o;i.refreshOn&&Zk(i.refreshOn,0)&&(t=HA);const s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,r,n,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await RM(this.generateResultFromCacheRecord.bind(this),HD,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==MA&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let n;if(this.performanceClient?.addQueueMeasurement(HD,t.correlationId),e.idToken&&(n=Kk(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){const e=n?.auth_time;if(!e)throw Vk(uk);Qk(e,t.maxAge)}return bU.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)}}class zU extends RU{async acquireToken(e){this.performanceClient.addQueueMeasurement(SD,e.correlationId);const t=this.initializeServerTelemetryManager(Gx),n=await RM(this.getClientConfiguration.bind(this),JD,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),r=new BU(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{const t=(await RM(r.acquireCachedToken.bind(r),FD,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(i){throw i instanceof gN&&i.errorCode===YO&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,t?.account)}}class qU extends IU{constructor(e,t,n,r,i,o,s,a,l,c,u,d){super(e,t,n,r,i,o,a,l,d),this.apiId=s,this.accountId=c,this.platformAuthProvider=l,this.nativeStorageManager=u,this.silentCacheClient=new zU(e,this.nativeStorageManager,n,r,i,o,a,l,d);const h=this.platformAuthProvider.getExtensionName();this.skus=_U.makeExtraSkuString({libraryName:dx,libraryVersion:pM,extensionName:h,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[LL]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(kD,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const n=this.performanceClient.startMeasurement(kD,e.correlationId),r=Yk(),i=this.initializeServerTelemetryManager(this.apiId);try{const o=await this.initializeNativeRequest(e);try{const e=await this.acquireTokensFromCache(this.accountId,o);return n.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(d){if(t===cO)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),d;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const s=await this.platformAuthProvider.sendMessage(o);return await this.handleNativeResponse(s,o,r).then(e=>(n.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),i.clearNativeBrokerErrorCode(),e)).catch(e=>{throw n.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e})}catch(d){throw d instanceof FU&&i.setNativeBrokerErrorCode(d.errorCode),d}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:HR.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),Vk(_k);const n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!n)throw Vk(_k);try{const e=this.createSilentCacheRequest(t,n),r=await this.silentCacheClient.acquireToken(e),i={...n,idTokenClaims:r?.idTokenClaims,idToken:r?.idToken};return{...r,account:i}}catch(d){throw d}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...n}=e;delete n.onRedirectNavigate;const r=await this.initializeNativeRequest(n);try{await this.platformAuthProvider.sendMessage(r)}catch(d){if(d instanceof FU){if(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(d.errorCode),HU(d))throw d}}this.browserStorage.setTemporaryCache(Lx,JSON.stringify(r),!0);const i={apiId:zx,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(o,i)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:r,...i}=n;r&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Lx));const o=Yk();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const e=await this.platformAuthProvider.sendMessage(i),t=await this.handleNativeResponse(e,i,o);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),t}catch(d){throw d}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,n){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const r=Kk(e.id_token,AN),i=this.createHomeAccountIdentifier(e,r),o=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId)?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(i!==o&&e.account.id!==t.accountId)throw jU(LU);const s=await this.getDiscoveredAuthority({requestAuthority:t.authority}),a=CU(this.browserStorage,s,i,AN,this.correlationId,r,e.client_info,void 0,r.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const l=await this.generateAuthenticationResult(e,t,r,a,s.canonicalAuthority,n);return await this.cacheAccount(a,this.correlationId),await this.cacheNativeTokens(e,t,i,r,e.access_token,l.tenantId,n),l}createHomeAccountIdentifier(e,t){return YR.generateHomeAccountId(e.client_info||kI.EMPTY_STRING,WR,this.logger,this.browserCrypto,t)}generateScopes(e,t){return t?HR.fromString(t):HR.fromString(e)}async generatePopAccessToken(e,t){if(t.tokenType===SA.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const n=new yU(this.browserCrypto),r={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw Vk(Lk);return n.signPopToken(e.access_token,t.keyId,r)}return e.access_token}async generateAuthenticationResult(e,t,n,r,i,o){const s=this.addTelemetryFromNativeResponse(e.properties.MATS),a=this.generateScopes(t.scope,e.scope),l=e.account.properties||{},c=l.UID||n.oid||n.sub||kI.EMPTY_STRING,u=l.TenantId||n.tid||kI.EMPTY_STRING,d=VR(r.getAccountInfo(),void 0,n,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);const h=await this.generatePopAccessToken(e,t),f=t.tokenType===SA.POP?SA.POP:SA.BEARER;return{authority:i,uniqueId:c,tenantId:u,scopes:a.asArray(),account:d,idToken:e.id_token,idTokenClaims:n,accessToken:h,fromCache:!!s&&this.isResponseFromCache(s),expiresOn:Xk(o+e.expires_in),tokenType:f,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,t){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,t)}cacheNativeTokens(e,t,n,r,i,o,s){const a=tR(n,t.authority,e.id_token||"",t.clientId,r.tid||""),l=s+(t.tokenType===SA.POP?kI.SHR_NONCE_VALIDITY:("string"===typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),c=this.generateScopes(e.scope,t.scope),u={idToken:a,accessToken:nR(n,t.authority,i,t.clientId,r.tid||o,c.printScopes(),l,0,AN,void 0,t.tokenType,void 0,t.keyId)};return this.nativeStorageManager.saveCacheRecord(u,this.correlationId,t.storeInCache)}getExpiresInValue(e,t){return e===SA.POP?kI.SHR_NONCE_VALIDITY:("string"===typeof t?parseInt(t,10):t)||0}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch(d){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return"undefined"===typeof e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=await this.getCanonicalAuthority(e),{scopes:n,...r}=e,i=new HR(n||[]);i.appendScopes(MI);const o={...r,accountId:this.accountId,clientId:this.config.auth.clientId,authority:t.urlString,scope:i.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(o.signPopToken&&e.popKid)throw mN(lN);if(this.handleExtraBrokerParams(o),o.extraParameters=o.extraParameters||{},o.extraParameters.telemetry=px,e.authenticationScheme===SA.POP){const t={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new yU(this.browserCrypto);let r;if(o.keyId)r=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:o.keyId})),o.signPopToken=!1;else{const i=await RM(n.generateCnf.bind(n),uP,this.logger,this.performanceClient,e.correlationId)(t,this.logger);r=i.reqCnfString,o.keyId=i.kid,o.signPopToken=!0}o.reqCnf=r}return this.addRequestSKUs(o),o}async getCanonicalAuthority(e){const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const n=new eD(t);return n.validateAsUri(),n}getPrompt(e){switch(this.apiId){case Vx:case Gx:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),XI}if(e)switch(e){case XI:case JI:case QI:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e} is not compatible with native flow`),mN(sN)}else this.logger.trace("initializeNativeRequest: prompt was not provided")}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(UL)&&e.extraParameters.hasOwnProperty(FL)&&e.extraParameters.hasOwnProperty(PL);if(!e.embeddedClientId&&!t)return;let n="";const r=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,n=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[FL],n=e.extraParameters[PL]),e.extraParameters={child_client_id:n,child_redirect_uri:r},this.performanceClient?.addFields({embeddedClientId:n,embeddedRedirectUri:r},e.correlationId)}}async function VU(e,t,n,r,i){const o=xU({...e.auth,authority:t},n,r,i);if(JL(o,{sku:dx,version:pM,os:"",cpu:""}),e.auth.protocolMode!==VA&&XL(o,e.telemetry.application),n.platformBroker&&(function(e){e.set("nativebroker","1")}(o),n.authenticationScheme===SA.POP)){const e=new IM(r,i),t=new yU(e);let s;if(n.popKid)s=e.encodeKid(n.popKid);else{s=(await RM(t.generateCnf.bind(t),uP,r,i,n.correlationId)(n,r)).reqCnfString}aU(o,s)}return jL(o,n.correlationId,i),o}async function WU(e,t,n,r,i){if(!n.codeChallenge)throw UR(TR);const o=await RM(VU,eP,r,i,n.correlationId)(e,t,n,r,i);return BL(o,eA),function(e,t,n){if(!t||!n)throw UR(TR);e.set("code_challenge",t),e.set("code_challenge_method",n)}(o,n.codeChallenge,kI.S256_CODE_CHALLENGE_METHOD),sU(o,n.extraQueryParameters||{}),OU(t,o,e.auth.encodeExtraQueryParams,n.extraQueryParameters)}async function $U(e,t,n,r,i,o){if(!r.earJwk)throw mN(vO);const s=await VU(t,n,r,i,o);BL(s,tA),function(e,t){e.set("ear_jwk",encodeURIComponent(t)),e.set("ear_jwe_crypto","eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}(s,r.earJwk);const a=new Map;sU(a,r.extraQueryParameters||{});return function(e,t,n){const r=e.createElement("form");return r.method="post",r.action=t,n.forEach((t,n)=>{const i=e.createElement("input");i.hidden=!0,i.name=n,i.value=t,r.appendChild(i)}),e.body.appendChild(r),r}(e,OU(n,a,t.auth.encodeExtraQueryParams,r.extraQueryParameters),s)}async function GU(e,t,n,r,i,o,s,a,l,c){if(a.verbose("Account id found, calling WAM for token"),!c)throw mN(iN);const u=new IM(a,l),d=new qU(r,i,u,a,s,r.system.navigationClient,n,l,c,t,o,e.correlationId),{userRequestState:h}=mU.parseRequestState(u,e.state);return RM(d.acquireToken.bind(d),kD,a,l,e.correlationId)({...e,state:h,prompt:void 0})}async function KU(e,t,n,r,i,o,s,a,l,c,u,d){if(pU.removeThrottle(s,i.auth.clientId,e),t.accountId)return RM(GU,iP,c,u,e.correlationId)(e,t.accountId,r,i,s,a,l,c,u,d);const h={...e,code:t.code||"",codeVerifier:n},f=new MU(o,s,h,c,u);return await RM(f.handleCodeResponse.bind(f),nP,c,u,e.correlationId)(t,e)}async function QU(e,t,n,r,i,o,s,a,l,c,u){if(pU.removeThrottle(o,r.auth.clientId,e),NU(t,e.state),!t.ear_jwe)throw mN(yO);if(!e.earJwk)throw mN(vO);const d=JSON.parse(await RM(WN,$P,l,c,e.correlationId)(e.earJwk,t.ear_jwe));if(d.accountId)return RM(GU,iP,l,c,e.correlationId)(e,d.accountId,n,r,o,s,a,l,c,u);const h=new bU(r.auth.clientId,o,new IM(l,c),l,null,null,c);h.validateTokenResponse(d);const f={code:"",state:e.state,nonce:e.nonce,client_info:d.client_info,cloud_graph_host_name:d.cloud_graph_host_name,cloud_instance_host_name:d.cloud_instance_host_name,cloud_instance_name:d.cloud_instance_name,msgraph_host:d.msgraph_host};return await RM(h.handleServerTokenResponse.bind(h),hP,l,c,e.correlationId)(d,i,Yk(),e,f,void 0,void 0,void 0,void 0)}async function YU(e,t,n){e.addQueueMeasurement(NP,n);const r=kM(JU,MP,t,e,n)(e,t,n);return{verifier:r,challenge:await RM(XU,LP,t,e,n)(r,e,t,n)}}function JU(e,t,n){try{const r=new Uint8Array(32);kM(jN,FP,t,e,n)(r);return TN(r)}catch(d){throw mN(mO)}}async function XU(e,t,n,r){t.addQueueMeasurement(LP,r);try{const i=await RM(HN,UP,n,t,r)(e,t,r);return TN(new Uint8Array(i))}catch(d){throw mN(mO)}}class ZU{constructor(e,t,n,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(AP),this.platformAuthType=wx}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const t={method:Sx,request:e},n={channel:hx,extensionId:this.extensionId,responseId:zN(),body:t};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+` - Sending request to browser extension: ${JSON.stringify(n)}`),this.messageChannel.port1.postMessage(n);const r=await new Promise((e,t)=>{this.resolvers.set(n.responseId,{resolve:e,reject:t})});return this.validatePlatformBrokerResponse(r)}static async createProvider(e,t,n){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const r=new ZU(e,t,n,fx);return await r.sendHandshakeRequest(),r}catch(d){const i=new ZU(e,t,n);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:hx,extensionId:this.extensionId,responseId:zN(),body:{method:bx}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(mN(nN)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const t=e.data;if(t.channel&&t.channel===hx&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===bx){const e=this.handshakeResolvers.get(t.responseId);if(!e)return void this.logger.trace(this.platformAuthType+`.onWindowMessage - resolver can't be found for request ${t.responseId}`);this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(mN(rN))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const t=e.data,n=this.resolvers.get(t.responseId),r=this.handshakeResolvers.get(t.responseId);try{const e=t.body.method;if(e===Ex){if(!n)return;const e=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+` - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)n.reject(jU(e.code,e.description,e.ext));else{if(!e.result)throw JA(GA,"Event does not contain result.");e.result.code&&e.result.description?n.reject(jU(e.result.code,e.result.description,e.result.ext)):n.resolve(e.result)}this.resolvers.delete(t.responseId)}else if(e===Cx){if(!r)return void this.logger.trace(this.platformAuthType+`.onChannelMessage - resolver can't be found for request ${t.responseId}`);clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+` - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),r.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(i):r&&r.reject(i)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw JA(GA,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){return this.getExtensionId()===fx?"chrome":this.getExtensionId()?.length?"unknown":void 0}}class eF{constructor(e,t,n){this.logger=e,this.performanceClient=t,this.correlationId=n,this.platformAuthType=yx}static async createProvider(e,t,n){if(e.trace("PlatformAuthDOMHandler: createProvider called"),window.navigator?.platformAuthentication){const r=await window.navigator.platformAuthentication.getSupportedContracts(gx);if(r?.includes(vx))return e.trace("Platform auth api available in DOM"),new eF(e,t,n)}}getExtensionId(){return gx}getExtensionVersion(){return""}getExtensionName(){return mx}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const t=this.initializePlatformDOMRequest(e),n=await window.navigator.platformAuthentication.executeGetToken(t);return this.validatePlatformBrokerResponse(n)}catch(d){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),d}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:t,clientId:n,authority:r,scope:i,redirectUri:o,correlationId:s,state:a,storeInCache:l,embeddedClientId:c,extraParameters:u,...d}=e,h=this.getDOMExtraParams(d);return{accountId:t,brokerId:this.getExtensionId(),authority:r,clientId:n,correlationId:s||this.correlationId,extraParameters:{...u,...h},isSecurityTokenService:!1,redirectUri:o,scope:i,state:a,storeInCache:l,embeddedClientId:c}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const t=e;if(!1===t.isSuccess&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),jU(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw JA(GA,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){this.logger.trace(this.platformAuthType+" - convertToNativeResponse called");return{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:e.extendedLifetimeToken??!1,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return{...Object.entries(e).reduce((e,t)=>{let[n,r]=t;return e[n]=String(r),e},{})}}}async function tF(e,t,n,r){e.trace("getPlatformAuthProvider called",n);const i=function(){let e;try{return e=window[_x],"true"===e?.getItem(gO)}catch(d){return!1}}();let o;e.trace("Has client allowed platform auth via DOM API: "+i);try{i&&(o=await eF.createProvider(e,t,n)),o||(e.trace("Platform auth via DOM API not available, checking for extension"),o=await ZU.createProvider(e,r||2e3,t))}catch(d){e.trace("Platform auth not available",d)}return o}function nF(e,t,n,r){if(t.trace("isPlatformAuthAllowed called"),!e.system.allowPlatformBroker)return t.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!n)return t.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(r)switch(r){case SA.BEARER:case SA.POP:return t.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return t.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}class rF extends RU{constructor(e,t,n,r,i,o,s,a,l,c){super(e,t,n,r,i,o,s,l,c),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=a,this.eventHandler=i}acquireToken(e,t){try{const n={popupName:this.generatePopupName(e.scopes||MI,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,n,t)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),n.popup=this.openSizedPopup("about:blank",n),this.acquireTokenPopupAsync(e,n,t))}catch(d){return Promise.reject(d)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),n={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},r=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,r,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),n.popup=this.openSizedPopup("about:blank",n),this.logoutPopupAsync(t,n,r,i))}catch(d){return Promise.reject(d)}}async acquireTokenPopupAsync(e,t,n){this.logger.verbose("acquireTokenPopupAsync called");const r=await RM(this.initializeAuthorizationRequest.bind(this),XD,this.logger,this.performanceClient,this.correlationId)(e,Yx.Popup);t.popup&&hM(r.authority);const i=nF(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);return r.platformBroker=i,this.config.auth.protocolMode===WA?this.executeEarFlow(r,t):this.executeCodeFlow(r,t,n)}async executeCodeFlow(e,t,n){const r=e.correlationId,i=this.initializeServerTelemetryManager(qx),o=n||await RM(YU,NP,this.logger,this.performanceClient,r)(this.performanceClient,this.logger,r),s={...e,codeChallenge:o.challenge};try{const n=await RM(this.createAuthCodeClient.bind(this),YD,this.logger,this.performanceClient,r)({serverTelemetryManager:i,requestAuthority:s.authority,requestAzureCloudOptions:s.azureCloudOptions,requestExtraQueryParameters:s.extraQueryParameters,account:s.account}),a=await RM(WU,ZD,this.logger,this.performanceClient,r)(this.config,n.authority,s,this.logger,this.performanceClient),l=this.initiateAuthRequest(a,t);this.eventHandler.emitEvent(bL,Yx.Popup,{popupWindow:l},null);const c=await this.monitorPopupForHash(l,t.popupWindowParent),u=kM(DU,fP,this.logger,this.performanceClient,this.correlationId)(c,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await RM(KU,oP,this.logger,this.performanceClient,r)(e,u,o.verifier,qx,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}catch(d){throw t.popup?.close(),d instanceof YA&&(d.setCorrelationId(this.correlationId),i.cacheFailedRequest(d)),d}}async executeEarFlow(e,t){const n=e.correlationId,r=await RM(this.getDiscoveredAuthority.bind(this),AD,this.logger,this.performanceClient,n)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),i=await RM(VN,WP,this.logger,this.performanceClient,n)(),o={...e,earJwk:i},s=t.popup||this.openPopup("about:blank",t);(await $U(s.document,this.config,r,o,this.logger,this.performanceClient)).submit();const a=await RM(this.monitorPopupForHash.bind(this),GD,this.logger,this.performanceClient,n)(s,t.popupWindowParent),l=kM(DU,fP,this.logger,this.performanceClient,this.correlationId)(a,this.config.auth.OIDCOptions.serverResponseType,this.logger);return RM(QU,rP,this.logger,this.performanceClient,n)(o,l,qx,this.config,r,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(e,t,n,r){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(CL,Yx.Popup,e);const i=this.initializeServerTelemetryManager(Qx);try{await this.clearCacheOnLogout(this.correlationId,e.account);const o=await RM(this.createAuthCodeClient.bind(this),YD,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:n,account:e.account||void 0});try{o.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&o.authority.protocolMode===VA){if(this.browserStorage.removeAccount(e.account?.homeAccountId,this.correlationId),this.eventHandler.emitEvent(SL,Yx.Popup,e),r){const e={apiId:Qx,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=eD.getAbsoluteUrl(r,sM());await this.navigationClient.navigateInternal(t,e)}return void t.popup?.close()}}const s=o.getLogoutUri(e);this.eventHandler.emitEvent(SL,Yx.Popup,e);const a=this.openPopup(s,t);if(this.eventHandler.emitEvent(bL,Yx.Popup,{popupWindow:a},null),await this.monitorPopupForHash(a,t.popupWindowParent).catch(()=>{}),r){const e={apiId:Qx,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=eD.getAbsoluteUrl(r,sM());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(d){throw t.popup?.close(),d instanceof YA&&(d.setCorrelationId(this.correlationId),i.cacheFailedRequest(d)),this.eventHandler.emitEvent(EL,Yx.Popup,null,d),this.eventHandler.emitEvent(TL,Yx.Popup),d}this.eventHandler.emitEvent(TL,Yx.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),mN(bO)}monitorPopupForHash(e,t){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const r=setInterval(()=>{if(e.closed)return this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(r),void n(mN(RO));let i="";try{i=e.location.href}catch(d){}if(!i||"about:blank"===i)return;clearInterval(r);let o="";const s=this.config.auth.OIDCOptions.serverResponseType;e&&(o=s===nA?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(o)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):"undefined"===typeof t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t)),!n)throw mN(kO);return n.focus&&n.focus(),this.currentWindow=n,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),n}catch(d){throw this.logger.error("error opening popup "+d.message),mN(AO)}}openSizedPopup(e,t){let{popupName:n,popupWindowAttributes:r,popupWindowParent:i}=t;const o=i.screenLeft?i.screenLeft:i.screenX,s=i.screenTop?i.screenTop:i.screenY,a=i.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=i.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=r.popupSize?.width,u=r.popupSize?.height,d=r.popupPosition?.top,h=r.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=ax),(!u||u<0||u>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=lx),(!d||d<0||d>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),d=Math.max(0,l/2-lx/2+s)),(!h||h<0||h>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),h=Math.max(0,a/2-ax/2+o)),i.open(e,n,`width=${c}, height=${u}, top=${d}, left=${h}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${cx}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${cx}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class iF extends RU{constructor(e,t,n,r,i,o,s,a,l,c){super(e,t,n,r,i,o,s,l,c),this.nativeStorage=a}async acquireToken(e){const t=await RM(this.initializeAuthorizationRequest.bind(this),XD,this.logger,this.performanceClient,this.correlationId)(e,Yx.Redirect);t.platformBroker=nF(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);const n=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent(_L,Yx.Redirect))},r=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${r}`),this.browserStorage.setTemporaryCache(Px,r,!0),window.addEventListener("pageshow",n);try{this.config.auth.protocolMode===WA?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(d){throw d instanceof YA&&d.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",n),d}}async executeCodeFlow(e,t){const n=e.correlationId,r=this.initializeServerTelemetryManager(zx),i=await RM(YU,NP,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),o={...e,codeChallenge:i.challenge};this.browserStorage.cacheAuthorizeRequest(o,i.verifier);try{const n=await RM(this.createAuthCodeClient.bind(this),YD,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account}),i=await RM(WU,ZD,this.logger,this.performanceClient,e.correlationId)(this.config,n.authority,o,this.logger,this.performanceClient);return await this.initiateAuthRequest(i,t)}catch(d){throw d instanceof YA&&(d.setCorrelationId(this.correlationId),r.cacheFailedRequest(d)),d}}async executeEarFlow(e){const t=e.correlationId,n=await RM(this.getDiscoveredAuthority.bind(this),AD,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await RM(VN,WP,this.logger,this.performanceClient,t)(),i={...e,earJwk:r};this.browserStorage.cacheAuthorizeRequest(i);return(await $U(document,this.config,n,i,this.logger,this.performanceClient)).submit(),new Promise((e,t)=>{setTimeout(()=>{t(mN(hN,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const i=this.initializeServerTelemetryManager(Wx);try{const[o,s]=this.getRedirectResponse(e||"");if(!o)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),"back_forward"!==function(){if("undefined"===typeof window||"undefined"===typeof window.performance||"function"!==typeof window.performance.getEntriesByType)return;const e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}()?r.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const a=this.browserStorage.getTemporaryCache(Px,!0)||kI.EMPTY_STRING,l=eD.removeHashFromUrl(a);if(l===eD.removeHashFromUrl(window.location.href)&&this.config.auth.navigateToLoginRequestUrl){this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&function(e){const t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}(a);return await this.handleResponse(o,t,n,i)}if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(o,t,n,i);if(!oM()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(xx,s,!0);const e={apiId:Wx,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let r=!0;if(a&&"null"!==a)this.logger.verbose(`Navigating to loginRequestUrl: ${a}`),r=await this.navigationClient.navigateInternal(a,e);else{const t=function(){const e=new eD(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}();this.browserStorage.setTemporaryCache(Px,t,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),r=await this.navigationClient.navigateInternal(t,e)}if(!r)return await this.handleResponse(o,t,n,i)}return null}catch(d){throw d instanceof YA&&(d.setCorrelationId(this.correlationId),i.cacheFailedRequest(d)),d}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===nA?window.location.search:window.location.hash);let n=XR(t);if(n){try{PU(n,this.browserCrypto,Yx.Redirect)}catch(d){return d instanceof YA&&this.logger.error(`Interaction type validation failed due to ${d.errorCode}: ${d.errorMessage}`),[null,""]}return iM(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}const r=this.browserStorage.getTemporaryCache(xx,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(xx)),r&&(n=XR(r),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,r]):[null,""]}async handleResponse(e,t,n,r){if(!e.state)throw mN(SO);if(e.ear_jwe){const n=await RM(this.getDiscoveredAuthority.bind(this),AD,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return RM(QU,rP,this.logger,this.performanceClient,t.correlationId)(t,e,zx,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const i=await RM(this.createAuthCodeClient.bind(this),YD,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority});return RM(KU,oP,this.logger,this.performanceClient,t.correlationId)(t,e,n,zx,this.config,i,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const n={apiId:zx,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},r=t||this.config.auth.onRedirectNavigate;if("function"===typeof r){this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback");return!1!==r(e)?(this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),void await this.navigationClient.navigateExternal(e,n)):void this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation")}return this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),void await this.navigationClient.navigateExternal(e,n)}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),mN(bO)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(Kx);try{this.eventHandler.emitEvent(CL,Yx.Redirect,e),await this.clearCacheOnLogout(this.correlationId,t.account);const r={apiId:Kx,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},i=await RM(this.createAuthCodeClient.bind(this),YD,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:n,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(i.authority.protocolMode===VA)try{i.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId)return this.browserStorage.removeAccount(t.account?.homeAccountId,this.correlationId),void this.eventHandler.emitEvent(SL,Yx.Redirect,t)}const o=i.getLogoutUri(t);if(this.eventHandler.emitEvent(SL,Yx.Redirect,t),!e||"function"!==typeof e.onRedirectNavigate)return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Dx),void await this.navigationClient.navigateExternal(o,r);if(!1!==e.onRedirectNavigate(o))return this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,Dx),void await this.navigationClient.navigateExternal(o,r);this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}catch(d){throw d instanceof YA&&(d.setCorrelationId(this.correlationId),n.cacheFailedRequest(d)),this.eventHandler.emitEvent(EL,Yx.Redirect,null,d),this.eventHandler.emitEvent(TL,Yx.Redirect),d}this.eventHandler.emitEvent(TL,Yx.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return eD.getAbsoluteUrl(t,sM())}}async function oF(e,t,n,r,i){if(t.addQueueMeasurement($D,r),!e)throw n.info("Navigate url is empty"),mN(bO);return i?RM(lF,KD,n,t,r)(e,i,t,r):kM(cF,QD,n,t,r)(e)}async function sF(e,t,n,r,i){const o=uF();if(!o.contentDocument)throw"No document associated with iframe!";return(await $U(o.contentDocument,e,t,n,r,i)).submit(),o}async function aF(e,t,n,r,i,o,s){return r.addQueueMeasurement(GD,o),new Promise((r,o)=>{t<fM&&i.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (10000ms). This may result in timeouts.`);const a=window.setTimeout(()=>{window.clearInterval(l),o(mN(PO))},t),l=window.setInterval(()=>{let t="";const n=e.contentWindow;try{t=n?n.location.href:""}catch(d){}if(!t||"about:blank"===t)return;let i="";n&&(i=s===nA?n.location.search:n.location.hash),window.clearTimeout(a),window.clearInterval(l),r(i)},n)}).finally(()=>{kM(dF,kP,i,r,o)(e)})}function lF(e,t,n,r){return n.addQueueMeasurement(KD,r),new Promise((n,r)=>{const i=uF();window.setTimeout(()=>{i?(i.src=e,n(i)):r("Unable to load iframe")},t)})}function cF(e){const t=uF();return t.src=e,t}function uF(){const e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function dF(e){document.body===e.parentNode&&document.body.removeChild(e)}class hF extends RU{constructor(e,t,n,r,i,o,s,a,l,c,u){super(e,t,n,r,i,o,a,c,u),this.apiId=s,this.nativeStorage=l}async acquireToken(e){this.performanceClient.addQueueMeasurement(ED,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==XI&&t.prompt!==ZI&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${XI}`),t.prompt=XI):t.prompt=XI;const n=await RM(this.initializeAuthorizationRequest.bind(this),XD,this.logger,this.performanceClient,e.correlationId)(t,Yx.Silent);return n.platformBroker=nF(this.config,this.logger,this.platformAuthProvider,n.authenticationScheme),hM(n.authority),this.config.auth.protocolMode===WA?this.executeEarFlow(n):this.executeCodeFlow(n)}async executeCodeFlow(e){let t;const n=this.initializeServerTelemetryManager(this.apiId);try{return t=await RM(this.createAuthCodeClient.bind(this),YD,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await RM(this.silentTokenHelper.bind(this),WD,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(d){if(d instanceof YA&&(d.setCorrelationId(this.correlationId),n.cacheFailedRequest(d)),!t||!(d instanceof YA)||d.errorCode!==sx)throw d;return this.performanceClient.addFields({retryError:d.errorCode},this.correlationId),await RM(this.silentTokenHelper.bind(this),WD,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,n=await RM(this.getDiscoveredAuthority.bind(this),AD,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),r=await RM(VN,WP,this.logger,this.performanceClient,t)(),i={...e,earJwk:r},o=await RM(sF,$D,this.logger,this.performanceClient,t)(this.config,n,i,this.logger,this.performanceClient),s=this.config.auth.OIDCOptions.serverResponseType,a=await RM(aF,GD,this.logger,this.performanceClient,t)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,s),l=kM(DU,fP,this.logger,this.performanceClient,t)(a,s,this.logger);return RM(QU,rP,this.logger,this.performanceClient,t)(i,l,this.apiId,this.config,n,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(mN(LO))}async silentTokenHelper(e,t){const n=t.correlationId;this.performanceClient.addQueueMeasurement(WD,n);const r=await RM(YU,NP,this.logger,this.performanceClient,n)(this.performanceClient,this.logger,n),i={...t,codeChallenge:r.challenge},o=await RM(WU,ZD,this.logger,this.performanceClient,n)(this.config,e.authority,i,this.logger,this.performanceClient),s=await RM(oF,$D,this.logger,this.performanceClient,n)(o,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),a=this.config.auth.OIDCOptions.serverResponseType,l=await RM(aF,GD,this.logger,this.performanceClient,n)(s,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,a),c=kM(DU,fP,this.logger,this.performanceClient,n)(l,a,this.logger);return RM(KU,oP,this.logger,this.performanceClient,n)(t,c,r.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}class fF extends gU{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(OD,e.correlationId);const t=Yk(),n=await RM(this.executeTokenRequest.bind(this),xD,this.logger,this.performanceClient,e.correlationId)(e,this.authority),r=n.headers?.[BI],i=new bU(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(n.body),RM(i.handleServerTokenResponse.bind(i),hP,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,r)}async acquireTokenByRefreshToken(e){if(!e)throw UR(CR);if(this.performanceClient?.addQueueMeasurement(MD,e.correlationId),!e.account)throw Vk(Sk);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await RM(this.acquireTokenWithCachedRefreshToken.bind(this),ND,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(d){const n=d instanceof BM&&d.errorCode===OM,r=d instanceof fU&&d.errorCode===AA&&d.subError===kA;if(n||r)return RM(this.acquireTokenWithCachedRefreshToken.bind(this),ND,this.logger,this.performanceClient,e.correlationId)(e,!1);throw d}return RM(this.acquireTokenWithCachedRefreshToken.bind(this),ND,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(ND,e.correlationId);const n=kM(this.cacheManager.getRefreshToken.bind(this.cacheManager),DP,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!n)throw qM(OM);if(n.expiresOn&&Zk(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||300))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),qM(MM);const r={...e,refreshToken:n.secret,authenticationScheme:e.authenticationScheme||SA.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:RL}};try{return await RM(this.acquireToken.bind(this),OD,this.logger,this.performanceClient,e.correlationId)(r)}catch(d){if(d instanceof BM&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(n.expiresOn)},e.correlationId),d.subError===UM)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const t=eR(n);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw d}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(xD,e.correlationId);const n=this.createTokenQueryParameters(e),r=eD.appendQueryString(t.tokenEndpoint,n),i=await RM(this.createTokenRequestBody.bind(this),LD,this.logger,this.performanceClient,e.correlationId)(e),o=this.createTokenRequestHeaders(e.ccsCredential),s=VM(this.config.authOptions.clientId,e);return RM(this.executePostToTokenEndpoint.bind(this),DD,this.logger,this.performanceClient,e.correlationId)(r,i,o,s,e.correlationId,DD)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(LD,e.correlationId);const t=new Map;if(qL(t,e.embeddedClientId||e.tokenBodyParameters?.[PL]||this.config.authOptions.clientId),e.redirectUri&&VL(t,e.redirectUri),zL(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),rU(t,sA),iU(t),JL(t,this.config.libraryInfo),XL(t,this.config.telemetry.application),uU(t),this.serverTelemetryManager&&!ix(this.config)&&cU(t,this.serverTelemetryManager),function(e,t){e.set("refresh_token",t)}(t,e.refreshToken),this.config.clientCredentials.clientSecret&&eU(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const n=this.config.clientCredentials.clientAssertion;tU(t,await SU(n.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),nU(t,n.assertionType)}if(e.authenticationScheme===SA.POP){const n=new yU(this.cryptoUtils,this.performanceClient);let r;if(e.popKid)r=this.cryptoUtils.encodeKid(e.popKid);else{r=(await RM(n.generateCnf.bind(n),uP,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString}aU(t,r)}else if(e.authenticationScheme===SA.SSH){if(!e.sshJwk)throw UR(kR);lU(t,e.sshJwk)}if((!FR.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&QL(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case RL:try{GL(t,BR(e.ccsCredential.credential))}catch(d){this.logger.verbose("Could not parse home account ID for CCS Header: "+d)}break;case DL:$L(t,e.ccsCredential.credential)}return e.embeddedClientId&&dU(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&sU(t,e.tokenBodyParameters),jL(t,e.correlationId,this.performanceClient),ZR(t)}}class pF extends RU{async acquireToken(e){this.performanceClient.addQueueMeasurement(_D,e.correlationId);const t=await RM(AU,BD,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n={...e,...t};e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));const r=this.initializeServerTelemetryManager(Gx),i=await this.createRefreshTokenClient({serverTelemetryManager:r,authorityUrl:n.authority,azureCloudOptions:n.azureCloudOptions,account:n.account});return RM(i.acquireTokenByRefreshToken.bind(i),MD,this.logger,this.performanceClient,e.correlationId)(n).catch(e=>{throw e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e),e})}logout(){return Promise.reject(mN(LO))}async createRefreshTokenClient(e){const t=await RM(this.getClientConfiguration.bind(this),JD,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new fF(t,this.performanceClient)}}class gF{constructor(e,t,n,r){this.isBrowserEnvironment="undefined"!==typeof window,this.config=e,this.storage=t,this.logger=n,this.cryptoObj=r}async loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw mN(qO);const r=e.correlationId||zN(),i=t.id_token?Kk(t.id_token,AN):void 0,o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new PM(PM.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,o,this.logger,e.correlationId||zN()):void 0,a=await this.loadAccount(e,n.clientInfo||t.client_info||"",r,i,s),l=await this.loadIdToken(t,a.homeAccountId,a.environment,a.realm,r),c=await this.loadAccessToken(e,t,a.homeAccountId,a.environment,a.realm,n,r),u=await this.loadRefreshToken(t,a.homeAccountId,a.environment,r);return this.generateAuthenticationResult(e,{account:a,idToken:l,accessToken:c,refreshToken:u},i,s)}async loadAccount(e,t,n,r,i){if(this.logger.verbose("TokenCache - loading account"),e.account){const t=YR.createFromAccountInfo(e.account);return await this.storage.setAccount(t,n),t}if(!i||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),mN(QO);const o=YR.generateHomeAccountId(t,i.authorityType,this.logger,this.cryptoObj,r),s=r?.tid,a=CU(this.storage,i,o,AN,n,r,t,i.hostnameAndPort,s,void 0,void 0,this.logger);return await this.storage.setAccount(a,n),a}async loadIdToken(e,t,n,r,i){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const o=tR(t,n,e.id_token,this.config.auth.clientId,r);return await this.storage.setIdTokenCredential(o,i),o}async loadAccessToken(e,t,n,r,i,o,s){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");const a=t.scope?HR.fromString(t.scope):new HR(e.scopes),l=o.expiresOn||t.expires_in+Yk(),c=o.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+Yk(),u=nR(n,r,t.access_token,this.config.auth.clientId,i,a.printScopes(),l,c,AN);return await this.storage.setAccessTokenCredential(u,s),u}async loadRefreshToken(e,t,n,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const i=rR(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(i,r),i}generateAuthenticationResult(e,t,n,r){let i,o="",s=[],a=null;t?.accessToken&&(o=t.accessToken.secret,s=HR.fromString(t.accessToken.target).asArray(),a=Xk(t.accessToken.expiresOn),i=Xk(t.accessToken.extendedExpiresOn));const l=t.account;return{authority:r?r.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:s,account:l.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:n||{},accessToken:o,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:i,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:l.cloudGraphHostName||"",msGraphHost:l.msGraphHost||"",fromNativeBroker:!1}}}class mF extends EU{constructor(e){super(e),this.includeRedirectUri=!1}}class vF extends RU{constructor(e,t,n,r,i,o,s,a,l,c){super(e,t,n,r,i,o,a,l,c),this.apiId=s}async acquireToken(e){if(!e.code)throw mN(JO);const t=await RM(this.initializeAuthorizationRequest.bind(this),XD,this.logger,this.performanceClient,e.correlationId)(e,Yx.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{const r={...t,code:e.code},i=await RM(this.getClientConfiguration.bind(this),JD,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:n,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new mF(i);this.logger.verbose("Auth code client created");const s=new MU(o,this.browserStorage,r,this.logger,this.performanceClient);return await RM(s.handleCodeResponseFromServer.bind(s),tP,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(d){throw d instanceof YA&&(d.setCorrelationId(this.correlationId),n.cacheFailedRequest(d)),d}}logout(){return Promise.reject(mN(LO))}}function yF(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}function wF(e,t){try{uM(e)}catch(d){throw t.end({success:!1},d),d}}class bF{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new IM(this.logger,this.performanceClient):Wk,this.eventHandler=new kL(this.logger),this.browserStorage=this.isBrowserEnvironment?new IL(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,function(e){const t=e.cloudDiscoveryMetadata;let n;if(t)try{n=JSON.parse(t)}catch(d){throw UR(_R)}return{canonicalAuthority:e.authority?xM(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:n}}(this.config.auth)):((e,t,n,r)=>new IL(e,{cacheLocation:Ix,temporaryCacheLocation:Ix,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},Wk,t,n,r))(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:Ix,temporaryCacheLocation:Ix,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new IL(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new gF(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const n=new bF(e);return await n.initialize(t),n}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized)return void this.logger.info("initialize has already been called, exiting early.");if(!this.isBrowserEnvironment)return this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,void this.eventHandler.emitEvent(tL);const n=e?.correlationId||this.getRequestCorrelationId(),r=this.config.system.allowPlatformBroker,i=this.performanceClient.startMeasurement(qD,n);if(this.eventHandler.emitEvent(eL),!t)try{this.logMultipleInstances(i)}catch{}if(await RM(this.browserStorage.initialize.bind(this.browserStorage),VD,this.logger,this.performanceClient,n)(n),r)try{this.platformAuthProvider=await tF(this.logger,this.performanceClient,n,this.config.system.nativeBrokerHandshakeTimeout)}catch(d){this.logger.verbose(d)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),kM(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),RP,this.logger,this.performanceClient,n)(n)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(n),this.initialized=!0,this.eventHandler.emitEvent(tL),i.end({allowPlatformBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),cM(this.initialized),this.isBrowserEnvironment){const t=e||"";let n=this.redirectResponse.get(t);return"undefined"===typeof n?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const t=this.browserStorage.getInteractionInProgress()?.type;if(t===Dx)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const n=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),i=r&&this.platformAuthProvider&&!e;let o,s;this.eventHandler.emitEvent(yL,Yx.Redirect);try{if(i&&this.platformAuthProvider){o=this.performanceClient.startMeasurement(wD,r?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform");const e=new qU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Wx,this.performanceClient,this.platformAuthProvider,r.accountId,this.nativeInternalStorage,r.correlationId);s=RM(e.handleRedirectPromise.bind(e),IP,this.logger,this.performanceClient,o.event.correlationId)(this.performanceClient,o.event.correlationId)}else{const[t,n]=this.browserStorage.getCachedRequest(),r=t.correlationId;o=this.performanceClient.startMeasurement(wD,r),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const i=this.createRedirectClient(r);s=RM(i.handleRedirectPromise.bind(i),_P,this.logger,this.performanceClient,o.event.correlationId)(e,t,n,o)}}catch(d){throw this.browserStorage.resetRequestCache(),d}return s.then(e=>{if(e){this.browserStorage.resetRequestCache();n.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(sL,Yx.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(cL,Yx.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),o.end({success:!0,accountType:yF(e.account)})}else o.event.errorCode?o.end({success:!1}):o.discard();return this.eventHandler.emitEvent(wL,Yx.Redirect),e}).catch(e=>{this.browserStorage.resetRequestCache();const t=e;throw n.length>0?this.eventHandler.emitEvent(uL,Yx.Redirect,null,t):this.eventHandler.emitEvent(aL,Yx.Redirect,null,t),this.eventHandler.emitEvent(wL,Yx.Redirect),o.end({success:!1},t),e})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const n=this.performanceClient.startMeasurement(yD,t);n.add({accountType:yF(e.account),scenarioId:e.scenarioId});const r=e.onRedirectNavigate;if(r)e.onRedirectNavigate=e=>{const t="function"===typeof r?r(e):void 0;return!1!==t?n.end({success:!0}):n.discard(),t};else{const e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{const r="function"===typeof e?e(t):void 0;return!1!==r?n.end({success:!0}):n.discard(),r}}const i=this.getAllAccounts().length>0;try{let r;if(dM(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Rx),i?this.eventHandler.emitEvent(lL,Yx.Redirect,e):this.eventHandler.emitEvent(oL,Yx.Redirect,e),this.platformAuthProvider&&this.canUsePlatformBroker(e)){r=new qU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,zx,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(n=>{if(n instanceof FU&&HU(n)){this.platformAuthProvider=void 0;return this.createRedirectClient(t).acquireToken(e)}if(n instanceof BM){this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createRedirectClient(t).acquireToken(e)}throw n})}else{r=this.createRedirectClient(t).acquireToken(e)}return await r}catch(d){throw this.browserStorage.resetRequestCache(),n.end({success:!1},d),i?this.eventHandler.emitEvent(uL,Yx.Redirect,null,d):this.eventHandler.emitEvent(aL,Yx.Redirect,null,d),d}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(vD,t);n.add({scenarioId:e.scenarioId,accountType:yF(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),wF(this.initialized,n),this.browserStorage.setInteractionInProgress(!0,Rx)}catch(d){return Promise.reject(d)}const r=this.getAllAccounts();let i;r.length>0?this.eventHandler.emitEvent(lL,Yx.Popup,e):this.eventHandler.emitEvent(oL,Yx.Popup,e);const o=this.getPreGeneratedPkceCodes(t);if(this.canUsePlatformBroker(e))i=this.acquireTokenNative({...e,correlationId:t},qx).then(e=>(n.end({success:!0,isNativeBroker:!0,accountType:yF(e.account)}),e)).catch(n=>{if(n instanceof FU&&HU(n)){this.platformAuthProvider=void 0;return this.createPopupClient(t).acquireToken(e,o)}if(n instanceof BM){this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow");return this.createPopupClient(t).acquireToken(e,o)}throw n});else{i=this.createPopupClient(t).acquireToken(e,o)}return i.then(e=>(r.length<this.getAllAccounts().length?this.eventHandler.emitEvent(sL,Yx.Popup,e):this.eventHandler.emitEvent(cL,Yx.Popup,e),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:yF(e.account)}),e)).catch(e=>(r.length>0?this.eventHandler.emitEvent(uL,Yx.Popup,null,e):this.eventHandler.emitEvent(aL,Yx.Popup,null,e),n.end({success:!1},e),Promise.reject(e))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),n={...e,prompt:e.prompt,correlationId:t};let r;if(this.ssoSilentMeasurement=this.performanceClient.startMeasurement(ID,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:yF(e.account)}),wF(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(hL,Yx.Silent,n),this.canUsePlatformBroker(n))r=this.acquireTokenNative(n,Vx).catch(e=>{if(e instanceof FU&&HU(e)){this.platformAuthProvider=void 0;return this.createSilentIframeClient(n.correlationId).acquireToken(n)}throw e});else{r=this.createSilentIframeClient(n.correlationId).acquireToken(n)}return r.then(e=>(this.eventHandler.emitEvent(fL,Yx.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:yF(e.account)}),e)).catch(e=>{throw this.eventHandler.emitEvent(pL,Yx.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const n=this.performanceClient.startMeasurement(fD,t);wF(this.initialized,n),this.eventHandler.emitEvent(gL,Yx.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw mN(ZO);if(e.code){const r=e.code;let i=this.hybridAuthCodeResponses.get(r);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(e=>(this.eventHandler.emitEvent(mL,Yx.Silent,e),this.hybridAuthCodeResponses.delete(r),n.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:yF(e.account)}),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(r),this.eventHandler.emitEvent(vL,Yx.Silent,null,e),n.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(r,i)),await i}if(e.nativeAccountId){if(this.canUsePlatformBroker(e,e.nativeAccountId)){const r=await this.acquireTokenNative({...e,correlationId:t},$x,e.nativeAccountId).catch(e=>{throw e instanceof FU&&HU(e)&&(this.platformAuthProvider=void 0),e});return n.end({accountType:yF(r.account),success:!0}),r}throw mN(tN)}throw mN(XO)}catch(d){throw this.eventHandler.emitEvent(vL,Yx.Silent,null,d),n.end({success:!1},d),d}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(TP,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);const t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then(e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e)).catch(e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(UD,e.correlationId),t){case lO:case cO:case uO:const t=this.createSilentCacheClient(e.correlationId);return RM(t.acquireToken.bind(t),SD,this.logger,this.performanceClient,e.correlationId)(e);default:throw Vk(Dk)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(pD,e.correlationId),t){case lO:case uO:case dO:case hO:const t=this.createSilentRefreshClient(e.correlationId);return RM(t.acquireToken.bind(t),_D,this.logger,this.performanceClient,e.correlationId)(e);default:throw Vk(Dk)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(jD,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return RM(t.acquireToken.bind(t),ED,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);dM(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,Dx);return this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);uM(this.initialized),this.browserStorage.setInteractionInProgress(!0,Dx);return this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(d){return Promise.reject(d)}}async clearCache(e){if(!this.isBrowserEnvironment)return void this.logger.info("in non-browser environment, returning early.");const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return function(e,t,n,r,i){return e.verbose("getAllAccounts called"),n?t.getAllAccounts(i||{},r):[]}(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;const i=n.getAccountInfoFilteredBy(e,r);return i?(t.verbose("getAccount: Account matching provided filter found, returning"),i):(t.verbose("getAccount: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;const i=n.getAccountInfoFilteredBy({username:e},r);return i?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),i):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;const i=n.getAccountInfoFilteredBy({homeAccountId:e},r);return i?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),i):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return function(e,t,n,r){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;const i=n.getAccountInfoFilteredBy({localAccountId:e},r);return i?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),i):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();!function(e,t,n){t.setActiveAccount(e,n)}(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return function(e,t){return e.getActiveAccount(t)}(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const n=YR.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(n,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,n,r){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw mN(iN);return new qU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.platformAuthProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,r)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!nF(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case XI:case JI:case QI:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!(!t&&!this.getNativeAccountId(e))||(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new rF(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new iF(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new hF(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Vx,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new zU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new pF(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new vF(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,$x,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return lM(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.config.cache.cacheLocation===Tx?this.eventHandler.subscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}disableAccountStorageEvents(){this.config.cache.cacheLocation===Tx?this.eventHandler.unsubscribeCrossTab():this.logger.info("Account storage events are only available when cacheLocation is set to localStorage")}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?zN():kI.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||iO})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||iO})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(gD,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),wF(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);const r=e.account||this.getActiveAccount();if(!r)throw mN(UO);return n.add({accountType:yF(r)}),this.acquireTokenSilentDeduped(e,r,t).then(r=>(n.end({success:!0,fromCache:r.fromCache,isNativeBroker:r.fromNativeBroker,accessTokenSize:r.accessToken.length,idTokenSize:r.idToken.length}),{...r,state:e.state,correlationId:t})).catch(e=>{throw e instanceof YA&&e.setCorrelationId(t),n.end({success:!1},e),e})}async acquireTokenSilentDeduped(e,t,n){const r=VM(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority,correlationId:n},t.homeAccountId),i=JSON.stringify(r),o=this.activeSilentTokenRequests.get(i);if("undefined"===typeof o){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",n),this.performanceClient.addFields({deduped:!1},n);const r=RM(this.acquireTokenSilentAsync.bind(this),mD,this.logger,this.performanceClient,n)({...e,correlationId:n},t);return this.activeSilentTokenRequests.set(i,r),r.finally(()=>{this.activeSilentTokenRequests.delete(i)})}return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",n),this.performanceClient.addFields({deduped:!0},n),o}async acquireTokenSilentAsync(e,t){const n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(mD,e.correlationId),this.eventHandler.emitEvent(lL,Yx.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);const r=await RM(kU,zD,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||lO,o=this.acquireTokenSilentNoIframe(r,i).catch(async e=>{const t=function(e,t){const n=!(e instanceof BM&&e.subError!==UM),r=e.errorCode===sx||e.errorCode===Dk,i=n&&r||e.errorCode===OM||e.errorCode===MM,o=pO.includes(t);return i&&o}(e,i);if(t){if(this.activeIframeRequest){if(i!==fO){const[t,n]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${n}`,r.correlationId);const o=this.performanceClient.startMeasurement(TD,r.correlationId);o.add({awaitIframeCorrelationId:n});const s=await t;if(o.end({success:s}),s)return this.logger.verbose(`Parallel iframe request with correlationId: ${n} succeeded. Retrying cache and/or RT redemption`,r.correlationId),this.acquireTokenSilentNoIframe(r,i);throw this.logger.info(`Iframe request with correlationId: ${n} failed. Interaction is required.`),e}return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",r.correlationId),RM(this.acquireTokenBySilentIframe.bind(this),jD,this.logger,this.performanceClient,r.correlationId)(r)}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),r.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",r.correlationId),RM(this.acquireTokenBySilentIframe.bind(this),jD,this.logger,this.performanceClient,r.correlationId)(r).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e});return o.then(t=>(this.eventHandler.emitEvent(cL,Yx.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(uL,Yx.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",n)})}async acquireTokenSilentNoIframe(e,t){return nF(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,Gx,e.account.nativeAccountId,t).catch(async e=>{if(e instanceof FU&&HU(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,Vk(Dk);throw e})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),t===cO&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),RM(this.acquireTokenFromCache.bind(this),UD,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===cO)throw n;return this.eventHandler.emitEvent(dL,Yx.Silent,e),RM(this.acquireTokenByRefreshToken.bind(this),pD,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await RM(YU,NP,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose((t?"Found":"Did not find")+" pre-generated PKCE codes"),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[];window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),function(e,t,n){const r=window.msal?.clientIds||[],i=r.length,o=r.filter(t=>t===e).length;o>1&&n.warning("There is already an instance of MSAL.js in the window with the same client id."),t.add({msalInstanceCount:i,sameClientIdInstanceCount:o})}(t,e,this.logger)}}class CF{static async createPublicClientApplication(e){const t=await async function(e,t){const n=new mM(e);return await n.initialize(),bF.createController(n,t)}(e);return new CF(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new bF(new mM(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const SF={auth:{clientId:"1fff571d-d94c-4603-a021-b1c62830bdf5",authority:"https://login.microsoftonline.com/85c4f037-2a6d-4213-b75c-b005446ce2a9",redirectUri:"localhost"===window.location.hostname?"http://localhost:3000":"https://meeting-book.vercel.app"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1}},EF={scopes:["User.Read","Mail.Send"]},TF=new CF(SF);const _F=function(e){let{eventData:t,onClose:n,events:r,accessToken:i,getFreshAccessToken:o}=e;if(!t)return null;const s=async(e,t,n)=>{try{const r=i||await o();if(!r)return void console.warn("No access token available for sending email.");const s=await fetch("/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,subject:t,message:n,accessToken:r})});if(!s.ok){const e=await s.text();console.error("Email send failed:",e)}}catch(r){console.error("Failed to send email:",r)}};return(0,qc.jsx)("div",{className:"modal-overlay",children:(0,qc.jsxs)("div",{className:"modal-content",children:[(0,qc.jsx)("h3",{children:"Booking Details"}),(0,qc.jsxs)("p",{children:[(0,qc.jsx)("strong",{children:"Name:"})," ",t.name]}),(0,qc.jsxs)("p",{children:[(0,qc.jsx)("strong",{children:"Department:"})," ",t.department]}),(0,qc.jsxs)("p",{children:[(0,qc.jsx)("strong",{children:"Room:"})," ",t.room]}),(0,qc.jsxs)("p",{children:[(0,qc.jsx)("strong",{children:"Start:"})," ",new Date(t.start).toLocaleString()]}),(0,qc.jsxs)("p",{children:[(0,qc.jsx)("strong",{children:"End:"})," ",new Date(t.end).toLocaleString()]}),(0,qc.jsxs)("div",{className:"modal-actions",children:["pending"===t.status&&(0,qc.jsx)("button",{onClick:async()=>{try{await function(e,t,n){e=Am(e,aT);const r=Am(e.firestore,gT),i=RT(r);let o;for(var s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];return o="string"==typeof(t=Iu(t))||t instanceof wT?OT(i,"updateDoc",e._key,t,n,a):xT(i,"updateDoc",e._key,t),r_(r,[o.toMutation(e._key,Hw.exists(!0))])}(uT(AI,"bookings",t.id),{status:"approved"}),t.userEmail&&await s(t.userEmail,"Your Booking is Approved",`Hello ${t.name},\n\nYour booking for ${t.room} from ${new Date(t.start).toLocaleString()} to ${new Date(t.end).toLocaleTimeString()} has been approved.\n\nThank you.`);const e=r.filter(e=>e.id!==t.id&&"pending"===e.status&&e.room===t.room&&new Date(e.start)<new Date(t.end)&&new Date(e.end)>new Date(t.start));for(const t of e)await t_(uT(AI,"bookings",t.id))}catch(e){console.error("Error approving booking:",e)}finally{n()}},children:"Approve"}),(0,qc.jsx)("button",{onClick:async()=>{try{await t_(uT(AI,"bookings",t.id)),t.userEmail&&await s(t.userEmail,"Your Booking Request",`Hello ${t.name},\n\nUnfortunately, your booking for ${t.room} on ${new Date(t.start).toLocaleString()} was declined. Please choose another available time slot.\n\nThank you.`)}catch(e){console.error("Error removing booking:",e)}finally{n()}},children:"Remove"}),(0,qc.jsx)("button",{className:"btn-cancel",onClick:n,children:"Close"})]})]})})},IF={instance:{initialize:()=>Promise.reject(rM(ZN)),acquireTokenPopup:()=>Promise.reject(rM(ZN)),acquireTokenRedirect:()=>Promise.reject(rM(ZN)),acquireTokenSilent:()=>Promise.reject(rM(ZN)),acquireTokenByCode:()=>Promise.reject(rM(ZN)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject(rM(ZN)),loginPopup:()=>Promise.reject(rM(ZN)),loginRedirect:()=>Promise.reject(rM(ZN)),logout:()=>Promise.reject(rM(ZN)),logoutRedirect:()=>Promise.reject(rM(ZN)),logoutPopup:()=>Promise.reject(rM(ZN)),ssoSilent:()=>Promise.reject(rM(ZN)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw rM(ZN)},getLogger:()=>{throw rM(ZN)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw rM(ZN)},hydrateCache:()=>Promise.reject(rM(ZN)),clearCache:()=>Promise.reject(rM(ZN))},inProgress:rO,accounts:[],logger:new zA({})},AF=h.createContext(IF);AF.Consumer;class kF{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case oL:return Xx;case hL:return tO;case lL:if(e.interactionType===Yx.Redirect||e.interactionType===Yx.Popup)return eO;break;case yL:return nO;case CL:return Zx;case fL:case pL:if(t&&t!==tO)break;return rO;case TL:if(t&&t!==Zx)break;return rO;case wL:if(t&&t!==nO)break;return rO;case sL:case aL:case cL:case uL:case _L:if(e.interactionType===Yx.Redirect||e.interactionType===Yx.Popup){if(t&&t!==Xx&&t!==eO)break;return rO}}return null}}function RF(e,t){if(e.length!==t.length)return!1;const n=[...t];return e.every(e=>{const t=n.shift();return!(!e||!t)&&(e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username)})}const DF="3.0.15",PF="UNBLOCK_INPROGRESS",xF="EVENT",OF=(e,t)=>{const{type:n,payload:r}=t;let i=e.inProgress;switch(n){case PF:e.inProgress===Jx&&(i=rO,r.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case xF:const t=r.message,o=kF.getInteractionStatusFromEvent(t,e.inProgress);o&&(r.logger.info(`MsalProvider - ${t.eventType} results in setting inProgress from ${e.inProgress} to ${o}`),i=o);break;default:throw new Error(`Unknown action type: ${n}`)}if(i===Jx)return e;const o=r.instance.getAllAccounts();return i===e.inProgress||RF(o,e.accounts)?i!==e.inProgress?{...e,inProgress:i}:RF(o,e.accounts)?e:{...e,accounts:o}:{...e,inProgress:i,accounts:o}};function NF(e){let{instance:t,children:n}=e;(0,h.useEffect)(()=>{t.initializeWrapperLibrary(oO,DF)},[t]);const r=(0,h.useMemo)(()=>t.getLogger().clone("@azure/msal-react",DF),[t]),[i,o]=(0,h.useReducer)(OF,void 0,()=>({inProgress:Jx,accounts:[]}));(0,h.useEffect)(()=>{const e=t.addEventCallback(e=>{o({payload:{instance:t,logger:r,message:e},type:xF})});return r.verbose(`MsalProvider - Registered event callback with id: ${e}`),t.initialize().then(()=>{t.handleRedirectPromise().catch(()=>{}).finally(()=>{o({payload:{instance:t,logger:r},type:PF})})}).catch(()=>{}),()=>{e&&(r.verbose(`MsalProvider - Removing event callback ${e}`),t.removeEventCallback(e))}},[t,r]);const s={instance:t,inProgress:i.inProgress,accounts:i.accounts,logger:r};return h.createElement(AF.Provider,{value:s},n)}const MF=["a.alkubaesy@swd.bh","admin2@swd.bh","admin3@swd.bh"];async function LF(e,t){const n={...EF,account:t};try{const t=await e.acquireTokenSilent(n);return(await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${t.accessToken}`}})).json()}catch(r){if(console.error("Silent token acquisition failed:",r),!(r instanceof BM))return null;try{const t=await e.acquireTokenPopup(n);return(await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${t.accessToken}`}})).json()}catch(i){return console.error("Popup token acquisition failed:",i),null}}}const UF=function(){const{instance:e,accounts:t}=(0,h.useContext)(AF),[n,r]=(0,h.useState)(e.getActiveAccount()||t[0]),[i,o]=(0,h.useState)([]),[s,a]=(0,h.useState)(null),[l,c]=(0,h.useState)(null),[u,d]=(0,h.useState)(!1),[f,p]=(0,h.useState)(null),[g,m]=(0,h.useState)(!1),[v,y]=(0,h.useState)(null);(0,h.useEffect)(()=>{n&&LF(e,n).then(e=>{if(e&&e.userPrincipalName){if(!e.userPrincipalName.endsWith("@swd.bh"))return alert("Access denied. Only @swd.bh emails are allowed."),void C();c(t=>({...t,username:e.userPrincipalName||"",name:e.displayName||"Unknown User",department:(null===t||void 0===t?void 0:t.department)||e.department||"",phone:e.mobilePhone||(null===t||void 0===t?void 0:t.phone)||""})),d(MF.includes(e.userPrincipalName))}else console.error("Failed to retrieve profile or userPrincipalName missing.")}).catch(e=>console.error("Profile fetch failed:",e))},[n,e]),(0,h.useEffect)(()=>{!async function(){if(null!==l&&void 0!==l&&l.username)try{const e=uT(AI,"users",l.username),t=await function(e){e=Am(e,aT);const t=Am(e.firestore,gT);return XE(mT(t),e._key).then(n=>i_(t,e,n))}(e);if(t.exists()){const e=t.data();p(e),c(t=>({...t,department:e.department||(null===t||void 0===t?void 0:t.department)||""}))}}catch(e){console.error("Failed to fetch user data:",e)}}()},[l]),(0,h.useEffect)(()=>{const e=n_(cT(AI,"bookings"),e=>{const t=e.docs.map(e=>({id:e.id,...e.data()}));if(o(t.map(e=>({...e,title:e.department?`${e.name} \u2013 ${e.department}`:e.name}))),l){const e=t.filter(e=>e.userId===l.username).sort((e,t)=>new Date(t.start)-new Date(e.start));if(e.length>0){const{name:t,cpr:n,phone:r,department:i}=e[0];p({name:t,cpr:n,phone:r,department:i})}}});return()=>e()},[l]);const[w,b]=(0,h.useState)(null),C=()=>{e.logoutPopup().then(()=>{c(null),r(null)})};return(0,qc.jsxs)("div",{children:[(0,qc.jsxs)("header",{style:{background:"#2e3b4e",color:"#fff",padding:"10px 20px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,qc.jsx)("h2",{style:{color:"white"},children:"Meeting Booking System"}),l?(0,qc.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,qc.jsxs)("span",{children:["Welcome, ",(0,qc.jsx)("strong",{children:l.name}),u&&(0,qc.jsx)("span",{className:"admin-badge",children:" (Admin)"})]}),(0,qc.jsx)("button",{onClick:C,style:{background:"#e74c3c",color:"#fff",border:"none",padding:"5px 10px",borderRadius:"5px",cursor:"pointer"},children:"Logout"})]}):(0,qc.jsx)("button",{onClick:()=>{e.loginPopup(EF).then(async t=>{e.setActiveAccount(t.account),r(t.account);const n=await e.acquireTokenSilent(EF);return b(n.accessToken),LF(e,t.account)}).then(e=>{if(e){if(!e.userPrincipalName.endsWith("@swd.bh"))return alert("Access denied. Only @swd.bh emails are allowed."),void C();c(t=>({...t,username:e.userPrincipalName||"",name:e.displayName||"Unknown User",department:(null===t||void 0===t?void 0:t.department)||e.department||"",phone:e.mobilePhone||(null===t||void 0===t?void 0:t.phone)||""})),d(MF.includes(e.userPrincipalName))}else alert("Failed to fetch Microsoft profile. Please try again.")}).catch(e=>{console.error("Login failed:",e),alert("Microsoft login failed: "+e.message)})},style:{background:"#3498db",color:"#fff",border:"none",padding:"5px 10px",borderRadius:"5px",cursor:"pointer"},children:"Login with Microsoft"})]}),(0,qc.jsx)("div",{className:"login-wrapper",style:{margin:"10px 0"},children:(0,qc.jsx)("button",{onClick:()=>{l?m(!0):alert("Please log in first.")},children:"Book Manually"})}),u&&v&&(0,qc.jsx)(_F,{eventData:v,onClose:()=>y(null),events:i,accessToken:w,getFreshAccessToken:async()=>{try{const t=await e.acquireTokenSilent(EF);return b(t.accessToken),t.accessToken}catch(t){console.error("Silent token refresh failed, trying popup:",t);try{const t=await e.acquireTokenPopup(EF);return b(t.accessToken),t.accessToken}catch(n){return console.error("Token acquisition failed:",n),null}}}}),(0,qc.jsx)(Vc,{events:i,onSelectSlot:e=>{var t;if(!l)return void alert("You must log in to book a meeting room.");const n=new Date(e.start);let r=new Date(e.end);n.getTime()===r.getTime()&&(r=new Date(n.getTime()+18e5)),a({start:n.toISOString(),end:r.toISOString(),resourceId:(null===(t=e.resource)||void 0===t?void 0:t.id)||e.resourceId||"Room 1"})},onDeleteEvent:async e=>{if(u)try{await t_(uT(AI,"bookings",e))}catch(t){console.error("Error deleting:",t),alert("Failed to delete booking.")}},isAdmin:u,currentUser:l,setSelectedEvent:y}),l&&(0,qc.jsx)(Wc,{slot:s,events:i,onClose:()=>a(null),onSubmit:async(e,t)=>{if(!l)return void alert("Please log in with your Microsoft account to book.");const n=l.username,r=l.name;await function(e,t){const n=Am(e.firestore,gT),r=uT(e),i=KT(e.converter,t);return r_(n,[DT(RT(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Hw.exists(!1))]).then(()=>r)}(cT(AI,"bookings"),{name:r,cpr:e.cpr,phone:e.phone,department:e.department||l.department||"",room:s.resourceId,start:s.start,end:t,userId:n,userEmail:n,bookedBy:r,status:"pending"}),await function(e,t,n){e=Am(e,aT);const r=Am(e.firestore,gT),i=KT(e.converter,t,n);return r_(r,[DT(RT(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Hw.none())])}(uT(AI,"users",n),{name:r,cpr:e.cpr,phone:e.phone,department:e.department||l.department||""}),p({name:r,cpr:e.cpr,phone:e.phone,department:e.department||l.department||""}),c(t=>({...t,department:e.department||l.department||""})),a(null)},lastUsedData:f?{...f,name:(null===l||void 0===l?void 0:l.name)||f.name}:{name:(null===l||void 0===l?void 0:l.name)||"",phone:(null===l||void 0===l?void 0:l.phone)||"",department:(null===l||void 0===l?void 0:l.department)||"",cpr:""}}),g&&(0,qc.jsx)($c,{onClose:()=>m(!1),onSubmit:e=>a(e)})]})};f.createRoot(document.getElementById("root")).render((0,qc.jsx)(NF,{instance:TF,children:(0,qc.jsx)(UF,{})}))})();
//# sourceMappingURL=main.897de269.js.map